<%= simple_form_for @content, url: @section.present? ? section_path(@casebook, @section) : @resource.present? ? resource_path(@casebook, @resource) : casebook_path(@casebook), html: { class: 'casebook-details' } do |f| %>
	<% if @section.present? %>
	  <header class="casebook-header">
	    <a class="casebook-title" href="<%= edit_casebook_path(@casebook) %>">
	      <%= @casebook.title %>
	    </a>
	    <div class="collaborators">
	      <%= render partial: 'content/collaborators', locals: {content: @casebook} %>
	    </div>
	  </header>
	<% end %>

	<header class="content">
	  <% if @section.present? %>
	    <div class="breadcrumbs">
	      <%= t 'content.show.section' %>
	      <% @section.ordinals.each_with_index do |ordinal, idx| %>
          <% unless idx == @section.ordinals.length-1 %>
            <a class="breadcrumb" href="<%= edit_section_path(@casebook, @section.ordinals[0..idx].join('.')) %>" %><%= ordinal %></a>
            <span class="separator">.</span>
         <% else %>
            <span class="breadcrumb active"><%= ordinal %>
         <% end %>
        <% end %>
	    </div>
	  <% end %>

		<%= f.input :title, placeholder: t('simple_form.labels.casebook.name') %>
		<%= f.input :subtitle, placeholder: t('simple_form.labels.casebook.subtitle') %>
		<% if @section.nil? %>
		  <div class="collaborators">
		    <% @casebook.users.each do |user| %>
		    	<div class="user <%= user.verified? ? 'verified' : '' %>"><%= user.display_name %></div>
		    <% end %>
		  </div>
		<% end %>

		<%= @content.inspect %>
		<%= @content.resource.inspect %>

		There
		<%= f.simple_fields_for :resource do |r| %>
			Here
				<%= r.input :url %>
		<% end %>

	</header>
	  <section class="headnote">
		  <h5>
		    <%= t 'content.show.headnote' %>
		  </h5>
		  <%= f.input :headnote, placeholder: t('simple_form.labels.casebook.description') %>
		</section>
	<section class="edit-actions">
	  <%= f.submit t('simple_form.labels.casebook.save'), class: 'save-button' %>
	  <%= link_to t('simple_form.labels.casebook.revert'), casebook_path(@casebook), class: 'reset-button' %>
	</section>
<% end %>

<% if @resource %>
	<section class="edit-resource">
		<% if @resource.resource.is_a? TextBlock %>
			<%= form_for @resource, url: resource_path(@casebook, @resource), method: :patch do |f| %>
				<textarea id="resource_textblock_content" class="form-control" name="text_content" data-ckeditor="true">
					<%= @resource.resource.content %>
				</textarea>
				<input class="form-control" type="submit" value="<%=t('content.text-block.save-changes')%>" />
			<% end %>
		<% elsif @resource.resource.is_a? Default %>
			<%= form_for @resource, url: resource_path(@casebook, @resource), method: :patch do |f| %>
				<input class="form-control" name="link_url" value="<%= @resource.resource.url %>" />
				<input class="form-control" type="submit" value="<%=t('content.default.save-changes')%>" />
			<% end %>
		<% end %>
	</section>
<% end %>