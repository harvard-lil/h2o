<header class="advanced-search">
  <%= simple_form_for :search, url: :search, method: :get do |f| %>
    <div class="narrow-inner">
      <%= text_field_tag :q, @query, class: 'form-control',  placeholder: t('search.labels.query.placeholder') %>
    </div>
    <div class="search-options">
      <%= f.input :sort, collection: {'Title': 'display_name', 'Date': 'updated_at', 'Relevance': 'score'}, selected: params[:sort] || 'display_name', input_html: { name: 'sort' } %>
      <% if @type == 'casebooks' %>
        <%= f.input :author, collection: @authors, label_method: :attribution, value_method: :id, selected: params[:author] || 'Author Name', include_blank: 'All', input_html: { name: 'author' }, label: false, class: 'minimal' %>
      <% end %>
      <% if @type == 'casebooks' || 'users' %>
        <%= f.input :school, collection: @schools, selected: params[:school] || 'All', include_blank: 'School', input_html: { name: 'school' }, label: false %>
      <% end %>
    </div>
  <% end %>
</header>
<section class="search-results">
  <div class="content">
    <% if @results %>
      <div class="results-container">
        <div class="type-tabs">
          <div class="type-tab <% if @type == 'casebooks' %>active<% end %>">
            <a href="<%= search_path(q: @query, type: 'casebooks') %>" class="wrapper">
              <%= t 'search.results.n-casebook-results', n: @results[:casebooks].try(:total) || 0 %>
            </a>
          </div>
          <div class="type-tab <% if @type == 'cases' %>active<% end %>">
            <a href="<%= search_path(q: @query, type: 'cases') %>" class="wrapper">
              <%= t 'search.results.n-case-results', n: @results[:cases].try(:total) || 0 %>
            </a>
          </div>
          <div class="search-tab <% if @type == 'users' %>active<% end %>">
            <a href="<%= search_path(q: @query, type: 'users') %>" class="wrapper">
              <%= t 'type.results.n-user-results', n: @results[:users].try(:total) || 0 %>
            </a>
          </div>
        </div>
        <% if @main_group %>
          <%= render partial: 'results', locals: {results: @main_group.results} %>
        <% else %>
          <div class="no-results">
            <%= t 'search.results.no-results' %>
          </div>
        <% end %>
      </div>
      <% if @pagination %>
        <%= render partial: 'results', locals: {pagination: @pagination} %>
      <% else %>
        <div class="no-results">
          <%= t 'search.results.no-results' %>
        </div>
      <% end %>
    <% end %>
  </div>
</section>
