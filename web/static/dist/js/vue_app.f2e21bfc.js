(function(t){function e(e){for(var a,i,r=e[0],c=e[1],l=e[2],d=0,f=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(f.length)f.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={vue_app:0},s=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/static/dist/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([4,"chunk-vendors"]),n()})({"02c0":function(t,e,n){},"0b59":function(t,e,n){"use strict";n("35f6")},"0cf1":function(t,e,n){},"119d":function(t,e,n){"use strict";var a=n("3835"),o=(n("a15b"),n("d81d"),n("4d63"),n("c607"),n("ac1f"),n("2c3e"),n("25f0"),n("a434"),n("1276"),n("d3b7"),n("159b"),n("2ef0")),s=n.n(o);function i(t){var e=FRONTEND_URLS[t];if(!e)return console.error("".concat(t," not present in FRONTEND_URLS")),!1;var n=e;return function(t){return"/"+n.map((function(e){return s.a.get(t,e.substr(1),e)})).join("/")}}function r(t){var e=FRONTEND_URLS[t];return e?new RegExp("^"+location.origin+"/"+s.a.map(e,(function(t){return t.length>0&&"_"===t[0]?"[^/]*":t})).join("/")+"$"):(console.error("".concat(t," not present in FRONTEND_URLS")),!1)}function c(t){var e=FRONTEND_URLS[t];return e?function(t){var n=t.split("/").splice(3),o={};return s.a.zip(e,n).forEach((function(t){var e=Object(a["a"])(t,2),n=e[0],s=e[1];if(n.length>0&&"_"===n[0]){var i=n.substr(1);o[i]=s}})),o}:(console.error("".concat(t," not present in FRONTEND_URLS")),!1)}e["a"]={url:i,matcher:r,reverser:c}},"12d0":function(t,e,n){"use strict";n("0cf1")},1505:function(t,e,n){"use strict";n("3b771")},"1b27":function(t,e,n){},"1dcd":function(t,e,n){},"1ea0":function(t,e,n){"use strict";n("deb3")},"26a0":function(t,e,n){"use strict";n("c01b")},"2c31":function(t,e,n){"use strict";n("61f1")},3158:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("ac1f"),n("841c"),n("1276"),n("d3b7"),n("159b"),n("498a");function a(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var o=n[a].trim();if(o.substring(0,t.length+1)===t+"="){e=decodeURIComponent(o.substring(t.length+1));break}}return e}function o(){var t=document.querySelector("meta[name=csrf-token]"),e=a("csrftoken"),n=void 0;return t?n=t.getAttribute("content"):e&&(n=e),n}},"35f6":function(t,e,n){},"3b771":function(t,e,n){},"3bf5":function(t,e,n){"use strict";n("5f3e")},"3d64":function(t,e,n){},"3e4f":function(t,e,n){"use strict";n("46dc")},4:function(t,e,n){t.exports=n("86f5")},"44bf":function(t,e,n){"use strict";n("3d64")},"46dc":function(t,e,n){},5033:function(t,e,n){},"547f":function(t,e,n){},"5ac5":function(t,e,n){"use strict";n("1dcd")},"5f3e":function(t,e,n){},"61f1":function(t,e,n){},"650c":function(t,e,n){},"661b":function(t,e,n){"use strict";(function(t){n("ac1f"),n("1276"),n("498a");var a=n("a78b"),o=n("67c4");function s(e){var n=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),o=0;o<a.length;o++){var s=t.trim(a[o]);if(s.substring(0,e.length+1)===e+"="){n=decodeURIComponent(s.substring(e.length+1));break}}return n}e["a"]={components:{Modal:a["a"]},props:{disabled:Boolean,publishCheck:Object},data:function(){return{showModal:!1,csrftoken:s("csrftoken"),liCheck:[{text:"Cover image added",val:this.publishCheck.coverImageExists},{text:"Description added",val:this.publishCheck.descriptionExists}]}},computed:{casebook:function(){return this.$store.getters["globals/casebook"]()}},methods:{attemptPublish:function(){this.showModal=!0},cancelPublish:function(){this.showModal=!1},confirmPublish:function(){var t="/casebooks/".concat(this.casebook),e={content_casebook:{public:!0}};o["a"].patch(t,e).then(this.handleSubmitResponse,this.handleSubmitErrors)},handleSubmitResponse:function(t){var e=t.request.responseURL;window.location.href=e,this.errors={}},handleSubmitErrors:function(t){t.response.data&&(this.errors=t.response.data)}}}}).call(this,n("1157"))},"66e1":function(t,e,n){},"67c4":function(t,e,n){"use strict";var a=n("ade3"),o=n("5530"),s=(n("caad"),n("bc3a")),i=n.n(s),r=n("3158"),c={"Content-Type":"application/json",Accept:"application/json"},l=Object(r["a"])();l&&(c["X-CSRF-Token"]=l);var u=i.a.create({headers:c});u.interceptors.request.use((function(t){var e=t.method.toUpperCase();return["PUT","DELETE","PATCH"].includes(e)&&(t.headers=Object(o["a"])(Object(o["a"])({},t.headers),{},Object(a["a"])({},"X-HTTP-Method-Override",e)),t.method="post"),t})),e["a"]=u},"69ae":function(t,e,n){"use strict";n("7e96")},"6ab2":function(t,e,n){"use strict";n("650c")},"6b23":function(t,e,n){"use strict";n("02c0")},"6b2c":function(t,e,n){"use strict";n("e5a0")},"7e96":function(t,e,n){},"831e":function(t,e,n){},"845b":function(t,e,n){},"865c":function(t,e,n){},"86f5":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("67c4"),o=(n("d3b7"),n("3ca3"),n("10d1"),n("ddb0"),n("a026")),s=new WeakMap,i=new WeakMap;o["default"].directive("selectionchange",{inserted:function(t,e){s.set(t,(function(n){var a=document.getSelection(),o=t.contains(a.anchorNode),s=i.get(t)&&!o;(o||s)&&e.value(n,s?null:a),i.set(t,o)})),document.addEventListener("selectionchange",s.get(t))},unbind:function(t,e){document.removeEventListener("selectionchange",s.get(t)),s.delete(t),i.delete(t)}});var r=n("8a39"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("button",{staticClass:"action one-line add-resource",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.displayModal()}}},[t._v("Add Content")]),t.showModal?n("Modal",{attrs:{"initial-focus":t.focusTarget},on:{close:function(e){t.showModal=!1}}},[n("template",{slot:"title"},[t._v("Add Resource")]),n("template",{slot:"body"},[n("div",{staticClass:"search-tabs"},[n("a",{class:{active:t.caseTab,"search-tab":!0},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setTab("case")}}},[t._v("Find a Legal Document")]),n("a",{class:{active:t.textTab,"search-tab":!0},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setTab("text")}}},[t._v("Create Custom Content")]),n("a",{class:{active:t.linkTab,"search-tab":!0},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setTab("link")}}},[t._v("Add Link")])]),t.caseTab?n("div",{staticClass:"add-resource-body"},[n("case-searcher",{attrs:{"search-on-top":!1,"can-cancel":!0},on:{choose:t.selectCase},model:{value:t.caseQueryObj,callback:function(e){t.caseQueryObj=e},expression:"caseQueryObj"}}),n("case-results",{attrs:{queryObj:t.caseQueryObj},on:{choose:t.selectCase}})],1):t.textTab?n("div",{staticClass:"add-resource-body"},[n("form",{ref:"textForm",staticClass:"new-text",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.submitTextForm()}}},[n("div",{class:{"form-group":!0,"has-error":t.errors.name}},[n("label",{staticClass:"title"},[t._v(" Title "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.textTitle,expression:"textTitle"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control",attrs:{name:"name",type:"text"},domProps:{value:t.textTitle},on:{input:function(e){e.target.composing||(t.textTitle=e.target.value)}}}),t.errors.name?n("span",{staticClass:"help-block"},[n("strong",[t._v(t._s(t.errors.name[0].message))])]):t._e()])]),n("div",{class:{"form-group":!0,"has-error":t.errors.content}},[n("label",{staticClass:"textarea"},[t._v(" Body "),n("editor",{model:{value:t.textContent,callback:function(e){t.textContent=e},expression:"textContent"}}),t.errors.content?n("span",{staticClass:"help-block has-error"},[n("strong",[t._v(t._s(t.errors.content[0].message))])]):t._e()],1)]),n("input",{staticClass:"save-button",attrs:{type:"submit",disabled:t.pendingSubmit},domProps:{value:t.pendingSubmit?"Save in progress":"Save Text"}})])]):t.linkTab?n("div",{staticClass:"add-resource-body"},[n("h3",[t._v("Enter the URL of any asset to link from the web.")]),n("h4",[t._v("Some examples: YouTube videos, PDFs, JPG, PNG, or GIF images")]),n("form",{ref:"linkForm",staticClass:"new-link",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.submitLinkForm()}}},[n("div",{class:{"form-group":!0,"has-error":t.errors.url}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.linkTarget,expression:"linkTarget"},{name:"focus",rawName:"v-focus"}],ref:"link_body",staticClass:"form-control",attrs:{name:"url",type:"text",placeholder:"Enter a URL to add it to your casebook"},domProps:{value:t.linkTarget},on:{input:function(e){e.target.composing||(t.linkTarget=e.target.value)}}}),t.errors.url?n("span",{staticClass:"help-block has-error"},[n("strong",[t._v(t._s(t.errors.url[0].message))])]):t._e()]),n("input",{staticClass:"search-button",attrs:{type:"submit",disabled:t.pendingSubmit},domProps:{value:t.pendingSubmit?"Save in progress":"Add Link"}})])]):t._e()])],2):t._e()],1)},l=[],u=n("5530"),d=n("a78b"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-results"},[n("form",{staticClass:"case-search"},[n("div",{staticClass:"form-control-group"},[n("label",{staticStyle:{width:"66%"}},[t._v(" "+t._s(t.searchLabel)+" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.passThrough,expression:"passThrough"}],ref:"case_search",staticClass:"form-control",attrs:{id:"case_search",name:"q",type:"text",placeholder:"Search for a case to import"},domProps:{value:t.passThrough},on:{input:function(e){e.target.composing||(t.passThrough=e.target.value)}}})]),n("input",{staticClass:"search-button btn btn-primary",staticStyle:{"margin-top":"-4px"},attrs:{type:"submit",value:"Search"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.runCaseSearch.apply(null,arguments)}}})]),t.showingLimits?n("div",[n("div",{staticClass:"toggle-line"},[n("a",{on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.hideLimits.apply(null,arguments)}}},[t._v("Basic search")])]),n("div",{staticClass:"source-row"},[n("label",[t._v(" Source: "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.searchLimit,expression:"searchLimit"}],staticClass:"form-control",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.searchLimit=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:null}},[t._v("All Sources")]),t._l(t.getSources,(function(e){return n("option",{key:e.id,domProps:{value:e}},[t._v(t._s(e.name))])}))],2)]),n("div",{staticClass:"about-source"},[t._v(" "+t._s(t.searchLimit?t.searchLimit.long_description:"Search all sources")+" ")])]),n("div",{staticClass:"jurisdiction-row"},[n("label",[t._v(" Jurisdiction: "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.jurisdiction,expression:"jurisdiction"}],staticClass:"form-control",attrs:{name:"jurisdiction"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.jurisdiction=e.target.multiple?n:n[0]}}},t._l(t.jurisdictions,(function(e){return n("option",{key:e.val,domProps:{value:e.val}},[t._v(t._s(e.name))])})),0)])]),n("label",[t._v(" Decision Date "),n("div",{staticClass:"date-row form-control-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.after_date,expression:"after_date"}],staticClass:"form-control",attrs:{name:"after_date",type:"date",placeholder:"YYYY-MM-DD"},domProps:{value:t.after_date},on:{blur:t.reformatDates,input:function(e){e.target.composing||(t.after_date=e.target.value)}}}),n("span",[t._v(" - ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.before_date,expression:"before_date"}],staticClass:"form-control",attrs:{name:"before_date",type:"date",placeholder:"YYYY-MM-DD"},domProps:{value:t.before_date},on:{blur:t.reformatDates,input:function(e){e.target.composing||(t.before_date=e.target.value)}}})])])]):n("div",[n("a",{on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.showLimits.apply(null,arguments)}}},[t._v("Advanced search options")])])])])},h=[],p=n("3835"),m=n("9558"),b=(n("ac1f"),n("99af"),n("e25e"),n("2ef0")),v=n.n(b),g=n("b85c"),_=(n("498a"),n("466d"),n("d81d"),n("2ca0"),n("1276"),n("00b4"),n("5319"),n("4de4"),n("fb6a"),n("b0c0"),n("119d")),y=["chapter","unit","part"],k={test:/^[0-9]+$/,level:parseInt},C={test:/^[ivxl]+$/,level:j},x={test:/^[a-z]$/,level:function(t){return parseInt(t,36)-9}},T=/^(([0-9]+|[a-z]|[ivxl]+)[.:)])+/,w=/^(a[.]l[.]a[.]|u[.]s[.])/,O=/[.:)]/;function S(t){var e=t.trim(),n=e.toLowerCase(),a=!1;if(n.match(w))return{numeral_stack:[],title:t};var o,s=Object(g["a"])(y);try{for(s.s();!(o=s.n()).done;){var i=o.value;n.startsWith(i)&&(a=!0,n=n.substr(i.length).trim())}}catch(p){s.e(p)}finally{s.f()}var r=T.exec(n);if(!r)return{numeral_stack:[],title:t};var c,l=[],u=Object(g["a"])(r[0].split(O));try{for(u.s();!(c=u.n()).done;){var d=c.value;l.push({arabic:d.match(k.test)?k.level(d):-1,roman:d.match(C.test)?C.level(d):-1,letter:d.match(x.test)?x.level(d):-1})}}catch(p){u.e(p)}finally{u.f()}a&&(l=l.map((function(t){return v.a.fromPairs(v.a.toPairs(t).map((function(t){return["top_"+t[0],t[1]]})))}))),l.pop();var f=n.length-r[0].length,h=e.substr(e.length-f).trim();return{numeral_stack:l,title:h}}function j(t){var e={i:1,v:5,x:10,l:50,c:100};if(null==t)return-1;for(var n,a,o=e[t.charAt(0)],s=1;s<t.length;s++)a=e[t.charAt(s)],n=e[t.charAt(s-1)],a<=n?o+=a:o=o-2*n+a;return o}function E(t){var e,n=[],a=[];function o(t){return t.length}function s(t){return v.a.fromPairs([v.a.minBy(v.a.toPairs(t).filter((function(t){return t[1]>-1})),(function(t){return t[1]}))])}function i(t,e,n){var a=t.slice();while(a.length>0){var o=a.pop(),s=v.a.keys(o)[0];if(n(o[s],e[s]))return a.push(o),a}return!1}function r(t,e){var n=e.numeral_stack,a=e.title,r={title:a};if(0===n.length){if(t===[])return r.enum=[1],t=[{blank:1}],[t,r];var c=t[t.length-1]||{blank:0};return c.blank?(c.blank+=1,r.depth=o(t),[t,r]):(t.push({blank:1}),r.depth=o(t),[t,r])}if(1===n.length){if(v.a.keys(n[0])[0].startsWith("top_"))try{t=t.filter((function(t){return v.a.keys(t)[0].startsWith("top_")}))}catch(_){console.warn(_)}var l=v.a.some(v.a.values(n[0]),(function(t){return 1===t}));if(l){var u=s(n[0]);return t.push(u),r.depth=o(t),[t,r]}var d=n.pop(),f=i(t,d,(function(t,e){return t+1===e}));if(f){t=f;var h=t[t.length-1];return h[v.a.keys(h)[0]]+=1,r.depth=o(t),[t,r]}var p=i(t,d,(function(t,e){return t<e}));if(p){t=p;var m=t[t.length-1],b=v.a.keys(m)[0];return m[b]=d[b],r.depth=o(t),[t,r]}var g=s(d);return t.push(g),r.depth=o(t),[t,r]}return t=n.map((function(e,n){return n<t.length?v.a.pick(e,v.a.keys(t[n])):s(e)})),r.depth=o(t),[t,r]}var c,l=Object(g["a"])(t);try{for(l.s();!(c=l.n()).done;){var u=c.value,d=r(n,u);n=d[0],e=d[1],a.push(e)}}catch(f){l.e(f)}finally{l.f()}return a}var A=/https?:\/\/(?:[\w]+\.)(?:\.?[\w]{2,})[^ ]*/;function N(t){return!!t.match(A)}function $(t){var e=t.match(A);return e&&1===e.length?e[0]:t}function D(t){var e=window.location.origin;return t.indexOf(e)>=0}function I(t){var e=v.a.keys(FRONTEND_URLS).map((function(t){return{name:t,match:_["a"].matcher(t),reverser:_["a"].reverser(t)}})),n=e.filter((function(e){return e.match.exec(t)})).map((function(e){return e.reverser(t)}));return n.length>0&&n[0]}function M(t,e){return e.search_regexes.map((function(n){var a=n.name,o=n.regex,s=n.fuzzy;return o.test(t)&&{resource_type:"Temp",display_type:a,source:v.a.pick(e,["id","sourceIndex"]),query:o.exec(t)[0],fuzzy:!!s}})).filter((function(t){return t}))}function L(t,e){var n=e.map((function(e){return M(t,e)})).filter((function(t){return t.length>0}));if(n.length>0)return{resource_type:"Temp",guesses:v.a.flatten(n)};if(D(t)){var a=I(t);return v.a.has(a,"caseId")?{resource_type:"Case",display_type:"Case",resource_id:a.caseId}:v.a.has(a,"casebookId")?{resource_type:"Clone",display_type:"Clone",casebookId:a.casebookId,sectionId:a.sectionId||a.resourceId,sectionOrd:a.sectionOrd||a.resourceOrd}:v.a.has(a,"titleSlug")?{resource_type:"Clone",display_type:"Clone",userSlug:a.userSlug,titleSlug:a.titleSlug,ordSlug:a.ordSlug}:{resource_type:"Link",display_type:"Link",url:$(t)}}return N(t)?{resource_type:"Link",display_type:"Link",url:$(t)}:{resource_type:"TextBlock",display_type:"Custom Content",title:t}}function R(t){var e=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),n=e,a=n.map(S),o=E(a);return o}function P(t,e){function n(t,e){if(0===e.length||!t)return t;var a=e[0],o=e.slice(1);return a>=t.children.length?null:n(t.children[a],o)}for(var a={title:"Root",type:"root",children:[]},o={},s=[],i=0;i<t.length;i++){var r=i>0&&t[i-1].depth||1,c=i+1<t.length&&t[i+1].depth||1,l=t[i],u=l.depth,d=l.title;while(r>u)s.pop(),r--;var f={title:d,resource_type:"Temp",children:[]},h=L(d,e),p=c>u;p?f.resource_type="Section":v.a.merge(f,v.a.omit(h,["guesses"])),o[f.resource_type]=v.a.get(o,f.resource_type,0)+1;var m=n(a,s);p&&s.push(m.children.length),m.children.push(f)}return[a,o]}var F={cleanDocLines:R,structureOutline:P,guessLineType:L},H=n("2f62"),q=Object(H["a"])("case_search"),U=q.mapActions,B=q.mapGetters,G=[{val:"",name:"All Jurisdictions"},{val:"ala",name:"Alabama"},{val:"alaska",name:"Alaska"},{val:"am-samoa",name:"American Samoa"},{val:"ariz",name:"Arizona"},{val:"ark",name:"Arkansas"},{val:"cal",name:"California"},{val:"colo",name:"Colorado"},{val:"conn",name:"Connecticut"},{val:"dakota-territory",name:"Dakota Territory"},{val:"dc",name:"District of Columbia"},{val:"del",name:"Delaware"},{val:"fla",name:"Florida"},{val:"ga",name:"Georgia"},{val:"guam",name:"Guam"},{val:"haw",name:"Hawaii"},{val:"idaho",name:"Idaho"},{val:"ill",name:"Illinois"},{val:"ind",name:"Indiana"},{val:"iowa",name:"Iowa"},{val:"kan",name:"Kansas"},{val:"ky",name:"Kentucky"},{val:"la",name:"Louisiana"},{val:"mass",name:"Massachusetts"},{val:"md",name:"Maryland"},{val:"me",name:"Maine"},{val:"mich",name:"Michigan"},{val:"minn",name:"Minnesota"},{val:"miss",name:"Mississippi"},{val:"mo",name:"Missouri"},{val:"mont",name:"Montana"},{val:"native-american",name:"Native American"},{val:"navajo-nation",name:"Navajo Nation"},{val:"nc",name:"North Carolina"},{val:"nd",name:"North Dakota"},{val:"neb",name:"Nebraska"},{val:"nev",name:"Nevada"},{val:"nh",name:"New Hampshire"},{val:"nj",name:"New Jersey"},{val:"nm",name:"New Mexico"},{val:"n-mar-i",name:"Northern Mariana Islands"},{val:"ny",name:"New York"},{val:"ohio",name:"Ohio"},{val:"okla",name:"Oklahoma"},{val:"or",name:"Oregon"},{val:"pa",name:"Pennsylvania"},{val:"pr",name:"Puerto Rico"},{val:"ri",name:"Rhode Island"},{val:"sc",name:"South Carolina"},{val:"sd",name:"South Dakota"},{val:"tenn",name:"Tennessee"},{val:"tex",name:"Texas"},{val:"tribal",name:"Tribal Jurisdictions"},{val:"uk",name:"United Kingdom"},{val:"us",name:"United States"},{val:"utah",name:"Utah"},{val:"va",name:"Virginia"},{val:"vi",name:"Virgin Islands"},{val:"vt",name:"Vermont"},{val:"wash",name:"Washington"},{val:"wis",name:"Wisconsin"},{val:"w-va",name:"West Virginia"},{val:"wyo",name:"Wyoming"}],V={props:["searchOnTop","canCancel","value","searchLabel"],data:function(){return{jurisdictions:G,showingLimits:!1,chosenSource:null,overrideSource:!1}},watch:{passThrough:function(t){}},methods:Object(u["a"])(Object(u["a"])({},U(["fetchForAllSources","fetchForSource","fetchSources"])),{},{showLimits:function(){this.showingLimits=!0,this.updateValue(this.value)},hideLimits:function(){this.showingLimits=!1,this.updateValue(this.value)},reformatDates:function(){function t(t,e){var n=Object(m["a"])(/([0-9]{4})\x2D?([0-9]{1,2})?\x2D?([0-9]{1,2})?/,{year:1,month:2,day:3});if("after_date"===e){var a=n.exec(t),o=Object(p["a"])(a,4),s=(o[0],o[1]),i=o[2],r=o[3];if(!s)return;return i=i||"01",i=1==i.length?"0"+i:i,r=r||"01",r=1==r.length?"0"+r:r,"".concat(s,"-").concat(i,"-").concat(r)}if("before_date"===e){var c=n.exec(t),l=Object(p["a"])(c,4),u=(l[0],l[1]),d=l[2],f=l[3];if(!u)return;if(!d)return"".concat(u,"-12-31");if(d=1==d.length?"0"+d:d,!f){var h=[31,28,31,30,31,30,31,31,30,31,30,31],b=parseInt(d)-1;return b=b>11?11:b,"".concat(u,"-").concat(d,"-").concat(h[b])}return f=1==f.length?"0"+f:f,"".concat(u,"-").concat(d,"-").concat(f)}return t}var e=v.a.mapValues(this.cleanQuery,t);return this.$emit("input",e),e},runCaseSearch:function(){var t=this.reformatDates();""!==t.query&&(this.showingLimits&&t.searchLimit?this.fetchForSource({queryObj:t,source:this.searchLimit}):this.fetchForAllSources({queryObj:t}),this.$emit("input",t))},emitCancel:function(){this.$emit("cancel",null)},emitChoice:function(t){this.$emit("choose",t)},guessSource:function(t){var e=F.guessLineType(t,this.getSources),n=e.guesses;n&&n.length>0?this.chosenSource=this.getSources[n[0].source.sourceIndex]:this.chosenSource=this.getSources[0]},updateValue:function(t){this.showingLimits||this.guessSource(t.query),this.$emit("input",this.cleaned(t))},cleaned:function(t){var e=this.showingLimits?["query","jurisdiction","before_date","after_date","searchLimit"]:["query"];return v.a.pickBy(t,(function(t,n){return t&&""!==t&&e.indexOf(n)>-1}))}}),computed:Object(u["a"])(Object(u["a"])({},B(["getSources"])),{},{displayedSearchLabel:function(){return this.searchLabel||""},cleanQuery:function(){var t=this.cleaned(this.value);return t.query?t:{query:""}},after_date:{get:function(){return this.value.after_date},set:function(t){this.updateValue(Object(u["a"])(Object(u["a"])({},this.value),{},{after_date:t}))}},before_date:{get:function(){return this.value.before_date},set:function(t){this.updateValue(Object(u["a"])(Object(u["a"])({},this.value),{},{before_date:t}))}},jurisdiction:{get:function(){return this.value.jurisdiction||""},set:function(t){this.updateValue(Object(u["a"])(Object(u["a"])({},this.value),{},{jurisdiction:t}))}},passThrough:{get:function(){return this.value.query},set:function(t){this.updateValue(Object(u["a"])(Object(u["a"])({},this.value),{},{query:t}))}},searchLimit:{get:function(){return this.value.searchLimit||null},set:function(t){this.updateValue(Object(u["a"])(Object(u["a"])({},this.value),{},{searchLimit:t}))}}}),mounted:function(){this.guessSource(this.value.query)}},Y=V,z=(n("6ab2"),n("2877")),W=Object(z["a"])(Y,f,h,!1,null,"33e9ba74",null),Q=W.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-results"},[t.searchResults.allPending?n("div",{staticClass:"search-alert"},[t._m(0),n("loading-spinner")],1):t.searchResults.emptyResults?n("div",{staticClass:"search-results-wrapper"},[t._m(1)]):t.searchResults.unRun?n("div",{staticClass:"search-results-wrapper"},[t._m(2)]):n("div",{staticClass:"search-results-wrapper"},t._l(t.searchResults.results,(function(e){return n("div",{key:e.id,staticClass:"search-results-entry"},[n("div",{staticClass:"name-column"},[n("a",{staticClass:"wrapper",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.emitChoice(e)}}},[n("span",{attrs:{title:e.fullName}},[t._v(t._s(e.shortName))])])]),n("div",{staticClass:"cite-column"},[n("a",{staticClass:"wrapper",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.emitChoice(e)}}},[n("span",{attrs:{title:e.fullCitations}},[t._v(t._s(e.shortCitations))])])]),n("div",{staticClass:"date-column"},[n("a",{staticClass:"wrapper",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.emitChoice(e)}}},[t._v(t._s(e.effectiveDate))])]),n("div",{staticClass:"preview-column"},[n("a",{attrs:{href:e.url,target:"_blank",rel:"noopener noreferrer"}},[t._v(t._s(e.sourceName))])])])})),0)])},J=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"spinner-message"},[n("div",[t._v("Searching")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-alert"},[n("span",[t._v("No legal documents found matching your search")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-alert"},[n("span",[t._v("Click Search to run your search")])])}],X=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Z=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"lds-ellipsis"},[n("div"),n("div"),n("div"),n("div")])}],tt=(n("d8a4"),{}),et=Object(z["a"])(tt,X,Z,!1,null,"44b8022a",null),nt=et.exports,at=Object(H["a"])("case_search"),ot=at.mapActions,st=at.mapGetters,it={components:{LoadingSpinner:nt},data:function(){return{delayedObj:{}}},props:["queryObj"],watch:{queryObj:v.a.debounce((function(t){this.delayedObj=t}),1e3)},computed:{sources:function(){return this.getSources()},searchResults:function(){return this.getSearch()(this.delayedObj)}},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},st(["getSearch","getSources"])),ot(["toggleSource"])),{},{emitChoice:function(t){this.$emit("choose",t)},internalToggleSource:function(t){this.toggleSource({source_id:t,queryObj:this.delayedObj})}}),mounted:function(){this.delayedObj=this.queryObj}},rt=it,ct=(n("1505"),Object(z["a"])(rt,K,J,!1,null,"57d7b90d",null)),lt=ct.exports,ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"textarea",attrs:{id:t.taID},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})},dt=[],ft={data:function(){return{taID:v.a.uniqueId("tinymce-vue-")}},props:["value"],mounted:function(){var t=window.initRichTextEditor(this.$refs.textarea),e=this;t.then((function(t){var n=Object(p["a"])(t,1),a=n[0];a.on("change input undo redo",(function(){e.$emit("input",a.getContent())}))}))},beforeDestroy:function(){window.tinyMCE.remove(this.$refs.textarea)}},ht=ft,pt=Object(z["a"])(ht,ut,dt,!1,null,null,null),mt=pt.exports,bt=Object(H["a"])("case_search"),vt=bt.mapActions,gt={components:{Modal:d["a"],CaseSearcher:Q,CaseResults:lt,editor:mt},props:["casebook","section"],data:function(){return{pendingSubmit:!1,showModal:!1,currentTab:"case",caseQueryObj:{query:""},textTitle:"",textContent:"",linkTarget:"",errors:{}}},computed:{focusTarget:function(){return this.caseTab?this.$refs.case_search:this.textTab?this.$refs.text_body:this.linkTab?this.$refs.link_body:null},caseTab:function(){return"case"===this.currentTab},textTab:function(){return"text"===this.currentTab},linkTab:function(){return"link"===this.currentTab}},methods:Object(u["a"])(Object(u["a"])({},vt(["fetch"])),{},{docImportUrl:_["a"].url("from_source"),docAddUrl:_["a"].url("new_legal_doc"),displayModal:function(){this.showModal=!0},properType:function(){return this.sectionType[0].toUpperCase()+this.sectionType.substr(1)},setTab:function(t){var e=this,n=0;function a(){e.$refs.case_search?e.$refs.case_search.focus():(n+=1,n<10&&e.$nextTick(a))}this.currentTab=t,a()},runCaseSearch:function(){""!==this.caseQuery&&this.fetch({query:this.caseQuery})},submitCaseForm:function(){},submitTextForm:function(){var t=new FormData(this.$refs.textForm);t.append("section",this.section),t.set("content",this.textContent);var e="/casebooks/".concat(this.casebook,"/new/text");this.pendingSubmit=!0,a["a"].post(e,t).then(this.handleSubmitResponse,this.handleSubmitErrors)},submitLinkForm:function(){var t=new FormData(this.$refs.linkForm);t.append("section",this.section);var e="/casebooks/".concat(this.casebook,"/new/link");this.pendingSubmit=!0,a["a"].post(e,t).then(this.handleSubmitResponse,this.handleSubmitErrors)},selectCase:function(t){var e=this,n=this.docImportUrl({sourceId:t.source_id}),o=this.docAddUrl({casebookId:this.casebook}),s=new FormData;s.append("section",this.section);var i=this.handleSubmitResponse;this.pendingSubmit=!0,a["a"].post(n,{id:t.id}).then((function(t){s.append("resource_id",t.data.id),a["a"].post(o,s).then(i,e.handleSubmitErrors)}))},handleSubmitResponse:function(t){var e=t.request.responseURL;window.location.href=e,this.errors={},this.pendingSubmit=!1},handleSubmitErrors:function(t){this.pendingSubmit=!1,t.response.data&&(this.errors=t.response.data)}})},_t=gt,yt=(n("6b2c"),Object(z["a"])(_t,c,l,!1,null,null,null)),kt=yt.exports,Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"audit-flow"}},[t.noSave?t._e():n("button",{staticClass:"action one-line save",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.save.apply(null,arguments)}}},[t._v("Save")]),n("publish-button",{attrs:{disabled:!t.allNodesSpecified,publishCheck:t.publishCheck}}),t.allNodesSpecified?t._e():n("button",{staticClass:"action audit-casebook",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.startAudit()}}},[t._v("Finalize entries")])],1)},xt=[],Tt=(n("159b"),n("e562"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"publish-button"}},[n("button",{staticClass:"action publish one-line",attrs:{type:"button",disabled:t.disabled,title:t.disabled?"Some resources are incomplete. Finalize Entries below.":"Publish"},on:{click:t.attemptPublish}},[t._v(" Publish ")]),t.showModal?n("Modal",{on:{close:function(e){t.showModal=!1}}},[n("template",{slot:"title"},[t._v("Confirm Publish")]),n("template",{slot:"body"},[n("p",[t._v("Are you ready to publish your book?")]),t.publishCheck.isVerifiedProfessor?n("div",{attrs:{id:"prof-prompt"}},[t._v(" You're almost ready to publish your book! The following elements are optional, but can make your book more discoverable by students and colleagues: "),n("ul",{staticClass:"fa-ul"},[this.publishCheck.coverImageFlag?n("li",[this.publishCheck.coverImageExists?n("span",{staticClass:"fa-li"},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-check fa-fw"}})],1):n("span",{staticClass:"fa-li"},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-xmark fa-fw"}})],1),t._v(" Cover Photo ")]):t._e(),n("li",[this.publishCheck.descriptionExists?n("span",{staticClass:"fa-li"},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-check fa-fw"}})],1):n("span",{staticClass:"fa-li"},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-xmark fa-fw"}})],1),t._v(" Description ")])]),t._v(" We also encourage you to share your work with your colleagues or on social media! Your book is an important contribution to open education for law and we hope you'll help others find it and use it in their own classrooms. Because you are a verified professor, your book will automatically be surfaced on H2O's search page and will appear in web searches. ")]):t._e(),n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"modal-button cancel",on:{click:t.cancelPublish}},[t._v("Go Back")]),n("button",{staticClass:"modal-button confirm",on:{click:t.confirmPublish}},[t._v("Publish")])])])],2):t._e()],1)}),wt=[],Ot=n("661b"),St=Ot["a"],jt=(n("97fb"),Object(z["a"])(St,Tt,wt,!1,null,null,null)),Et=jt.exports,At=Object(H["a"])("case_search"),Nt=At.mapGetters,$t={components:{PublishButton:Et},props:{noSave:Boolean,publishCheck:Object},data:function(){return{autoAudited:{}}},methods:{save:function(){var t=document.querySelector("form.edit_content_resource")||document.querySelector("form.edit_content_section")||document.querySelector("form.edit_content_casebook");t.submit()},bulkAddUrl:_["a"].url("new_from_outline"),startAudit:function(){var t=this;function e(e){var n=v.a.reverse(e.slice()),a=250;function o(){var e=n.pop();if(e){if(v.a.has(e,"title")){var s=F.guessLineType(e.title,t.getSources);if("Temp"===s.resource_type)s.guesses.forEach((function(e){var n=e.query,a=e.source;t.$store.dispatch("case_search/fetchForSource",{queryObj:{query:n},source:a})}));else{var i={query:e.title};t.$store.dispatch("case_search/fetchForAllSources",{queryObj:i})}}setTimeout(o,a)}}o()}if(!this.allNodesSpecified){this.inAuditMode=!0;var n=this.needingAudit.map(this.$store.getters["table_of_contents/getNode"]);e(n);var a=this.needingAudit[0];this.auditStep(a)}},auditStep:function(t){var e=this;this.$store.dispatch("table_of_contents/revealNode",{casebook:this.casebook,id:t}).then((function(){var n=e.$store.getters["table_of_contents/getNode"](t);if(n){var a=n.url.split("/"),o=a[a.length-2],s=document.getElementById(o),i=s.getBoundingClientRect().top+window.pageYOffset-60;window.scrollTo({top:i,behavior:"smooth"}),e.$store.dispatch("table_of_contents/setAudit",{id:t})}}))},handleSubmitResponse:function(t){this.$store.dispatch("table_of_contents/clearAudit",{id:t}),this.$store.dispatch("table_of_contents/fetch",{casebook:this.casebook,subsection:this.section})},handleSubmitErrors:function(t){console.error(t)}},watch:{allSearchResults:function(t){var e=this,n=this;t.forEach((function(t){var o=t.url,s=t.id,i=(t.queryObj,t.searchResults);if(i&&v.a.has(i,"results")&&v.a.isArray(i.results)&&1===i.results.length){var r=i.results[0],c={from:"Temp",to:"LegalDocument",id:r.id,source_id:r.source_id,title:r.shortName};v.a.has(e.autoAudited,s)||(e.autoAudited[s]=!0,a["a"].patch(o,c).then((function(){return n.handleSubmitResponse(s)}),e.handleSubmitError))}}))},currentAuditId:function(t){"None"===t&&(this.inAuditMode=!1),this.inAuditMode&&this.auditStep(this.currentAuditId)}},computed:Object(u["a"])(Object(u["a"])({},Nt(["getSources","getSearch"])),{},{inAuditMode:{get:function(){return this.$store.getters["globals/inAuditMode"]()},set:function(t){this.$store.commit("globals/setAuditMode",t)}},currentAuditId:function(){return this.needingAudit.length>0?this.needingAudit[0]:"None"},casebook:function(){return this.$store.getters["globals/casebook"]()},section:function(){return this.$store.getters["globals/section"]()},needingAudit:function(){return this.$store.getters["table_of_contents/auditTargets"](this.section||this.casebook)},allNodesNeedingSearch:function(){var t=this,e=[],n=this;return this.needingAudit.forEach((function(a){var o=t.$store.getters["table_of_contents/getNode"](a);if(o&&"Temp"===o.resource_type&&v.a.has(o,"title")){var s=F.guessLineType(o.title,t.getSources);if("Temp"===s.resource_type){s.guesses.forEach((function(t){var e=t.query,a=t.source;n.$store.dispatch("case_search/fetchForSource",{queryObj:{query:e},source:a})}));var i={query:s.guesses[0].query};e.push({url:o.url,id:o.id,queryObj:i})}else{var r={query:o.title};n.$store.dispatch("case_search/fetchForAllSources",{queryObj:r}),e.push({url:o.url,id:o.id,queryObj:r})}}})),e},allSearchResults:function(){var t=this;return this.allNodesNeedingSearch.map((function(e){return Object(u["a"])(Object(u["a"])({},e),{},{searchResults:t.getSearch(e.queryObj)})}))},allNodesSpecified:function(){return 0===this.needingAudit.length}})},Dt=$t,It=(n("5ac5"),Object(z["a"])(Dt,Ct,xt,!1,null,null,null)),Mt=It.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.finalizingGroup?n("Modal",{on:{close:function(e){t.finalizingGroup=!1}}},[n("template",{slot:"title"},[t._v("Group Casebooks")]),n("template",{slot:"body"},[n("form",{staticClass:"form-group",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.createGroup.apply(null,arguments)}}},[n("div",[t.selectedCoAuthors.length>0?n("div",[t._v(" The following co-authors will also see this group: "),n("span",[t._v(t._s(t.selectedCoAuthors))])]):t._e(),n("label",{attrs:{for:"newGroupTitle"}},[t._v(" Title ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.newGroupTitle,expression:"newGroupTitle"}],staticClass:"form-control",attrs:{name:"newGroupTitle",type:"text",autofocus:""},domProps:{value:t.newGroupTitle},on:{input:function(e){e.target.composing||(t.newGroupTitle=e.target.value)}}}),t.takenTitle?n("div",{staticClass:"invalid-feedback"},[t._v(" This title is in use by you or one of your co-authors already. ")]):t._e()]),n("br"),n("div",[n("label",{attrs:{for:"current"}},[t._v(" Current Edition ")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.newGroupCurrent,expression:"newGroupCurrent"}],staticClass:"form-control",attrs:{name:"current"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.newGroupCurrent=e.target.multiple?n:n[0]}}},t._l(t.selectedCasebooks,(function(e){return n("option",{key:e.id,domProps:{value:e}},[t._v(t._s(e.title))])})),0)]),t.user.public_url?n("div",{staticClass:"advice"},[t._v(" The current edition will be available at "),n("span",[t._v(t._s(t.newPublicUrl))])]):n("div",{staticClass:"advice"},[t._v(" Your author URL isn't yet set. To give this casebook a nice public url set it up "),n("a",{attrs:{target:"_blank",href:"/accounts/edit/"}},[t._v(" on your profile page")]),t._v(". ")]),n("br"),n("button",{staticClass:"btn btn-primary full-width",attrs:{disabled:t.takenTitle,type:"submit"},on:{submit:t.createGroup}},[t._v("Group these casebooks")])])])],2):t._e(),n("div",{staticClass:"dashboard-header"},[n("h1",[t._v(t._s(t.user.name))]),t.user.pronouns?n("span",{staticClass:"pronouns"},[t._v(" ("+t._s(t.user.pronouns)+")")]):t._e(),t.user.personal_site?n("a",{staticClass:"personal-site",attrs:{href:t.user.personal_site}},[t._v(" "+t._s(t.user.personal_site)+" ")]):t._e()]),t.user.short-t.bio?n("div",{staticClass:"short-bio"},[t._v(" "+t._s(t.user.short_bio)+" ")]):t._e(),n("h2",{staticClass:"casebooks"},[t._v("Casebooks")]),t.user.active?n("div",{staticClass:"archived-link"},[n("a",{attrs:{href:"/casebooks/archived/"}},[t._v("[View Archived Casebooks]")])]):t._e(),n("hr",{staticClass:"owned"}),t.user.active&&!t.managingCasebooks?n("div",{staticClass:"management-links"},[n("a",{attrs:{href:"#",role:"button"},on:{click:t.startManagement}},[t._v("Manage Casebooks")])]):t._e(),t.user.active&&t.managingCasebooks?n("div",{staticClass:"management-links"},[n("ul",[n("li",[n("a",{class:{disabled:!t.canArchive},attrs:{href:"#",role:"button"},on:{click:t.archiveCasebooks,mouseover:function(e){return t.activateHelp(t.archiveHelp)},mouseleave:t.deactivateHelp}},[t._v(" Archive selected ")])]),n("li",[n("a",{class:{disabled:!t.canUngroup},attrs:{href:"#",role:"button"},on:{click:t.unTitle,mouseover:function(e){return t.activateHelp(t.ungroupHelp)},mouseleave:t.deactivateHelp}},[t._v(" Ungroup selected ")])]),n("li",[n("a",{class:{disabled:!t.canGroup},attrs:{href:"#",role:"button"},on:{click:t.finalizeGroup,mouseover:function(e){return t.activateHelp(t.groupHelp)},mouseleave:t.deactivateHelp}},[t._v(" Group selected ")])]),n("li",[n("a",{attrs:{title:"Finish managing casebooks",href:"#",role:"button"},on:{click:t.stopManagement}},[t._v("Done")])])]),n("div",{staticClass:"help-manage",domProps:{innerHTML:t._s(t.currentHelp)}})]):t._e(),n("div",{staticClass:"content-browser"},[n("div",{class:t.managingCasebooks?"content-selectable":"content-clickable"},[t._l(t.casebooks,(function(e){return n("casebook",{key:e.id,attrs:{selectable:t.managingCasebooks,casebook:e},model:{value:t.selectedCasebooks,callback:function(e){t.selectedCasebooks=e},expression:"selectedCasebooks"}})})),t.user.active?n("div",{staticClass:"create-casebook-wrapper"},[t._m(0)]):t._e()],2)]),t._l(t.titles,(function(e){return n("div",{key:e.id,staticClass:"title-holder"},[n("div",{staticClass:"title-divider"},[n("span",{staticClass:"title-name"},[t._v(t._s(e.name))]),n("span",{staticClass:"title-slug"},[t.user.public_url?n("a",{attrs:{href:t.titleUrl(e)}},[t._v(" "+t._s(t.titleUrl(e)))]):n("a",{attrs:{href:"/accounts/edit/"}},[t._v("Set up your public url ")])])]),t.user.active&&t.managingCasebooks?n("div",{staticClass:"management-links"},[n("ul",[n("li",[n("a",{class:{disabled:!t.canAddToGroup},on:{click:function(n){return t.addToTitle(e)},mouseover:function(n){t.activateTitleHelp(t.addToGroupHelp(e),e)},mouseleave:t.deactivateTitleHelp}},[t._v(" Add selected to group ")])]),n("li",[n("a",{class:{disabled:!t.canSetCurrent(e)},on:{click:function(n){return t.setCurrent(e)},mouseover:function(n){t.activateTitleHelp(t.setCurrentTitleHelp(e),e)},mouseleave:t.deactivateTitleHelp}},[t._v(" Set current edition ")])]),n("li",[n("a",{on:{click:function(n){return t.deleteTitle(e)}}},[t._v(" Delete group ")])])]),n("div",{staticClass:"help-manage",domProps:{innerHTML:t._s(t.titleHelp(e))}})]):t._e(),e.expanded?n("div",{staticClass:"content-browser"},[n("div",{class:t.managingCasebooks?"content-selectable":"content-clickable"},[n("div",{staticClass:"current-edition"},[n("casebook",{attrs:{casebook:e.current,selectable:t.managingCasebooks},model:{value:t.selectedCasebooks,callback:function(e){t.selectedCasebooks=e},expression:"selectedCasebooks"}}),n("div",[t._v(" Current edition ")])],1),t._l(t.outDated(e),(function(e){return n("casebook",{key:e.id,attrs:{casebook:e,selectable:t.managingCasebooks},model:{value:t.selectedCasebooks,callback:function(e){t.selectedCasebooks=e},expression:"selectedCasebooks"}})}))],2)]):n("div",{staticClass:"content-browser"},[n("div",{staticClass:"current-edition"},[n("casebook",{attrs:{casebook:e.current,selectable:t.managingCasebooks},model:{value:t.selectedCasebooks,callback:function(e){t.selectedCasebooks=e},expression:"selectedCasebooks"}}),n("div",[t._v(" Current edition ")])],1),e.casebooks&&e.casebooks.length>1?n("div",{staticClass:"expand-editions-container"},[n("a",{on:{click:function(n){return t.expandTitle(e)}}},[t._v("Show "+t._s(e.casebooks.length-1)+" other editions")])]):n("div",{staticClass:"expand-editions-container"},[t._v(" Only one edition. ")])])])}))],2)},Rt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"create-casebook-button",attrs:{type:"button","data-action":"show-casebook-modal"}},[n("div",{staticClass:"create-casebook-text"},[t._v("Create a New Casebook")])])}],Pt=(n("a15b"),n("5db7"),n("73d9"),n("caad"),n("2532"),n("7db0"),n("c740"),n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["padded",t.selected?"selected":""]},[n("div",{staticClass:"select-label-container"},[t.selectable?n("label",[t._v(" Select "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectionIndirection,expression:"selectionIndirection"}],staticClass:"casebook-check",attrs:{type:"checkbox"},domProps:{value:t.casebook,checked:Array.isArray(t.selectionIndirection)?t._i(t.selectionIndirection,t.casebook)>-1:t.selectionIndirection},on:{change:function(e){var n=t.selectionIndirection,a=e.target,o=!!a.checked;if(Array.isArray(n)){var s=t.casebook,i=t._i(n,s);a.checked?i<0&&(t.selectionIndirection=n.concat([s])):i>-1&&(t.selectionIndirection=n.slice(0,i).concat(n.slice(i+1)))}else t.selectionIndirection=o}}})]):t._e()]),n(t.clickAction,{tag:"component",staticClass:"wrapper",attrs:{href:t.outerUrl},on:{click:t.selectBook}},[n("div",{staticClass:"casebook-container"},[n("div",{class:{"content-page":!0,archived:t.casebook.is_archived,public:t.casebook.is_public,draft:!(t.casebook.is_public||t.casebook.is_archived)}},[n("div",{staticClass:"state"},[t._v(t._s(t.displayState))]),t.casebook.cover_image?n("div",{staticClass:"cover-image-container"},[n("img",{staticClass:"cover-image",attrs:{src:t.casebook.cover_image,title:"cover"}})]):n("div",{staticClass:"casebook-info"},[n("div",{staticClass:"title"},[t._v(t._s(t.casebook.title))]),n("div",{staticClass:"subtitle"},[t._v(t._s(t.casebook.subtitle))]),n("div",{staticClass:"author-info"},[n("div",{staticClass:"owner"},[n("ul",t._l(t.attributed(t.casebook.authors),(function(e){return n("li",{key:e.id,class:e.verified_professor?"verified-prof":""},[t._v(" "+t._s(e.attribution)+" ")])})),0)])])]),t.casebook.has_draft&&t.casebook.user_editable?n(t.clickAction,{tag:"component",staticClass:"wrapper",attrs:{href:t.casebook.draft_url}},[n("div",{staticClass:"unpublished-changes"},[n("span",{staticClass:"exclamation"},[t._v("!")]),n("span",{staticClass:"description"},[t._v("This casebook has unpublished changes.")])])]):t._e()],1)])])],1)}),Ft=[],Ht={props:["casebook","selectable","value"],computed:{selectionIndirection:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},clickAction:function(){return this.selectable?"div":"a"},selected:function(){var t=this;return v.a.find(this.value,(function(e){var n=e.id;return n===t.casebook.id}))},outerUrl:function(){return this.casebook.is_public?this.casebook.url:this.casebook.is_archived?this.casebook.settings_url:this.casebook.edit_url},displayState:function(){return this.casebook.is_public?"Published":this.casebook.has_draft?"with draft":this.casebook.is_archived?"Archived":"Draft"}},methods:{attributed:function(t){return v.a.filter(t,"has_attribution")},selectBook:function(){this.selectable&&(this.selectionIndirection=v.a.find(this.value,this.casebook)?v.a.difference(this.value,[this.casebook]):v.a.concat(this.value,[this.casebook]))}}},qt=Ht,Ut=(n("a3ea"),Object(z["a"])(qt,Pt,Ft,!1,null,null,null)),Bt=Ut.exports,Gt={components:{Casebook:Bt,Modal:d["a"]},data:function(){return{finalizingGroup:!1,newGroupCurrent:{},selectedCasebooks:[],newGroupTitle:"",managingCasebooks:!1,currentHelp:"&nbsp;",currentTitleHelp:"&nbsp;",currentTitleHelpId:null,casebooks:[],titles:[],user:{}}},props:["casebookList"],watch:{selectedCasebooks:function(t){t.length>=1&&(this.newGroupCurrent=this.defaultCurrent(t))}},computed:{selectedCoAuthors:function(){var t=this;return v.a.sortBy(v.a.filter(v.a.uniq(v.a.map(v.a.flatMap(this.selectedCasebooks,"authors"),"attribution")),(function(e){return e!==t.user.name}))).join(", ")},takenTitle:function(){return this.allTitleUrls.includes(this.slugifyNewTitle)},allTitleUrls:function(){return v.a.uniq(v.a.flatMap(v.a.flatMap(this.allCasebooks,"authors"),"titles"))},canArchive:function(){return v.a.every(this.selectedCasebooks,"can_archive")},archiveHelp:function(){return this.canArchive?"Archived casebooks will not be visible to others":"You must unpublish casebooks before you can archive them"},canGroup:function(){var t=v.a.map(this.casebooks,"id");return this.selectedCasebooks.length>0&&v.a.every(this.selectedCasebooks,(function(e){var n=e.id,a=e.is_public;return a&&t.includes(n)}))},groupHelp:function(){return this.canGroup?"Collect editions of the same casebook, and promote the most recent.":"Only published casebooks can be grouped. Casebooks may only belong to one group."},canUngroup:function(){var t=v.a.map(this.casebooks,"id");return this.selectedCasebooks.length>0&&v.a.find(this.selectedCasebooks,(function(e){var n=e.id;return!t.includes(n)}))},ungroupHelp:function(){return this.canUngroup?"Remove selected casebooks from groups":"None of the selected casebooks belong to a group"},uniqueSelection:function(){return 1===this.selectedCasebooks.length},hasTitledCasebooks:function(){return this.allCasebooks.titled.length>0},newPublicUrl:function(){return"".concat(window.location.origin,"/author/").concat(this.user.public_url,"/").concat(this.slugifyNewTitle)},slugifyNewTitle:function(){var t=/[^a-zA-Z0-9 _-]/g,e=this.newGroupTitle.toLowerCase().replace(t,"").replace(/ /g,"-");return 0===e.length?"***":e},titledCasebookSelected:function(){return!v.a.isEmpty(v.a.intersectionBy(v.a.flatMap(this.titles,"casebooks"),"id"),this.selectedCasebooks)},allCasebooks:function(){return this.casebooks.concat(v.a.flatMap(this.titles,"casebooks"))}},methods:{activateHelp:function(t){this.currentHelp=t},deactivateHelp:function(){this.currentHelp="&nbsp;"},activateTitleHelp:function(t,e){this.currentTitleHelp=t,this.currentTitleHelpID=e.id},deactivateTitleHelp:function(){this.currentTitleHelp="&nbsp;",this.currentTitleHelpID=null},titleHelp:function(t){var e=this.currentTitleHelp;return t.id===this.currentTitleHelpID?e:"&nbsp;"},canSetCurrent:function(t){return this.uniqueSelection&&this.selectionWithinTitle(t)},setCurrentTitleHelp:function(t){return this.canSetCurrent(t)?"Sets the current edition to the selected casebook":"Please specify a unique edition to make current"},canAddToGroup:function(t){return this.canGroup},addToGroupHelp:function(t){return this.canAddToGroup(t)?"Add selected casebooks to this group":"Only public casebooks that do not belong to another group can be added to this group"},resetManagement:function(){this.finalizingGroup=!1,this.newGroupCurrent={},this.selectedCasebooks=[],this.newGroupTitle="";var t,e=Object(g["a"])(this.titles);try{for(e.s();!(t=e.n()).done;){var n=t.value;o["default"].set(n,"expanded",!0)}}catch(a){e.e(a)}finally{e.f()}},titleUrl:function(t){return"".concat(window.location.origin,"/author/").concat(this.user.public_url,"/").concat(t.public_url,"/")},isSelected:function(t){return 1===this.selectedCasebooks.filter((function(e){return e.id===t.id})).length},createGroup:function(){if(!this.takenTitle){var t="/api/titles/",e={name:this.newGroupTitle,public_url:this.slugifyNewTitle,current:this.newGroupCurrent.id,casebooks:this.selectedCasebooks};a["a"].post(t,e).then(this.handleTitlePostResponse,this.handleTitleCreateErrors),this.resetManagement()}},handleTitlePostResponse:function(t){var e=t.data;e.expanded=!0;var n=e.casebooks;this.removeCasebooks(n),this.titles.push(e)},handleTitleCreateErrors:function(){console.error(arguments)},startManagement:function(){this.managingCasebooks=!0,this.selectedCasebooks=[],this.newGroupTitle="";var t,e=Object(g["a"])(this.titles);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.expandTitle(n)}}catch(a){e.e(a)}finally{e.f()}},expandTitle:function(t){o["default"].set(t,"expanded",!0)},archiveCasebooks:function(){var t=this;if(this.canArchive){var e,n=Object(g["a"])(this.selectedCasebooks);try{for(n.s();!(e=n.n()).done;){var o=e.value,s=new FormData;s.append("submission_type","change_visibility"),s.append("transition_to","Archived");var i=_["a"].url("casebook_settings")({casebookId:o.id});a["a"].post(i,s).then(t.handleArchiveResponse(o),console.error)}}catch(r){n.e(r)}finally{n.f()}}},handleArchiveResponse:function(t){var e=this;return function(){e.removeCasebooks([t])}},stopManagement:function(){this.managingCasebooks=!1,this.selectedCasebooks=[]},finalizeGroup:function(){if(this.canGroup){var t=v.a.sortBy(this.selectedCasebooks.map((function(t){var e=t.title;return e}))),e=v.a.takeWhile(v.a.zip(v.a.map(v.a.first(t)),v.a.map(v.a.last(t))).map((function(t){var e=Object(p["a"])(t,2),n=e[0],a=e[1];return n===a&&n}))).join("").trim();this.newGroupTitle=e,this.finalizingGroup=!0}},deleteTitle:function(t){var e="/api/titles/".concat(t.id);a["a"].delete(e).then(this.handleTitleDeleteResponse(t.id),this.handleTitleDeleteError)},addToTitle:function(t){var e=v.a.cloneDeep(t);e.casebooks=t.casebooks.concat(v.a.difference(this.selectedCasebooks,t.casebooks)),this.updateTitle(e)},selectionWithinTitle:function(t){var e=v.a.map(t.casebooks,"id");return v.a.every(this.selectedCasebooks,(function(t){var n=t.id;return e.includes(n)}))},setCurrent:function(t){this.canSetCurrent&&(t.current=this.selectedCasebooks[0],this.updateTitle(t))},updateTitle:function(t){var e="/api/titles/".concat(t.id);a["a"].put(e,t).then(this.handleTitleUpdateResponse,this.handleTitleUpdateError)},unTitle:function(){var t=this;if(this.canUngroup){var e,n=this.titles.filter((function(e){return!v.a.isEmpty(v.a.intersectionBy(e.casebooks,t.selectedCasebooks,"id"))})),a=n.filter((function(e){return v.a.isEmpty(v.a.differenceBy(e.casebooks,t.selectedCasebooks,"id"))})),o=v.a.difference(n,a),s=Object(g["a"])(a);try{for(s.s();!(e=s.n()).done;){var i=e.value;this.deleteTitle(i)}}catch(f){s.e(f)}finally{s.f()}var r,c=v.a.map(this.selectedCasebooks,"id"),l=Object(g["a"])(o);try{for(l.s();!(r=l.n()).done;){var u=r.value,d=v.a.cloneDeep(u);d.casebooks=v.a.remove(d.casebooks,(function(t){var e=t.id;return c.includes(e)})),d.current&&d.casebooks.includes(d.current)||(d.current=this.defaultCurrent(d.casebooks)),this.updateTitle(d)}}catch(f){l.e(f)}finally{l.f()}}},defaultCurrent:function(t){return v.a.last(v.a.sortBy(v.a.filter(t,"is_public"),"updated_at"))},handleTitleDeleteResponse:function(t){var e=this;return function(n){var a=v.a.findIndex(e.titles,(function(e){var n=e.id;return n===t}));if(-1!==a){var o,s=Object(g["a"])(e.titles[a].casebooks);try{for(s.s();!(o=s.n()).done;){var i=o.value;e.casebooks.push(i)}}catch(r){s.e(r)}finally{s.f()}e.titles.splice(a)}}},handleTitleDeleteError:function(t){console.error(t)},removeCasebooks:function(t){var e=v.a.map(t,"id"),n=function(t){var n=t.id;return e.includes(n)};function a(t){var e=v.a.findIndex(t,n);while(-1!==e)t.splice(e,1),e=v.a.findIndex(t,n,e)}a(this.casebooks);var o,s=Object(g["a"])(this.titles);try{for(s.s();!(o=s.n()).done;){var i=o.value;a(i.casebooks)}}catch(r){s.e(r)}finally{s.f()}},handleTitleUpdateResponse:function(t){var e=t.data,n=v.a.find(this.titles,(function(t){var n=t.id;return n===e.id}));if(n){var a,s=v.a.difference(n.casebooks,e.casebooks),i=Object(g["a"])(s);try{for(i.s();!(a=i.n()).done;){var r=a.value;this.casebooks.push(r)}}catch(l){i.e(l)}finally{i.f()}}this.removeCasebooks(e.casebooks);var c=v.a.findIndex(this.titles,(function(t){t.id;return e.id}));-1!==c?o["default"].set(this.titles,c,e):this.titles.push(e),this.resetManagement()},handleTitleUpdateError:function(t){console.error(t)},outDated:function(t){return v.a.filter(t.casebooks,(function(e){var n=e.id;return n!==t.current.id}))}},mounted:function(){this.casebooks=this.casebookList.casebooks,this.titles=this.casebookList.titles,this.user=this.casebookList.user}},Vt=Gt,Yt=(n("69ae"),Object(z["a"])(Vt,Lt,Rt,!1,null,null,null)),zt=Yt.exports,Wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},Qt=[],Kt=Object(H["a"])("globals"),Jt=Object(H["a"])("case_search"),Xt={props:["casebook","section","searchSources"],created:function(){this.casebook&&this.setCasebook(this.casebook),this.section&&this.setSection(this.section),this.searchSources&&this.setSources(this.searchSources)},methods:Object(u["a"])(Object(u["a"])({},Kt.mapMutations(["setCasebook","setSection"])),Jt.mapMutations(["setSources"]))},Zt=Xt,te=Object(z["a"])(Zt,Wt,Qt,!1,null,null,null),ee=te.exports,ne=n("2b88"),ae=n.n(ne),oe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"quick-add"}},[n("div",{staticClass:"form-control-group"},[n("form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[n("div",{staticClass:"form"},[n("div",{staticClass:"form-control-group inline-search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control",attrs:{type:"text",name:"addcontent",placeholder:"Enter title here"},domProps:{value:t.title},on:{paste:function(e){return e.preventDefault(),e.stopPropagation(),t.handlePaste.apply(null,arguments)},input:function(e){e.target.composing||(t.title=e.target.value)}}}),n("select",{directives:[{name:"model",rawName:"v-model",value:t.resource_info,expression:"resource_info"}],staticClass:"resource-type form-control",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.resource_info=e.target.multiple?n:n[0]}}},t._l(t.resource_info_options,(function(e){return n("option",{key:e.k,domProps:{value:e.value}},[t._v(t._s(e.name))])})),0),n("input",{staticClass:"form-control btn btn-primary create-button",attrs:{type:"submit",value:"Add"},on:{submit:t.handleSubmit}})])])]),t.waitingFor?n("div",{staticClass:"stats"},[n("span",[t._v(t._s(t.waitingFor))]),n("loading-spinner")],1):t._e()]),t._m(0)])},se=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"advice"},[n("span",[t._v("Enter a single title or citation, or paste in a list or outline. To learn more, review our "),n("a",{attrs:{href:"https://about.opencasebook.org/making-casebooks/#quick-add"}},[t._v("quick add documentation.")])])])}],ie=Object(H["a"])("globals"),re=Object(H["a"])("case_search"),ce=[{name:"Section",value:{resource_type:"Section"},k:0},{name:"Search",value:{resource_type:"LegalDocument"},k:1},{name:"Custom Content",value:{resource_type:"TextBlock"},k:2},{name:"Link",value:{resource_type:"Link"},k:3}],le=function(){return{title:"",resource_info:ce[0].value,resource_info_options:ce}},ue=1e3,de={components:{LoadingSpinner:nt},props:[],data:function(){return Object(u["a"])(Object(u["a"])({},le()),{},{stats:{},waitingFor:!1,unWait:function(){}})},directives:{},computed:Object(u["a"])(Object(u["a"])(Object(u["a"])({},ie.mapGetters(["casebook","section"])),re.mapGetters(["getSources"])),{},{totalIdentified:function(){return v.a.values(this.stats).reduce((function(t,e){return t+e}),0)},lineInfo:function(){return F.guessLineType(this.title,this.getSources)},desiredOrdinal:function(){var t=/^[0-9]+(\.[0-9])* /,e=this.title.match(t);if(e)return e[0]}}),watch:{lineInfo:function(){if("Unknown"!==this.lineInfo.resource_type)if("Temp"===this.lineInfo.resource_type){var t=5,e=v.a.chain(this.lineInfo.guesses).map((function(t){return{name:t.display_type,value:t}})).uniqBy((function(t){return t.name})).map((function(e){return Object(u["a"])(Object(u["a"])({},e),{},{k:t++})})).value();this.resource_info_options=v.a.concat(e,ce),this.resource_info=this.lineInfo.guesses[0]}else if("Clone"===this.lineInfo.resource_type){var n=v.a.concat([{name:this.lineInfo.display_type,value:this.lineInfo,k:5}],v.a.cloneDeep(ce));this.resource_info=n[0].value,this.resource_info_options=n}else{var a=v.a.concat([{name:this.lineInfo.display_type,value:{resource_type:this.lineInfo.resource_type},k:5}],v.a.cloneDeep(ce));this.resource_info=a[0].value,this.resource_info_options=a}}},methods:{bulkAddUrl:_["a"].url("new_from_outline"),resetForm:function(){var t=this,e=le();v.a.keys(e).forEach((function(n){t[n]=e[n]})),this.waitingFor=!1,this.unWait(),this.unWait=function(){},this.manualResourceType=!1},handleSubmit:function(){var t=v.a.pick(this.resource_info,["resource_type","url","casebookId","resource_id","sectionId","sectionOrd","userSlug","titleSlug","ordSlug"]),e=Object(u["a"])(Object(u["a"])({},t),{},{title:this.title});"Unknown"===e.resource_type&&(e.resource_type="Temp"),"Link"===e.resource_type&&(e.url||(e.url=e.title),e.title=void 0);var n={section:this.section(),data:[e]};this.postData(n)},postData:function(t){return a["a"].post(this.bulkAddUrl({casebookId:this.casebook()}),t).then(this.handleSuccess,this.handleFailure)},handleSuccess:function(t){this.$store.dispatch("table_of_contents/slowMerge",{casebook:this.casebook(),newToc:t.data}),this.resetForm()},handleFailure:function(t){console.error(t)},handlePaste:function(t){var e=this,n=(t.clipboardData||window.clipboardData).getData("text");if(n.indexOf("\n")>=0){this.waitingFor="Parsing pasted text";var a=F.cleanDocLines(n),o=F.structureOutline(a,this.getSources),s=Object(p["a"])(o,2),i=s[0],r=s[1];v.a.keys(r).map((function(t){e.stats[t]=v.a.get(e.stats,t,0)+r[t]})),this.postData({section:this.section(),data:i.children}),this.title=""}else this.title+=n},searchForCase:v.a.debounce((function(){var t=this.title;t&&this.$store.dispatch("case_search/fetchForAllSources",{query:t})}),ue)}},fe=de,he=(n("3e4f"),Object(z["a"])(fe,oe,se,!1,null,"2b058145",null)),pe=he.exports,me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"type-picker"},[n("h4",[t._v("This is a temporary entry in your casebook. Finish it below.")]),n("div",[n("div",{staticClass:"type-tabs"},[n("a",{class:{active:t.caseTab,tab:!0},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setTab("case")}}},[t._v("Case")]),n("a",{class:{active:t.textTab,tab:!0},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setTab("text")}}},[t._v("Text")]),n("a",{class:{active:t.linkTab,tab:!0},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setTab("link")}}},[t._v("Link")])]),n("div",{staticClass:"modal-body"},[t.caseTab?n("div",{staticClass:"add-resource-body"},[n("case-searcher",{attrs:{"search-on-top":!1,"can-cancel":!0},on:{choose:t.selectCase},model:{value:t.caseQueryObj,callback:function(e){t.caseQueryObj=e},expression:"caseQueryObj"}}),n("case-results",{attrs:{queryObj:t.caseQueryObj},on:{choose:t.selectCase}})],1):t.textTab?n("div",{staticClass:"add-resource-body"},[n("form",{ref:"textForm",staticClass:"new-text",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.submitTextForm()}}},[n("div",{class:{"form-group":!0,"has-error":t.errors.content}},[n("label",{staticClass:"textarea"},[t._v(" Text body "),n("editor",{model:{value:t.textContent,callback:function(e){t.textContent=e},expression:"textContent"}}),t.errors.content?n("span",{staticClass:"help-block has-error"},[n("strong",[t._v(t._s(t.errors.content[0].message))])]):t._e()],1)]),n("input",{staticClass:"save-button",attrs:{type:"submit",value:"Save text"}})])]):t.linkTab?n("div",{staticClass:"add-resource-body"},[n("h3",[t._v("Enter the URL of any asset to link from the web.")]),n("h4",[t._v("Some examples: YouTube videos, PDFs, JPG, PNG, or GIF images")]),n("form",{ref:"linkForm",staticClass:"new-link",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.submitLinkForm()}}},[n("div",{class:{"form-group":!0,"has-error":t.errors.url}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.linkTarget,expression:"linkTarget"},{name:"focus",rawName:"v-focus"}],ref:"link_body",staticClass:"form-control",attrs:{name:"url",type:"text",placeholder:"Enter a URL to add it to your casebook"},domProps:{value:t.linkTarget},on:{input:function(e){e.target.composing||(t.linkTarget=e.target.value)}}}),t.errors.url?n("span",{staticClass:"help-block has-error"},[n("strong",[t._v(t._s(t.errors.url[0].message))])]):t._e()]),n("input",{staticClass:"search-button",attrs:{type:"submit",value:"Add linked resource"}})])]):t._e()])])])},be=[],ve=Object(H["a"])("case_search"),ge=ve.mapActions,_e={components:{CaseSearcher:Q,CaseResults:lt,editor:mt},data:function(){return{showModal:!1,currentTab:"case",caseQueryObj:{query:""},textTitle:"",textContent:"",linkTarget:"",errors:{}}},computed:{casebook:function(){return this.$store.getters["globals/casebook"]()},section:function(){return this.$store.getters["globals/section"]()},focusTarget:function(){return this.caseTab?this.$refs.case_search:this.textTab?this.$refs.text_body:this.linkTab?this.$refs.link_body:null},caseTab:function(){return"case"===this.currentTab},textTab:function(){return"text"===this.currentTab},linkTab:function(){return"link"===this.currentTab}},methods:Object(u["a"])(Object(u["a"])({},ge(["fetch"])),{},{displayModal:function(){this.showModal=!0},properType:function(){return this.sectionType[0].toUpperCase()+this.sectionType.substr(1)},setTab:function(t){var e=this,n=0;function a(){e.$refs.case_search?e.$refs.case_search.focus():(n+=1,n<10&&e.$nextTick(a))}this.currentTab=t,a()},submitTextForm:function(){var t={from:"Temp",to:"TextBlock",content:this.textContent},e=window.location.href.substr(0,window.location.href.length-5);a["a"].patch(e,t).then(this.handleSubmitResponse,this.handleSubmitErrors)},submitLinkForm:function(){var t={from:"Temp",to:"Link",url:this.linkTarget},e=window.location.href.substr(0,window.location.href.length-5);a["a"].patch(e,t).then(this.handleSubmitResponse,this.handleSubmitErrors)},selectCase:function(t){var e=window.location.href.substr(0,window.location.href.length-5),n={from:"Temp",to:"Case",cap_id:t.id,h2o_case_id:t.h2o_case_id};a["a"].patch(e,n).then(this.handleSubmitResponse,this.handleSubmitErrors)},handleSubmitResponse:function(t){var e=t.request.responseURL;window.location.href=e,this.errors={}},handleSubmitErrors:function(t){t.response.data&&(this.errors=t.response.data)}})},ye=_e,ke=(n("dc0a"),Object(z["a"])(ye,me,be,!1,null,null,null)),Ce=ke.exports,xe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"section-cloner"}},[n("button",{staticClass:"action clone-casebook-nodes",attrs:{"data-disable-with":"Clone-Node"},on:{click:function(e){return t.displayModal()}}},[t._v("Clone "+t._s(t.properType()))]),t.showModal?n("Modal",{on:{close:function(e){t.showModal=!1}}},[n("template",{slot:"title"},[t._v("Clone "+t._s(t.properType())+" To Casebook")]),n("template",{slot:"body"},[n("p",{staticClass:"cloner-text"},[t._v("The "+t._s(t.sectionType)+' "'),n("em",[t._v(t._s(t.sectionSource))]),t._v('" will be copied to the casebook you select below:')]),n("ul",{staticClass:"clone-target-list"},t._l(t.casebookTargets,(function(e){return n("li",{key:e.form_target},[n("form",{attrs:{action:e.form_target,method:"POST"}},[n("input",{attrs:{type:"hidden",name:"csrfmiddlewaretoken"},domProps:{value:t.csrftoken}}),n("button",{staticClass:"link",attrs:{type:"submit"}},[t._v(t._s(e.title))])])])})),0)])],2):t._e()],1)},Te=[],we=n("3158"),Oe={components:{Modal:d["a"]},props:{casebookTargets:{type:Array},sectionSource:{type:String},sectionType:{type:String}},data:function(){return{showModal:!1,csrftoken:Object(we["a"])()}},methods:{displayModal:function(){this.showModal=!0},properType:function(){return this.sectionType[0].toUpperCase()+this.sectionType.substr(1)}}},Se=Oe,je=(n("1ea0"),Object(z["a"])(Se,xe,Te,!1,null,null,null)),Ee=je.exports,Ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"take-notes-cloner"}},[n("button",{staticClass:"action annotate-casebook-nodes",attrs:{"data-disable-with":"Clone-Node"},on:{click:function(e){return t.displayModal()}}},[t._v("Take notes")]),t.showModal?n("Modal",{on:{close:function(e){t.showModal=!1}}},[n("template",{staticClass:"modal-title",slot:"title"},[n("span",{staticClass:"take-notes-icon"}),n("h4",[t._v("Copy this "+t._s(t.properType())+" to Take Notes")])]),n("template",{staticClass:"modal-body-take-notes",slot:"body"},[n("p",{staticClass:"take-notes-cloner-text"},[n("b",[t._v(" To Take Notes on a specific section or resource, you need to first add a copy to an existing book in your dashboard."),n("br"),n("br"),t._v(" Choose the book")]),t._v(' where you would like "'),n("em",[t._v(t._s(t.sectionSource))]),t._v('" to appear: ')]),n("ul",{staticClass:"take-notes-target-list"},t._l(t.casebookTargets,(function(e){return n("li",{key:e.form_target},[n("form",{attrs:{action:e.form_target,method:"POST"}},[n("input",{attrs:{type:"hidden",name:"csrfmiddlewaretoken"},domProps:{value:t.csrftoken}}),n("button",{staticClass:"link",attrs:{type:"submit"}},[t._v(t._s(e.title))])])])})),0)])],2):t._e()],1)},Ne=[],$e={components:{Modal:d["a"]},props:{casebookTargets:{type:Array},sectionSource:{type:String},sectionType:{type:String}},data:function(){return{showModal:!1,csrftoken:Object(we["a"])()}},methods:{displayModal:function(){this.showModal=!0},properType:function(){return this.sectionType[0].toUpperCase()+this.sectionType.substr(1)}}},De=$e,Ie=(n("bf5c"),Object(z["a"])(De,Ae,Ne,!1,null,null,null)),Me=Ie.exports,Le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{directives:[{name:"selectionchange",rawName:"v-selectionchange",value:t.selectionchangeHandler,expression:"selectionchangeHandler"}],staticClass:"resource"},[t.editable?n("TheAnnotator",{ref:"annotator"}):t._e(),t.collapsible.length?n("TheGlobalElisionExpansionButton"):t._e(),n("TheResourceBody",{attrs:{resource:t.resource}})],1)},Re=[],Pe=n("2909"),Fe=(n("4e82"),n("a630"),n("8a79"),["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","IFRAME","IMG","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL"]),He=function(t){return Fe.includes(t.tagName)},qe=function(t){return t.nodeType==document.ELEMENT_NODE},Ue=function(t){return t.nodeType==document.TEXT_NODE},Be=function(t){return t.textContent.length},Ge=function(t){for(var e=t.attributes,n={},a=0;a<e.length;a++)n[e[a].name]=e[a].value;return n},Ve=function(t){return Ue(t)?t.parentNode:t},Ye=function(t,e,n){var a=n?{acceptNode:function(t){return n(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}:null,o=document.createTreeWalker(t,NodeFilter.SHOW_ALL,a),s=e.nodeType===document.TEXT_NODE?function(t){return t&&t!==e}:function(t){return t&&!e.contains(t)},i=0,r=o.nextNode();while(s(r))r.nodeType===document.TEXT_NODE&&(i+=Be(r)),r=o.nextNode();return i},ze=function(t){return({elide:"elision",replace:"replacement"}[t]||t)+"-annotation"},We=function(t){return Boolean(t.hash)&&t.origin==location.origin&&t.pathname==location.pathname},Qe=function(t){return We(t)?"footnote-link":t.getAttribute("is")||t.tagName},Ke=function(t){return t[t.length-1]},Je=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[t,e,e+Be(t)]},Xe=function(t){return function(e,n){var a=Ke(e)||[null,null,t],o=Object(p["a"])(a,3),s=(o[0],o[1],o[2]);return e.concat([Je(n,s)])}},Ze=function(t,e){var n=Object(p["a"])(e,3),a=n[0],o=n[1],s=n[2];return t.filter((function(t){return t>o&&t<s})).reduce((function(t,e){var n=Ke(t),a=Object(p["a"])(n,3),o=a[0],s=a[1],i=a[2],r=o.splitText(e-s);return Ke(t)[2]=e,t.concat([[r,e,i]])}),[[a,o,s]])},tn=function(t,e,n){return n.reduce(an(t,e),[]).map(cn(t,e))},en=function(t,e,n){var a=t.filter((function(t){return t[1]>=e&&t[2]<=n})),o=a.findIndex((function(t){return He(t[0])}));return-1==o?a:a.slice(0,o)},nn=function(t,e,n){return function(a,o){var s=[a].concat(Object(Pe["a"])(en(n,a[2],o.end_offset)));if(1===s.length&&Ue(s[0][0])&&" "===s[0][0].textContent){var i=document.createElement("PRE");i.setAttribute("is","space-preserver"),s[0][0]=i}var r={startOffset:a[1],endOffset:Ke(s)[2],isHead:!o.used};return o.used=!0,[t(ze(o.kind),{key:"".concat(o.id,"/").concat(r.startOffset,"-").concat(r.endOffset),props:Object(u["a"])(Object(u["a"])({},r),{},{annotation:o})},tn(t,e.filter((function(t){return t!=o})),s)),r.startOffset,r.endOffset]}},an=function(t,e){return function(n,a,o,s){var i=Object(p["a"])(a,3),r=i[0],c=i[1],l=i[2],u=Ke(n)||[null,null,s[0][1]],d=Object(p["a"])(u,3),f=(d[0],d[1],d[2]);return f>c?n:He(r)?n.concat([a]):n.concat([e.filter((function(t){return t.start_offset<=c&&t.end_offset>=l})).sort((function(t,e){return e.end_offset-t.end_offset})).slice(0,1).reduce(nn(t,e,s),a)])}},on=function(t,e,n){return t.filter((function(t){return t.start_offset>e||t.end_offset<n})).reduce((function(t,e){return t.concat([e["start_offset"],e["end_offset"]])}),[]).filter((function(t,e,n){return n.indexOf(t)===e})).sort((function(t,e){return t-e}))},sn=function(t,e,n,a){var o=on(t,n,a);return Array.from(e).reduce(Xe(n),[]).reduce((function(t,e){return t.concat(Ue(e[0])?Ze(o,e):[e])}),[])},rn=function(t){return!v.a.isString(t)&&(!(!t.tag||!v.a.endsWith(t.tag,"elision-annotation")&&!v.a.endsWith(t.tag,"replacement-annotation"))||(!!(t.classList&&t.classList.indexOf("fully-elided")>-1)||!!(t.data&&t.data.class&&t.data.class["fully-elided"])))},cn=function(t,e){return function(n){var a=Object(p["a"])(n,3),o=a[0],s=a[1],i=a[2];if(Ue(o))return o.textContent;if(qe(o)){var r=Ge(o);delete r.is;var c=Qe(o),l={attrs:r},u=tn(t,e,sn(e,o.childNodes,s,i));switch(c){case"footnote-link":l.props={startOffset:s,endOffset:i};break}if(v.a.some(u,rn)){var d=u.filter((function(t){return!rn(t)}));v.a.every(d,(function(t){return v.a.isString(t)&&""===t.trim()}))&&(l.class={"fully-elided":!0})}return t(c,l,u)}return o}},ln=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",{staticClass:"space-preserver"},[t._v(" ")])},un=[],dn={},fn=dn,hn=(n("3bf5"),Object(z["a"])(fn,ln,un,!1,null,"5ff42c12",null)),pn=hn.exports,mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"elision"},[t.isHead?n("AnnotationExpansionToggle",{attrs:{annotation:t.annotation,"aria-label":"elided text"}}):t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:t.uiState.expanded,expression:"uiState.expanded"}],staticClass:"selected-text"},[t._t("default")],2),t.isTail&&t.uiState.expanded?n("span",{staticClass:"sr-only",attrs:{"data-exclude-from-offset-calcs":"true"}},[t._v("(end of elided text)")]):t._e(),t.hasHandle?n("AnnotationHandle",{attrs:{"ui-state":t.uiState}},[n("li",[n("a",{on:{click:function(e){return t.toggleExpansion(t.uiState)}}},[t.uiState.expanded?[t._v("Hide")]:[t._v("Reveal")],t._v(" original text ")],2)]),n("li",[n("a",{on:{click:function(e){return t.destroy(t.annotation)}}},[t._v("Remove elision")])])]):t._e()],1)},bn=[],vn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},gn=[],_n=(n("a9e3"),n("2af1"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"annotation-handle",attrs:{"data-exclude-from-offset-calcs":"true"}},[n("button",{ref:"button",staticClass:"annotation-button",style:{right:t.offsetRight+"px"},attrs:{"aria-label":"Edit annotation"},on:{click:function(e){return e.preventDefault(),t.$refs.menu.open.apply(null,arguments)}}},[t._v("")]),n("ContextMenu",{ref:"menu"},[n("ul",[t._t("default")],2)])],1)}),yn=[],kn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"context-menu",style:t.style,attrs:{tabindex:"-1"},on:{focusout:t.onFocusout,click:t.onClick}},[t._t("default",null,{data:t.data})],2)},Cn=[],xn={props:{closeOnClick:{type:Boolean,default:!0},closeOnScroll:{type:Boolean,default:!0}},computed:{style:function(){if(this.show&&this.left){var t=this.$el.parentElement;while(!t.classList.contains("casebook-inner")&&t.parentElement)t=t.parentElement;var e=t.offsetLeft,n=this.$el.previousElementSibling,a=0;while(n)a+=n.offsetWidth,n=n.previousElementSibling;return{left:"".concat(this.left-e-a,"px"),top:"".concat(this.$el.parentElement.offsetTop-this.$el.parentElement.offsetHeight,"px")}}return null}},data:function(){return{top:null,left:null,show:!1,data:null}},mounted:function(){this.closeOnScroll&&this.addScrollEventListener()},beforeDestroy:function(){this.closeOnScroll&&this.removeScrollEventListener()},methods:{addScrollEventListener:function(){window.addEventListener("scroll",this.close)},onFocusout:function(t){t.relatedTarget==this.$el||this.$el.contains(t.relatedTarget)||this.close(!0)},close:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.top=null,this.left=null,this.data=null,this.show=!1,t&&this.$emit("close")},onClick:function(){this.closeOnClick&&this.close(!1)},open:function(t,e){var n=this;this.data=e,this.show=!0,this.$nextTick((function(){n.positionMenu(t.clientY,t.clientX),n.$el.focus(),n.$emit("open",t,n.data,n.top,n.left)}))},positionMenu:function(t,e){var n=window.innerHeight-this.$el.offsetHeight-25,a=window.innerWidth-this.$el.offsetWidth-25;t>n&&(t=n),e>a&&(e=a),this.top=t,this.left=e},removeScrollEventListener:function(){window.removeEventListener("scroll",this.close)}},watch:{closeOnScroll:function(t,e){t!==e&&(t?this.addScrollEventListener():this.removeScrollEventListener())}}},Tn=xn,wn=(n("12d0"),Object(z["a"])(Tn,kn,Cn,!1,null,null,null)),On=wn.exports,Sn=["elide","replace"],jn=5,En={all:[]},An={getById:function(t){return function(e){return t.all.find((function(t){return t.id===e}))}},getByKind:function(t,e,n,a){return function(e){return t.all.filter((function(t){return e.includes((a["annotations/getById"](t.id)||{}).kind)}))}},getByHeadY:function(t){return function(e){return t.all.filter((function(t){return Math.max(jn,Math.abs(t.headY-e))==jn}))}},collapsible:function(t,e){return e.getByKind(Sn)},areAllExpanded:function(t,e){return e.collapsible.reduce((function(t,e){return t&&e.expanded}),!0)}},Nn={toggleExpansion:function(t,e){var n=t.commit,a=t.getters,o=t.rootGetters;n("update",{obj:e,vals:{expanded:!e.expanded}});var s=o["annotations/getById"](e.id);o["annotations/getStartingAtOrAfter"](s.start_offset).forEach((function(t){return n("update",{obj:a.getById(t.id),vals:{headY:null}})}))},toggleAllExpansions:function(t){var e=t.dispatch,n=t.getters;return n.collapsible.filter((function(t){return t.expanded==n.areAllExpanded})).forEach((function(t){return e("toggleExpansion",t)}))},expandById:function(t,e){var n=t.dispatch,a=t.getters;return a.collapsible.filter((function(t){return e.includes(t.id)})).forEach((function(t){return n("toggleExpansion",t)}))}},$n={append:function(t,e){var n;return(n=t.all).push.apply(n,Object(Pe["a"])(e))},update:function(t,e){return Object.assign(e.obj,e.vals)},destroy:function(t,e){return t.all.splice(t.all.indexOf(e),1)},toggleExpansion:function(t,e){return o["default"].set(e,"expanded",!e.expanded)}},Dn={namespaced:!0,state:En,getters:An,actions:Nn,mutations:$n},In={components:{ContextMenu:On},props:{uiState:{type:Object,required:!0}},computed:{offsetRight:function(){var t=this.$store.getters["annotations_ui/getByHeadY"](this.uiState.headY).filter((function(t){return t.id})).sort((function(t,e){return t.start_offset-e.start_offset}));return-55-30*Math.max(0,t.indexOf(this.uiState))}},methods:{updateHeadY:function(){var t=this.$el.getBoundingClientRect().top+window.scrollY;Math.abs(t-this.uiState.headY)>jn&&this.$store.commit("annotations_ui/update",{obj:this.uiState,vals:{headY:t}})}},mounted:function(){this.updateHeadY()},updated:function(){this.updateHeadY()}},Mn=In,Ln=(n("6b23"),Object(z["a"])(Mn,_n,yn,!1,null,"5200425b",null)),Rn=Ln.exports,Pn=Object(H["a"])("annotations"),Fn=Pn.mapActions,Hn={components:{AnnotationHandle:Rn},props:{annotation:{type:Object,required:!0},startOffset:{type:Number,required:!0},endOffset:{type:Number,required:!0},isHead:{type:Boolean,required:!0}},data:function(){return{expandedDefault:!0}},computed:{uiState:function(){return this.$store.getters["annotations_ui/getById"](this.annotation.id)},isNew:function(){return-1==Math.sign(this.annotation.id)},isTail:function(){return this.endOffset==this.annotation.end_offset},isEditable:function(){return this.$store.getters["resources_ui/getEditability"]},hasHandle:function(){return this.isEditable&&this.isHead&&!this.isNew}},methods:Object(u["a"])({},Fn(["destroy","createAndUpdate"])),created:function(){this.isHead&&this.isNew&&["highlight","elide"].includes(this.annotation.kind)&&this.createAndUpdate({obj:this.annotation,vals:{}}),this.uiState||this.$store.commit("annotations_ui/append",[{id:this.annotation.id,expanded:this.expandedDefault,headY:null}])}},qn=Hn,Un=Object(z["a"])(qn,vn,gn,!1,null,"16f08814",null),Bn=Un.exports,Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"toggle",class:{expanded:t.uiState.expanded},attrs:{role:"button",tabindex:"0","data-exclude-from-offset-calcs":"true","aria-expanded":t.uiState.expanded||"false"},on:{click:function(e){return t.toggleExpansion(t.uiState)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toggleExpansion(t.uiState)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:(e.preventDefault(),t.toggleExpansion(t.uiState))}]}},[t.uiState.expanded?t._t("expanded"):t._t("collapsed")],2)},Vn=[],Yn=Object(H["a"])("annotations_ui"),zn=Yn.mapActions,Wn={props:{annotation:{type:Object,required:!0}},computed:{uiState:function(){return this.$store.getters["annotations_ui/getById"](this.annotation.id)||{}}},methods:Object(u["a"])({},zn(["toggleExpansion"]))},Qn=Wn,Kn=(n("cf59"),Object(z["a"])(Qn,Gn,Vn,!1,null,"6c978a10",null)),Jn=Kn.exports,Xn=Object(H["a"])("annotations_ui"),Zn=Xn.mapActions,ta={extends:Bn,components:{AnnotationExpansionToggle:Jn},data:function(){return{expandedDefault:!1}},methods:Object(u["a"])({},Zn(["toggleExpansion"]))},ea=ta,na=(n("bef9"),Object(z["a"])(ea,mn,bn,!1,null,"2c996573",null)),aa=na.exports,oa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"replacement",class:{head:t.isHead,tail:t.addTailClass}},[t.isHead?[!t.isEditable||t.uiState.expanded?n("AnnotationExpansionToggle",{attrs:{annotation:t.annotation},scopedSlots:t._u([{key:"collapsed",fn:function(){return[t._v(t._s(t.content))]},proxy:!0}],null,!1,469247190)}):n("span",{directives:[{name:"contenteditable",rawName:"v-contenteditable:content",value:!0,expression:"true",arg:"content"}],ref:"replacementText",staticClass:"replacement-text",attrs:{"data-exclude-from-offset-calcs":"true"},on:{blur:t.revert,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.submit.apply(null,arguments))},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:e.target.blur.apply(null,arguments)}}})]:t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:t.uiState.expanded,expression:"uiState.expanded"}],staticClass:"selected-text"},[t._t("default")],2),t.isTail&&t.uiState.expanded?n("span",{staticClass:"sr-only",attrs:{"data-exclude-from-offset-calcs":"true"}},[t._v("(end of replaced text)")]):t._e(),t.hasHandle?n("AnnotationHandle",{attrs:{"ui-state":t.uiState}},[n("li",[n("a",{on:{click:function(e){return t.toggleExpansion(t.uiState)}}},[t.uiState.expanded?[t._v("Hide")]:[t._v("Reveal")],t._v(" original text ")],2)]),n("li",[n("a",{on:{click:function(e){return t.destroy(t.annotation)}}},[t._v("Remove replacement")])])]):t._e(),t.isHead&&t.isModified?n("SideMenu",[n("li",[n("a",{on:{mousedown:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[t._v("Save")])]),n("li",[n("a",{on:{mousedown:function(e){return e.preventDefault(),t.$refs.replacementText.blur.apply(null,arguments)}}},[t._v("Cancel")])])]):t._e()],2)},sa=[],ia=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"context-menu side-menu"},[n("ul",{staticClass:"menu-items"},[t._t("default")],2)])},ra=[],ca={},la=ca,ua=(n("26a0"),Object(z["a"])(la,ia,ra,!1,null,"66587456",null)),da=ua.exports,fa=Object(H["a"])("annotations"),ha=fa.mapActions,pa=Object(H["a"])("annotations_ui").mapActions,ma={extends:Bn,components:{SideMenu:da,AnnotationExpansionToggle:Jn},data:function(){return{expandedDefault:!1,newVals:{content:""}}},computed:{content:{get:function(){return this.newVals.content||this.annotation.content},set:function(t){this.newVals.content=t}},isModified:function(){return this.isNew||this.content!=this.annotation.content},addTailClass:function(){return this.isTail&&this.uiState.expanded||this.isHead&&!this.uiState.expanded}},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},pa(["toggleExpansion"])),ha(["createAndUpdate","update"])),{},{submit:function(){this.isModified&&this.content?(this.newVals.content=this.$refs.replacementText.innerText,this[this.isNew?"createAndUpdate":"update"]({obj:this.annotation,vals:this.newVals})):this.$refs.replacementText.blur()},revert:function(){this.isNew?(this.$store.commit("annotations/destroy",this.annotation),this.$store.commit("annotations_ui/destroy",this.uiState)):this.isModified&&(this.newVals.content=this.annotation.content)}}),mounted:function(){this.isNew&&this.$refs.replacementText&&this.$refs.replacementText.focus()},updated:function(){!this.isModified&&this.$refs.replacementText&&this.$refs.replacementText.blur()}},ba=ma,va=(n("92c5"),Object(z["a"])(ba,oa,sa,!1,null,"38ee148e",null)),ga=va.exports,_a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"highlight"},[n("span",{staticClass:"selected-text"},[t._t("default")],2),t.hasHandle?n("AnnotationHandle",{attrs:{"ui-state":t.uiState}},[n("li",[n("a",{on:{click:function(e){return t.destroy(t.annotation)}}},[t._v("Remove highlight")])])]):t._e()],1)},ya=[],ka={extends:Bn},Ca=ka,xa=(n("9a12"),Object(z["a"])(Ca,_a,ya,!1,null,"646aeb45",null)),Ta=xa.exports,wa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"link"},[n("a",{staticClass:"selected-text",class:{tail:t.isTail},attrs:{href:t.annotation.content,target:"_blank"}},[t._t("default")],2),t.hasHandle?[n("AnnotationHandle",{attrs:{"ui-state":t.uiState}},[n("li",[n("a",{on:{click:function(e){return e.preventDefault(),t.$refs.editMenu.open.apply(null,arguments)}}},[t._v("Edit link")])]),n("li",[n("a",{on:{click:function(e){return t.destroy(t.annotation)}}},[t._v("Remove link")])])]),n("ContextMenu",{ref:"editMenu",staticClass:"edit-menu",attrs:{"data-exclude-from-offset-calcs":"true",closeOnClick:!1}},[n("form",{on:{submit:function(e){return e.preventDefault(),t.submitUpdate.apply(null,arguments)}}},[n("LinkInput",{model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])]:t._e(),t.isNew&&t.isHead?[n("div",{staticClass:"link-content-wrapper",attrs:{tabindex:"-1"}},[n("form",{ref:"linkForm",staticClass:"form link-form",attrs:{id:""+t.annotation.id,tabindex:"0"},on:{submit:function(e){return e.preventDefault(),t.submit("link",t.content)},focusout:t.focusOut}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],ref:"linkInput",attrs:{id:"link-input",type:"url",required:"true",pattern:"\\w+://\\w+.*",placeholder:"Url to link to...",tabindex:"0"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})])])]:t._e()],2)},Oa=[],Sa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{attrs:{id:"link-input",type:"url",required:"true",pattern:"\\w+://\\w+.*",placeholder:"Url to link to..."},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}})},ja=[],Ea={props:["value"]},Aa=Ea,Na=Object(z["a"])(Aa,Sa,ja,!1,null,"47ba0ee8",null),$a=Na.exports,Da=Object(H["a"])("annotations"),Ia=Da.mapActions,Ma={extends:Bn,components:{ContextMenu:On,LinkInput:$a},props:["value"],data:function(){return{newVals:{content:null}}},computed:{content:{get:function(){return null===this.newVals.content?this.annotation.content:this.newVals.content},set:function(t){this.newVals.content=t}}},methods:Object(u["a"])(Object(u["a"])({},Ia(["update","createAndUpdate"])),{},{submitUpdate:function(){this.update({obj:this.annotation,vals:this.newVals}),this.$refs.editMenu.close()},submit:function(t){this.createAndUpdate({obj:this.annotation,vals:this.newVals})},focusOut:function(t){-1===Math.sign(this.annotation.id)&&(this.$store.commit("annotations/destroy",this.annotation),this.$store.commit("annotations_ui/destroy",this.uiState))}}),mounted:function(){this.$nextTick((function(){-1==Math.sign(this.annotation.id)&&this.$refs.linkInput.focus()}))}},La=Ma,Ra=(n("a4cd"),Object(z["a"])(La,wa,Oa,!1,null,"22e03138",null)),Pa=Ra.exports,Fa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"note"},[n("a",{staticClass:"selected-text",attrs:{href:"#"+t.annotation.id+"-content",id:t.isHead?t.annotation.id+"-head":""},on:{click:function(e){return e.preventDefault(),t.handleClick.apply(null,arguments)}}},[t._t("default")],2),t.hasHandle?n("AnnotationHandle",{attrs:{"ui-state":t.uiState}},[n("li",[n("a",{on:{click:function(e){return t.editNote(t.annotation)}}},[t._v("Edit Note")])]),n("li",[n("a",{on:{click:function(e){return t.destroy(t.annotation)}}},[t._v("Remove note")])])]):t._e(),t.isHead?n("span",{staticClass:"note-content-wrapper",class:{top:t.isEditing},attrs:{"data-exclude-from-offset-calcs":"true"}},[t.isEditing?n("form",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.dismissNote,expression:"dismissNote"}],ref:"noteForm",staticClass:"form note-content",attrs:{id:""+t.annotation.id},on:{submit:function(e){return e.preventDefault(),t.submit("note",t.content)}}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],ref:"noteInput",attrs:{id:"note-textarea",required:"true",placeholder:"Note text..."},domProps:{value:t.content},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.$refs.noteSubmitButton.click.apply(null,arguments))},input:function(e){e.target.composing||(t.content=e.target.value)}}}),n("input",{ref:"noteSubmitButton",staticClass:"button",attrs:{type:"submit",value:"Save",id:"save-note"}})]):[n("a",{staticClass:"note-icon",attrs:{href:"#"+t.annotation.id+"-head"},on:{click:function(e){return e.preventDefault(),t.handleClick.apply(null,arguments)}}},[n("i",{staticClass:"fas fa-paperclip"})]),n("span",{staticClass:"note-content",attrs:{id:t.annotation.id+"-content",tabindex:"0"}},[t._v(" "+t._s(t.annotation.content)+" ")])]],2):t._e()],1)},Ha=[],qa=n("c28b"),Ua=n.n(qa),Ba=Object(H["a"])("annotations_ui"),Ga=(Ba._mapGetters,Object(H["a"])("annotations")),Va=Ga.mapActions;o["default"].use(Ua.a);var Ya,za,Wa={extends:Bn,props:["tempId"],data:function(){return{content:"",isEditing:!1}},methods:Object(u["a"])(Object(u["a"])({},Va(["createAndUpdate","update"])),{},{handleClick:function(t){document.getElementById(t.currentTarget.getAttribute("href").slice(1)).focus({preventScroll:!0})},editNote:function(){this.isEditing=!0,this.content=this.annotation.content},submit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isNew){var n=this.$refs.noteForm.id,a=this.$store.getters["annotations/getById"](parseInt(n));this.createAndUpdate({obj:a,vals:{content:e}})}else this.update({obj:this.annotation,vals:{content:e}}),this.isEditing=!1;this.content=e},dismissNote:function(){this.isNew?(this.$store.commit("annotations/destroy",this.annotation),this.$store.commit("annotations_ui/destroy",this.uiState)):this.isEditing=!1}}),mounted:function(){this.$nextTick((function(){-1==Math.sign(this.annotation.id)&&(this.isEditing=!0,this.$refs.noteInput.focus())}))}},Qa=Wa,Ka=(n("b036"),Object(z["a"])(Qa,Fa,Ha,!1,null,"e2df4790",null)),Ja=Ka.exports,Xa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"correction",class:{head:t.isHead,tail:t.addTailClass}},[t.isHead?[t.isEditable?n("span",{directives:[{name:"contenteditable",rawName:"v-contenteditable:content",value:!0,expression:"true",arg:"content"}],ref:"correctionText",staticClass:"correction-text",attrs:{"data-exclude-from-offset-calcs":"true"},on:{blur:t.revert,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.submit.apply(null,arguments))},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:e.target.blur.apply(null,arguments)}}}):n("span",[t._v(t._s(t.content))])]:t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:t.uiState.expanded,expression:"uiState.expanded"}],staticClass:"selected-text"},[t._t("default")],2),t.isTail&&t.uiState.expanded?n("span",{staticClass:"sr-only",attrs:{"data-exclude-from-offset-calcs":"true"}},[t._v("(end of replaced text)")]):t._e(),t.hasHandle?n("AnnotationHandle",{attrs:{"ui-state":t.uiState}},[n("li",[n("a",{on:{click:function(e){return t.toggleExpansion(t.uiState)}}},[t.uiState.expanded?[t._v("Hide")]:[t._v("Reveal")],t._v(" original text ")],2)]),n("li",[n("a",{on:{click:function(e){return t.destroy(t.annotation)}}},[t._v("Remove correction")])])]):t._e(),t.isHead&&t.isModified?n("SideMenu",[n("li",[n("a",{on:{mousedown:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[t._v("Save")])]),n("li",[n("a",{on:{mousedown:function(e){return e.preventDefault(),t.$refs.correctionText.blur.apply(null,arguments)}}},[t._v("Cancel")])])]):t._e()],2)},Za=[],to=Object(H["a"])("annotations"),eo=to.mapActions,no=Object(H["a"])("annotations_ui").mapActions,ao={extends:Bn,components:{SideMenu:da},data:function(){return{expandedDefault:!1,newVals:{content:""}}},computed:{content:{get:function(){return this.newVals.content||this.annotation.content},set:function(t){this.newVals.content=t}},isModified:function(){return this.isNew||this.content!=this.annotation.content},addTailClass:function(){return this.isTail&&this.uiState.expanded||this.isHead&&!this.uiState.expanded}},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},no(["toggleExpansion"])),eo(["createAndUpdate","update"])),{},{submit:function(){this.isModified&&this.content?(this.newVals.content=this.$refs.correctionText.innerText,this[this.isNew?"createAndUpdate":"update"]({obj:this.annotation,vals:this.newVals})):this.$refs.correctionText.blur()},revert:function(){this.isNew?(this.$store.commit("annotations/destroy",this.annotation),this.$store.commit("annotations_ui/destroy",this.uiState)):this.isModified&&(this.newVals.content=this.annotation.content)}}),mounted:function(){this.isNew&&this.$refs.correctionText&&this.$refs.correctionText.focus()},updated:function(){!this.isModified&&this.$refs.correctionText&&this.$refs.correctionText.blur()}},oo=ao,so=(n("f0f6"),Object(z["a"])(oo,Xa,Za,!1,null,"5b7265c9",null)),io=so.exports,ro=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{on:{click:function(e){return e.preventDefault(),t.handleClick.apply(null,arguments)}}},[t._t("default")],2)},co=[],lo=n("f13c"),uo=n.n(lo),fo=Object(H["a"])("annotations_ui"),ho=fo.mapActions,po={props:{startOffset:{type:Number,required:!0},endOffset:{type:Number,required:!0}},computed:{id:function(){return this.$attrs.name||this.$attrs.id},siblingId:function(){return(this.$attrs.href||"").slice(1)},enclosingAnnotationIds:function(){return this.$store.getters["annotations/getWithinOffsets"](this.startOffset,this.endOffset)},relatedAnnotationIds:function(){return this.$store.getters["footnotes_ui/getById"](this.siblingId)||[]}},methods:Object(u["a"])(Object(u["a"])({},ho(["expandById"])),{},{handleClick:function(){var t=this;this.expandById(this.relatedAnnotationIds),this.$nextTick((function(){return uo.a.scrollTo(document.querySelector('[id="'.concat(t.siblingId,'"], [name="').concat(t.siblingId,'"]')))}))}}),created:function(){this.$store.commit("footnotes_ui/register",{id:this.id,annotationIds:this.enclosingAnnotationIds})}},mo=po,bo=Object(z["a"])(mo,ro,co,!1,null,null,null),vo=bo.exports,go={components:{SpacePreserver:pn,ElisionAnnotation:aa,ReplacementAnnotation:ga,HighlightAnnotation:Ta,LinkAnnotation:Pa,NoteAnnotation:Ja,CorrectionAnnotation:io,FootnoteLink:vo},props:{resource:{type:Object}},computed:{body:function(){var t=(new DOMParser).parseFromString(this.resource.content,"text/html").body;return t.setAttribute("is","DIV"),t.setAttribute("class","case-text"),t}},render:function(t){var e=this.$store.state.annotations.all;return e.forEach((function(t){return t.used=!1})),cn(t,e)(Je(this.body))}},_o=go,yo=(n("0b59"),Object(z["a"])(_o,Ya,za,!1,null,"1b62bdcc",null)),ko=yo.exports,Co=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"the-annotator","data-exclude-from-offset-calcs":"true"}},[t.offsets?n("SideMenu",{style:{top:t.topDistance}},[n("li",[n("a",{attrs:{id:"create-highlight"},on:{click:function(e){return t.input(e,"highlight")}}},[t._v("Highlight")])]),n("li",[n("a",{attrs:{id:"create-elision"},on:{click:function(e){return t.input(e,"elide")}}},[t._v("Elide")])]),n("li",[n("a",{attrs:{id:"create-replacement"},on:{click:function(e){return t.input(e,"replace")}}},[t._v("Replace")])]),n("li",[n("a",{attrs:{id:"create-link"},on:{click:function(e){return t.input(e,"link")}}},[t._v("Add link")])]),n("li",[n("a",{attrs:{id:"create-note"},on:{click:function(e){return t.input(e,"note")}}},[t._v("Add note")])]),n("li",[n("a",{attrs:{id:"create-correction"},on:{click:function(e){return t.input(e,"correction")}}},[t._v("Correction")])])]):t._e(),t.showModal?n("Modal",{on:{close:function(e){t.showModal=!1}}},[n("template",{slot:"title"},[t._v("Error")]),n("template",{slot:"body"},[n("p",[t._v("An error occurred while trying to save your annotation. Please try again.")]),n("button",{staticClass:"modal-button",on:{click:function(e){t.showModal=!1}}},[t._v("Dismiss")])])],2):t._e()],1)},xo=[],To=(n("25f0"),Object(H["a"])("annotations")),wo=To.mapActions,Oo={components:{SideMenu:da,Modal:d["a"],ContextMenu:On,LinkInput:$a},data:function(){return{ranges:null,content:null,showModal:!1,selection:null}},watch:{ranges:function(){this.content=""}},computed:{topDistance:function(){var t=this.$parent.$el.getBoundingClientRect(),e=window.scrollY-(t.top+window.scrollY),n=this.ranges[1].getBoundingClientRect();return Math.min(Math.max(n.top-t.top,e+20),n.bottom-t.top).toString(10)+"px"},resourceId:function(){return document.querySelector("header.casebook").dataset.resourceId},hasValidRanges:function(){return this.ranges&&!this.ranges[0].collapsed&&Ve(this.ranges[0].commonAncestorContainer).closest(".case-text")},offsets:function(){var t=this;if(this.hasValidRanges){var e=document.querySelector(".case-text"),n=["start","end"].map((function(n,a){return t.ranges[a]["".concat(n,"Offset")]+Ye(e,t.ranges[a]["".concat(n,"Container")],t.contributesToOffsets)})),a=this.selection.toString().length,o=this.ranges[0].startContainer==this.ranges[0].commonAncestorContainer,s=this.ranges[1].endContainer==this.ranges[1].commonAncestorContainer;return(o?!s:s)&&(o?n[0]=n[1]-a:n[1]=n[0]+a),n}}},methods:Object(u["a"])(Object(u["a"])({},wo(["create"])),{},{tempId:function(){return-1*Math.floor(Math.random()*Math.floor(1e7))},contributesToOffsets:function(t){return!(!t||t.nodeType!==Node.TEXT_NODE&&t.nodeType!==Node.ELEMENT_NODE)&&!Ve(t).closest("[data-exclude-from-offset-calcs='true']")},selectionchange:function(t,e){e&&!this.contributesToOffsets(e.anchorNode)||(this.ranges=e&&"Range"==e.type?[e.getRangeAt(0),e.getRangeAt(e.rangeCount-1)]:null,this.selection=e)},close:function(){document.getSelection().empty(),this.ranges=null},input:function(t,e){var n=this.tempId();this.$store.commit("annotations/append",[{id:n,content:this.content,kind:e,resource_id:this.resourceId,start_offset:this.offsets[0],end_offset:this.offsets[1]}]),this.close()}})},So=Oo,jo=(n("a105"),Object(z["a"])(So,Co,xo,!1,null,"34021196",null)),Eo=jo.exports,Ao=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{on:{click:t.toggleAllExpansions}},[t.areAllExpanded?[t._v("Hide")]:[t._v("Show")],t._v(" elided text ")],2)},No=[],$o=Object(H["a"])("annotations_ui"),Do=$o.mapGetters,Io=$o.mapActions,Mo={computed:Object(u["a"])({},Do(["areAllExpanded"])),methods:Object(u["a"])({},Io(["toggleAllExpansions"]))},Lo=Mo,Ro=(n("a609"),Object(z["a"])(Lo,Ao,No,!1,null,"497af012",null)),Po=Ro.exports,Fo=Object(H["a"])("annotations"),Ho=Fo.mapActions,qo=Object(H["a"])("annotations_ui"),Uo=qo.mapGetters,Bo={components:{TheResourceBody:ko,TheAnnotator:Eo,TheGlobalElisionExpansionButton:Po},props:{resource:{type:Object},editable:{type:Boolean}},data:function(){return{ranges:null}},computed:Object(u["a"])(Object(u["a"])({},Uo(["collapsible"])),{},{resourceId:function(){var t=document.querySelector("header.casebook");return t&&t.dataset&&t.dataset.resourceId}}),methods:Object(u["a"])(Object(u["a"])({},Ho(["list"])),{},{selectionchangeHandler:function(t,e){this.$refs.annotator&&this.$refs.annotator.selectionchange(t,e)}}),created:function(){this.$store.commit("resources_ui/setEditability",this.editable),this.resourceId&&this.list({resource_id:this.resourceId})}},Go=Bo,Vo=(n("f2b5"),Object(z["a"])(Go,Le,Re,!1,null,"7ef4ef6e",null)),Yo=Vo.exports,zo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"table-of-contents",class:{editable:t.editing}},[0!==this.toc.length&&t.editing&&"False"==t.verified_professor?n("div",{staticClass:"take-notes-tip"},[n("span",{staticClass:"take-notes-icon"}),n("p",[t._v("Click on the content below to Take Notes!")])]):t._e(),n("button",{staticClass:"action-expand toc-expand",attrs:{"aria-expanded":t.tocCollapsed?"false":"true","aria-label":t.tocCollapsed?"expand all":"collapse all"},on:{click:t.toggleToc}},[n("collapse-triangle",{attrs:{collapsed:t.tocCollapsed}}),t._v(" "+t._s(t.tocCollapsed?"Expand all":"Collapse all")+" ")],1),t.dataReady?n("vue-nestable",{attrs:{"max-depth":100,hooks:{beforeMove:t.canMove},"class-prop":"cssClasses","collapsed-groups":t.collapsedSections},on:{change:t.moveSubsection},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[n("entry",{attrs:{item:a,"root-ordinal-display":t.rootOrdinalDisplay,editing:t.editing}})]}}],null,!1,3333503588),model:{value:t.toc,callback:function(e){t.toc=e},expression:"toc"}},[n("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[n("placeholder",{attrs:{editing:t.editing,"node-type":t.nodeType}})],1)]):t._e()],1)},Wo=[],Qo=n("a0fc"),Ko=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.editing?n("div",[n("div",{staticClass:"listing empty"},[n("div",{staticClass:"add-content-link"},[t._v(" This "+t._s(t.nodeType)+" is empty. ")])])]):t._e()},Jo=[],Xo={props:["editing","nodeType"]},Zo=Xo,ts=Object(z["a"])(Zo,Ko,Jo,!1,null,null,null),es=ts.exports,ns=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside.stop.prevent",value:t.dismissAudit,expression:"dismissAudit",modifiers:{stop:!0,prevent:!0}}],class:["listing-wrapper",t.showDelete?"delete-confirm":"",t.animated,t.dimmed],attrs:{id:t.anchor}},[n(t.editing?"vue-nestable-handle":"div",{tag:"component",attrs:{item:t.item}},[t.isResource?n("div",{class:{listing:!0,resource:!0,temporary:"Temp"==t.item.resource_type,editing:"editing"}},[n("div",{staticClass:"list-left"},[n("div",{class:{"section-number":!0,"is-instructional-material":t.item.is_instructional_material}},[t._v(t._s(t.item.ordinal_string))]),t.isLegalDoc?n("div",{staticClass:"resource-container"},[n("a",{staticClass:"section-title case-section-title",attrs:{href:t.url}},[t._v(t._s(t.item.title))]),n("div",{staticClass:"case-metadata-container"},[n("div",{staticClass:"resource-case"},[t._v(t._s(t.item.citation))]),n("div",{staticClass:"resource-date"},[t._v(t._s(t.item.decision_date))])])]):n("div",{staticClass:"resource-container"},[n("a",{staticClass:"section-title",attrs:{href:t.url}},[t._v(t._s(t.item.title))])])]),n("div",{staticClass:"list-right"},[t.needsToSpecifyCase?n("div",[n("button",{staticClass:"btn btn-sm specify-case-button",attrs:{value:"Specify Document"},on:{click:t.auditThisCase}},[t._v("Specify Document")])]):t._e(),n("div",{staticClass:"resource-type-container"},[t.item.is_transmutable&&t.editing?n("div",[n("entry-transmuter",{attrs:{item:t.item}})],1):n("div",{class:{"resource-type":!0,temporary:"Temp"===t.item.resource_type}},[t._v(t._s("TextBlock"===t.item.resource_type?"Text":t.item.resource_type))])]),t.editing?n("div",{class:{actions:!t.showDelete,"actions-extra":t.showDelete}},[t.showDelete?n("div",{staticClass:"action-confirmation"},[n("div",{staticClass:"action-align-resource"},[n("button",{staticClass:"action-confirm-delete btn btn-danger",on:{click:t.confirmDeletion}},[t._v("Delete "+t._s(null!==t.item.resource_type&&"Section"!==t.item.resource_type?"":"section and all contents"))]),n("button",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"action-cancel-delete btn",on:{click:t.cancelDeletion}},[t._v("Keep")])])]):n("button",{staticClass:"action-delete",attrs:{"aria-label":"Delete "+t.item.title},on:{click:t.markForDeletion}})]):t._e()])]):n("div",{staticClass:"listing section",class:["listing","section",t.item.children.length>0?"child-present":"child-free",t.editing?"editing":""]},[n("div",{staticClass:"list-left"},[t.item.children.length>0||t.collapsed?n("button",{staticClass:"action-expand",attrs:{"aria-role":"heading","aria-expanded":t.collapsed?"false":"true","aria-label":t.collapsed?"expand "+t.item.title:"collapse "+t.item.title},on:{click:t.toggleSectionExpanded}},[n("collapse-triangle",{attrs:{collapsed:t.collapsed}})],1):t._e(),n("div",{staticClass:"section-number"},[t._v(t._s(t.item.ordinal_string))]),n("div",{staticClass:"section-container"},[n("div",{staticClass:"section-title"},[n("a",{staticClass:"section-title",attrs:{href:t.url}},[t._v(t._s(t.item.title))])])])]),n("div",{staticClass:"list-right"},[t.item.is_transmutable&&t.editing?n("div",{staticClass:"resource-type-container"},[n("entry-transmuter",{attrs:{item:t.item}})],1):n("div",[t._v("  ")]),t.editing?n("div",{class:{actions:!t.showDelete,"actions-extra":t.showDelete}},[t.showDelete?n("div",{staticClass:"action-confirmation"},[n("div",{staticClass:"action-align-section"},[n("button",{staticClass:"action-confirm-delete btn btn-danger",on:{click:t.confirmDeletion}},[t._v("Delete "+t._s(null!==t.item.resource_type&&"Section"!==t.item.resource_type?"":"section and all contents"))]),n("button",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"action-cancel-delete btn",on:{click:t.cancelDeletion}},[t._v("Keep")])])]):n("button",{staticClass:"action-delete",attrs:{"aria-label":"Delete "+t.item.title},on:{click:t.markForDeletion}})]):t._e()])])]),t.item.audit&&"Temp"===t.item.resource_type?n("div",{staticClass:"audit-drawer"},[n("entry-auditor",{attrs:{item:t.item}})],1):t._e()],1)},as=[],os=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("case-results",{attrs:{queryObj:t.searchOptions},on:{choose:t.selectCase}}),n("case-searcher",{model:{value:t.searchOptions,callback:function(e){t.searchOptions=e},expression:"searchOptions"}})],1)},ss=[],is={components:{CaseSearcher:Q,CaseResults:lt},props:["item"],data:function(){return{searchOptions:{query:""}}},computed:{casebook:function(){return this.$store.getters["globals/casebook"]()},section:function(){return this.$store.getters["globals/section"]()},rootNode:function(){return this.section||this.casebook},url:function(){return this.editing?this.item.edit_url:this.item.url}},methods:{selectCase:function(t){var e=this.item.url,n={from:"Temp",to:"LegalDocument",id:t.id,source_id:t.source_id,title:t.shortName};a["a"].patch(e,n).then(this.handleSubmitResponse,this.handleSubmitErrors)},selectText:function(){var t=this.item.url,e={from:"Temp",to:"TextBlock",content:null};a["a"].patch(t,e).then(this.handleSubmitResponse,this.handleSubmitErrors)},extraErrorHandler:function(t){console.error(t)},handleSubmitResponse:function(t){this.$store.dispatch("table_of_contents/clearAudit",{id:this.item.id}),this.$store.dispatch("table_of_contents/fetch",{casebook:this.casebook,subsection:this.section})},handleSubmitErrors:function(t){console.error(t)}},mounted:function(){this.searchOptions.query=this.item.title}},rs=is,cs=(n("a5bf"),Object(z["a"])(rs,os,ss,!1,null,"cd951f32",null)),ls=cs.exports,us=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"transmuter-holder"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.resource_type,expression:"resource_type"}],staticClass:"transmute-dropdown select-css",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.resource_type=e.target.multiple?n:n[0]}}},["LegalDocument"===t.item.resource_type?n("option",{attrs:{value:"LegalDocument"}},[t._v("Legal Doc")]):n("option",{attrs:{value:"Temp"}},[t._v("Legal Doc")]),n("option",{attrs:{value:"Section"}},[t._v("Section")]),n("option",{attrs:{value:"TextBlock"}},[t._v("Custom Content")]),n("option",{attrs:{value:"Link"}},[t._v("Link")])])])},ds=[],fs={data:function(){return{resource_type:""}},props:["item"],mounted:function(){this.item.resource_type?v.a.includes(["Text","Multimedia"],this.item.resource_type)?this.resource_type="TextBlock":this.resource_type=this.item.resource_type:this.resource_type="Section"},methods:{changeType:_["a"].url("resource"),refreshTOC:function(){var t=this.$store.getters["globals/casebook"](),e=this.$store.getters["globals/section"]();this.$store.dispatch("table_of_contents/fetch",{casebook:t,subsection:e})}},computed:{casebook:function(){return this.$store.getters["globals/casebook"]()}},watch:{item:function(t){this.resource_type="Text"==t.resource_type?"TextBlock":t.resource_type},resource_type:function(t){if(!(t===this.item.resource_type||v.a.includes(["Text","Multimedia"],this.item.resource_type)&&"TextBlock"==t)){var e="Text"==this.item.resource_type?"TextBlock":this.item.resource_type,n={from:e,to:"Temp"==t?"LegalDocument":t};a["a"].patch(this.item.url,n).then(this.refreshTOC,this.refreshTOC)}}}},hs=fs,ps=(n("2c31"),Object(z["a"])(hs,us,ds,!1,null,"20c1b9bd",null)),ms=ps.exports,bs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{class:{open:!t.collapsed,collapsed:t.collapsed},attrs:{height:"32",width:"32"}},[n("polygon",{attrs:{points:"6,6 20,16 6,24"}})])},vs=[],gs={name:"collapse-triangle",props:["collapsed"]},_s=gs,ys=(n("44bf"),Object(z["a"])(_s,bs,vs,!1,null,"52227b04",null)),ks=ys.exports,Cs=Object(H["a"])("table_of_contents"),xs=Cs.mapActions,Ts=Object(H["a"])("case_search"),ws=Ts.mapGetters;o["default"].use(Qo["VueNestable"]),o["default"].use(Ua.a);var Os={components:{EntryAuditor:ls,EntryTransmuter:ms,VueNestableHandle:Qo["VueNestableHandle"],CollapseTriangle:ks},props:["item","rootOrdinalDisplay","editing"],data:function(){return{showDelete:!1}},computed:Object(u["a"])(Object(u["a"])({},ws(["getSources"])),{},{autoSpecifyCandidate:function(){if(this.needsToSpecifyCase){var t=F.guessLineType(this.item.title,this.getSources());return 1===t.guesses.length}return!1},needsToSpecifyCase:function(){return"Temp"===this.item.resource_type&&!this.item.audit},collapsed:function(){return this.item.collapsed},url:function(){return this.editing?this.item.edit_url:this.item.url},dimmed:function(){return!this.item.audit&&this.$store.getters["globals/inAuditMode"]()?"dimmed":""},animated:function(){return this.item.audit?"":this.item.animationState},animatingLoading:function(){return this.animationState&&"loading"===this.animationState},animatingLoaded:function(){return this.animationState&&"loaded"===this.animationState},isResource:function(){return null!==this.item.resource_type&&""!==this.item.resource_type&&"Section"!==this.item.resource_type},anchor:function(){if(!this.item.url)return"";var t=this.item.url.split("/");return t[t.length-2]},casebook:function(){return this.$store.getters["globals/casebook"]()},section:function(){return this.$store.getters["globals/section"]()},isLegalDoc:function(){return v.a.has(this.item,"citation")&&this.item.citation}}),methods:Object(u["a"])(Object(u["a"])({auditThisCase:function(){this.$store.dispatch("table_of_contents/setAudit",{id:this.item.id})},toggleSectionExpanded:function(){this.$store.dispatch("table_of_contents/toggleCollapsed",{id:this.item.id})},dismissAudit:function(){this.item.audit&&this.$store.getters["globals/inAuditMode"]()&&(this.$store.commit("globals/setAuditMode",!1),this.$store.dispatch("table_of_contents/clearAudit",{id:this.item.id}))}},xs(["deleteNode"])),{},{markForDeletion:function(){this.showDelete=!0},cancelDeletion:function(){this.showDelete=!1},confirmDeletion:function(t){t.id;this.deleteNode({casebook:this.casebook,rootNode:this.section||this.casebook,targetId:this.item.id})}})},Ss=Os,js=(n("dc40"),Object(z["a"])(Ss,ns,as,!1,null,"55be8b48",null)),Es=js.exports,As=Object(H["a"])("table_of_contents"),Ns=As.mapActions,$s=As.mapMutations,Ds={components:{VueNestable:Qo["VueNestable"],Placeholder:es,Entry:Es,CollapseTriangle:ks},data:function(){return{needsDeleteConfirmation:{},tocCollapsed:!1}},directives:{focus:{inserted:function(t){t.focus()}}},computed:{collapsedSections:function(){return this.$store.getters["table_of_contents/collapsedNodes"](this.rootNode)},casebook:function(){return this.$store.getters["globals/casebook"]()},section:function(){return this.$store.getters["globals/section"]()},rootNode:function(){return this.section||this.casebook},rootOrdinalDisplay:function(){return""!==this.rootOrdinals?this.rootOrdinals+".":this.rootOrdinals},nodeType:function(){return this.section?"section":"casebook"},toc:{get:function(){var t=v.a.get(this.$store,"state.table_of_contents.toc.".concat(this.rootNode,".children"),[]);return t},set:function(t){this.shuffle({id:this.rootNode,children:t})}},dataReady:function(){return this.toc!==[null]&&null!==this.toc}},mounted:function(){var t=window.location.hash,e=0;function n(){null!==document.getElementById(t.substring(1))?(window.location.hash="",window.location.hash=t):(e+=1,e<5&&setTimeout(n,15))}""!==t&&setTimeout(n,15)},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Ns(["fetch","commitShuffle","moveNode"])),$s(["shuffle"])),{},{canMove:function(t){var e=t.dragItem,n=t.pathFrom,a=t.pathTo;if(1===a.length)return!0;var o=[],s=a.slice(0),i=n.pop(),r=s.slice(0,n.length);v.a.isEqual(r,n)&&s.length>n.length&&s[n.length]>=i&&(s[n.length]+=1);var c=s.splice(0,1)[0],l=this.toc[c];while(s.length>0){if(o.push({ii:c,t:l.resource_type}),null!==l.resource_type&&"Section"!==l.resource_type||l.id===e.id||l.collapsed)return!1;c=s.splice(0,1)[0],l=l.children[c]}return!0},moveSubsection:function(t,e){var n=t.id,a=e.items;e.pathTo;function o(t,e){var n=t.children.map((function(n,a){return n.id===e?{parent:t.id,index:a}:o(n,e)})).filter((function(t){return null!==t}));return 1===n.length?n[0]:null}var s=o({id:null,children:a},n),i=s.parent,r=s.index;this.moveNode({casebook:this.casebook,rootNode:this.rootNode,moverId:n,parent:i,index:r})},collapseToc:function(){var t=this.$store.getters["table_of_contents/topLevelNodes"](this.rootNode);this.$store.dispatch("table_of_contents/collapseAll",{ids:t})},expandToc:function(){var t=this.$store.getters["table_of_contents/topLevelNodes"](this.rootNode);this.$store.dispatch("table_of_contents/expandAll",{ids:t})},toggleToc:function(){this.tocCollapsed?(this.tocCollapsed=!1,this.expandToc()):(this.tocCollapsed=!0,this.collapseToc())}}),props:["editing","rootOrdinals","verified_professor"],created:function(){this.fetch({casebook:this.casebook,subsection:this.section})}},Is=Ds,Ms=(n("a8fc"),Object(z["a"])(Is,zo,Wo,!1,null,null,null)),Ls=Ms.exports,Rs=n("8c4f"),Ps=n("074f"),Fs=n.n(Ps),Hs={resourcePath:function(t){return"/resources/".concat(t.resource_id,"/annotations")},path:function(t){return"".concat(Hs.resourcePath(t),"/").concat(t.id)}},qs={all:[]},Us={getCount:function(t){return t.all.length},getById:function(t){return function(e){return t.all.find((function(t){return t.id===e}))}},getStartingAtOrAfter:function(t){return function(e){return t.all.filter((function(t){return t.start_offset>=e}))}},getSpanningOffsets:function(t){return function(e,n){return t.all.filter((function(t){return t.start_offset<=e&&t.end_offset>=n}))}},getWithinOffsets:function(t){return function(e,n){return t.all.filter((function(t){return t.start_offset>e||t.end_offset<n}))}}},Bs={list:function(t,e){var n=t.commit;return a["a"].get(Hs.resourcePath(e)).then((function(t){n("append",t.data)}))},create:function(t,e){var n=t.commit;return a["a"].post(Hs.resourcePath(e),{annotation:e}).then((function(t){n("append",[Object(u["a"])(Object(u["a"])({},e),t.data)])}))},update:function(t,e){var n=t.commit;return a["a"].patch(Hs.path(e.obj),{annotation:e.vals}).then((function(t){n("update",{obj:e.obj,vals:Object(u["a"])(Object(u["a"])({},e.vals),t.data)})}))},destroy:function(t,e){var n=t.commit,o=t.rootGetters;return a["a"].delete(Hs.path(e)).then((function(t){n("destroy",e),n("annotations_ui/destroy",o["annotations_ui/getById"](e.id),{root:!0})}))},createAndUpdate:function(t,e){var n=t.commit,o=t.rootGetters;return a["a"].post(Hs.resourcePath(e.obj),{annotation:Object(u["a"])(Object(u["a"])({},e.obj),e.vals)}).then((function(t){n("annotations_ui/update",{obj:o["annotations_ui/getById"](e.obj.id),vals:{id:t.data.id}},{root:!0}),n("update",{obj:e.obj,vals:Object(u["a"])(Object(u["a"])({},e.vals),t.data)})}))}},Gs={append:function(t,e){var n;return(n=t.all).push.apply(n,Object(Pe["a"])(e))},update:function(t,e){return Object.assign(e.obj,e.vals)},destroy:function(t,e){return t.all.splice(t.all.indexOf(e),1)}},Vs={namespaced:!0,state:qs,getters:Us,actions:Bs,mutations:Gs},Ys={all:{}},zs={getById:function(t){return function(e){return t.all[e]}}},Ws={register:function(t,e){return o["default"].set(t.all,e.id,e.annotationIds)}},Qs={namespaced:!0,state:Ys,getters:zs,mutations:Ws},Ks={editable:!1},Js={getEditability:function(t){return t.editable}},Xs={setEditability:function(t,e){return t.editable=e}},Zs={namespaced:!0,state:Ks,getters:Js,mutations:Xs},ti={toc:{},augments:{}};function ei(t,e){v.a.keys(e).forEach((function(n){return o["default"].set(t,n,e[n])}))}var ni={addCSSClass:function(t){return function(e){return e.cssClasses=v.a.get(e,"cssClasses",[]).filter((function(e){return e!==t})).concat([t]),e}},removeCSSClass:function(t){return function(e){return e.cssClasses=v.a.get(e,"cssClasses",[]).filter((function(e){return e!==t})),e}},addFlag:function(t){return function(e){return e[t]=!0,e}},removeFlag:function(t){return function(e){return e[t]=!1,e}},flatFilter:function(t,e){function n(t){var a=e(t)?[t]:[];return a.concat(v.a.flatMap(t.children||[],n))}return n(t)},pruneFilter:function(t,e){function n(t){return e(t)?[t].concat(v.a.flatMap(t.children||[],n)):[]}return n(t)},firstMatching:function(t,e){function n(t){return e(t)?t:v.a.find(v.a.flatMap(t.children||[],n).filter(v.a.identity),e)}return n(t)},findPath:function(t,e){function n(t,a){var o=a.concat([t.id]);return e(t)?[{path:o}]:v.a.flatMap(t.children||[],(function(t){return n(t,o)}))}return v.a.get(n(t,[]),"0.path",[])},resourcePath:function(t,e){return e?"/casebook/".concat(t,"/toc/").concat(e):"/casebook/".concat(t,"/toc")},findNode:function(t,e){var n=function(t){return t.id===e},a=v.a.values(t).map((function(t){return ni.firstMatching(t,n)}));return v.a.find(a,v.a.identity)},auditIDs:function(t,e){function n(t){return t.resource_type&&"Temp"===t.resource_type}return e in t?ni.flatFilter(t[e],n).map((function(t){return t.id})):[]},collapsedIDs:function(t,e){function n(t){return t.collapsed}return e in t?ni.flatFilter(t[e],n).map((function(t){return t.id})):[]},openIDs:function(t,e){function n(t){return!t.collapsed}return e in t?ni.flatFilter(t[e],n).map((function(t){return t.id})):[]},topLevelIDs:function(t,e){return e in t?t[e].children.map((function(t){return t.id})):[]},augmentNode:ei,augmentNodes:function(t,e){var n={};function a(t){var o=v.a.get(e,t.id,n);ei(t,o),(t.children||[]).forEach(a)}a(t)}},ai={getNode:function(t){return function(e){return ni.findNode(t.toc,e)}},auditTargets:function(t){return function(e){return ni.auditIDs(t.toc,e)}},collapsedNodes:function(t){return function(e){return ni.collapsedIDs(t.toc,e)}},openNodes:function(t){return function(e){return ni.openIDs(t.toc,e)}},topLevelNodes:function(t){return function(e){return ni.topLevelIDs(t.toc,e)}}},oi=function(t){return ni.addCSSClass("collapsed")(ni.addFlag("collapsed")(t))},si=function(t){return ni.removeCSSClass("collapsed")(ni.removeFlag("collapsed")(t))},ii=function(t){return ni.removeCSSClass("loading")(ni.addCSSClass("loaded")(t))},ri=ni.addFlag("audit"),ci=ni.removeFlag("audit"),li={overwrite:function(t,e){ni.augmentNodes(e,t.augments),o["default"].set(t.toc,e.id,e)},delete:function(t,e){function n(e,a){function s(t){return[t.id].concat(v.a.flatMap(t.children||[],s))}for(var i=0;i<e.children.length;i++)if(e.children[i].id===a){var r=s(e.children[i])||[];r.forEach((function(e){v.a.has(t.augments,e)&&o["default"].delete(t.augments,e)})),o["default"].delete(e.children,i),i--}else n(e.children[i],a)}return e.casebook in t.toc&&(n(t.toc[e.casebook],e.id),t.toc)},shuffle:function(t,e){var n=e.id,a=e.children;n in t.toc&&(a.forEach((function(e){return ni.augmentNodes(e,t.augments)})),o["default"].set(t.toc[n],"children",a))},modifyAugment:function(t,e){var n=e.id,a=e.ids,s=e.modifyFn,i=(n?[n]:[]).concat(a||[]);i.forEach((function(e){var n=s(v.a.get(t.augments,e,{}));o["default"].set(t.augments,e,n);var a=ni.findNode(t.toc,e);a?ni.augmentNode(a,n):v.a.has(t.augments,e)&&o["default"].delete(t.augments,e)}))}},ui={revealNode:function(t,e){var n=t.commit,a=t.state,o=e.casebook,s=e.id,i=ni.findPath(a.toc[o],(function(t){return t.id===s}));n("modifyAugment",{ids:i,modifyFn:si})},toggleCollapsed:function(t,e){var n=t.commit,a=e.id;n("modifyAugment",{id:a,modifyFn:function(t){return v.a.get(t,"collapsed",!1)?si(t):oi(t)}})},collapseAll:function(t,e){var n=t.commit,a=e.ids;n("modifyAugment",{ids:a,modifyFn:oi})},expandAll:function(t,e){var n=t.commit,a=e.ids;n("modifyAugment",{ids:a,modifyFn:si})},setAudit:function(t,e){var n=t.commit,a=t.state,o=e.id,s=v.a.keys(a.augments).filter((function(t){return v.a.get(a.augments[t],"audit",!1)})).map(parseInt);n("modifyAugment",{ids:s,modifyFn:ci}),n("modifyAugment",{id:o,modifyFn:ri})},clearAudit:function(t,e){var n=t.commit,a=e.id;n("modifyAugment",{id:a,modifyFn:ci})},slowMerge:function(t,e){var n=t.commit,a=t.state,o=(e.casebook,e.newToc);function s(t){return!ni.findNode(a.toc,t.id)}var i=ni.flatFilter(o,s),r=250;i.forEach((function(t){a.augments[t.id]={cssClasses:["loading"]},t.cssClasses=["loading"]})),n("overwrite",o),setTimeout((function(){n("modifyAugment",{ids:i.map((function(t){return t.id})),modifyFn:ii})}),r)},fetch:function(t,e){var n=t.commit,o=e.casebook,s=e.subsection;s&&""!==s||(s=null),a["a"].get(ni.resourcePath(o,s)).then((function(t){t.data.id||(t.data.id=o),n("overwrite",t.data)}),console.error)},deleteNode:function(t,e){var n=t.commit,o=t.state,s=t.dispatch,i=e.casebook,r=e.rootNode,c=e.targetId;if(!c||""===c)return!1;var l=ni.findNode(o.toc,c);return null!==l&&a["a"].delete(ni.resourcePath(i,c)).then((function(){n("delete",{casebook:r,id:c})}),(function(){s("fetch",{casebook:r})}))},moveNode:function(t,e){var n=t.commit,o=(t.state,t.dispatch),s=e.casebook,i=e.rootNode,r=e.moverId,c=e.parent,l=e.index,u={parent:c,index:l};return null===c&&i!=s&&(u["parent"]=i),a["a"].patch(ni.resourcePath(s,r),u).then((function(t){t.data.id||(t.data.id=s),n("overwrite",t.data)}),(function(){o("fetch",i!==s?{casebook:s,subsection:i}:{casebook:s})}))}},di={namespaced:!0,state:ti,getters:ai,mutations:li,actions:ui},fi=n("b054"),hi=n.n(fi),pi=(n("4d63"),n("c607"),n("2c3e"),_["a"].url("search_sources")()),mi=_["a"].url("search_using"),bi={sources:[],searches:{}},vi={normalize:function(t){var e=v.a.keys(t).filter((function(t){return"searchLimit"!==t})).map((function(e){return"".concat(e,"=").concat(t[e])})).join(",");return e},encodeQuery:function(t){var e=v.a.keys(t).filter((function(t){return"searchLimit"!==t})).map((function(e){return"".concat("query"===e?"q":e,"=").concat(encodeURI(t[e]))})).join("&");return e}},gi={getSearch:function(t){return function(e){var n=vi.normalize(e),a=v.a.get(e,"searchLimit",!1),o=t.searches[n];if(!o)return{unRun:!0};var s=[],i=[],r=v.a.keys(v.a.groupBy(o.map((function(t){return v.a.isArray(t)?"completed":t})),(function(t){return t}))).filter((function(t){return"disabled"!==t})),c=0===r.length,l=1===r.length&&"completed"===r[0],d=1===r.length&&"pending"===r[0],f=r.length>1;o.forEach((function(e,n){if(!v.a.isArray(e)||0!==e.length){var o=v.a.find(t.sources,(function(t){var n=t.id;return n===e[0].source_id}));o&&(v.a.isArray(e)?(o.status="completed",a&&e[0].source_id!=a.id||(s=s.concat(e.map((function(t){return Object(u["a"])({sourceName:o.name},t)}))))):o.status="timeout"===o.status?"disabled":o.results,i.push(o))}}));var h=l&&0===s.length;return{sources:i,results:s,allDisabled:c,allCompleted:l,allPending:d,mixedResults:f,emptyResults:h}}},getSources:function(t){return t.sources}},_i={setSources:function(t,e){e.forEach((function(t,e){t.search_regexes.forEach((function(t){t.regex=new RegExp(t.regex)})),t.sourceIndex=e})),o["default"].set(t,"sources",e)},overwrite:function(t,e){var n=e.queryObj,a=e.source,s=e.results,i=vi.normalize(n);o["default"].set(t.searches[i],a.sourceIndex,s)},setPending:function(t,e){var n=e.queryObj,a=e.source,s=vi.normalize(n);o["default"].set(t.searches[s],a.sourceIndex,"pending")},setDisabled:function(t,e){var n=e.queryObj,a=e.source,s=vi.normalize(n);o["default"].set(t.searches[s],a.sourceIndex,"disabled")},scrub:function(t,e){var n=e.queryObj,a=e.source,s=vi.normalize(n);o["default"].set(t.searches[s],a.sourceIndex,"timeout")},initializeSearch:function(t,e){var n=vi.normalize(e);v.a.has(t.searches,n)||o["default"].set(t.searches,n,t.sources.map((function(){return"disabled"})))},toggleSourceEnabled:function(t,e){t.sources[e].enabled=!t.sources[e].enabled}},yi={fetchForSource:function(t,e){var n=t.state,o=t.commit,s=t.dispatch,i=e.queryObj,r=e.source;if(i!=={}){o("initializeSearch",i);var c=vi.normalize(i);if(!(v.a.hasIn(n,["searches",c])&&n.searches[c].length>=r.sourceIndex)||v.a.includes(["timeout","disabled"],n.searches[c][r.sourceIndex])){o("setPending",{queryObj:i,source:r});var l=mi({sourceId:r.id}),u="".concat(l,"?").concat(vi.encodeQuery(i));a["a"].get(u).then((function(t){var e=t.data.results;e.forEach((function(t){return t.source_id=r.id})),o("overwrite",{queryObj:i,source:r,results:e})}),console.error),s("timeOutSearch",{queryObj:i,source:r})}}},fetchForAllSources:function(t,e){var n,a=t.state,o=(t.commit,t.dispatch),s=e.queryObj,i=Object(g["a"])(a.sources);try{for(i.s();!(n=i.n()).done;){var r=n.value;o("fetchForSource",{queryObj:s,source:r})}}catch(c){i.e(c)}finally{i.f()}},fetchSources:function(t){var e=t.state,n=t.commit;t.dispatch;e.sources&&0!==e.sources.length||a["a"].get(pi).then((function(t){n("setSources",t.data.sources)}))},timeOutSearch:function(t,e){var n=t.state,a=t.commit,o=e.queryObj,s=e.source,i=3e4;setTimeout((function(){"pending"===n.searches[vi.normalize(o)][s.sourceIndex]&&a("scrub",{queryObj:o,source:s})}),i)},toggleSource:function(t,e){var n=t.state,a=t.commit,o=t.dispatch,s=e.source_id,i=e.queryObj,r=v.a.find(n.sources,(function(t){return t.id===s}));a("toggleSourceEnabled",r.sourceIndex),r.enabled?o("fetchForSource",{queryObj:i,source:r}):a("setDisabled",{queryObj:i,source:r})}},ki={namespaced:!0,state:bi,getters:gi,mutations:_i,actions:yi},Ci={casebook:null,section:null,inAuditMode:!1},xi={casebook:function(t){return function(){return t.casebook}},section:function(t){return function(){return t.section}},inAuditMode:function(t){return function(){return t.inAuditMode}}},Ti={setCasebook:function(t,e){return t.casebook=e},setSection:function(t,e){return t.section=e},setAuditMode:function(t,e){return t.inAuditMode=e}},wi={namespaced:!0,state:Ci,getters:xi,mutations:Ti};o["default"].use(H["b"]);var Oi=!1,Si=new H["b"].Store({modules:{annotations:Vs,annotations_ui:Dn,footnotes_ui:Qs,resources_ui:Zs,table_of_contents:di,case_search:ki,globals:wi},strict:Oi,plugins:Oi?[hi()()]:[]}),ji=n("ecee"),Ei=n("c074"),Ai=n("ad3d");o["default"].use(Rs["a"]),o["default"].config.productionTip=!1,o["default"].use(Fs.a),ji["c"].add(Ei["a"],Ei["b"]),o["default"].component("font-awesome-icon",Ai["a"]),document.addEventListener("DOMContentLoaded",(function(){var t=[{path:"/casebooks/:id/resources/:resource_id/",component:Yo}],e=new Rs["a"]({routes:t,mode:"history"}),n=new o["default"]({el:"#app",store:Si,router:e,components:{TheResource:Yo,SectionCloner:Ee,TakeNotesCloner:Me,AddContent:kt,TheTableOfContents:Ls,PortalVue:ae.a,QuickAdd:pe,ResourceTypePicker:Ce,Globals:ee,AuditButton:Mt,Dashboard:zt}});window.sentry.USE_SENTRY&&(console.log("using sentry"),r["a"]({Vue:o["default"],dsn:window.sentry.DSN,environment:window.sentry.ENVIRONMENT,tracesSampleRate:window.sentry.TRACES_SAMPLE_RATE})),window.app=n}))},9122:function(t,e,n){},"92c5":function(t,e,n){"use strict";n("9122")},9795:function(t,e,n){},"97fb":function(t,e,n){"use strict";n("5033")},"9a12":function(t,e,n){"use strict";n("ee79")},a105:function(t,e,n){"use strict";n("865c")},a3ea:function(t,e,n){"use strict";n("aacb")},a4cd:function(t,e,n){"use strict";n("66e1")},a5bf:function(t,e,n){"use strict";n("1b27")},a609:function(t,e,n){"use strict";n("845b")},a78b:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("portal",{attrs:{to:"modal-target"}},[n("transition",{attrs:{name:"fade"}},[n("focus-trap",{attrs:{active:t.hasFocusTarget,"initial-focus":t.wrappedFocus}},[n("div",{attrs:{id:"modal","aria-labelledby":"modal-title",tabindex:"-1"},on:{click:function(e){return e.target!==e.currentTarget?null:t.$emit("close")}}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){return t.$emit("close")}}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("")])]),n("h4",{staticClass:"modal-title",attrs:{id:"modal-title"}},[t._t("title")],2)]),n("div",{staticClass:"modal-body"},[t._t("body")],2)])])])])],1)],1)},o=[],s=n("2b88"),i=n.n(s),r=n("a026"),c=n("4976");r["default"].use(i.a),r["default"].directive("focus",{inserted:function(t){t.focus()}});var l={components:{FocusTrap:c["a"]},props:["initialFocus"],computed:{wrappedFocus:function(){return this.initialFocus},hasFocusTarget:function(){return!!this.initialFocus}},methods:{onKey:function(t){"Escape"==t.key&&this.$emit("close")}},created:function(){var t=document.getElementById("non-modal");t.style.position="relative",t.setAttribute("aria-hidden","true"),t.style.overflow="unset",document.body.classList.add("modal-open"),window.addEventListener("keydown",this.onKey)},beforeDestroy:function(){var t=document.getElementById("non-modal");t.removeAttribute("aria-hidden"),document.body.classList.remove("modal-open"),t.style="",window.removeEventListener("keydown",this.onKey)}},u=l,d=(n("b03f"),n("2877")),f=Object(d["a"])(u,a,o,!1,null,"67a504db",null);e["a"]=f.exports},a8fc:function(t,e,n){"use strict";n("bbbc")},a924:function(t,e,n){},aacb:function(t,e,n){},b036:function(t,e,n){"use strict";n("e420")},b03f:function(t,e,n){"use strict";n("fe67")},b4e9:function(t,e,n){},bbbc:function(t,e,n){},bbe1:function(t,e,n){},bef9:function(t,e,n){"use strict";n("b4e9")},bf5c:function(t,e,n){"use strict";n("831e")},c01b:function(t,e,n){},cf59:function(t,e,n){"use strict";n("547f")},d8a4:function(t,e,n){"use strict";n("a924")},dc0a:function(t,e,n){"use strict";n("bbe1")},dc40:function(t,e,n){"use strict";n("e9a4")},deb3:function(t,e,n){},e420:function(t,e,n){},e5a0:function(t,e,n){},e8ab:function(t,e,n){},e9a4:function(t,e,n){},ee79:function(t,e,n){},f0f6:function(t,e,n){"use strict";n("e8ab")},f2b5:function(t,e,n){"use strict";n("9795")},fe67:function(t,e,n){}});
//# sourceMappingURL=vue_app.f2e21bfc.js.map