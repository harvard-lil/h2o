(function(t){function n(n){for(var r,u,a=n[0],c=n[1],s=n[2],l=0,d=[];l<a.length;l++)u=a[l],Object.prototype.hasOwnProperty.call(o,u)&&o[u]&&d.push(o[u][0]),o[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);f&&f(n);while(d.length)d.shift()();return i.push.apply(i,s||[]),e()}function e(){for(var t,n=0;n<i.length;n++){for(var e=i[n],r=!0,a=1;a<e.length;a++){var c=e[a];0!==o[c]&&(r=!1)}r&&(i.splice(n--,1),t=u(u.s=e[0]))}return t}var r={},o={rich_text_editor:0},i=[];function u(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,u),e.l=!0,e.exports}u.m=t,u.c=r,u.d=function(t,n,e){u.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,n){if(1&n&&(t=u(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(u.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)u.d(e,r,function(n){return t[n]}.bind(null,r));return e},u.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(n,"a",n),n},u.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},u.p="/static/dist/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=n,a=a.slice();for(var s=0;s<a.length;s++)n(a[s]);var f=c;i.push([1,"chunk-common"]),e()})({"030f":function(t,n,e){(function(t){(function(n){"use strict";var e=function(){},r=function(t){return function(){return t()}},o=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},i=function(t){return function(){return t}},u=function(t){return t};function a(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}var c=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},s=function(t){return function(){throw new Error(t)}},f=i(!1),l=i(!0),d=tinymce.util.Tools.resolve("tinymce.ThemeManager"),m=function(){return m=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e],n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},m.apply(this,arguments)};function g(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]])}return e}function p(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var h,v=function(){return b},b=function(){var t=function(t){return t.isNone()},n=function(t){return t()},r=function(t){return t},o={fold:function(t,n){return t()},is:f,isSome:f,isNone:l,getOr:r,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:r,orThunk:n,map:v,each:e,bind:v,exists:f,forall:l,filter:v,equals:t,equals_:t,toArray:function(){return[]},toString:i("none()")};return Object.freeze&&Object.freeze(o),o}(),y=function(t){var n=i(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:l,isNone:f,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return y(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:b},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(f,(function(n){return e(t,n)}))}};return o},w=function(t){return null===t||void 0===t?b:y(t)},x={some:y,none:v,from:w},C=function(t){var n=function(n){return t===n},e=function(n){return C(t)},r=function(n){return C(t)},o=function(n){return C(n(t))},u=function(n){return C(t)},a=function(n){n(t)},c=function(n){return n(t)},s=function(n,e){return e(t)},d=function(n){return n(t)},m=function(n){return n(t)},g=function(){return x.some(t)};return{is:n,isValue:l,isError:f,getOr:i(t),getOrThunk:i(t),getOrDie:i(t),or:e,orThunk:r,fold:s,map:o,mapError:u,each:a,bind:c,exists:d,forall:m,toOption:g}},S=function(t){var n=function(t){return t()},r=function(){return s(String(t))()},o=function(t){return t},i=function(t){return t()},a=function(n){return S(t)},c=function(n){return S(n(t))},d=function(n){return S(t)},m=function(n,e){return n(t)};return{is:f,isValue:f,isError:l,getOr:u,getOrThunk:n,getOrDie:r,or:o,orThunk:i,fold:m,map:a,mapError:c,each:e,bind:d,exists:f,forall:l,toOption:x.none}},k=function(t,n){return t.fold((function(){return S(n)}),C)},O={value:C,error:S,fromOption:k},T=function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},E=function(t){return function(n){return T(n)===t}},D=E("string"),A=E("object"),_=E("array"),R=E("boolean"),B=E("function"),I=E("number"),P=function(t,n){if(_(t)){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e]))return!1;return!0}return!1},N=Array.prototype.slice,M=Array.prototype.indexOf,F=Array.prototype.push,L=function(t,n){return M.call(t,n)},H=function(t,n){var e=L(t,n);return-1===e?x.none():x.some(e)},z=function(t,n){return L(t,n)>-1},V=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return!0}return!1},j=function(t,n){for(var e=[],r=0;r<t;r++)e.push(n(r));return e},U=function(t,n){for(var e=[],r=0;r<t.length;r+=n){var o=N.call(t,r,r+n);e.push(o)}return e},W=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},G=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];n(o,e)}},q=function(t,n){for(var e=t.length-1;e>=0;e--){var r=t[e];n(r,e)}},X=function(t,n){for(var e=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o],a=n(u,o)?e:r;a.push(u)}return{pass:e,fail:r}},Y=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e},K=function(t,n,e){return q(t,(function(t){e=n(e,t)})),e},$=function(t,n,e){return G(t,(function(t){e=n(e,t)})),e},J=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return x.some(o)}return x.none()},Q=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return x.some(e)}return x.none()},Z=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!_(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);F.apply(n,t[e])}return n},tt=function(t,n){var e=W(t,n);return Z(e)},nt=function(t,n){for(var e=0,r=t.length;e<r;++e){var o=t[e];if(!0!==n(o,e))return!1}return!0},et=function(t){var n=N.call(t,0);return n.reverse(),n},rt=function(t,n){return Y(t,(function(t){return!z(n,t)}))},ot=function(t){return[t]},it=function(t,n){var e=N.call(t,0);return e.sort(n),e},ut=function(t){return 0===t.length?x.none():x.some(t[0])},at=function(t){return 0===t.length?x.none():x.some(t[t.length-1])},ct=B(Array.from)?Array.from:function(t){return N.call(t)},st=Object.keys,ft=Object.hasOwnProperty,lt=function(t,n){for(var e=st(t),r=0,o=e.length;r<o;r++){var i=e[r],u=t[i];n(u,i)}},dt=function(t,n){return mt(t,(function(t,e){return{k:e,v:n(t,e)}}))},mt=function(t,n){var e={};return lt(t,(function(t,r){var o=n(t,r);e[o.k]=o.v})),e},gt=function(t,n){var e=[];return lt(t,(function(t,r){e.push(n(t,r))})),e},pt=function(t,n){for(var e=st(t),r=0,o=e.length;r<o;r++){var i=e[r],u=t[i];if(n(u,i,t))return x.some(u)}return x.none()},ht=function(t){return gt(t,(function(t){return t}))},vt=function(t,n){return bt(t,n)?x.from(t[n]):x.none()},bt=function(t,n){return ft.call(t,n)},yt=function(t){if(!_(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],r={};return G(t,(function(o,i){var u=st(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==r[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!_(c))throw new Error("case arguments must be an array");e.push(a),r[a]=function(){var r=arguments.length;if(r!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];var s=function(t){var n=st(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));var r=nt(e,(function(t){return z(n,t)}));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,o)};return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);var n=arguments[i];return n.apply(null,o)},match:s,log:function(t){n.console.log(t,{constructors:e,constructor:a,params:o})}}}})),r},wt={generate:yt},xt=Object.prototype.hasOwnProperty,Ct=function(t,n){return n},St=function(t,n){var e=A(t)&&A(n);return e?Ot(t,n):n},kt=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)xt.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},Ot=kt(St),Tt=kt(Ct),Et=function(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}},Dt=wt.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),At=function(t){return Dt.defaultedThunk(i(t))},_t=function(t){return Dt.mergeWithThunk(i(t))},Rt=Dt.strict,Bt=Dt.asOption,It=Dt.defaultedThunk,Pt=Dt.mergeWithThunk,Nt=function(t,n){var e={};return lt(t,(function(t,r){z(n,r)||(e[r]=t)})),e},Mt=function(t){return function(n){return bt(n,t)?x.from(n[t]):x.none()}},Ft=function(t,n){return function(e){return bt(e,t)?e[t]:n}},Lt=function(t,n){return Mt(n)(t)},Ht=function(t,n){return bt(t,n)&&void 0!==t[n]&&null!==t[n]},zt=function(t,n){var e={};return e[t]=n,e},Vt=function(t){var n={};return G(t,(function(t){n[t.key]=t.value})),n},jt=(wt.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t){var n=[],e=[];return G(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}}),Ut=function(t,n){return Nt(t,n)},Wt=function(t){return Mt(t)},Gt=function(t,n){return Ft(t,n)},qt=function(t,n){return Lt(t,n)},Xt=function(t,n){return zt(t,n)},Yt=function(t){return Vt(t)},Kt=function(t,n){return 0===t.length?O.value(n):O.value(Ot(n,Tt.apply(void 0,t)))},$t=function(t){return O.error(Z(t))},Jt=function(t,n){var e=jt(t);return e.errors.length>0?$t(e.errors):Kt(e.values,n)},Qt=function(t,n){return Ht(t,n)};(function(t){t[t["Error"]=0]="Error",t[t["Value"]=1]="Value"})(h||(h={}));var Zt=function(t,n,e){return t.stype===h.Error?n(t.serror):e(t.svalue)},tn=function(t){var n=[],e=[];return G(t,(function(t){Zt(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},nn=function(t,n){return t.stype===h.Error?{stype:h.Error,serror:n(t.serror)}:t},en=function(t,n){return t.stype===h.Value?{stype:h.Value,svalue:n(t.svalue)}:t},rn=function(t,n){return t.stype===h.Value?n(t.svalue):t},on=function(t,n){return t.stype===h.Error?n(t.serror):t},un=function(t){return{stype:h.Value,svalue:t}},an=function(t){return{stype:h.Error,serror:t}},cn=function(t){return Zt(t,O.error,O.value)},sn=function(t){return t.fold(an,un)},fn={fromResult:sn,toResult:cn,svalue:un,partition:tn,serror:an,bind:rn,bindError:on,map:en,mapError:nn,fold:Zt},ln=function(t,n){return t.length>0?fn.svalue(Ot(n,Tt.apply(void 0,t))):fn.svalue(n)},dn=function(t){return o(fn.serror,Z)(t)},mn=function(t,n){var e=fn.partition(t);return e.errors.length>0?dn(e.errors):ln(e.values,n)},gn=function(t){var n=fn.partition(t);return n.errors.length>0?dn(n.errors):fn.svalue(n.values)},pn={consolidateObj:mn,consolidateArr:gn},hn=wt.generate([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),vn=wt.generate([{field:["name","presence","type"]},{state:["name"]}]),bn=function(t){return A(t)&&st(t).length>100?" removed due to size":JSON.stringify(t,null,2)},yn=function(t){var n=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t;return W(n,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))},wn=function(t,n){return fn.serror([{path:t,getErrorInfo:n}])},xn=function(t,n,e){return wn(t,(function(){return'Could not find valid *strict* value for "'+n+'" in '+bn(e)}))},Cn=function(t,n){return wn(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))},Sn=function(t,n,e){return wn(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+bn(n)}))},kn=function(t,n){return wn(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))},On=function(t,n){return wn(t,(function(){return n}))},Tn=wt.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),En=function(t,n,e){return Lt(n,e).fold((function(){return xn(t,e,n)}),fn.svalue)},Dn=function(t,n,e){var r=Lt(t,n).fold((function(){return e(t)}),u);return fn.svalue(r)},An=function(t,n){return fn.svalue(Lt(t,n))},_n=function(t,n,e){var r=Lt(t,n).map((function(n){return!0===n?e(t):n}));return fn.svalue(r)},Rn=function(t,n,e,r){return e.fold((function(e,o,u,a){var c=function(n){var i=a.extract(t.concat([e]),r,n);return fn.map(i,(function(t){return zt(o,r(t))}))},s=function(n){return n.fold((function(){var t=zt(o,r(x.none()));return fn.svalue(t)}),(function(n){var i=a.extract(t.concat([e]),r,n);return fn.map(i,(function(t){return zt(o,r(x.some(t)))}))}))};return function(){return u.fold((function(){return fn.bind(En(t,n,e),c)}),(function(t){return fn.bind(Dn(n,e,t),c)}),(function(){return fn.bind(An(n,e),s)}),(function(t){return fn.bind(_n(n,e,t),s)}),(function(t){var r=t(n),o=fn.map(Dn(n,e,i({})),(function(t){return Ot(r,t)}));return fn.bind(o,c)}))}()}),(function(t,e){var o=e(n);return fn.svalue(zt(t,r(o)))}))},Bn=function(t,n,e,r){var o=W(e,(function(e){return Rn(t,n,e,r)}));return pn.consolidateObj(o,{})},In=function(t){var n=function(n,e,r){return t().extract(n,e,r)},e=function(){return t().toString()},r=function(){return t().toDsl()};return{extract:n,toString:e,toDsl:r}},Pn=function(t){var n=function(n,e,r){return fn.bindError(t(r,e),(function(t){return On(n,t)}))},e=function(){return"val"},r=function(){return hn.itemOf(t)};return{extract:n,toString:e,toDsl:r}},Nn=function(t){var n=st(t);return Y(n,(function(n){return Qt(t,n)}))},Mn=function(t){var n=Fn(t),e=K(t,(function(t,n){return n.fold((function(n){return Ot(t,Xt(n,!0))}),i(t))}),{}),r=function(t,r,o){var i=R(o)?[]:Nn(o),u=Y(i,(function(t){return!Qt(e,t)}));return 0===u.length?n.extract(t,r,o):kn(t,u)};return{extract:r,toString:n.toString,toDsl:n.toDsl}},Fn=function(t){var n=function(n,e,r){return Bn(n,r,t,e)},e=function(){var n=W(t,(function(t){return t.fold((function(t,n,e,r){return t+" -> "+r.toString()}),(function(t,n){return"state("+t+")"}))}));return"obj{\n"+n.join("\n")+"}"},r=function(){return hn.objOf(W(t,(function(t){return t.fold((function(t,n,e,r){return vn.field(t,e,r)}),(function(t,n){return vn.state(t)}))})))};return{extract:n,toString:e,toDsl:r}},Ln=function(t){var n=function(n,e,r){var o=W(r,(function(r,o){return t.extract(n.concat(["["+o+"]"]),e,r)}));return pn.consolidateArr(o)},e=function(){return"array("+t.toString()+")"},r=function(){return hn.arrOf(t)};return{extract:n,toString:e,toDsl:r}},Hn=function(t,n){var e=function(n,e){return Ln(Pn(t)).extract(n,u,e)},r=function(t,r,o){var i=st(o),u=e(t,i);return fn.bind(u,(function(e){var i=W(e,(function(t){return Tn.field(t,t,Rt(),n)}));return Fn(i).extract(t,r,o)}))},o=function(){return"setOf("+n.toString()+")"},i=function(){return hn.setOf(t,n)};return{extract:r,toString:o,toDsl:i}},zn=i(Pn(fn.svalue)),Vn=o(Ln,Fn),jn=Tn.state,Un=Tn.field,Wn=function(t,n,e,r,o){var i=qt(r,o);return i.fold((function(){return Sn(t,r,o)}),(function(r){return r.extract(t.concat(["branch: "+o]),n,e)}))},Gn=function(t,n){var e=function(e,r,o){var i=qt(o,t);return i.fold((function(){return Cn(e,t)}),(function(t){return Wn(e,r,o,n,t)}))},r=function(){return"chooseOn("+t+"). Possible values: "+st(n)},o=function(){return hn.choiceOf(t,n)};return{extract:e,toString:r,toDsl:o}},qn=Pn(fn.svalue),Xn=function(t){return Vn(t)},Yn=function(){return Ln(qn)},Kn=In,$n=function(t){return Pn((function(n){return t(n).fold(fn.serror,fn.svalue)}))},Jn=function(t,n){return Hn((function(n){return fn.fromResult(t(n))}),n)},Qn=function(t,n,e,r){var o=n.extract([t],e,r);return fn.mapError(o,(function(t){return{input:r,errors:t}}))},Zn=function(t,n,e){return fn.toResult(Qn(t,n,u,e))},te=function(t){return t.fold((function(t){throw new Error(ee(t))}),u)},ne=function(t,n,e){return te(Zn(t,n,e))},ee=function(t){return"Errors: \n"+yn(t.errors)+"\n\nInput object: "+bn(t.input)},re=function(t,n){return Gn(t,n)},oe=function(t,n){return Gn(t,dt(n,Fn))},ie=i(qn),ue=function(t,n){return Pn((function(e){var r=typeof e;return t(e)?fn.svalue(e):fn.serror("Expected type: "+n+" but got: "+r)}))},ae=ue(I,"number"),ce=ue(D,"string"),se=ue(R,"boolean"),fe=ue(B,"function"),le=function(t){var n=function(t,n){var e=t.next();while(!e.done){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return le(t[n])}));case"Map":return n(t.keys(),le)&&n(t.values(),le);case"Set":return n(t.keys(),le);default:return!1}},de=Pn((function(t){return le(t)?fn.svalue(t):fn.serror("Expected value to be acceptable for sending via postMessage")})),me=function(t){return $n((function(n){return z(t,n)?O.value(n):O.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},ge=function(t){return Un(t,t,Rt(),zn())},pe=function(t,n){return Un(t,t,Rt(),n)},he=function(t){return pe(t,ae)},ve=function(t){return pe(t,ce)},be=function(t,n){return Un(t,t,Rt(),me(n))},ye=function(t){return pe(t,se)},we=function(t){return pe(t,fe)},xe=function(t,n){return Un(t,t,Bt(),Pn((function(e){return fn.serror("The field: "+t+" is forbidden. "+n)})))},Ce=function(t,n){return Un(t,t,Rt(),Fn(n))},Se=function(t,n){return Un(t,t,Rt(),Vn(n))},ke=function(t,n){return Un(t,t,Rt(),Ln(n))},Oe=function(t){return Un(t,t,Bt(),zn())},Te=function(t,n){return Un(t,t,Bt(),n)},Ee=function(t){return Te(t,ae)},De=function(t){return Te(t,ce)},Ae=function(t){return Te(t,fe)},_e=function(t,n){return Te(t,Ln(n))},Re=function(t,n){return Te(t,Fn(n))},Be=function(t,n){return Te(t,Mn(n))},Ie=function(t,n){return Un(t,t,At(n),zn())},Pe=function(t,n,e){return Un(t,t,At(n),e)},Ne=function(t,n){return Pe(t,n,ae)},Me=function(t,n){return Pe(t,n,ce)},Fe=function(t,n,e){return Pe(t,n,me(e))},Le=function(t,n){return Pe(t,n,se)},He=function(t,n){return Pe(t,n,fe)},ze=function(t,n){return Pe(t,n,de)},Ve=function(t,n,e){return Pe(t,n,Ln(e))},je=function(t,n,e){return Pe(t,n,Fn(e))},Ue=function(t,n){return jn(t,n)},We=function(t){var n=t,e=function(){return n},r=function(t){n=t},o=function(){return We(e())};return{get:e,set:r,clone:o}},Ge=function(t,e){var r=e||n.document,o=r.createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||o.childNodes.length>1)throw n.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Ye(o.childNodes[0])},qe=function(t,e){var r=e||n.document,o=r.createElement(t);return Ye(o)},Xe=function(t,e){var r=e||n.document,o=r.createTextNode(t);return Ye(o)},Ye=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:i(t)}},Ke=function(t,n,e){var r=t.dom();return x.from(r.elementFromPoint(n,e)).map(Ye)},$e={fromHtml:Ge,fromTag:qe,fromText:Xe,fromDom:Ye,fromPoint:Ke},Je=function(t,n,e){return 0!==(t.compareDocumentPosition(n)&e)},Qe=function(t,e){return Je(t,e,n.Node.DOCUMENT_POSITION_PRECEDING)},Ze=function(t,e){return Je(t,e,n.Node.DOCUMENT_POSITION_CONTAINED_BY)},tr={documentPositionPreceding:Qe,documentPositionContainedBy:Ze},nr=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}},er=function(t,n){var e=nr(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return ir(r(1),r(2))},rr=function(t,n){var e=String(n).toLowerCase();return 0===t.length?or():er(t,e)},or=function(){return ir(0,0)},ir=function(t,n){return{major:t,minor:n}},ur={nu:ir,detect:rr,unknown:or},ar="Edge",cr="Chrome",sr="IE",fr="Opera",lr="Firefox",dr="Safari",mr=function(t,n){return function(){return n===t}},gr=function(){return pr({current:void 0,version:ur.unknown()})},pr=function(t){var n=t.current,e=t.version;return{current:n,version:e,isEdge:mr(ar,n),isChrome:mr(cr,n),isIE:mr(sr,n),isOpera:mr(fr,n),isFirefox:mr(lr,n),isSafari:mr(dr,n)}},hr={unknown:gr,nu:pr,edge:i(ar),chrome:i(cr),ie:i(sr),opera:i(fr),firefox:i(lr),safari:i(dr)},vr="Windows",br="iOS",yr="Android",wr="Linux",xr="OSX",Cr="Solaris",Sr="FreeBSD",kr=function(t,n){return function(){return n===t}},Or=function(){return Tr({current:void 0,version:ur.unknown()})},Tr=function(t){var n=t.current,e=t.version;return{current:n,version:e,isWindows:kr(vr,n),isiOS:kr(br,n),isAndroid:kr(yr,n),isOSX:kr(xr,n),isLinux:kr(wr,n),isSolaris:kr(Cr,n),isFreeBSD:kr(Sr,n)}},Er={unknown:Or,nu:Tr,windows:i(vr),ios:i(br),android:i(yr),linux:i(wr),osx:i(xr),solaris:i(Cr),freebsd:i(Sr)},Dr=function(t,n,e,r){var o=t.isiOS()&&!0===/ipad/i.test(e),u=t.isiOS()&&!o,a=t.isiOS()||t.isAndroid(),c=a||r("(pointer:coarse)"),s=o||!u&&a&&r("(min-device-width:768px)"),f=u||a&&!s,l=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),d=!f&&!s&&!l;return{isiPad:i(o),isiPhone:i(u),isTablet:i(s),isPhone:i(f),isTouch:i(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:i(l),isDesktop:i(d)}},Ar=function(t,n){var e=String(n).toLowerCase();return J(t,(function(t){return t.search(e)}))},_r=function(t,n){return Ar(t,n).map((function(t){var e=ur.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},Rr=function(t,n){return Ar(t,n).map((function(t){var e=ur.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},Br={detectBrowser:_r,detectOs:Rr},Ir=function(t,n,e){if(""===n)return!0;if(t.length<n.length)return!1;var r=t.substr(e,e+n.length);return r===n},Pr=function(t,n){return-1!==t.indexOf(n)},Nr=function(t,n){return Ir(t,n,t.length-n.length)},Mr=function(t){return t.replace(/^\s+|\s+$/g,"")},Fr=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Lr=function(t){return function(n){return Pr(n,t)}},Hr=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Pr(t,"edge/")&&Pr(t,"chrome")&&Pr(t,"safari")&&Pr(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Fr],search:function(t){return Pr(t,"chrome")&&!Pr(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Pr(t,"msie")||Pr(t,"trident")}},{name:"Opera",versionRegexes:[Fr,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Lr("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Lr("firefox")},{name:"Safari",versionRegexes:[Fr,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Pr(t,"safari")||Pr(t,"mobile/"))&&Pr(t,"applewebkit")}}],zr=[{name:"Windows",search:Lr("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Pr(t,"iphone")||Pr(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Lr("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Lr("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Lr("linux"),versionRegexes:[]},{name:"Solaris",search:Lr("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Lr("freebsd"),versionRegexes:[]}],Vr={browsers:i(Hr),oses:i(zr)},jr=function(t,n){var e=Vr.browsers(),r=Vr.oses(),o=Br.detectBrowser(e,t).fold(hr.unknown,hr.nu),i=Br.detectOs(r,t).fold(Er.unknown,Er.nu),u=Dr(i,o,t,n);return{browser:o,os:i,deviceType:u}},Ur={detect:jr},Wr=function(t){return n.window.matchMedia(t).matches},Gr=We(Ur.detect(n.navigator.userAgent,Wr)),qr=function(){return Gr.get()},Xr=(n.Node.ATTRIBUTE_NODE,n.Node.CDATA_SECTION_NODE,n.Node.COMMENT_NODE,n.Node.DOCUMENT_NODE),Yr=(n.Node.DOCUMENT_TYPE_NODE,n.Node.DOCUMENT_FRAGMENT_NODE,n.Node.ELEMENT_NODE),Kr=n.Node.TEXT_NODE,$r=(n.Node.PROCESSING_INSTRUCTION_NODE,n.Node.ENTITY_REFERENCE_NODE,n.Node.ENTITY_NODE,n.Node.NOTATION_NODE,Yr),Jr=Xr,Qr=function(t,n){var e=t.dom();if(e.nodeType!==$r)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Zr=function(t){return t.nodeType!==$r&&t.nodeType!==Jr||0===t.childElementCount},to=function(t,e){var r=void 0===e?n.document:e.dom();return Zr(r)?[]:W(r.querySelectorAll(t),$e.fromDom)},no=function(t,e){var r=void 0===e?n.document:e.dom();return Zr(r)?x.none():x.from(r.querySelector(t)).map($e.fromDom)},eo=function(t,n){return t.dom()===n.dom()},ro=function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},oo=function(t,n){return tr.documentPositionContainedBy(t.dom(),n.dom())},io=qr().browser,uo=io.isIE()?oo:ro,ao=function(t,n){return eo(t.element(),n.event().target())},co=function(t){if(!Qt(t,"can")&&!Qt(t,"abort")&&!Qt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return ne("Extracting event.handler",Mn([Ie("can",i(!0)),Ie("abort",i(!1)),Ie("run",e)]),t)},so=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return $(t,(function(t,r){return t&&n(r).apply(void 0,e)}),!0)}},fo=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return $(t,(function(t,r){return t||n(r).apply(void 0,e)}),!1)}},lo=function(t){return B(t)?{can:i(!0),abort:i(!1),run:t}:t},mo=function(t){var n=so(t,(function(t){return t.can})),e=fo(t,(function(t){return t.abort})),r=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];G(t,(function(t){t.run.apply(void 0,n)}))};return co({can:n,abort:e,run:r})},go=i("touchstart"),po=i("touchmove"),ho=i("touchend"),vo=i("touchcancel"),bo=i("mousedown"),yo=i("mousemove"),wo=i("mouseout"),xo=i("mouseup"),Co=i("mouseover"),So=i("focusin"),ko=i("focusout"),Oo=i("keydown"),To=i("keyup"),Eo=i("input"),Do=i("change"),Ao=i("click"),_o=i("transitionend"),Ro=i("selectstart"),Bo={tap:i("alloy.tap")},Io=i("alloy.focus"),Po=i("alloy.blur.post"),No=i("alloy.paste.post"),Mo=i("alloy.receive"),Fo=i("alloy.execute"),Lo=i("alloy.focus.item"),Ho=Bo.tap,zo=function(){return qr().deviceType.isTouch()?Bo.tap():Ao()},Vo=i("alloy.longpress"),jo=i("alloy.sandbox.close"),Uo=i("alloy.typeahead.cancel"),Wo=i("alloy.system.init"),Go=i("alloy.system.touchmove"),qo=i("alloy.system.touchend"),Xo=i("alloy.system.scroll"),Yo=i("alloy.system.resize"),Ko=i("alloy.system.attached"),$o=i("alloy.system.detached"),Jo=i("alloy.system.dismissRequested"),Qo=i("alloy.system.repositionRequested"),Zo=i("alloy.focusmanager.shifted"),ti=i("alloy.slotcontainer.visibility"),ni=i("alloy.change.tab"),ei=i("alloy.dismiss.tab"),ri=i("alloy.highlight"),oi=i("alloy.dehighlight"),ii=function(t,n){si(t,t.element(),n,{})},ui=function(t,n,e){si(t,t.element(),n,e)},ai=function(t){ii(t,Fo())},ci=function(t,n,e){si(t,n,e,{})},si=function(t,n,e,r){var o=m({target:n},r);t.getSystem().triggerEvent(e,n,dt(o,i))},fi=function(t,n,e,r){t.getSystem().triggerEvent(e,n,r.event())};function li(t,n,e,r,o){return t(e,r)?x.some(e):B(o)&&o(e)?x.none():n(e,r,o)}"undefined"!==typeof n.window?n.window:Function("return this;")();var di=function(t){var n=t.dom().nodeName;return n.toLowerCase()},mi=function(t){return t.dom().nodeType},gi=function(t){return function(n){return mi(n)===t}},pi=gi(Yr),hi=gi(Kr),vi=function(t){var n=hi(t)?t.dom().parentNode:t.dom();return void 0!==n&&null!==n&&n.ownerDocument.body.contains(n)},bi=Et((function(){return yi($e.fromDom(n.document))})),yi=function(t){var n=t.dom().body;if(null===n||void 0===n)throw new Error("Body is not available yet");return $e.fromDom(n)},wi=function(t,n,e){var r=t.dom(),o=B(e)?e:i(!1);while(r.parentNode){r=r.parentNode;var u=$e.fromDom(r);if(n(u))return x.some(u);if(o(u))break}return x.none()},xi=function(t,n,e){var r=function(t,n){return n(t)};return li(r,wi,t,n,e)},Ci=function(t,n){var e=function(t){for(var r=0;r<t.childNodes.length;r++){var o=$e.fromDom(t.childNodes[r]);if(n(o))return x.some(o);var i=e(t.childNodes[r]);if(i.isSome())return i}return x.none()};return e(t.dom())},Si=function(t,n,e){var r=xi(t,(function(t){return n(t).isSome()}),e);return r.bind(n)},ki=function(t){return Yt(t)},Oi=function(t,n){return{key:t,value:co({abort:n})}},Ti=function(t,n){return{key:t,value:co({can:n})}},Ei=function(t){return{key:t,value:co({run:function(t,n){n.event().prevent()}})}},Di=function(t,n){return{key:t,value:co({run:n})}},Ai=function(t,n,e){return{key:t,value:co({run:function(t){n.apply(void 0,[t].concat(e))}})}},_i=function(t){return function(n){return Di(t,n)}},Ri=function(t){return function(n){return{key:t,value:co({run:function(t,e){ao(t,e)&&n(t,e)}})}}},Bi=function(t,n){return Di(t,(function(e,r){e.getSystem().getByUid(n).each((function(n){fi(n,n.element(),t,r)}))}))},Ii=function(t,n,e){var r=n.partUids[e];return Bi(t,r)},Pi=function(t,n){return Di(t,(function(t,e){var r=e.event(),o=t.getSystem().getByDom(r.target()).fold((function(){var n=Si(r.target(),(function(n){return t.getSystem().getByDom(n).toOption()}),i(!1));return n.getOr(t)}),(function(t){return t}));n(t,o,e)}))},Ni=function(t){return Di(t,(function(t,n){n.cut()}))},Mi=function(t){return Di(t,(function(t,n){n.stop()}))},Fi=function(t,n){return Ri(t)(n)},Li=Ri(Ko()),Hi=Ri($o()),zi=Ri(Wo()),Vi=_i(Fo()),ji=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return G(t,(function(t,e){r[t]=i(n[e])})),r}},Ui=function(t){return t.slice(0).sort()},Wi=function(t,n){throw new Error("All required keys ("+Ui(t).join(", ")+") were not specified. Specified keys were: "+Ui(n).join(", ")+".")},Gi=function(t){throw new Error("Unsupported keys for object: "+Ui(t).join(", "))},qi=function(t,n){if(!_(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");G(n,(function(n){if(!D(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")}))},Xi=function(t){var n=Ui(t),e=J(n,(function(t,e){return e<n.length-1&&t===n[e+1]}));e.each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")}))},Yi=function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return qi("required",t),qi("optional",n),Xi(e),function(r){var o=st(r),u=nt(t,(function(t){return z(o,t)}));u||Wi(t,o);var a=Y(o,(function(t){return!z(e,t)}));a.length>0&&Gi(a);var c={};return G(t,(function(t){c[t]=i(r[t])})),G(n,(function(t){c[t]=i(Object.prototype.hasOwnProperty.call(r,t)?x.some(r[t]):x.none())})),c}},Ki=function(t){return $e.fromDom(t.dom().ownerDocument)},$i=function(t){return $e.fromDom(t.dom().ownerDocument.documentElement)},Ji=function(t){return $e.fromDom(t.dom().ownerDocument.defaultView)},Qi=function(t){return x.from(t.dom().parentNode).map($e.fromDom)},Zi=function(t){return x.from(t.dom().offsetParent).map($e.fromDom)},tu=function(t){return x.from(t.dom().nextSibling).map($e.fromDom)},nu=function(t){return W(t.dom().childNodes,$e.fromDom)},eu=function(t,n){var e=t.dom().childNodes;return x.from(e[n]).map($e.fromDom)},ru=function(t){return eu(t,0)},ou=(ji("element","offset"),function(t,e){var r=e||n.document,o=r.createElement("div");return o.innerHTML=t,nu($e.fromDom(o))}),iu=function(t,n){var e=Qi(t);e.each((function(e){e.dom().insertBefore(n.dom(),t.dom())}))},uu=function(t,n){var e=tu(t);e.fold((function(){var e=Qi(t);e.each((function(t){cu(t,n)}))}),(function(t){iu(t,n)}))},au=function(t,n){var e=ru(t);e.fold((function(){cu(t,n)}),(function(e){t.dom().insertBefore(n.dom(),e.dom())}))},cu=function(t,n){t.dom().appendChild(n.dom())},su=function(t,n,e){eu(t,e).fold((function(){cu(t,n)}),(function(t){iu(t,n)}))},fu=function(t,n){G(n,(function(n){iu(t,n)}))},lu=function(t,n){G(n,(function(n){cu(t,n)}))},du=function(t){t.dom().textContent="",G(nu(t),(function(t){mu(t)}))},mu=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},gu=function(t){var n=nu(t);n.length>0&&fu(t,n),mu(t)},pu=function(t){return t.dom().innerHTML},hu=function(t,n){var e=Ki(t),r=e.dom(),o=$e.fromDom(r.createDocumentFragment()),i=ou(n,r);lu(o,i),du(t),cu(t,o)},vu=function(t){var n=$e.fromTag("div"),e=$e.fromDom(t.dom().cloneNode(!0));return cu(n,e),pu(n)},bu=function(t,e,r){if(!(D(r)||R(r)||I(r)))throw n.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")},yu=function(t,n,e){bu(t.dom(),n,e)},wu=function(t,n){var e=t.dom();lt(n,(function(t,n){bu(e,n,t)}))},xu=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},Cu=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Su=function(t,n){t.dom().removeAttribute(n)},ku=function(t,n){return $e.fromDom(t.dom().cloneNode(n))},Ou=function(t){return ku(t,!1)},Tu=function(t){var n=Ou(t);return vu(n)},Eu=function(t){return Tu(t)},Du=function(t,n,e){return eo(n,t.element())&&!eo(n,e)},Au=ki([Ti(Io(),(function(t,e){var r=e.event().originator(),o=e.event().target();return!Du(t,r,o)||(n.console.warn(Io()+" did not get interpreted by the desired target. \nOriginator: "+Eu(r)+"\nTarget: "+Eu(o)+"\nCheck the "+Io()+" event handlers"),!1)}))]),_u=Object.freeze({events:Au}),Ru=0,Bu=function(t){var n=new Date,e=n.getTime(),r=Math.floor(1e9*Math.random());return Ru++,t+"_"+r+Ru+String(e)},Iu=i("alloy-id-"),Pu=i("data-alloy-id"),Nu=Iu(),Mu=Pu(),Fu=function(t,n){var e=Bu(Nu+t);return Lu(n,e),e},Lu=function(t,n){Object.defineProperty(t.dom(),Mu,{value:n,writable:!0})},Hu=function(t){var n=pi(t)?t.dom()[Mu]:null;return x.from(n)},zu=function(t){return Bu(t)},Vu=u,ju=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+"\n"+Eu(t().element())+" is not in context.")}};return{debugInfo:i("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:i(!1)}},Uu=ju(),Wu=function(t,n,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:Gu(u.slice(0,1).concat(u.slice(3)))}},t},Gu=function(t){return W(t,(function(t){return Nr(t,"/*")?t.substring(0,t.length-"/*".length):t}))},qu=function(t,n){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:Gu(i)}},t},Xu=function(t,n){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Gu(i.slice(1))}},t},Yu=Bu("alloy-premade"),Ku=function(t){return Xt(Yu,t)},$u=function(t){return qt(t,Yu)},Ju=function(t){return Xu((function(n){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.apply(void 0,[n.getApis()].concat([n].concat(e)))}),t)},Qu={init:function(){return Zu({readState:function(){return"No State required"}})}},Zu=function(t){return t},ta=function(t,n){var e=W(n,(function(t){return Re(t.name(),[ge("config"),Ie("state",Qu)])})),r=Zn("component.behaviours",Fn(e),t.behaviours).fold((function(n){throw new Error(ee(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),(function(t){return t}));return{list:n,data:dt(r,(function(t){var n=t,e=n.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return e}}))}},na=function(t){return t.list},ea=function(t){return t.data},ra=function(t,n){var e={};return lt(t,(function(t,r){lt(t,(function(t,o){var i=Gt(o,[])(e);e[o]=i.concat([n(r,t)])}))})),e},oa=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},ia=function(t,n){return m(m({},t),{attributes:m(m({},t.attributes),n.attributes),styles:m(m({},t.styles),n.styles),classes:t.classes.concat(n.classes)})},ua=function(t,n,e,r){var o=m({},n);G(e,(function(n){o[n.name()]=n.exhibit(t,r)}));var i=function(t,n){return{name:t,modification:n}},u=ra(o,i),a=function(t){return K(t,(function(t,n){return m(m({},n.modification),t)}),{})},c=K(u.classes,(function(t,n){return n.modification.concat(t)}),[]),s=a(u.attributes),f=a(u.styles);return oa({classes:c,attributes:s,styles:f})},aa=function(t,n,e,r){var o=e.slice(0);try{var i=o.sort((function(e,o){var i=e[n](),u=o[n](),a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return a<c?-1:c<a?1:0}));return O.value(i)}catch(u){return O.error([u])}},ca=function(t,n){return{handler:t,purpose:i(n)}},sa=function(t,n){return{cHandler:t,purpose:i(n)}},fa=function(t,n){return sa(a.apply(void 0,[t.handler].concat(n)),t.purpose())},la=function(t){return t.cHandler},da=function(t,n){return{name:i(t),handler:i(n)}},ma=function(t,n){var e={};return G(t,(function(t){e[t.name()]=t.handlers(n)})),e},ga=function(t,n,e){var r=m(m({},e),ma(n,t));return ra(r,da)},pa=function(t,n,e,r){var o=ga(t,e,r);return ya(o,n)},ha=function(t){var n=lo(t);return function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[t,e].concat(r);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},va=function(t,n){return O.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(n,(function(t){return t.name()})),null,2)])},ba=function(t,n,e){var r=n[e];return r?aa("Event: "+e,"name",t,r).map((function(t){var n=W(t,(function(t){return t.handler()}));return mo(n)})):va(e,t)},ya=function(t,n){var e=gt(t,(function(t,e){var r=1===t.length?O.value(t[0].handler()):ba(t,n,e);return r.map((function(r){var o=ha(r),i=t.length>1?Y(n[e],(function(n){return V(t,(function(t){return t.name()===n}))})).join(" > "):t[0].name();return Xt(e,ca(o,i))}))}));return Jt(e,{})},wa=function(t){return Zn("custom.definition",Fn([Un("dom","dom",Rt(),Fn([ge("tag"),Ie("styles",{}),Ie("classes",[]),Ie("attributes",{}),Oe("value"),Oe("innerHtml")])),ge("components"),ge("uid"),Ie("events",{}),Ie("apis",{}),Un("eventOrder","eventOrder",_t({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),ie()),Oe("domModification")]),t)},xa=function(t){return m(m({},t.dom),{uid:t.uid,domChildren:W(t.components,(function(t){return t.element()}))})},Ca=function(t){return t.domModification.fold((function(){return oa({})}),oa)},Sa=function(t){return t.events},ka=function(t,n){var e=xu(t,n);return void 0===e||""===e?[]:e.split(" ")},Oa=function(t,n,e){var r=ka(t,n),o=r.concat([e]);return yu(t,n,o.join(" ")),!0},Ta=function(t,n,e){var r=Y(ka(t,n),(function(t){return t!==e}));return r.length>0?yu(t,n,r.join(" ")):Su(t,n),!1},Ea=function(t){return void 0!==t.dom().classList},Da=function(t){return ka(t,"class")},Aa=function(t,n){return Oa(t,"class",n)},_a=function(t,n){return Ta(t,"class",n)},Ra=function(t,n){Ea(t)?t.dom().classList.add(n):Aa(t,n)},Ba=function(t){var n=Ea(t)?t.dom().classList:Da(t);0===n.length&&Su(t,"class")},Ia=function(t,n){if(Ea(t)){var e=t.dom().classList;e.remove(n)}else _a(t,n);Ba(t)},Pa=function(t,n){return Ea(t)&&t.dom().classList.contains(n)},Na=function(t,n){G(n,(function(n){Ra(t,n)}))},Ma=function(t,n){G(n,(function(n){Ia(t,n)}))},Fa=function(t){return void 0!==t.style&&B(t.style.getPropertyValue)},La=function(t,e,r){if(!D(r))throw n.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);Fa(t)&&t.style.setProperty(e,r)},Ha=function(t,n){Fa(t)&&t.style.removeProperty(n)},za=function(t,n,e){var r=t.dom();La(r,n,e)},Va=function(t,n){var e=t.dom();lt(n,(function(t,n){La(e,n,t)}))},ja=function(t,n){var e=t.dom();lt(n,(function(t,n){t.fold((function(){Ha(e,n)}),(function(t){La(e,n,t)}))}))},Ua=function(t,e){var r=t.dom(),o=n.window.getComputedStyle(r),i=o.getPropertyValue(e),u=""!==i||vi(t)?i:Wa(r,e);return null===u?void 0:u},Wa=function(t,n){return Fa(t)?t.style.getPropertyValue(n):""},Ga=function(t,n){var e=t.dom(),r=Wa(e,n);return x.from(r).filter((function(t){return t.length>0}))},qa=function(t,n,e){var r=$e.fromTag(t);za(r,n,e);var o=Ga(r,n);return o.isSome()},Xa=function(t,n){var e=t.dom();Ha(e,n),Cu(t,"style")&&""===Mr(xu(t,"style"))&&Su(t,"style")},Ya=function(t){return t.dom().offsetWidth},Ka=function(t){return t.dom().value},$a=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom().value=n},Ja=function(t){var n=$e.fromTag(t.tag);wu(n,t.attributes),Na(n,t.classes),Va(n,t.styles),t.innerHtml.each((function(t){return hu(n,t)}));var e=t.domChildren;return lu(n,e),t.value.each((function(t){$a(n,t)})),t.uid,Lu(n,t.uid),n},Qa=function(t){var n=Gt("behaviours",{})(t),e=Y(st(n),(function(t){return void 0!==n[t]}));return W(e,(function(t){return n[t].me}))},Za=function(t,n){return ta(t,n)},tc=function(t){var n=Qa(t);return Za(t,n)},nc=function(t,n,e){var r=xa(t),o=Ca(t),i={"alloy.base.modification":o},u=n.length>0?ua(e,i,n,r):o;return ia(r,u)},ec=function(t,n,e){var r={"alloy.base.behaviour":Sa(t)};return pa(e,t.eventOrder,n,r).getOrDie()},rc=function(t){var n=function(){return y},e=We(Uu),r=te(wa(t)),o=tc(t),u=na(o),a=ea(o),c=nc(r,u,a),s=Ja(c),f=ec(r,u,a),l=We(r.components),d=function(t){e.set(t)},m=function(){e.set(ju(n))},g=function(){var t=nu(s),n=tt(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));l.set(n)},p=function(n){var e=a,r=B(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))};return r()},h=function(t){return B(a[t.name()])},v=function(){return r.apis},b=function(t){return a[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},y={getSystem:e.get,config:p,hasConfigured:h,spec:i(t),readState:b,getApis:v,connect:d,disconnect:m,element:i(s),syncComponents:g,components:l.get,events:i(f)};return y},oc=function(t){var n=Gt("components",[])(t);return W(n,sc)},ic=function(t){var n=Vu(t),e=n.events,r=g(n,["events"]),o=oc(r),i=m(m({},r),{events:m(m({},_u),e),components:o});return O.value(rc(i))},uc=function(t){var n=$e.fromText(t);return ac({element:n})},ac=function(t){var n=ne("external.component",Mn([ge("element"),Oe("uid")]),t),r=We(ju()),o=function(t){r.set(t)},u=function(){r.set(ju((function(){return a})))};n.uid.each((function(t){Lu(n.element,t)}));var a={getSystem:r.get,config:x.none,hasConfigured:i(!1),connect:o,disconnect:u,getApis:function(){return{}},element:i(n.element),spec:i(t),readState:i("No state"),syncComponents:e,components:i([]),events:i({})};return Ku(a)},cc=zu,sc=function(t){return $u(t).fold((function(){var n=t.hasOwnProperty("uid")?t:m({uid:cc("")},t);return ic(n).getOrDie()}),(function(t){return t}))},fc=Ku;function lc(t,n){var e=function(n,e){if(!I(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();Fa(r)&&(r.style[t]=e+"px")},r=function(e){var r=n(e);if(r<=0||null===r){var o=Ua(e,t);return parseFloat(o)||0}return r},o=r,i=function(t,n){return $(n,(function(n,e){var r=Ua(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)},u=function(t,n,e){var r=i(t,e),o=n>r?n-r:0;return o};return{set:e,get:r,getOuter:o,aggregate:i,max:u}}var dc,mc=lc("height",(function(t){var n=t.dom();return vi(t)?n.getBoundingClientRect().height:n.offsetHeight})),gc=function(t){return mc.get(t)},pc=function(t){return mc.getOuter(t)},hc=function(t,n){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=mc.max(t,n,e);za(t,"max-height",r+"px")},vc=function(t,n){var e=function(e,r){return vc(t+e,n+r)};return{left:i(t),top:i(n),translate:e}},bc=vc,yc=function(t){var n=t.getBoundingClientRect();return bc(n.left,n.top)},wc=function(t,n){return void 0!==t?t:void 0!==n?n:0},xc=function(t){var n=t.dom().ownerDocument,e=n.body,r=n.defaultView,o=n.documentElement;if(e===t.dom())return bc(e.offsetLeft,e.offsetTop);var i=wc(r.pageYOffset,o.scrollTop),u=wc(r.pageXOffset,o.scrollLeft),a=wc(o.clientTop,e.clientTop),c=wc(o.clientLeft,e.clientLeft);return Cc(t).translate(u-c,i-a)},Cc=function(t){var n=t.dom(),e=n.ownerDocument,r=e.body;return r===n?bc(r.offsetLeft,r.offsetTop):vi(t)?yc(n):bc(0,0)},Sc=lc("width",(function(t){return t.dom().offsetWidth})),kc=function(t,n){Sc.set(t,n)},Oc=function(t){return Sc.get(t)},Tc=function(t){return Sc.getOuter(t)},Ec=function(t,n){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=Sc.max(t,n,e);za(t,"max-width",r+"px")},Dc=(qr().browser.isSafari(),function(t){var e=void 0!==t?t.dom():n.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return bc(r,o)}),Ac=function(t,n,e,r){return{x:i(t),y:i(n),width:i(e),height:i(r),right:i(t+e),bottom:i(n+r)}},_c=function(t){var e=void 0===t?n.window:t,r=e.document,o=Dc($e.fromDom(r)),i=e["visualViewport"];if(void 0!==i)return Ac(Math.max(i.pageLeft,o.left()),Math.max(i.pageTop,o.top()),i.width,i.height);var u=r.documentElement,a=u.clientWidth,c=u.clientHeight;return Ac(o.left(),o.top(),a,c)},Rc=function(t,n){var e=t.view(n);return e.fold(i([]),(function(n){var e=t.owner(n),r=Rc(t,e);return[n].concat(r)}))},Bc=function(t,n){var e=n.owner(t),r=Rc(n,e);return x.some(r)},Ic=function(t){var e=t.dom()===n.document?x.none():x.from(t.dom().defaultView.frameElement);return e.map($e.fromDom)},Pc=function(t){return Ki(t)},Nc=Object.freeze({view:Ic,owner:Pc}),Mc=function(t){var e=$e.fromDom(n.document),r=Dc(e),o=Bc(t,Nc);return o.fold(a(xc,t),(function(n){var e=Cc(t),o=K(n,(function(t,n){var e=Cc(n);return{left:t.left+e.left(),top:t.top+e.top()}}),{left:0,top:0});return bc(o.left+e.left()+r.left(),o.top+e.top()+r.top())}))},Fc=ji("point","width","height"),Lc=ji("x","y","width","height"),Hc=function(t,n,e,r){return{x:i(t),y:i(n),width:i(e),height:i(r),right:i(t+e),bottom:i(n+r)}},zc=function(t){var n=xc(t),e=Tc(t),r=pc(t);return Hc(n.left(),n.top(),e,r)},Vc=function(t){var n=Mc(t),e=Tc(t),r=pc(t);return Hc(n.left(),n.top(),e,r)},jc=function(){return _c(n.window)},Uc=function(t,n,e){return xi(t,n,e).isSome()},Wc=function(t,n,e){return wi(t,(function(t){return Qr(t,n)}),e)},Gc=function(t,n){return no(n,t)},qc=function(t,n,e){return li(Qr,Wc,t,n,e)},Xc=function(t){var n=xi(t,(function(t){if(!pi(t))return!1;var n=xu(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1}));return n.bind((function(t){var n=xu(t,"id"),e=Ki(t);return Gc(e,'[aria-owns="'+n+'"]')}))},Yc=function(){var t=Bu("aria-owns"),n=function(n){yu(n,"aria-owns",t)},e=function(t){Su(t,"aria-owns")};return{id:i(t),link:n,unlink:e}},Kc=function(t,n){return Xc(n).exists((function(n){return $c(t,n)}))},$c=function(t,n){return Uc(n,(function(n){return eo(n,t.element())}),i(!1))||Kc(t,n)},Jc=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},Qc=function(t){for(var n=[],e=0;e<t.length;e++){var r=t[e];if(!r.isSome())return x.none();n.push(r.getOrDie())}return x.some(n)},Zc=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return x.none()},ts=function(t,n,e){return t.isSome()&&n.isSome()?x.some(e(t.getOrDie(),n.getOrDie())):x.none()},ns=function(t,n,e,r){return t.isSome()&&n.isSome()&&e.isSome()?x.some(r(t.getOrDie(),n.getOrDie(),e.getOrDie())):x.none()},es="unknown";(function(t){t[t["STOP"]=0]="STOP",t[t["NORMAL"]=1]="NORMAL",t[t["LOGGING"]=2]="LOGGING"})(dc||(dc={}));var rs=We({}),os=function(t,e){var r=[],o=(new Date).getTime();return{logEventCut:function(t,n,e){r.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){r.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){r.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){r.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){r.push({outcome:"response",purpose:e,target:n})},write:function(){var i=(new Date).getTime();z(["mousemove","mouseover","mouseout",Wo()],t)||n.console.log(t,{event:t,time:i-o,target:e.dom(),sequence:W(r,(function(t){return z(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Eu(t.target)+")":t.outcome}))})}}},is=function(t,n,e){var r=qt(rs.get(),t).orThunk((function(){var n=st(rs.get());return Zc(n,(function(n){return t.indexOf(n)>-1?x.some(rs.get()[n]):x.none()}))})).getOr(dc.NORMAL);switch(r){case dc.NORMAL:return e(fs());case dc.LOGGING:var o=os(t,n),i=e(o);return o.write(),i;case dc.STOP:return!0}},us=["alloy/data/Fields","alloy/debugging/Debugging"],as=function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");return J(n,(function(t){return t.indexOf("alloy")>0&&!V(us,(function(n){return t.indexOf(n)>-1}))})).getOr(es)}return es},cs={logEventCut:e,logEventStopped:e,logNoParent:e,logEventNoHandlers:e,logEventResponse:e,write:e},ss=function(t,n,e){return is(t,n,e)},fs=i(cs),ls=i([ge("menu"),ge("selectedMenu")]),ds=i([ge("item"),ge("selectedItem")]),ms=(i(Fn(ds().concat(ls()))),i(Fn(ds()))),gs=Ce("initSize",[ge("numColumns"),ge("numRows")]),ps=function(){return pe("markers",ms())},hs=function(){return Ce("markers",[ge("backgroundMenu")].concat(ls()).concat(ds()))},vs=function(t){return Ce("markers",W(t,ge))},bs=function(t,n,e){as();return Un(n,n,e,$n((function(t){return O.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},ys=function(t){return bs("onHandler",t,At(e))},ws=function(t){return bs("onKeyboardHandler",t,At(x.none))},xs=function(t){return bs("onHandler",t,Rt())},Cs=function(t){return bs("onKeyboardHandler",t,Rt())},Ss=function(t,n){return Ue(t,i(n))},ks=function(t){return Ue(t,u)},Os=i(gs),Ts=ji("x","y","bubble","direction","label"),Es=wt.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ds=function(t,n,e,r,o,i,u,a,c){return t.fold(n,e,r,o,i,u,a,c)},As=function(t,n,e,r){return t.fold(n,n,r,r,n,r,e,e)},_s=function(t,n,e,r){return t.fold(n,r,n,r,e,e,n,r)},Rs=Es.southeast,Bs=Es.southwest,Is=Es.northeast,Ps=Es.northwest,Ns=Es.south,Ms=Es.north,Fs=Es.east,Ls=Es.west,Hs=function(t){return t.x()},zs=function(t,n){return t.x()+t.width()/2-n.width()/2},Vs=function(t,n){return t.x()+t.width()-n.width()},js=function(t,n){return t.y()-n.height()},Us=function(t){return t.y()+t.height()},Ws=function(t,n){return t.y()+t.height()/2-n.height()/2},Gs=function(t){return t.x()+t.width()},qs=function(t,n){return t.x()-n.width()},Xs=function(t,n,e){return Ts(Hs(t),Us(t),e.southeast(),Rs(),"layout-se")},Ys=function(t,n,e){return Ts(Vs(t,n),Us(t),e.southwest(),Bs(),"layout-sw")},Ks=function(t,n,e){return Ts(Hs(t),js(t,n),e.northeast(),Is(),"layout-ne")},$s=function(t,n,e){return Ts(Vs(t,n),js(t,n),e.northwest(),Ps(),"layout-nw")},Js=function(t,n,e){return Ts(zs(t,n),js(t,n),e.north(),Ms(),"layout-n")},Qs=function(t,n,e){return Ts(zs(t,n),Us(t),e.south(),Ns(),"layout-s")},Zs=function(t,n,e){return Ts(Gs(t),Ws(t,n),e.east(),Fs(),"layout-e")},tf=function(t,n,e){return Ts(qs(t,n),Ws(t,n),e.west(),Ls(),"layout-w")},nf=function(){return[Xs,Ys,Ks,$s,Qs,Js,Zs,tf]},ef=function(){return[Ys,Xs,$s,Ks,Qs,Js,Zs,tf]},rf=function(){return[Xs,Ys,Ks,$s,Qs,Js]},of=function(){return[Ys,Xs,$s,Ks,Qs,Js]},uf=function(t,n,e){return Vi((function(r){e(r,t,n)}))},af=function(t,n,e){return zi((function(r,o){e(r,t,n)}))},cf=function(t,n,e,r,o,i){var u=Mn(t),a=Re(n,[Be("config",t)]);return df(u,a,n,e,r,o,i)},sf=function(t,n,e,r,o,i){var u=t,a=Re(n,[Te("config",t)]);return df(u,a,n,e,r,o,i)},ff=function(t,n,e){var r=function(r){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var a=[r].concat(o);return r.config({name:i(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(a,1);return n.apply(void 0,[r,t.config,t.state].concat(e))}))};return Wu(r,e,n)},lf=function(t){return{key:t,value:void 0}},df=function(t,n,e,r,o,i,u){var c=function(t){return Qt(t,e)?t[e]():x.none()},s=dt(o,(function(t,n){return ff(e,t,n)})),f=dt(i,(function(t,n){return qu(t,n)})),l=m(m(m({},f),s),{revoke:a(lf,e),config:function(n){var r=ne(e+"-config",t,n);return{key:e,value:{config:r,me:l,configAsRaw:Et((function(){return ne(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:function(){return n},exhibit:function(t,n){return c(t).bind((function(t){return qt(r,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(oa({}))},name:function(){return e},handlers:function(t){return c(t).map((function(t){var n=Gt("events",(function(t,n){return{}}))(r);return n(t.config,t.state)})).getOr({})}});return l},mf=function(t){return Yt(t)},gf=Mn([ge("fields"),ge("name"),Ie("active",{}),Ie("apis",{}),Ie("state",Qu),Ie("extra",{})]),pf=function(t){var n=ne("Creating behaviour: "+t.name,gf,t);return cf(n.fields,n.name,n.active,n.apis,n.extra,n.state)},hf=Mn([ge("branchKey"),ge("branches"),ge("name"),Ie("active",{}),Ie("apis",{}),Ie("state",Qu),Ie("extra",{})]),vf=function(t){var n=ne("Creating behaviour: "+t.name,hf,t);return sf(oe(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},bf=i(void 0),yf=function(t,n){return n.universal()?t:Y(t,(function(t){return z(n.channels(),t)}))},wf=function(t){return ki([Di(Mo(),(function(n,e){var r=t.channels,o=st(r),i=yf(o,e);G(i,(function(t){var o=r[t],i=o.schema,u=ne("channel["+t+"] data\nReceiver: "+Eu(n.element()),i,e.data());o.onReceive(n,u)}))}))])},xf=Object.freeze({events:wf}),Cf=[pe("channels",Jn(O.value,Mn([xs("onReceive"),Ie("schema",ie())])))],Sf=pf({fields:Cf,name:"receiving",active:xf}),kf=function(t,n){return oa({classes:[],styles:n.useFixed()?{}:{position:"relative"}})},Of=Object.freeze({exhibit:kf}),Tf=function(t){t.dom().focus()},Ef=function(t){t.dom().blur()},Df=function(t){var n=Ki(t).dom();return t.dom()===n.activeElement},Af=function(t){var e=void 0!==t?t.dom():n.document;return x.from(e.activeElement).map($e.fromDom)},_f=function(t){return Af(Ki(t)).filter((function(n){return t.dom().contains(n.dom())}))},Rf=function(t,n){var r=Ki(n),o=Af(r).bind((function(t){var e=function(n){return eo(t,n)};return e(n)?x.some(n):Ci(n,e)})),i=t(n);return o.each((function(t){Af(r).filter((function(n){return eo(n,t)})).fold((function(){Tf(t)}),e)})),i},Bf=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],If=function(t,n,e){var r=function(t){return qt(e,t).getOr([])},o=function(t,n,e){var o=rt(Bf,e);return{offset:function(){return bc(t,n)},classesOn:function(){return tt(e,r)},classesOff:function(){return tt(o,r)}}};return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return o(-t,n,["top","alignRight"])},innerNortheast:function(){return o(t,n,["top","alignLeft"])},innerNorth:function(){return o(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return o(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return o(t,-n,["bottom","alignLeft"])},innerSouth:function(){return o(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return o(t,-n/2,["valignCentre","right"])},innerEast:function(){return o(-t,-n/2,["valignCentre","left"])}}},Pf=function(){return If(0,0,{})},Nf=Yi(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),Mf=ji("position","left","top","right","bottom"),Ff=wt.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Lf=function(t,n,e,r,o,i){var u=n.x()-e,a=n.y()-r,c=n.width(),s=n.height(),f=o-(u+c),l=i-(a+s),d=x.some(u),m=x.some(a),g=x.some(f),p=x.some(l),h=x.none();return Ds(n.direction(),(function(){return Mf(t,d,m,h,h)}),(function(){return Mf(t,h,m,g,h)}),(function(){return Mf(t,d,h,h,p)}),(function(){return Mf(t,h,h,g,p)}),(function(){return Mf(t,d,m,h,h)}),(function(){return Mf(t,d,h,h,p)}),(function(){return Mf(t,d,m,h,h)}),(function(){return Mf(t,h,m,g,h)}))},Hf=function(t,n){return t.fold((function(){return Mf("absolute",x.some(n.x()),x.some(n.y()),x.none(),x.none())}),(function(t,e,r,o){return Lf("absolute",n,t,e,r,o)}),(function(t,e,r,o){return Lf("fixed",n,t,e,r,o)}))},zf=function(t,n){var e=a(Mc,n),r=t.fold(e,e,(function(){var t=Dc();return Mc(n).translate(-t.left(),-t.top())})),o=Tc(n),i=pc(n);return Hc(r.left(),r.top(),o,i)},Vf=function(t,n){return n.fold((function(){return t.fold(jc,jc,Hc)}),(function(n){return t.fold(n,n,(function(){var e=n(),r=jf(t,e.x(),e.y());return Hc(r.left(),r.top(),e.width(),e.height())}))}))},jf=function(t,n,e){var r=bc(n,e),o=function(){var t=Dc();return r.translate(-t.left(),-t.top())};return t.fold(i(r),i(r),o)},Uf=function(t,n,e,r){return t.fold(n,e,r)},Wf=Ff.relative,Gf=Ff.fixed,qf=function(t){return t},Xf=function(t,n){return function(e){return"rtl"===Yf(e)?n:t}},Yf=function(t){return"rtl"===Ua(t,"direction")?"rtl":"ltr"},Kf=function(){return Re("layouts",[ge("onLtr"),ge("onRtl")])},$f=function(t,n,e,r){var o=n.layouts.map((function(n){return n.onLtr(t)})).getOr(e),i=n.layouts.map((function(n){return n.onRtl(t)})).getOr(r),u=Xf(o,i);return u(t)},Jf=function(t,n,e){var r=n.hotspot,o=zf(e,r.element()),i=$f(t.element(),n,rf(),of());return x.some(qf({anchorBox:o,bubble:n.bubble.getOr(Pf()),overrides:n.overrides,layouts:i,placer:x.none()}))},Qf=[ge("hotspot"),Oe("bubble"),Ie("overrides",{}),Kf(),Ss("placement",Jf)],Zf=function(t,n,e){var r=jf(e,n.x,n.y),o=Hc(r.left(),r.top(),n.width,n.height),i=$f(t.element(),n,nf(),ef());return x.some(qf({anchorBox:o,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:x.none()}))},tl=[ge("x"),ge("y"),Ie("height",0),Ie("width",0),Ie("bubble",Pf()),Ie("overrides",{}),Kf(),Ss("placement",Zf)],nl=function(){return"\ufeff"},el=ji("start","soffset","finish","foffset"),rl={create:el},ol=wt.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),il=function(t,n,e,r){return t.fold(n,e,r)},ul=function(t){return t.fold(u,u,u)},al=ol.before,cl=ol.on,sl=ol.after,fl={before:al,on:cl,after:sl,cata:il,getStart:ul},ll=wt.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),dl=function(t){return ll.exact(t.start(),t.soffset(),t.finish(),t.foffset())},ml=function(t){return t.match({domRange:function(t){return $e.fromDom(t.startContainer)},relative:function(t,n){return fl.getStart(t)},exact:function(t,n,e,r){return t}})},gl=ll.domRange,pl=ll.relative,hl=ll.exact,vl=function(t){var n=ml(t);return Ji(n)},bl=rl.create,yl={domRange:gl,relative:pl,exact:hl,exactFromRange:dl,getWin:vl,range:bl},wl=function(t,n){n.fold((function(n){t.setStartBefore(n.dom())}),(function(n,e){t.setStart(n.dom(),e)}),(function(n){t.setStartAfter(n.dom())}))},xl=function(t,n){n.fold((function(n){t.setEndBefore(n.dom())}),(function(n,e){t.setEnd(n.dom(),e)}),(function(n){t.setEndAfter(n.dom())}))},Cl=function(t,n,e){var r=t.document.createRange();return wl(r,n),xl(r,e),r},Sl=function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},kl=function(t){return{left:i(t.left),top:i(t.top),right:i(t.right),bottom:i(t.bottom),width:i(t.width),height:i(t.height)}},Ol=function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?x.some(e).map(kl):x.none()},Tl=wt.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),El=function(t,n,e){return n($e.fromDom(e.startContainer),e.startOffset,$e.fromDom(e.endContainer),e.endOffset)},Dl=function(t,n){return n.match({domRange:function(t){return{ltr:i(t),rtl:x.none}},relative:function(n,e){return{ltr:Et((function(){return Cl(t,n,e)})),rtl:Et((function(){return x.some(Cl(t,e,n))}))}},exact:function(n,e,r,o){return{ltr:Et((function(){return Sl(t,n,e,r,o)})),rtl:Et((function(){return x.some(Sl(t,r,o,n,e))}))}}})},Al=function(t,n){var e=n.ltr();if(e.collapsed){var r=n.rtl().filter((function(t){return!1===t.collapsed}));return r.map((function(t){return Tl.rtl($e.fromDom(t.endContainer),t.endOffset,$e.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return El(t,Tl.ltr,e)}))}return El(t,Tl.ltr,e)},_l=function(t,n){var e=Dl(t,n);return Al(t,e)},Rl=function(t,n){var e=_l(t,n);return e.match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})},Bl=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(n-a.left);if(e<=a.bottom){if(e<a.top||c>i)return u-1;i=c}}return 0},Il=function(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom};function Pl(t,n){var e=function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return r(e).getOr("")},r=function(n){return t(n)?x.from(n.dom().nodeValue):x.none()},o=function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r};return{get:e,getOption:r,set:o}}var Nl=Pl(hi,"text"),Ml=function(t){return Nl.get(t)},Fl=function(t){return Nl.getOption(t)},Ll=function(t,n,e,r,o){var i=function(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r},u=function(t){var n=i(t);return n.getBoundingClientRect()},a=Ml(n).length,c=Bl(u,e,r,o.right,a);return i(c)},Hl=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getClientRects(),u=Zc(i,(function(t){return Il(t,e,r)?x.some(t):x.none()}));return u.map((function(o){return Ll(t,n,e,r,o)}))},zl=function(t,n,e,r){var o=t.dom().createRange(),i=nu(n);return Zc(i,(function(n){return o.selectNode(n.dom()),Il(o.getBoundingClientRect(),e,r)?Vl(t,n,e,r):x.none()}))},Vl=function(t,n,e,r){return hi(n)?Hl(t,n,e,r):zl(t,n,e,r)},jl=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return Vl(t,n,u,a)},Ul=function(t){return"img"===di(t)?1:Fl(t).fold((function(){return nu(t).length}),(function(t){return t.length}))},Wl="",Gl=function(t){return Fl(t).filter((function(t){return 0!==t.trim().length||t.indexOf(Wl)>-1})).isSome()},ql=["img","br"],Xl=function(t){var n=Gl(t);return n||z(ql,di(t))},Yl=function(t){return Ci(t,Xl)},Kl=function(t){return $l(t,Xl)},$l=function(t,n){var e=function(t){for(var r=nu(t),o=r.length-1;o>=0;o--){var i=r[o];if(n(i))return x.some(i);var u=e(i);if(u.isSome())return u}return x.none()};return e(t)},Jl=!0,Ql=!1,Zl=function(t,n){return n-t.left<t.right-n?Jl:Ql},td=function(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r},nd=function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=Zl(o,e),u=i===Jl?Yl:Kl;return u(n).map((function(n){return td(t,n,i)}))},ed=function(t,n,e){var r=n.dom().getBoundingClientRect(),o=Zl(r,e);return x.some(td(t,n,o))},rd=function(t,n,e){var r=0===nu(n).length?ed:nd;return r(t,n,e)},od=function(t,n,e){return x.from(t.dom().caretPositionFromPoint(n,e)).bind((function(n){if(null===n.offsetNode)return x.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),x.some(e)}))},id=function(t,n,e){return x.from(t.dom().caretRangeFromPoint(n,e))},ud=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return jl(t,n,u,a)},ad=function(t,n,e){return $e.fromPoint(t,n,e).bind((function(r){var o=function(){return rd(t,r,n)};return 0===nu(r).length?o():ud(t,r,n,e).orThunk(o)}))},cd=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(t,n){return to(n,t)}),sd=function(t,n,e,r){var o=Ki(t),i=o.dom().createRange();return i.setStart(t.dom(),n),i.setEnd(e.dom(),r),i},fd=function(t,n,e,r){var o=sd(t,n,e,r),i=eo(t,e)&&n===r;return o.collapsed&&!i},ld=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return x.some(rl.create($e.fromDom(n.startContainer),n.startOffset,$e.fromDom(e.endContainer),e.endOffset))}return x.none()},dd=function(t){var n=$e.fromDom(t.anchorNode),e=$e.fromDom(t.focusNode);return fd(n,t.anchorOffset,e,t.focusOffset)?x.some(rl.create(n,t.anchorOffset,e,t.focusOffset)):ld(t)},md=function(t){return x.from(t.getSelection()).filter((function(t){return t.rangeCount>0})).bind(dd)},gd=function(t,n){var e=Rl(t,n);return Ol(e)},pd=ji("element","offset"),hd=function(t,n){var e=nu(t);if(0===e.length)return pd(t,n);if(n<e.length)return pd(e[n],0);var r=e[e.length-1],o=hi(r)?Ml(r).length:nu(r).length;return pd(r,o)},vd=wt.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),bd=function(t){return t.fold((function(t){return t}),(function(t,n,e){return t.translate(-n,-e)}))},yd=function(t){return t.fold((function(t){return t}),(function(t,n,e){return t}))},wd=function(t){return $(t,(function(t,n){return t.translate(n.left(),n.top())}),bc(0,0))},xd=function(t){var n=W(t,bd);return wd(n)},Cd=function(t){var n=W(t,yd);return wd(n)},Sd=vd.screen,kd=vd.absolute,Od=function(t,n,e){var r=Ji(e.root).dom(),o=function(n){var e=Ki(n),r=Ki(t.element());return eo(e,r)};return x.from(r.frameElement).map($e.fromDom).filter(o).map(xc)},Td=function(t,n,e){var r=Ki(t.element()),o=Dc(r),i=Od(t,n,e).getOr(o);return kd(i,o.left(),o.top())},Ed=function(t,n,e,r){var o=t,i=n,u=e,a=r;t<0&&(o=0,u=e+t),n<0&&(i=0,a=r+n);var c=Sd(bc(o,i));return x.some(Fc(c,u,a))},Dd=function(t,n,e,r,o){return t.map((function(t){var i=[n,t.point()],u=Uf(r,(function(){return Cd(i)}),(function(){return Cd(i)}),(function(){return xd(i)})),a=Lc(u.left(),u.top(),t.width(),t.height()),c=function(){return e.showAbove?[Ks,$s,Xs,Ys,Js,Qs]:[Xs,Ys,Ks,$s,Qs,Qs]},s=function(){return e.showAbove?[$s,Ks,Ys,Xs,Js,Qs]:[Ys,Xs,$s,Ks,Qs,Js]},f=$f(o,e,c(),s());return qf({anchorBox:a,bubble:e.bubble.getOr(Pf()),overrides:e.overrides,layouts:f,placer:x.none()})}))},Ad={capRect:Ed,calcNewAnchor:Dd},_d=ji("element","offset"),Rd=function(t,n){return hi(t)?_d(t,n):hd(t,n)},Bd=function(t,n){var e=n.getSelection.getOrThunk((function(){return function(){return md(t)}}));return e().map((function(t){var n=Rd(t.start(),t.soffset()),e=Rd(t.finish(),t.foffset());return yl.range(n.element(),n.offset(),e.element(),e.offset())}))},Id=function(t,n,e){var r=Ji(n.root).dom(),o=Td(t,e,n),i=Bd(r,n).bind((function(t){var n=gd(r,yl.exactFromRange(t)).orThunk((function(){var n=$e.fromText(nl());return iu(t.start(),n),gd(r,yl.exact(n,0,n,1)).map((function(t){return mu(n),t}))}));return n.bind((function(t){return Ad.capRect(t.left(),t.top(),t.width(),t.height())}))})),u=Bd(r,n).bind((function(t){return pi(t.start())?x.some(t.start()):Qi(t.start())})),a=u.getOr(t.element());return Ad.calcNewAnchor(i,o,n,e,a)},Pd=[Oe("getSelection"),ge("root"),Oe("bubble"),Kf(),Ie("overrides",{}),Ie("showAbove",!1),Ss("placement",Id)],Nd=function(t,n,e){var r=Td(t,e,n);return n.node.bind((function(o){var i=o.dom().getBoundingClientRect(),u=Ad.capRect(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element());return Ad.calcNewAnchor(u,r,n,e,a)}))},Md=[ge("node"),ge("root"),Oe("bubble"),Kf(),Ie("overrides",{}),Ie("showAbove",!1),Ss("placement",Nd)],Fd=function(t){return t.x()+t.width()},Ld=function(t,n){return t.x()-n.width()},Hd=function(t,n){return t.y()-n.height()+t.height()},zd=function(t){return t.y()},Vd=function(t,n,e){return Ts(Fd(t),zd(t),e.southeast(),Rs(),"link-layout-se")},jd=function(t,n,e){return Ts(Ld(t,n),zd(t),e.southwest(),Bs(),"link-layout-sw")},Ud=function(t,n,e){return Ts(Fd(t),Hd(t,n),e.northeast(),Is(),"link-layout-ne")},Wd=function(t,n,e){return Ts(Ld(t,n),Hd(t,n),e.northwest(),Ps(),"link-layout-nw")},Gd=function(){return[Vd,jd,Ud,Wd]},qd=function(){return[jd,Vd,Wd,Ud]},Xd=function(t,n,e){var r=zf(e,n.item.element()),o=$f(t.element(),n,Gd(),qd());return x.some(qf({anchorBox:r,bubble:Pf(),overrides:n.overrides,layouts:o,placer:x.none()}))},Yd=[ge("item"),Kf(),Ie("overrides",{}),Ss("placement",Xd)],Kd=oe("anchor",{selection:Pd,node:Md,hotspot:Qf,submenu:Yd,makeshift:tl}),$d=ji("anchorBox","origin"),Jd=function(t,n){return $d(t,n)},Qd=function(t,n,e,r){var o=t+n;return o>r?e:o<e?r:o},Zd=function(t,n,e){return t<=n?n:t>=e?e:t},tm=wt.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),nm=function(t,n,e,r,o){var i=o.x(),u=o.y(),a=o.width(),c=o.height(),s=t>=i,f=n>=u,l=s&&f,d=t+e<=i+a,m=n+r<=u+c,g=d&&m,p=Math.abs(Math.min(e,s?i+a-t:i-(t+e))),h=Math.abs(Math.min(r,f?u+c-n:u-(n+r))),v=Zd(t,o.x(),o.right()),b=Zd(n,o.y(),o.bottom());return{originInBounds:l,sizeInBounds:g,limitX:v,limitY:b,deltaW:p,deltaH:h}},em=function(t,n,e,r){var o=t.x(),u=t.y(),a=t.bubble().offset().left(),c=t.bubble().offset().top(),s=r.y(),f=r.bottom(),l=r.x(),d=r.right(),m=o+a,g=u+c,p=nm(m,g,n,e,r),h=p.originInBounds,v=p.sizeInBounds,b=p.limitX,y=p.limitY,w=p.deltaW,x=p.deltaH,C=i(y+x-s),S=i(f-y),k=As(t.direction(),S,S,C),O=i(b+w-l),T=i(d-b),E=_s(t.direction(),T,T,O),D=Nf({x:b,y:y,width:w,height:x,maxHeight:k,maxWidth:E,direction:t.direction(),classes:{on:t.bubble().classesOn(),off:t.bubble().classesOff()},label:t.label(),candidateYforTest:g});return h&&v?tm.fit(D):tm.nofit(D,w,x)},rm=function(t,n,e,r,o){var i=e.width(),c=e.height(),s=function(t,u,a,s){var f=t(n,e,r),l=em(f,i,c,o);return l.fold(tm.fit,(function(t,n,e){var r=e>s||n>a;return r?tm.nofit(t,n,e):tm.nofit(u,a,s)}))},f=$(t,(function(t,n){var e=a(s,n);return t.fold(tm.fit,e)}),tm.nofit(Nf({x:n.x(),y:n.y(),width:e.width(),height:e.height(),maxHeight:e.height(),maxWidth:e.width(),direction:Rs(),classes:{on:[],off:[]},label:"none",candidateYforTest:n.y()}),-1,-1));return f.fold(u,u)},om=function(t){return{width:i(Tc(t)),height:i(pc(t))}},im=function(t,n,e,r){Xa(n,"max-height"),Xa(n,"max-width");var o=om(n);return rm(r.preference(),t,o,e,r.bounds())},um=function(t,n){var e=n.classes();Ma(t,e.off),Na(t,e.on)},am=function(t,n,e){var r=e.maxHeightFunction();r(t,n.maxHeight())},cm=function(t,n,e){var r=e.maxWidthFunction();r(t,n.maxWidth())},sm=function(t,n,e){var r=function(t){return t+"px"},o=Hf(e.origin(),n);ja(t,{position:x.some(o.position()),left:o.left().map(r),top:o.top().map(r),right:o.right().map(r),bottom:o.bottom().map(r)})},fm=function(t,n){hc(t,Math.floor(n))},lm=i((function(t,n){fm(t,n),Va(t,{"overflow-x":"hidden","overflow-y":"auto"})})),dm=i((function(t,n){fm(t,n)})),mm=Yi(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),gm=function(t,n,e){return void 0===t[n]?e:t[n]},pm=function(t,n,r,o,i,u){var a=gm(u,"maxHeightFunction",lm()),c=gm(u,"maxWidthFunction",e),s=t.anchorBox(),f=t.origin(),l=mm({bounds:Vf(f,i),origin:f,preference:o,maxHeightFunction:a,maxWidthFunction:c});hm(s,n,r,l)},hm=function(t,n,e,r){var o=im(t,n,e,r);sm(n,o,r),um(n,o),am(n,o,r),cm(n,o,r)},vm=function(){var t=n.document.documentElement;return Gf(0,0,t.clientWidth,t.clientHeight)},bm=function(t){var n=xc(t.element()),e=t.element().dom().getBoundingClientRect();return Wf(n.left(),n.top(),e.width,e.height)},ym=function(t,n,e,r,o){var i=Jd(e.anchorBox,n);pm(i,o.element(),e.bubble,e.layouts,r,e.overrides)},wm=function(t,n,e,r,o){xm(t,n,e,r,o,x.none())},xm=function(t,n,e,r,o,i){var u=i.map(zc);return Cm(t,n,e,r,o,u)},Cm=function(t,n,e,r,o,u){var a=ne("positioning anchor.info",Kd,r);Rf((function(){za(o.element(),"position","fixed");var e=Ga(o.element(),"visibility");za(o.element(),"visibility","hidden");var r=n.useFixed()?vm():bm(t),c=a.placement,s=u.map(i).or(n.getBounds);c(t,a,r).each((function(n){var e=n.placer.getOr(ym);e(t,r,n,s,o)})),e.fold((function(){Xa(o.element(),"visibility")}),(function(t){za(o.element(),"visibility",t)})),Ga(o.element(),"left").isNone()&&Ga(o.element(),"top").isNone()&&Ga(o.element(),"right").isNone()&&Ga(o.element(),"bottom").isNone()&&Ga(o.element(),"position").is("fixed")&&Xa(o.element(),"position")}),o.element())},Sm=function(t,n,e){return n.useFixed()?"fixed":"absolute"},km=Object.freeze({position:wm,positionWithin:xm,positionWithinBounds:Cm,getMode:Sm}),Om=[Ie("useFixed",f),Oe("getBounds")],Tm=pf({fields:Om,name:"positioning",active:Of,apis:km}),Em=function(t){ii(t,$o());var n=t.components();G(n,Em)},Dm=function(t){var n=t.components();G(n,Dm),ii(t,Ko())},Am=function(t,n){cu(t.element(),n.element())},_m=function(t){G(t.components(),(function(t){return mu(t.element())})),du(t.element()),t.syncComponents()},Rm=function(t,n){var e=t.components();_m(t);var r=rt(e,n);G(r,(function(n){Em(n),t.getSystem().removeFromWorld(n)})),G(n,(function(n){n.getSystem().isConnected()?Am(t,n):(t.getSystem().addToWorld(n),Am(t,n),vi(t.element())&&Dm(n)),t.syncComponents()}))},Bm=function(t,n){Im(t,n,cu)},Im=function(t,n,e){t.getSystem().addToWorld(n),e(t.element(),n.element()),vi(t.element())&&Dm(n),t.syncComponents()},Pm=function(t){Em(t),mu(t.element()),t.getSystem().removeFromWorld(t)},Nm=function(t){var n=Qi(t.element()).bind((function(n){return t.getSystem().getByDom(n).toOption()}));Pm(t),n.each((function(t){t.syncComponents()}))},Mm=function(t){var n=t.components();G(n,Pm),du(t.element()),t.syncComponents()},Fm=function(t,n){Hm(t,n,cu)},Lm=function(t,n){Hm(t,n,uu)},Hm=function(t,n,e){e(t,n.element());var r=nu(n.element());G(r,(function(t){n.getByDom(t).each(Dm)}))},zm=function(t){var n=nu(t.element());G(n,(function(n){t.getByDom(n).each(Em)})),mu(t.element())},Vm=function(t,n,e,r){e.get().each((function(n){Mm(t)}));var o=n.getAttachPoint(t);Bm(o,t);var i=t.getSystem().build(r);return Bm(t,i),e.set(i),i},jm=function(t,n,e,r){var o=Vm(t,n,e,r);return n.onOpen(t,o),o},Um=function(t,n,e,r){return e.get().map((function(){return Vm(t,n,e,r)}))},Wm=function(t,n,e,r,o){Jm(t,n),jm(t,n,e,r),o(),Zm(t,n)},Gm=function(t,n,e){e.get().each((function(r){Mm(t),Nm(t),n.onClose(t,r),e.clear()}))},qm=function(t,n,e){return e.isOpen()},Xm=function(t,n,e,r){return qm(t,n,e)&&e.get().exists((function(e){return n.isPartOf(t,e,r)}))},Ym=function(t,n,e){return e.get()},Km=function(t,n,e,r){Ga(t.element(),n).fold((function(){Su(t.element(),e)}),(function(n){yu(t.element(),e,n)})),za(t.element(),n,r)},$m=function(t,n,e){if(Cu(t.element(),e)){var r=xu(t.element(),e);za(t.element(),n,r)}else Xa(t.element(),n)},Jm=function(t,n,e){var r=n.getAttachPoint(t);za(t.element(),"position",Tm.getMode(r)),Km(t,"visibility",n.cloakVisibilityAttr,"hidden")},Qm=function(t){return V(["top","left","right","bottom"],(function(n){return Ga(t,n).isSome()}))},Zm=function(t,n,e){Qm(t.element())||Xa(t.element(),"position"),$m(t,"visibility",n.cloakVisibilityAttr)},tg=Object.freeze({cloak:Jm,decloak:Zm,open:jm,openWhileCloaked:Wm,close:Gm,isOpen:qm,isPartOf:Xm,getState:Ym,setContent:Um}),ng=function(t,n){return ki([Di(jo(),(function(e,r){Gm(e,t,n)}))])},eg=Object.freeze({events:ng}),rg=[ys("onOpen"),ys("onClose"),ge("isPartOf"),ge("getAttachPoint"),Ie("cloakVisibilityAttr","data-precloak-visibility")],og=function(){var t=We(x.none()),n=i("not-implemented"),e=function(){return t.get().isSome()},r=function(n){t.set(x.some(n))},o=function(n){return t.get()},u=function(){t.set(x.none())};return Zu({readState:n,isOpen:e,clear:u,set:r,get:o})},ig=Object.freeze({init:og}),ug=pf({fields:rg,name:"sandboxing",active:eg,apis:tg,state:ig}),ag=i("dismiss.popups"),cg=i("reposition.popups"),sg=i("mouse.released"),fg=Mn([Ie("isExtraPart",i(!1)),Re("fireEventInstead",[Ie("event",Jo())])]),lg=function(t){var n,e=ne("Dismissal",fg,t);return n={},n[ag()]={schema:Mn([ge("target")]),onReceive:function(t,n){if(ug.isOpen(t)){var r=ug.isPartOf(t,n.target)||e.isExtraPart(t,n.target);r||e.fireEventInstead.fold((function(){return ug.close(t)}),(function(n){return ii(t,n.event)}))}}},n},dg=Mn([Ie("isExtraPart",i(!1)),Re("fireEventInstead",[Ie("event",Qo())]),we("doReposition")]),mg=function(t){var n,e=ne("Reposition",dg,t);return n={},n[cg()]={onReceive:function(t){ug.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return ii(t,n.event)}))}},n},gg=function(t,n,e){n.store.manager.onLoad(t,n,e)},pg=function(t,n,e){n.store.manager.onUnload(t,n,e)},hg=function(t,n,e,r){n.store.manager.setValue(t,n,e,r)},vg=function(t,n,e){return n.store.manager.getValue(t,n,e)},bg=function(t,n,e){return e},yg=Object.freeze({onLoad:gg,onUnload:pg,setValue:hg,getValue:vg,getState:bg}),wg=function(t,n){var e=t.resetOnDom?[Li((function(e,r){gg(e,t,n)})),Hi((function(e,r){pg(e,t,n)}))]:[af(t,n,gg)];return ki(e)},xg=Object.freeze({events:wg}),Cg=function(){var t=We(null),n=function(){return{mode:"memory",value:t.get()}},e=function(){return null===t.get()},r=function(){t.set(null)};return Zu({set:t.set,get:t.get,isNotSet:e,clear:r,readState:n})},Sg=function(){var t=function(){};return Zu({readState:t})},kg=function(){var t=We({}),n=We({}),e=function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},r=function(){t.set({}),n.set({})},o=function(e){return qt(t.get(),e).orThunk((function(){return qt(n.get(),e)}))},i=function(e){var r=t.get(),o=n.get(),i={},u={};G(e,(function(t){i[t.value]=t,qt(t,"meta").each((function(n){qt(n,"text").each((function(n){u[n]=t}))}))})),t.set(m(m({},r),i)),n.set(m(m({},o),u))};return Zu({readState:e,lookup:o,update:i,clear:r})},Og=function(t){return t.store.manager.state(t)},Tg=Object.freeze({memory:Cg,dataset:kg,manual:Sg,init:Og}),Eg=function(t,n,e,r){var o=n.store;e.update([r]),o.setValue(t,r),n.onSetValue(t,r)},Dg=function(t,n,e){var r=n.store,o=r.getDataKey(t);return e.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(t){return t}))},Ag=function(t,n,e){var r=n.store;r.initialValue.each((function(r){Eg(t,n,e,r)}))},_g=function(t,n,e){e.clear()},Rg=[Oe("initialValue"),ge("getFallbackEntry"),ge("getDataKey"),ge("setValue"),Ss("manager",{setValue:Eg,getValue:Dg,onLoad:Ag,onUnload:_g,state:kg})],Bg=function(t,n,e){return n.store.getValue(t)},Ig=function(t,n,e,r){n.store.setValue(t,r),n.onSetValue(t,r)},Pg=function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},Ng=[ge("getValue"),Ie("setValue",e),Oe("initialValue"),Ss("manager",{setValue:Ig,getValue:Bg,onLoad:Pg,onUnload:e,state:Qu.init})],Mg=function(t,n,e,r){e.set(r),n.onSetValue(t,r)},Fg=function(t,n,e){return e.get()},Lg=function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},Hg=function(t,n,e){e.clear()},zg=[Oe("initialValue"),Ss("manager",{setValue:Mg,getValue:Fg,onLoad:Lg,onUnload:Hg,state:Cg})],Vg=[Pe("store",{mode:"memory"},oe("mode",{memory:zg,manual:Ng,dataset:Rg})),ys("onSetValue"),Ie("resetOnDom",!1)],jg=pf({fields:Vg,name:"representing",active:xg,apis:yg,extra:{setValueFrom:function(t,n){var e=jg.getValue(n);jg.setValue(t,e)}},state:Tg}),Ug=function(t,n){return je(t,{},W(n,(function(n){return xe(n.name(),"Cannot configure "+n.name()+" for "+t)})).concat([Ue("dump",u)]))},Wg=function(t){return t.dump},Gg=function(t,n){return m(m({},t.dump),mf(n))},qg={field:Ug,augment:Gg,get:Wg},Xg="placeholder",Yg=wt.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Kg=function(t,n,e,r){return t.exists((function(t){return t!==e.owner}))?Yg.single(!0,i(e)):qt(r,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+st(r)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))},$g=function(t,n,e,r){return e.uiType===Xg?Kg(t,n,e,r):Yg.single(!1,i(e))},Jg=function(t,n,e,r){var o=$g(t,n,e,r);return o.fold((function(o,i){var u=i(n,e.config,e.validated),a=qt(u,"components").getOr([]),c=tt(a,(function(e){return Jg(t,n,e,r)}));return[m(m({},u),{components:c})]}),(function(t,r){var o=r(n,e.config,e.validated),i=e.validated.preprocess.getOr(u);return i(o)}))},Qg=function(t,n,e,r){return tt(e,(function(e){return Jg(t,n,e,r)}))},Zg=function(t,n){var e=!1,r=function(){return e},o=function(){if(!0===e)throw new Error("Trying to use the same placeholder more than once: "+t);return e=!0,n},u=function(){return n.fold((function(t,n){return t}),(function(t,n){return t}))};return{name:i(t),required:u,used:r,replace:o}},tp=function(t,n,e,r){var o=dt(r,(function(t,n){return Zg(n,t)})),i=Qg(t,n,e,o);return lt(o,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i},np=Yg.single,ep=Yg.multiple,rp=i(Xg),op=wt.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ip=Ie("factory",{sketch:u}),up=Ie("schema",[]),ap=ge("name"),cp=Un("pname","pname",It((function(t){return"<alloy."+Bu(t.name)+">"})),ie()),sp=Ue("schema",(function(){return[Oe("preprocess")]})),fp=Ie("defaults",i({})),lp=Ie("overrides",i({})),dp=Fn([ip,up,ap,cp,fp,lp]),mp=Fn([ip,up,ap,fp,lp]),gp=Fn([ip,up,ap,cp,fp,lp]),pp=Fn([ip,sp,ap,ge("unit"),cp,fp,lp]),hp=function(t){return t.fold(x.some,x.none,x.some,x.some)},vp=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},bp=function(t){return t.fold(u,u,u,u)},yp=function(t,n){return function(e){var r=ne("Converting part type",n,e);return t(r)}},wp=yp(op.required,dp),xp=yp(op.external,mp),Cp=yp(op.optional,gp),Sp=yp(op.group,pp),kp=i("entirety"),Op=Object.freeze({required:wp,external:xp,optional:Cp,group:Sp,asNamedPart:hp,name:vp,asCommon:bp,original:kp}),Tp=function(t,n,e,r){return Ot(n.defaults(t,e,r),e,{uid:t.partUids[n.name]},n.overrides(t,e,r))},Ep=function(t,n,e){var r={},o={};return G(e,(function(t){t.fold((function(t){r[t.pname]=np(!0,(function(n,e,r){return t.factory.sketch(Tp(n,t,e,r))}))}),(function(t){var e=n.parts[t.name];o[t.name]=i(t.factory.sketch(Tp(n,t,e[kp()]),e))}),(function(t){r[t.pname]=np(!1,(function(n,e,r){return t.factory.sketch(Tp(n,t,e,r))}))}),(function(t){r[t.pname]=ep(!0,(function(n,e,r){var o=n[t.name];return W(o,(function(e){return t.factory.sketch(Ot(t.defaults(n,e,r),e,t.overrides(n,e)))}))}))}))})),{internals:i(r),externals:i(o)}},Dp=function(t,n){var e={};return G(n,(function(n){hp(n).each((function(n){var r=Ap(t,n.pname);e[n.name]=function(e){var o=ne("Part: "+n.name+" in "+t,Fn(n.schema),e);return m(m({},r),{config:e,validated:o})}}))})),e},Ap=function(t,n){return{uiType:rp(),owner:t,name:n}},_p=function(t,n,e){return{uiType:rp(),owner:t,name:n,config:e,validated:{}}},Rp=function(t){return tt(t,(function(t){return t.fold(x.none,x.some,x.none,x.none).map((function(t){return Ce(t.name,t.schema.concat([ks(kp())]))})).toArray()}))},Bp=function(t){return W(t,vp)},Ip=function(t,n,e){return Ep(t,n,e)},Pp=function(t,n,e){return tp(x.some(t),n,n.components,e)},Np=function(t,n,e){var r=n.partUids[e];return t.getSystem().getByUid(r).toOption()},Mp=function(t,n,e){return Np(t,n,e).getOrDie("Could not find part: "+e)},Fp=function(t,n,e){var r={},o=n.partUids,u=t.getSystem();return G(e,(function(t){r[t]=i(u.getByUid(o[t]))})),r},Lp=function(t,n){var e=t.getSystem();return dt(n.partUids,(function(t,n){return i(e.getByUid(t))}))},Hp=function(t){return st(t.partUids)},zp=function(t,n,e){var r={},o=n.partUids,u=t.getSystem();return G(e,(function(t){r[t]=i(u.getByUid(o[t]).getOrDie())})),r},Vp=function(t,n){var e=Bp(n);return Yt(W(e,(function(n){return{key:n,value:t+"-"+n}})))},jp=function(t){return Un("partUids","partUids",Pt((function(n){return Vp(n.uid,t)})),ie())},Up=Object.freeze({generate:Dp,generateOne:_p,schemas:Rp,names:Bp,substitutes:Ip,components:Pp,defaultUids:Vp,defaultUidsSchema:jp,getAllParts:Lp,getAllPartNames:Hp,getPart:Np,getPartOrDie:Mp,getParts:Fp,getPartsOrDie:zp}),Wp=function(t,n){var e=t.length>0?[Ce("parts",t)]:[];return e.concat([ge("uid"),Ie("dom",{}),Ie("components",[]),ks("originalSpec"),Ie("debug.sketcher",{})]).concat(n)},Gp=function(t,n,e,r,o){var i=Wp(r,o);return ne(t+" [SpecSchema]",Mn(i.concat(n)),e)},qp=function(t,n,e,r){var o=Yp(r),i=Gp(t,n,o,[],[]);return e(i,o)},Xp=function(t,n,e,r,o){var i=Yp(o),u=Rp(e),a=jp(e),c=Gp(t,n,i,u,[a]),s=Ip(t,c,e),f=Pp(t,c,s.internals());return r(c,f,i,s.externals())},Yp=function(t){return t.hasOwnProperty("uid")?t:m(m({},t),{uid:zu("uid")})};function Kp(t){return void 0!==t.uid}var $p,Jp=Mn([ge("name"),ge("factory"),ge("configFields"),Ie("apis",{}),Ie("extraApis",{})]),Qp=Mn([ge("name"),ge("factory"),ge("configFields"),ge("partFields"),Ie("apis",{}),Ie("extraApis",{})]),Zp=function(t){var n=ne("Sketcher for "+t.name,Jp,t),e=function(t){return qp(n.name,n.configFields,n.factory,t)},r=dt(n.apis,Ju),o=dt(n.extraApis,(function(t,n){return qu(t,n)}));return m(m({name:i(n.name),partFields:i([]),configFields:i(n.configFields),sketch:e},r),o)},th=function(t){var n=ne("Sketcher for "+t.name,Qp,t),e=function(t){return Xp(n.name,n.configFields,n.partFields,n.factory,t)},r=Dp(n.name,n.partFields),o=dt(n.apis,Ju),u=dt(n.extraApis,(function(t,n){return qu(t,n)}));return m(m({name:i(n.name),partFields:i(n.partFields),configFields:i(n.configFields),sketch:e,parts:i(r)},o),u)},nh=function(t){return"input"===di(t)&&"radio"!==xu(t,"type")||"textarea"===di(t)},eh=function(t,n,e){return n.find(t)},rh=Object.freeze({getCurrent:eh}),oh=[ge("find")],ih=pf({fields:oh,name:"composing",apis:rh}),uh=function(t,n,e,r){var o=cd(t.element(),"."+n.highlightClass);G(o,(function(e){V(r,(function(t){return t.element()===e}))||(Ia(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),ii(e,oi())})))}))},ah=function(t,n,e){return uh(t,n,e,[])},ch=function(t,n,e,r){gh(t,n,e,r)&&(Ia(r.element(),n.highlightClass),n.onDehighlight(t,r),ii(r,oi()))},sh=function(t,n,e,r){uh(t,n,e,[r]),gh(t,n,e,r)||(Ra(r.element(),n.highlightClass),n.onHighlight(t,r),ii(r,ri()))},fh=function(t,n,e){vh(t,n).each((function(r){sh(t,n,e,r)}))},lh=function(t,n,e){bh(t,n).each((function(r){sh(t,n,e,r)}))},dh=function(t,n,e,r){hh(t,n,e,r).fold((function(t){throw new Error(t)}),(function(r){sh(t,n,e,r)}))},mh=function(t,n,e,r){var o=Ch(t,n),i=J(o,r);i.each((function(r){sh(t,n,e,r)}))},gh=function(t,n,e,r){return Pa(r.element(),n.highlightClass)},ph=function(t,n,e){return Gc(t.element(),"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOption()}))},hh=function(t,n,e,r){var o=cd(t.element(),"."+n.itemClass);return x.from(o[r]).fold((function(){return O.error("No element found with index "+r)}),t.getSystem().getByDom)},vh=function(t,n,e){return Gc(t.element(),"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOption()}))},bh=function(t,n,e){var r=cd(t.element(),"."+n.itemClass),o=r.length>0?x.some(r[r.length-1]):x.none();return o.bind((function(n){return t.getSystem().getByDom(n).toOption()}))},yh=function(t,n,e,r){var o=cd(t.element(),"."+n.itemClass),i=Q(o,(function(t){return Pa(t,n.highlightClass)}));return i.bind((function(n){var e=Qd(n,r,0,o.length-1);return t.getSystem().getByDom(o[e]).toOption()}))},wh=function(t,n,e){return yh(t,n,e,-1)},xh=function(t,n,e){return yh(t,n,e,1)},Ch=function(t,n,e){var r=cd(t.element(),"."+n.itemClass);return Jc(W(r,(function(n){return t.getSystem().getByDom(n).toOption()})))},Sh=Object.freeze({dehighlightAll:ah,dehighlight:ch,highlight:sh,highlightFirst:fh,highlightLast:lh,highlightAt:dh,highlightBy:mh,isHighlighted:gh,getHighlighted:ph,getFirst:vh,getLast:bh,getPrevious:wh,getNext:xh,getCandidates:Ch}),kh=[ge("highlightClass"),ge("itemClass"),ys("onHighlight"),ys("onDehighlight")],Oh=pf({fields:kh,name:"highlighting",apis:Sh}),Th=function(){return[8]},Eh=function(){return[9]},Dh=function(){return[13]},Ah=function(){return[27]},_h=function(){return[32]},Rh=function(){return[37]},Bh=function(){return[38]},Ih=function(){return[39]},Ph=function(){return[40]},Nh=function(t,n,e){var r=et(t.slice(0,n)),o=et(t.slice(n+1));return J(r.concat(o),e)},Mh=function(t,n,e){var r=et(t.slice(0,n));return J(r,e)},Fh=function(t,n,e){var r=t.slice(0,n),o=t.slice(n+1);return J(o.concat(r),e)},Lh=function(t,n,e){var r=t.slice(n+1);return J(r,e)},Hh=function(t){return function(n){var e=n.raw();return z(t,e.which)}},zh=function(t){return function(n){return nt(t,(function(t){return t(n)}))}},Vh=function(t){var n=t.raw();return!0===n.shiftKey},jh=function(t){var n=t.raw();return!0===n.ctrlKey},Uh=c(Vh),Wh=function(t,n){return{matches:t,classification:n}},Gh=function(t,n){var e=J(t,(function(t){return t.matches(n)}));return e.map((function(t){return t.classification}))},qh=function(t,n,e){var r=n.exists((function(t){return e.exists((function(n){return eo(n,t)}))}));r||ui(t,Zo(),{prevFocus:n,newFocus:e})},Xh=function(){var t=function(t){return _f(t.element())},n=function(n,e){var r=t(n);n.getSystem().triggerFocus(e,n.element());var o=t(n);qh(n,r,o)};return{get:t,set:n}},Yh=function(){var t=function(t){return Oh.getHighlighted(t).map((function(t){return t.element()}))},n=function(n,r){var o=t(n);n.getSystem().getByDom(r).fold(e,(function(t){Oh.highlight(n,t)}));var i=t(n);qh(n,o,i)};return{get:t,set:n}};(function(t){t["OnFocusMode"]="onFocus",t["OnEnterOrSpaceMode"]="onEnterOrSpace",t["OnApiMode"]="onApi"})($p||($p={}));var Kh=function(t,n,e,r,o){var i=function(){return t.concat([Ie("focusManager",Xh()),Pe("focusInside","onFocus",$n((function(t){return z(["onFocus","onEnterOrSpace","onApi"],t)?O.value(t):O.error("Invalid value for focusInside")}))),Ss("handler",c),Ss("state",n),Ss("sendFocusIn",o)])},u=function(t,n,e,r,o){var i=e(t,n,r,o);return Gh(i,n.event()).bind((function(e){return e(t,n,r,o)}))},a=function(t,n){var i=t.focusInside!==$p.OnFocusMode?x.none():o(t).map((function(e){return Di(Io(),(function(r,o){e(r,t,n),o.stop()}))})),a=function(e,r){var i=Hh(_h().concat(Dh()))(r.event());t.focusInside===$p.OnEnterOrSpaceMode&&i&&ao(e,r)&&o(t).each((function(o){o(e,t,n),r.stop()}))};return ki(i.toArray().concat([Di(Oo(),(function(r,o){u(r,o,e,t,n).fold((function(){a(r,o)}),(function(t){o.stop()}))})),Di(To(),(function(e,o){u(e,o,r,t,n).each((function(t){o.stop()}))}))]))},c={schema:i,processKey:u,toEvents:a};return c},$h=function(t){var n=[Oe("onEscape"),Oe("onEnter"),Ie("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ie("firstTabstop",0),Ie("useTabstopAt",i(!0)),Oe("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return qc(n,t)})).getOr(n);return gc(e)>0},r=function(t,n){var r=cd(t.element(),n.selector),o=Y(r,(function(t){return e(n,t)}));return x.from(o[n.firstTabstop])},o=function(t,n){return n.focusManager.get(t).bind((function(t){return qc(t,n.selector)}))},u=function(t,n){return e(t,n)&&t.useTabstopAt(n)},c=function(t,n){r(t,n).each((function(e){n.focusManager.set(t,e)}))},s=function(t,n,e,r,o){return o(n,e,(function(t){return u(r,t)})).fold((function(){return r.cyclic?x.some(!0):x.none()}),(function(n){return r.focusManager.set(t,n),x.some(!0)}))},f=function(t,n,e,r){var i=cd(t.element(),e.selector);return o(t,e).bind((function(n){var o=Q(i,a(eo,n));return o.bind((function(n){return s(t,i,n,e,r)}))}))},l=function(t,n,e,r){var o=e.cyclic?Nh:Mh;return f(t,n,e,o)},d=function(t,n,e,r){var o=e.cyclic?Fh:Lh;return f(t,n,e,o)},m=function(t,n,e,r){return e.onEnter.bind((function(e){return e(t,n)}))},g=function(t,n,e,r){return e.onEscape.bind((function(e){return e(t,n)}))},p=i([Wh(zh([Vh,Hh(Eh())]),l),Wh(Hh(Eh()),d),Wh(Hh(Ah()),g),Wh(zh([Uh,Hh(Dh())]),m)]),h=i([]);return Kh(n,Qu.init,p,h,(function(){return x.some(c)}))},Jh=$h(Ue("cyclic",i(!1))),Qh=$h(Ue("cyclic",i(!0))),Zh=function(t,n,e){return ci(t,e,Fo()),x.some(!0)},tv=function(t,n,e){return nh(e)&&Hh(_h())(n.event())?x.none():Zh(t,n,e)},nv=function(t,n){return x.some(!0)},ev=[Ie("execute",tv),Ie("useSpace",!1),Ie("useEnter",!0),Ie("useControlEnter",!1),Ie("useDown",!1)],rv=function(t,n,e){return e.execute(t,n,t.element())},ov=function(t,n,e,r){var o=e.useSpace&&!nh(t.element())?_h():[],i=e.useEnter?Dh():[],u=e.useDown?Ph():[],a=o.concat(i).concat(u);return[Wh(Hh(a),rv)].concat(e.useControlEnter?[Wh(zh([jh,Hh(Dh())]),rv)]:[])},iv=function(t,n,e,r){return e.useSpace&&!nh(t.element())?[Wh(Hh(_h()),nv)]:[]},uv=Kh(ev,Qu.init,ov,iv,(function(){return x.none()})),av=function(t){var n=We(x.none()),e=function(t,e){n.set(x.some({numRows:i(t),numColumns:i(e)}))},r=function(){return n.get().map((function(t){return t.numRows()}))},o=function(){return n.get().map((function(t){return t.numColumns()}))};return Zu({readState:function(){return n.get().map((function(t){return{numRows:t.numRows(),numColumns:t.numColumns()}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:e,getNumRows:r,getNumColumns:o})},cv=function(t){return t.state(t)},sv=Object.freeze({flatgrid:av,init:cv}),fv=function(t){return function(n,e,r,o){var i=t(n.element());return gv(i,n,e,r,o)}},lv=function(t,n){var e=Xf(t,n);return fv(e)},dv=function(t,n){var e=Xf(n,t);return fv(e)},mv=function(t){return function(n,e,r,o){return gv(t,n,e,r,o)}},gv=function(t,n,e,r,o){var i=r.focusManager.get(n).bind((function(e){return t(n.element(),e,r,o)}));return i.map((function(t){return r.focusManager.set(n,t),!0}))},pv=mv,hv=mv,vv=mv,bv=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},yv=function(t){var n=t.dom();return!bv(n)},wv=Yi(["index","candidates"],[]),xv=function(t,n){return Q(t,n).map((function(n){return wv({index:n,candidates:t})}))},Cv=function(t,n,e){var r=a(eo,n),o=cd(t,e),i=Y(o,yv);return xv(i,r)},Sv=function(t,n){return Q(t,(function(t){return eo(n,t)}))},kv=function(t,n,e,r){var o=Math.floor(n/e),i=n%e;return r(o,i).bind((function(n){var r=n.row()*e+n.column();return r>=0&&r<t.length?x.some(t[r]):x.none()}))},Ov=function(t,n,e,r,o){return kv(t,n,r,(function(n,u){var a=n===e-1,c=a?t.length-n*r:r,s=Qd(u,o,0,c-1);return x.some({row:i(n),column:i(s)})}))},Tv=function(t,n,e,r,o){return kv(t,n,r,(function(n,u){var a=Qd(n,o,0,e-1),c=a===e-1,s=c?t.length-a*r:r,f=Zd(u,0,s-1);return x.some({row:i(a),column:i(f)})}))},Ev=function(t,n,e,r){return Ov(t,n,e,r,1)},Dv=function(t,n,e,r){return Ov(t,n,e,r,-1)},Av=function(t,n,e,r){return Tv(t,n,e,r,-1)},_v=function(t,n,e,r){return Tv(t,n,e,r,1)},Rv=[ge("selector"),Ie("execute",tv),ws("onEscape"),Ie("captureTab",!1),Os()],Bv=function(t,n,e){Gc(t.element(),n.selector).each((function(e){n.focusManager.set(t,e)}))},Iv=function(t,n){return n.focusManager.get(t).bind((function(t){return qc(t,n.selector)}))},Pv=function(t,n,e,r){return Iv(t,e).bind((function(r){return e.execute(t,n,r)}))},Nv=function(t){return function(n,e,r,o){return Cv(n,e,r.selector).bind((function(n){return t(n.candidates(),n.index(),o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}},Mv=function(t,n,e,r){return e.captureTab?x.some(!0):x.none()},Fv=function(t,n,e,r){return e.onEscape(t,n)},Lv=Nv(Dv),Hv=Nv(Ev),zv=Nv(Av),Vv=Nv(_v),jv=i([Wh(Hh(Rh()),lv(Lv,Hv)),Wh(Hh(Ih()),dv(Lv,Hv)),Wh(Hh(Bh()),pv(zv)),Wh(Hh(Ph()),hv(Vv)),Wh(zh([Vh,Hh(Eh())]),Mv),Wh(zh([Uh,Hh(Eh())]),Mv),Wh(Hh(Ah()),Fv),Wh(Hh(_h().concat(Dh())),Pv)]),Uv=i([Wh(Hh(_h()),nv)]),Wv=Kh(Rv,av,jv,Uv,(function(){return x.some(Bv)})),Gv=function(t,n,e,r){var o=function(t){return"button"===di(t)&&"disabled"===xu(t,"disabled")},i=function(t,n,e){var u=Qd(n,r,0,e.length-1);return u===t?x.none():o(e[u])?i(t,u,e):x.from(e[u])};return Cv(t,e,n).bind((function(t){var n=t.index(),e=t.candidates();return i(n,n,e)}))},qv=[ge("selector"),Ie("getInitial",x.none),Ie("execute",tv),ws("onEscape"),Ie("executeOnMove",!1),Ie("allowVertical",!0)],Xv=function(t,n){return n.focusManager.get(t).bind((function(t){return qc(t,n.selector)}))},Yv=function(t,n,e){return Xv(t,e).bind((function(r){return e.execute(t,n,r)}))},Kv=function(t,n){n.getInitial(t).orThunk((function(){return Gc(t.element(),n.selector)})).each((function(e){n.focusManager.set(t,e)}))},$v=function(t,n,e){return Gv(t,e.selector,n,-1)},Jv=function(t,n,e){return Gv(t,e.selector,n,1)},Qv=function(t){return function(n,e,r){return t(n,e,r).bind((function(){return r.executeOnMove?Yv(n,e,r):x.some(!0)}))}},Zv=function(t,n,e,r){return e.onEscape(t,n)},tb=function(t,n,e,r){var o=Rh().concat(e.allowVertical?Bh():[]),i=Ih().concat(e.allowVertical?Ph():[]);return[Wh(Hh(o),Qv(lv($v,Jv))),Wh(Hh(i),Qv(dv($v,Jv))),Wh(Hh(Dh()),Yv),Wh(Hh(_h()),Yv),Wh(Hh(Ah()),Zv)]},nb=i([Wh(Hh(_h()),nv)]),eb=Kh(qv,Qu.init,tb,nb,(function(){return x.some(Kv)})),rb=Yi(["rowIndex","columnIndex","cell"],[]),ob=function(t,n,e){return x.from(t[n]).bind((function(t){return x.from(t[e]).map((function(t){return rb({rowIndex:n,columnIndex:e,cell:t})}))}))},ib=function(t,n,e,r){var o=t[n],i=o.length,u=Qd(e,r,0,i-1);return ob(t,n,u)},ub=function(t,n,e,r){var o=Qd(e,r,0,t.length-1),i=t[o].length,u=Zd(n,0,i-1);return ob(t,o,u)},ab=function(t,n,e,r){var o=t[n],i=o.length,u=Zd(e+r,0,i-1);return ob(t,n,u)},cb=function(t,n,e,r){var o=Zd(e+r,0,t.length-1),i=t[o].length,u=Zd(n,0,i-1);return ob(t,o,u)},sb=function(t,n,e){return ib(t,n,e,1)},fb=function(t,n,e){return ib(t,n,e,-1)},lb=function(t,n,e){return ub(t,e,n,-1)},db=function(t,n,e){return ub(t,e,n,1)},mb=function(t,n,e){return ab(t,n,e,-1)},gb=function(t,n,e){return ab(t,n,e,1)},pb=function(t,n,e){return cb(t,e,n,-1)},hb=function(t,n,e){return cb(t,e,n,1)},vb=[Ce("selectors",[ge("row"),ge("cell")]),Ie("cycles",!0),Ie("previousSelector",x.none),Ie("execute",tv)],bb=function(t,n){var e=n.previousSelector(t).orThunk((function(){var e=n.selectors;return Gc(t.element(),e.cell)}));e.each((function(e){n.focusManager.set(t,e)}))},yb=function(t,n,e){return _f(t.element()).bind((function(r){return e.execute(t,n,r)}))},wb=function(t,n){return W(t,(function(t){return cd(t,n.selectors.cell)}))},xb=function(t,n){return function(e,r,o){var i=o.cycles?t:n;return qc(r,o.selectors.row).bind((function(t){var n=cd(t,o.selectors.cell);return Sv(n,r).bind((function(n){var r=cd(e,o.selectors.row);return Sv(r,t).bind((function(t){var e=wb(r,o);return i(e,t,n).map((function(t){return t.cell()}))}))}))}))}},Cb=xb(fb,mb),Sb=xb(sb,gb),kb=xb(lb,pb),Ob=xb(db,hb),Tb=i([Wh(Hh(Rh()),lv(Cb,Sb)),Wh(Hh(Ih()),dv(Cb,Sb)),Wh(Hh(Bh()),pv(kb)),Wh(Hh(Ph()),hv(Ob)),Wh(Hh(_h().concat(Dh())),yb)]),Eb=i([Wh(Hh(_h()),nv)]),Db=Kh(vb,Qu.init,Tb,Eb,(function(){return x.some(bb)})),Ab=[ge("selector"),Ie("execute",tv),Ie("moveOnTab",!1)],_b=function(t,n,e){return e.focusManager.get(t).bind((function(r){return e.execute(t,n,r)}))},Rb=function(t,n){Gc(t.element(),n.selector).each((function(e){n.focusManager.set(t,e)}))},Bb=function(t,n,e){return Gv(t,e.selector,n,-1)},Ib=function(t,n,e){return Gv(t,e.selector,n,1)},Pb=function(t,n,e){return e.moveOnTab?vv(Bb)(t,n,e):x.none()},Nb=function(t,n,e){return e.moveOnTab?vv(Ib)(t,n,e):x.none()},Mb=i([Wh(Hh(Bh()),vv(Bb)),Wh(Hh(Ph()),vv(Ib)),Wh(zh([Vh,Hh(Eh())]),Pb),Wh(zh([Uh,Hh(Eh())]),Nb),Wh(Hh(Dh()),_b),Wh(Hh(_h()),_b)]),Fb=i([Wh(Hh(_h()),nv)]),Lb=Kh(Ab,Qu.init,Mb,Fb,(function(){return x.some(Rb)})),Hb=[ws("onSpace"),ws("onEnter"),ws("onShiftEnter"),ws("onLeft"),ws("onRight"),ws("onTab"),ws("onShiftTab"),ws("onUp"),ws("onDown"),ws("onEscape"),Ie("stopSpaceKeyup",!1),Oe("focusIn")],zb=function(t,n,e){return[Wh(Hh(_h()),e.onSpace),Wh(zh([Uh,Hh(Dh())]),e.onEnter),Wh(zh([Vh,Hh(Dh())]),e.onShiftEnter),Wh(zh([Vh,Hh(Eh())]),e.onShiftTab),Wh(zh([Uh,Hh(Eh())]),e.onTab),Wh(Hh(Bh()),e.onUp),Wh(Hh(Ph()),e.onDown),Wh(Hh(Rh()),e.onLeft),Wh(Hh(Ih()),e.onRight),Wh(Hh(_h()),e.onSpace),Wh(Hh(Ah()),e.onEscape)]},Vb=function(t,n,e){return e.stopSpaceKeyup?[Wh(Hh(_h()),nv)]:[]},jb=Kh(Hb,Qu.init,zb,Vb,(function(t){return t.focusIn})),Ub=Jh.schema(),Wb=Qh.schema(),Gb=eb.schema(),qb=Wv.schema(),Xb=Db.schema(),Yb=uv.schema(),Kb=Lb.schema(),$b=jb.schema(),Jb=Object.freeze({acyclic:Ub,cyclic:Wb,flow:Gb,flatgrid:qb,matrix:Xb,execution:Yb,menu:Kb,special:$b}),Qb=vf({branchKey:"mode",branches:Jb,name:"keying",active:{events:function(t,n){var e=t.handler;return e.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element(),t.element())}),(function(r){r(t,n,e)}))},setGridSize:function(t,e,r,o,i){Qt(r,"setGridSize")?r.setGridSize(o,i):n.console.error("Layout does not support setGridSize")}},state:sv}),Zb=function(t,n,e,r){Rf((function(){var n=W(r,t.getSystem().build);Rm(t,n)}),t.element())},ty=function(t,n,e,r){var o=t.getSystem().build(r);Im(t,o,e)},ny=function(t,n,e,r){ty(t,n,cu,r)},ey=function(t,n,e,r){ty(t,n,au,r)},ry=function(t,n,e,r){var o=oy(t),i=J(o,(function(t){return eo(r.element(),t.element())}));i.each(Nm)},oy=function(t,n){return t.components()},iy=function(t,n,e,r,o){var i=oy(t);return x.from(i[r]).map((function(i){return ry(t,n,e,i),o.each((function(e){ty(t,n,(function(t,n){su(t,n,r)}),e)})),i}))},uy=function(t,n,e,r,o){var i=oy(t);return Q(i,r).bind((function(r){return iy(t,n,e,r,o)}))},ay=Object.freeze({append:ny,prepend:ey,remove:ry,replaceAt:iy,replaceBy:uy,set:Zb,contents:oy}),cy=pf({fields:[],name:"replacing",apis:ay}),sy=function(t,n){var e=ki(n);return pf({fields:[ge("enabled")],name:t,active:{events:i(e)}})},fy=function(t,n){var e=sy(t,n);return{key:t,value:{config:{},me:e,configAsRaw:i({}),initialConfig:{},state:Qu}}},ly=function(t,n){n.ignore||(Tf(t.element()),n.onFocus(t))},dy=function(t,n){n.ignore||Ef(t.element())},my=function(t){return Df(t.element())},gy=Object.freeze({focus:ly,blur:dy,isFocused:my}),py=function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return oa(e)},hy=function(t){return ki([Di(Io(),(function(n,e){ly(n,t),e.stop()}))].concat(t.stopMousedown?[Di(bo(),(function(t,n){n.event().prevent()}))]:[]))},vy=Object.freeze({exhibit:py,events:hy}),by=[ys("onFocus"),Ie("stopMousedown",!1),Ie("ignore",!1)],yy=pf({fields:by,name:"focusing",active:vy,apis:gy}),wy=function(t,n,e){var r=n.aria;r.update(t,r,e.get())},xy=function(t,n,e){n.toggleClass.each((function(n){e.get()?Ra(t.element(),n):Ia(t.element(),n)}))},Cy=function(t,n,e){Oy(t,n,e,!e.get())},Sy=function(t,n,e){e.set(!0),xy(t,n,e),wy(t,n,e)},ky=function(t,n,e){e.set(!1),xy(t,n,e),wy(t,n,e)},Oy=function(t,n,e,r){var o=r?Sy:ky;o(t,n,e)},Ty=function(t,n,e){return e.get()},Ey=function(t,n,e){Oy(t,n,e,n.selected)},Dy=Object.freeze({onLoad:Ey,toggle:Cy,isOn:Ty,on:Sy,off:ky,set:Oy}),Ay=function(t,n,e){return oa({})},_y=function(t,n){var e=uf(t,n,Cy),r=af(t,n,Ey);return ki(Z([t.toggleOnExecute?[e]:[],[r]]))},Ry=Object.freeze({exhibit:Ay,events:_y}),By=function(t){var n=function(){var n=We(t),e=function(){return n.get()},r=function(t){return n.set(t)},o=function(){return n.set(t)},i=function(){return n.get()};return{get:e,set:r,clear:o,readState:i}};return{init:n}},Iy=function(t,n,e){yu(t.element(),"aria-pressed",e),n.syncWithExpanded&&My(t,n,e)},Py=function(t,n,e){yu(t.element(),"aria-selected",e)},Ny=function(t,n,e){yu(t.element(),"aria-checked",e)},My=function(t,n,e){yu(t.element(),"aria-expanded",e)},Fy=[Ie("selected",!1),Oe("toggleClass"),Ie("toggleOnExecute",!0),Pe("aria",{mode:"none"},oe("mode",{pressed:[Ie("syncWithExpanded",!1),Ss("update",Iy)],checked:[Ss("update",Ny)],expanded:[Ss("update",My)],selected:[Ss("update",Py)],none:[Ss("update",e)]}))],Ly=pf({fields:Fy,name:"toggling",active:Ry,apis:Dy,state:By(!1)}),Hy=function(){return[Di(zo(),(function(t,n){n.stop(),ai(t)})),Ni(qr().deviceType.isTouch()?go():bo())]},zy=function(t){var n=function(t){return Vi((function(n,e){t(n),e.stop()}))};return ki(Z([t.map(n).toArray(),Hy()]))},Vy="alloy.item-hover",jy="alloy.item-focus",Uy=function(t){(_f(t.element()).isNone()||yy.isFocused(t))&&(yy.isFocused(t)||yy.focus(t),ui(t,Vy,{item:t}))},Wy=function(t){ui(t,jy,{item:t})},Gy=i(Vy),qy=i(jy),Xy=function(t){return{dom:t.dom,domModification:m(m({},t.domModification),{attributes:m(m(m({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:qg.augment(t.itemBehaviours,[t.toggling.fold(Ly.revoke,(function(t){return Ly.config(m({aria:{mode:"checked"}},t))})),yy.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Wy(t)}}),Qb.config({mode:"execution"}),jg.config({store:{mode:"memory",initialValue:t.data}}),fy("item-type-events",p(Hy(),[Di(Co(),Uy),Di(Lo(),yy.focus)]))]),components:t.components,eventOrder:t.eventOrder}},Yy=[ge("data"),ge("components"),ge("dom"),Ie("hasSubmenu",!1),Oe("toggling"),qg.field("itemBehaviours",[Ly,yy,Qb,jg]),Ie("ignoreFocus",!1),Ie("domModification",{}),Ss("builder",Xy),Ie("eventOrder",{})],Ky=function(t){return{dom:t.dom,components:t.components,events:ki([Mi(Lo())])}},$y=[ge("dom"),ge("components"),Ss("builder",Ky)],Jy=function(){return"item-widget"},Qy=i([wp({name:"widget",overrides:function(t){return{behaviours:mf([jg.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:function(){}}})])}}})]),Zy=function(t){var n=Ip(Jy(),t,Qy()),e=Pp(Jy(),t,n.internals()),r=function(n){return Np(n,t,"widget").map((function(t){return Qb.focusIn(t),t}))},o=function(n,e){return nh(e.event().target())?x.none():function(){return t.autofocus?(e.setSource(n.element()),x.none()):x.none()}()};return{dom:t.dom,components:e,domModification:t.domModification,events:ki([Vi((function(t,n){r(t).each((function(t){n.stop()}))})),Di(Co(),Uy),Di(Lo(),(function(n,e){t.autofocus?r(n):yy.focus(n)}))]),behaviours:qg.augment(t.widgetBehaviours,[jg.config({store:{mode:"memory",initialValue:t.data}}),yy.config({ignore:t.ignoreFocus,onFocus:function(t){Wy(t)}}),Qb.config({mode:"special",focusIn:t.autofocus?function(t){r(t)}:bf(),onLeft:o,onRight:o,onEscape:function(n,e){return yy.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element()),x.none()):x.none():(yy.focus(n),x.some(!0))}})])}},tw=[ge("uid"),ge("data"),ge("components"),ge("dom"),Ie("autofocus",!1),Ie("ignoreFocus",!1),qg.field("widgetBehaviours",[jg,yy,Qb]),Ie("domModification",{}),jp(Qy()),Ss("builder",Zy)],nw=oe("type",{widget:tw,item:Yy,separator:$y}),ew=function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}},rw=function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}},ow=function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}},iw=i([Sp({factory:{sketch:function(t){var n=ne("menu.spec item",nw,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:m(m({},n),{uid:zu("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),uw=i([ge("value"),ge("items"),ge("dom"),ge("components"),Ie("eventOrder",{}),Ug("menuBehaviours",[Oh,jg,ih,Qb]),Pe("movement",{mode:"menu",moveOnTab:!0},oe("mode",{grid:[Os(),Ss("config",ew)],matrix:[Ss("config",rw),ge("rowSelector")],menu:[Ie("moveOnTab",!0),Ss("config",ow)]})),ps(),Ie("fakeFocus",!1),Ie("focusManager",Xh()),ys("onHighlight")]),aw=i("alloy.menu-focus"),cw=function(t,n,e,r){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Gg(t.menuBehaviours,[Oh.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),jg.config({store:{mode:"memory",initialValue:t.value}}),ih.config({find:x.some}),Qb.config(t.movement.config(t,t.movement))]),events:ki([Di(qy(),(function(t,n){var e=n.event();t.getSystem().getByDom(e.target()).each((function(e){Oh.highlight(t,e),n.stop(),ui(t,aw(),{menu:t,item:e})}))})),Di(Gy(),(function(t,n){var e=n.event().item();Oh.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}},sw=th({name:"Menu",configFields:uw(),partFields:iw(),factory:cw}),fw=function(t){return mt(t,(function(t,n){return{k:t,v:n}}))},lw=function(t,n,e,r){return qt(e,r).bind((function(r){return qt(t,r).bind((function(r){var o=lw(t,n,e,r);return x.some([r].concat(o))}))})).getOr([])},dw=function(t,n){var e={};lt(t,(function(t,n){G(t,(function(t){e[t]=n}))}));var r=n,o=fw(n),i=dt(o,(function(t,n){return[n].concat(lw(e,r,o,n))}));return dt(e,(function(t){return qt(i,t).getOr([t])}))},mw=function(){var t=We({}),n=We({}),e=We({}),r=We(x.none()),o=We({}),i=function(){t.set({}),n.set({}),e.set({}),r.set(x.none())},u=function(){return r.get().isNone()},a=function(t,e){var r;n.set(m(m({},n.get()),(r={},r[t]={type:"prepared",menu:e},r)))},c=function(i,u,a,c){r.set(x.some(i)),t.set(a),n.set(u),o.set(c);var s=dw(c,a);e.set(s)},s=function(n){return pt(t.get(),(function(t,e){return t===n}))},f=function(t,n,e){return h(t).bind((function(r){return s(t).bind((function(t){return n(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:e}}))}))}))},l=function(t,n){var o=Y(b(t).toArray(),(function(t){return h(t).isSome()}));return qt(e.get(),t).bind((function(t){var e=et(o.concat(t)),i=tt(e,(function(t,o){return f(t,n,e.slice(0,o+1)).fold((function(){return r.get().is(t)?[]:[x.none()]}),(function(t){return[x.some(t)]}))}));return Qc(i)}))},d=function(n){return qt(t.get(),n).map((function(t){var r=qt(e.get(),n).getOr([]);return[t].concat(r)}))},g=function(t){return qt(e.get(),t).bind((function(t){return t.length>1?x.some(t.slice(1)):x.none()}))},p=function(t){return qt(e.get(),t)},h=function(t){return v(t).bind(gw)},v=function(t){return qt(n.get(),t)},b=function(n){return qt(t.get(),n)},y=function(t){var n=o.get();return rt(st(n),t)},w=function(){return r.get().bind(h)},C=function(){return n.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:p,collapse:g,lookupMenu:v,lookupItem:b,otherMenus:y,getPrimary:w,getMenus:C,clear:i,isClear:u,getTriggeringPath:l}},gw=function(t){return"prepared"===t.type?x.some(t.menu):x.none()},pw={init:mw,extractPreparedMenu:gw},hw=function(t,n){var e,r=We(x.none()),o=function(n,e,r){return dt(r,(function(r,o){var i=function(){return sw.sketch(m(m({dom:r.dom},r),{value:o,items:r.items,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Yh():Xh()}))};return o===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=pw.init(),u=function(n){var e=o(n,t.data.primary,t.data.menus),r=s();return i.setContents(t.data.primary,e,t.data.expansions,r),i.getPrimary()},a=function(t){return jg.getValue(t).value},c=function(t,n,e){return Zc(n,(function(t){if(!t.getSystem().isConnected())return x.none();var n=Oh.getCandidates(t);return J(n,(function(t){return a(t)===e}))}))},s=function(n){return dt(t.data.menus,(function(t,n){return tt(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},f=function(t,n){Oh.highlight(t,n),Oh.getHighlighted(n).orThunk((function(){return Oh.getFirst(n)})).each((function(n){ci(t,n.element(),Lo())}))},l=function(t,n){return Jc(W(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?x.some(t.menu):x.none()}))})))},d=function(n,e,r){var o=l(e,e.otherMenus(r));G(o,(function(e){Ma(e.element(),[t.markers.backgroundMenu]),t.stayInDom||cy.remove(n,e)}))},g=function(n){return r.get().getOrThunk((function(){var e={},o=cd(n.element(),"."+t.markers.item),i=Y(o,(function(t){return"true"===xu(t,"aria-haspopup")}));return G(i,(function(t){n.getSystem().getByDom(t).each((function(t){var n=a(t);e[n]=t}))})),r.set(x.some(e)),e}))},p=function(t,n){var e=g(t);lt(e,(function(t,e){var r=z(n,e);yu(t.element(),"aria-expanded",r)}))},h=function(n,e,r){return x.from(r[0]).bind((function(o){return e.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return x.none();var i=o.menu,u=l(e,r.slice(1));return G(u,(function(n){Ra(n.element(),t.markers.backgroundMenu)})),vi(i.element())||cy.append(n,fc(i)),Ma(i.element(),[t.markers.backgroundMenu]),f(n,i),d(n,e,r),x.some(i)}))}))};(function(t){t[t["HighlightSubmenu"]=0]="HighlightSubmenu",t[t["HighlightParent"]=1]="HighlightParent"})(e||(e={}));var v=function(t,n,e){if("notbuilt"===e.type){var r=t.getSystem().build(e.nbMenu());return i.setMenuBuilt(n,r),r}return e.menu},b=function(n,r,o){void 0===o&&(o=e.HighlightSubmenu);var u=a(r);return i.expand(u).bind((function(u){return p(n,u),x.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=v(n,a,c);return vi(s.element())||cy.append(n,fc(s)),t.onOpenSubmenu(n,r,s,et(u)),o===e.HighlightSubmenu?(Oh.highlightFirst(s),h(n,i,u)):(Oh.dehighlightAll(s),x.some(r))}))}))}))},y=function(n,e){var r=a(e);return i.collapse(r).bind((function(r){return p(n,r),h(n,i,r).map((function(r){return t.onCollapseMenu(n,e,r),r}))}))},w=function(t,n){var e=a(n);return i.refresh(e).bind((function(n){return p(t,n),h(t,i,n)}))},C=function(t,n){return nh(n.element())?x.none():b(t,n,e.HighlightSubmenu)},S=function(t,n){return nh(n.element())?x.none():y(t,n)},k=function(n,e){return y(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))},O=function(n){return function(e,r){return qc(r.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOption().bind((function(t){return n(e,t).map((function(){return!0}))}))}))}},T=ki([Di(aw(),(function(t,n){var e=n.event().item();i.lookupItem(a(e)).each((function(){var e=n.event().menu();Oh.highlight(t,e);var r=a(n.event().item());i.refresh(r).each((function(n){return d(t,i,n)}))}))})),Vi((function(n,r){var o=r.event().target();n.getSystem().getByDom(o).each((function(r){var o=a(r);0===o.indexOf("collapse-item")&&y(n,r),b(n,r,e.HighlightSubmenu).fold((function(){t.onExecute(n,r)}),(function(){}))}))})),Li((function(n,e){u(n).each((function(e){cy.append(n,fc(e)),t.onOpenMenu(n,e),t.highlightImmediately&&f(n,e)}))}))].concat(t.navigateOnHover?[Di(Gy(),(function(n,r){var o=r.event().item();w(n,o),b(n,o,e.HighlightParent),t.onHover(n,o)}))]:[])),E=function(t){return Oh.getHighlighted(t).bind(Oh.getHighlighted)},D=function(t){E(t).each((function(n){y(t,n)}))},A=function(t){i.getPrimary().each((function(n){f(t,n)}))},_=function(t){return x.from(t.components()[0]).filter((function(t){return"menu"===xu(t.element(),"role")}))},R=function(n){var e=i.getPrimary().bind((function(t){return E(n).bind((function(t){var e=a(t),r=ht(i.getMenus()),o=Jc(W(r,pw.extractPreparedMenu));return i.getTriggeringPath(e,(function(t){return c(n,o,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))}));e.fold((function(){_(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var r=e.primary,o=e.triggeringPath;t.onRepositionMenu(n,r,o)}))},B={collapseMenu:D,highlightPrimary:A,repositionMenus:R};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Gg(t.tmenuBehaviours,[Qb.config({mode:"special",onRight:O(C),onLeft:O(S),onEscape:O(k),focusIn:function(t,n){i.getPrimary().each((function(n){ci(t,n.element(),Lo())}))}}),Oh.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),ih.config({find:function(t){return Oh.getHighlighted(t)}}),cy.config({})]),eventOrder:t.eventOrder,apis:B,events:T}},vw=i("collapse-item"),bw=function(t,n,e){return{primary:t,menus:n,expansions:e}},yw=function(t,n){return{primary:t,menus:Xt(t,n),expansions:{}}},ww=function(t){return{value:Bu(vw()),meta:{text:t}}},xw=Zp({name:"TieredMenu",configFields:[Cs("onExecute"),Cs("onEscape"),xs("onOpenMenu"),xs("onOpenSubmenu"),xs("onRepositionMenu"),ys("onCollapseMenu"),Ie("highlightImmediately",!0),Ce("data",[ge("primary"),ge("menus"),ge("expansions")]),Ie("fakeFocus",!1),ys("onHighlight"),ys("onHover"),hs(),ge("dom"),Ie("navigateOnHover",!0),Ie("stayInDom",!1),Ug("tmenuBehaviours",[Qb,Oh,ih,cy]),Ie("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:hw,extraApis:{tieredData:bw,singleData:yw,collapseItem:ww}}),Cw=function(t,n,e,r,o){var i=function(){return t.lazySink(n)},u="horizontal"===r.type?{layouts:{onLtr:function(){return rf()},onRtl:function(){return of()}}}:{},a=function(t){return 2===t.length},c=function(t){return a(t)?u:{}};return xw.sketch({dom:{tag:"div"},data:r.data,markers:r.menu.markers,onEscape:function(){return ug.close(n),t.onEscape.map((function(t){return t(n)})),x.some(!0)},onExecute:function(){return x.some(!0)},onOpenMenu:function(t,n){Tm.positionWithinBounds(i().getOrDie(),e,n,o())},onOpenSubmenu:function(t,n,e,r){var o=i().getOrDie();Tm.position(o,m({anchor:"submenu",item:n},c(r)),e)},onRepositionMenu:function(t,n,r){var u=i().getOrDie();Tm.positionWithinBounds(u,e,n,o()),G(r,(function(t){var n=c(t.triggeringPath);Tm.position(u,m({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)}))}})},Sw=function(t,n){var e=function(n,e){var r=t.getRelated(n);return r.exists((function(t){return $c(t,e)}))},r=function(t,n){ug.setContent(t,n)},o=function(t,n,e){u(t,n,e,x.none())},u=function(t,n,e,r){a(t,n,e,(function(){return r.map((function(t){return zc(t)}))}))},a=function(n,e,r,o){var i=t.lazySink(n).getOrDie();ug.openWhileCloaked(n,r,(function(){return Tm.positionWithinBounds(i,e,n,o())})),jg.setValue(n,x.some({mode:"position",anchor:e,getBounds:o}))},c=function(t,n,e){s(t,n,e,(function(){return x.none()}))},s=function(n,e,r,o){var i=Cw(t,n,e,r,o);ug.open(n,i),jg.setValue(n,x.some({mode:"menu",menu:i}))},f=function(t){jg.setValue(t,x.none()),ug.close(t)},l=function(t){return ug.getState(t)},d=function(n){ug.isOpen(n)&&jg.getValue(n).each((function(e){switch(e.mode){case"menu":ug.getState(n).each((function(t){xw.repositionMenus(t)}));break;case"position":var r=t.lazySink(n).getOrDie();Tm.positionWithinBounds(r,e.anchor,n,e.getBounds());break}}))},g={setContent:r,showAt:o,showWithin:u,showWithinBounds:a,showMenuAt:c,showMenuWithinBounds:s,hide:f,getContent:l,reposition:d,isOpen:ug.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Gg(t.inlineBehaviours,[ug.config({isPartOf:function(t,n,r){return $c(n,r)||e(t,r)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),jg.config({store:{mode:"memory",initialValue:x.none()}}),Sf.config({channels:m(m({},lg(m({isExtraPart:i(!1)},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),mg(m(m({isExtraPart:i(!1)},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:d})))})]),eventOrder:t.eventOrder,apis:g}},kw=Zp({name:"InlineView",configFields:[ge("lazySink"),ys("onShow"),ys("onHide"),Ae("onEscape"),Ug("inlineBehaviours",[ug,jg,Sf]),Re("fireDismissalEventInstead",[Ie("event",Jo())]),Re("fireRepositionEventInstead",[Ie("event",Qo())]),Ie("getRelated",x.none),Ie("eventOrder",x.none)],factory:Sw,apis:{showAt:function(t,n,e,r){t.showAt(n,e,r)},showWithin:function(t,n,e,r,o){t.showWithin(n,e,r,o)},showWithinBounds:function(t,n,e,r,o){t.showWithinBounds(n,e,r,o)},showMenuAt:function(t,n,e,r){t.showMenuAt(n,e,r)},showMenuWithinBounds:function(t,n,e,r,o){t.showMenuWithinBounds(n,e,r,o)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Ow=function(t){return t.x()},Tw=function(t,n){return t.x()+t.width()/2-n.width()/2},Ew=function(t,n){return t.x()+t.width()-n.width()},Dw=function(t){return t.y()},Aw=function(t,n){return t.y()+t.height()-n.height()},_w=function(t,n,e){return Ts(Ow(t),Aw(t,n),e.innerSoutheast(),Rs(),"layout-se")},Rw=function(t,n,e){return Ts(Ew(t,n),Aw(t,n),e.innerSouthwest(),Bs(),"layout-sw")},Bw=function(t,n,e){return Ts(Ow(t),Dw(t),e.innerNortheast(),Is(),"layout-ne")},Iw=function(t,n,e){return Ts(Ew(t,n),Dw(t),e.innerNorthwest(),Ps(),"layout-nw")},Pw=function(t,n,e){return Ts(Tw(t,n),Dw(t),e.innerNorth(),Ms(),"layout-n")},Nw=function(t,n,e){return Ts(Tw(t,n),Aw(t,n),e.innerSouth(),Ns(),"layout-s")},Mw=function(t){var n=zy(t.action),e=t.dom.tag,r=function(n){return qt(t.dom,"attributes").bind((function(t){return qt(t,n)}))},o=function(){if("button"===e){var t=r("type").getOr("button"),n=r("role").map((function(t){return{role:t}})).getOr({});return m({type:t},n)}var o=r("role").getOr("button");return{role:o}};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:qg.augment(t.buttonBehaviours,[yy.config({}),Qb.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:o()},eventOrder:t.eventOrder}},Fw=Zp({name:"Button",factory:Mw,configFields:[Ie("uid",void 0),ge("dom"),Ie("components",[]),qg.field("buttonBehaviours",[yy,Qb]),Oe("action"),Oe("role"),Ie("eventOrder",{})]}),Lw=function(t){var n=Kp(t)&&Qt(t,"uid")?t.uid:zu("memento"),e=function(t){return t.getSystem().getByUid(n).getOrDie()},r=function(t){return t.getSystem().getByUid(n).toOption()},o=function(){return m(m({},t),{uid:n})};return{get:e,getOpt:r,asSpec:o}},Hw=function(t){return x.from(t()["temporary-placeholder"]).getOr("!not found!")},zw=function(t,n){return x.from(n()[t]).getOrThunk((function(){return Hw(n)}))},Vw=function(t,n,e){return x.from(n()[t]).or(e).getOrThunk((function(){return Hw(n)}))},jw=function(t,n){return Zc(t,(function(t){return x.from(n()[t])})).getOrThunk((function(){return Hw(n)}))},Uw={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Ww=function(t){var n=Lw({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:mf([cy.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},r=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},o=Lw({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},r(0)],behaviours:mf([cy.config({})])}),i=function(t,n){t.getSystem().isConnected()&&o.getOpt(t).each((function(t){cy.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},r(n)])}))},u=function(t,e){if(t.getSystem().isConnected()){var r=n.get(t);cy.set(r,[uc(e)])}},a={updateProgress:i,updateText:u},c=Z([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return x.from(Uw[t])})).toArray()]);return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:jw(c,t.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:mf([cy.config({})])}].concat(t.progress?[o.asSpec()]:[]).concat(Fw.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:zw("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),apis:a}},Gw=Zp({name:"Notification",factory:Ww,configFields:[Oe("level"),ge("progress"),ge("icon"),ge("onAction"),ge("text"),ge("iconProvider"),ge("translationProvider")],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),qw=tinymce.util.Tools.resolve("tinymce.util.Delay");function Xw(t,n,e){var r=n.backstage,o=function(t){switch(t){case"bc-bc":return Nw;case"tc-tc":return Pw;case"tc-bc":return Js;case"bc-tc":default:return Qs}},i=function(t){G(t,(function(t){return t.moveTo(0,0)}))},u=function(t){t.length>0&&(ut(t).each((function(t){return t.moveRel(null,"banner")})),G(t,(function(n,e){e>0&&n.moveRel(t[e-1].getEl(),"bc-tc")})))},a=function(t){i(t),u(t)},c=function(t,i){var u=function(){i(),kw.hide(c)},a=sc(Gw.sketch({text:t.text,level:z(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:x.from(t.icon),onAction:u,iconProvider:r.shared.providers.icons,translationProvider:r.shared.providers.translate})),c=sc(kw.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}}));return e.add(c),t.timeout>0&&qw.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,n){kw.showAt(c,{anchor:"makeshift",x:t,y:n},fc(a))},moveRel:function(t,e){if("banner"!==e){var r=o(e),i={anchor:"node",root:bi(),node:x.some($e.fromDom(t)),layouts:{onRtl:function(){return[r]},onLtr:function(){return[r]}}};kw.showAt(c,i,fc(a))}else kw.showAt(c,n.backstage.shared.anchors.banner(),fc(a))},text:function(t){Gw.updateText(a,t)},settings:t,getEl:function(){return a.element().dom()},progressBar:{value:function(t){Gw.updateProgress(a,t)}}}},s=function(t){t.close()},f=function(t){return t.settings};return{open:c,close:s,reposition:a,getArgs:f}}var Yw,Kw=function(t,e){var r=null,o=function(){null!==r&&(n.clearTimeout(r),r=null)},i=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null===r&&(r=n.setTimeout((function(){t.apply(null,o),r=null}),e))};return{cancel:o,throttle:i}},$w=function(t,e){var r=null,o=function(){null!==r&&(n.clearTimeout(r),r=null)},i=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&n.clearTimeout(r),r=n.setTimeout((function(){t.apply(null,o),r=null}),e)};return{cancel:o,throttle:i}},Jw=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Qw=function(t){return t.nodeType===n.Node.TEXT_NODE},Zw=function(t,n){return t.isBlock(n)||z(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)},tx=wt.generate([{aborted:[]},{edge:["element"]},{success:["info"]}]),nx=wt.generate([{abort:[]},{kontinue:[]},{finish:["info"]}]),ex=function(t,n,e,r,o,i){var u=function(){return i.fold(tx.aborted,tx.edge)},a=function(){var e=o();return e?ex(t,e,x.none(),r,o,x.some(n)):u()};if(Zw(t,n))return u();if(Qw(n)){var c=n.textContent;return r(nx,n,c,e).fold(tx.aborted,(function(){return a()}),tx.success)}return a()},rx=function(t,n,e,r,o){var i=new Jw(n,o||t.getRoot());return ex(t,n,x.some(e),r,i.prev,x.none())},ox="[data-mce-autocompleter]",ix=function(t,n){return ux($e.fromDom(t.selection.getNode())).getOrThunk((function(){var e=$e.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return cu(e,$e.fromDom(n.extractContents())),n.insertNode(e.dom()),Qi(e).each((function(t){return t.dom().normalize()})),Kl(e).map((function(n){t.selection.setCursorLocation(n.dom(),Ul(n))})),e}))},ux=function(t){return qc(t,ox)},ax=function(t){return t.collapsed&&3===t.startContainer.nodeType},cx=/[\u00a0 \t\r\n]/,sx=function(t,n,e,r){var o;for(o=n-1;o>=0;o--){var i=t.charAt(o);if(cx.test(i))return x.none();if(i===e)break}return-1===o||n-o<r?x.none():x.some(t.substring(o+1,n))},fx=function(t,n){var e=t.toString().substring(n.length);return e.replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},lx=function(t,n,e,r){if(void 0===r&&(r=0),!ax(n))return x.none();var o=function(t,o,i,u){var a=u.getOr(i.length);return sx(i,a,e,1).fold((function(){return i.match(cx)?t.abort():t.kontinue()}),(function(u){var c=n.cloneRange();return c.setStart(o,a-u.length-1),c.setEnd(n.endContainer,n.endOffset),i.length<r?t.abort():t.finish({text:fx(c,e),range:c,triggerChar:e})}))};return rx(t,n.startContainer,n.startOffset,o).fold(x.none,x.none,x.some)},dx=function(t,n,e,r){return void 0===r&&(r=0),ux($e.fromDom(n.startContainer)).fold((function(){return lx(t,n,e,r)}),(function(n){var r=t.createRng();return r.selectNode(n.dom()),x.some({range:r,text:fx(r,e),triggerChar:e})}))},mx=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){ui(t,Oo(),{raw:n})};n.on("keydown",(function(n){var r=function(){return t.getView().bind(Oh.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(r().each(ai),n.preventDefault()):40===n.which?(r().fold((function(){t.getView().each(Oh.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||r().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&ux($e.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},gx={setup:mx},px=tinymce.util.Tools.resolve("tinymce.util.Promise"),hx=function(t,n){return{element:t,offset:n}},vx=function(t){return t.nodeType===n.Node.TEXT_NODE},bx=function(t){return t.nodeType===n.Node.ELEMENT_NODE},yx=function(t){if(vx(t))return hx(t,t.data.length);var n=t.childNodes;return n.length>0?yx(n[n.length-1]):hx(t,n.length)},wx=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?wx(e[n],0):e.length>0&&bx(t)&&e.length===n?yx(e[e.length-1]):hx(t,n)},xx=function(t){var n=function(t,n,e,r){var o=r.getOr(e.length);return 0===o?t.kontinue():t.finish(/\s/.test(e.charAt(o-1)))};return function(e){var r=wx(e.startContainer,e.startOffset);return rx(t,r.element,r.offset,n).fold(i(!0),i(!0),u)}},Cx=function(t,n,e){return Zc(e.triggerChars,(function(e){return dx(t,n,e)}))},Sx=function(t,n){var e=n(),r=t.selection.getRng();return Cx(t.dom,r,e).bind((function(e){return kx(t,n,e)}))},kx=function(t,n,e,r){void 0===r&&(r={});var o=n(),i=t.selection.getRng(),u=i.startContainer.nodeValue,a=Y(o.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return xx(t.dom)}))(e.range,u,e.text)}));if(0===a.length)return x.none();var c=px.all(W(a,(function(t){var n=t.fetch(e.text,t.maxResults,r);return n.then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction}}))})));return x.some({lookupData:c,context:e})},Ox=Fn([ve("type"),De("text")]),Tx=function(t){return Zn("separatormenuitem",Ox,t)},Ex=Fn([Ue("type",(function(){return"autocompleteitem"})),Ue("active",(function(){return!1})),Ue("disabled",(function(){return!1})),Ie("meta",{}),ve("value"),De("text"),De("icon")]),Dx=Fn([ve("type"),ve("ch"),Ne("minChars",1),Ie("columns",1),Ne("maxResults",10),Ae("matches"),we("fetch"),we("onAction")]),Ax=function(t){return Zn("Autocompleter.Separator",Ox,t)},_x=function(t){return Zn("Autocompleter.Item",Ex,t)},Rx=function(t){return Zn("Autocompleter",Dx,t)},Bx=function(t){var n={};return G(t,(function(t){n[t]={}})),st(n)},Ix=function(t){var n=t.ui.registry.getAll().popups,e=dt(n,(function(t){return Rx(t).fold((function(t){throw new Error(ee(t))}),(function(t){return t}))})),r=Bx(gt(e,(function(t){return t.ch}))),o=ht(e),i=function(t){return Y(o,(function(n){return n.ch===t}))};return{dataset:e,triggerChars:r,lookupByChar:i}},Px=[Le("disabled",!1),De("text"),De("shortcut"),Un("value","value",It((function(){return Bu("menuitem-value")})),ie()),Ie("meta",{})],Nx=Fn([ve("type"),He("onSetup",(function(){return e})),He("onAction",e),De("icon")].concat(Px)),Mx=function(t){return Zn("menuitem",Nx,t)},Fx=Fn([ve("type"),we("getSubmenuItems"),He("onSetup",(function(){return e})),De("icon")].concat(Px)),Lx=function(t){return Zn("nestedmenuitem",Fx,t)},Hx=Fn([ve("type"),Le("active",!1),He("onSetup",(function(){return e})),we("onAction")].concat(Px)),zx=function(t){return Zn("togglemenuitem",Hx,t)},Vx=Fn([ve("type"),Le("active",!1),De("icon")].concat(Px)),jx=function(t){return Zn("choicemenuitem",Vx,t)},Ux=["inserttable","colorswatch"],Wx=Fn([ve("type"),be("fancytype",Ux),He("onAction",e)]),Gx=function(t){return Zn("fancymenuitem",Wx,t)},qx=function(t,n,e){var r=cd(t.element(),"."+e);if(r.length>0){var o=Q(r,(function(t){var e=t.dom().getBoundingClientRect().top,o=r[0].dom().getBoundingClientRect().top;return Math.abs(e-o)>n})).getOr(r.length);return x.some({numColumns:o,numRows:Math.ceil(r.length/o)})}return x.none()},Xx=function(t,n){return mf([fy(t,n)])},Yx=function(t){return Xx(Bu("unnamed-events"),t)},Kx={namedEvents:Xx,unnamedEvents:Yx},$x=[ge("lazySink"),ge("tooltipDom"),Ie("exclusive",!0),Ie("tooltipComponents",[]),Ie("delay",300),Fe("mode","normal",["normal","follow-highlight"]),Ie("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:i([Qs,Js,Xs,Ks,Ys,$s]),onRtl:i([Qs,Js,Xs,Ks,Ys,$s])}}})),ys("onHide"),ys("onShow")],Jx=function(){var t=We(x.none()),e=We(x.none()),r=function(){return e.get()},o=function(t){e.set(x.some(t))},u=function(){e.set(x.none())},a=function(){t.get().each((function(t){n.clearTimeout(t)}))},c=function(e,r){a(),t.set(x.some(n.setTimeout((function(){e()}),r)))},s=function(){return e.get().isSome()},f=i("not-implemented");return Zu({getTooltip:r,isShowing:s,setTooltip:o,clearTooltip:u,clearTimer:a,resetTimer:c,readState:f})},Qx=Object.freeze({init:Jx}),Zx=Bu("tooltip.exclusive"),tC=Bu("tooltip.show"),nC=Bu("tooltip.hide"),eC=function(t,n,e){t.getSystem().broadcastOn([Zx],{})},rC=function(t,n,e,r){e.getTooltip().each((function(t){t.getSystem().isConnected()&&cy.set(t,r)}))},oC=Object.freeze({hideAllExclusive:eC,setComponents:rC}),iC=function(t,n){var e=function(e){n.getTooltip().each((function(r){Nm(r),t.onHide(e,r),n.clearTooltip()})),n.clearTimer()},r=function(e){if(!n.isShowing()){eC(e);var r=t.lazySink(e).getOrDie(),o=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:ki("normal"===t.mode?[Di(Co(),(function(t){ii(e,tC)})),Di(wo(),(function(t){ii(e,nC)}))]:[]),behaviours:mf([cy.config({})])});n.setTooltip(o),Bm(r,o),t.onShow(e,o),Tm.position(r,t.anchor(e),o)}};return ki(Z([[Di(tC,(function(e){n.resetTimer((function(){r(e)}),t.delay)})),Di(nC,(function(r){n.resetTimer((function(){e(r)}),t.delay)})),Di(Mo(),(function(t,n){var r=n;z(r.channels(),Zx)&&e(t)})),Hi((function(t){e(t)}))],"normal"===t.mode?[Di(So(),(function(t){ii(t,tC)})),Di(Po(),(function(t){ii(t,nC)})),Di(Co(),(function(t){ii(t,tC)})),Di(wo(),(function(t){ii(t,nC)}))]:[Di(ri(),(function(t,n){ii(t,tC)})),Di(oi(),(function(t){ii(t,nC)}))]]))},uC=Object.freeze({events:iC}),aC=pf({fields:$x,name:"tooltipping",active:uC,state:Qx,apis:oC}),cC=function(t){var n=void 0!==t.dom().attributes?t.dom().attributes:[];return $(n,(function(t,n){var e;return"class"===n.name?t:m(m({},t),(e={},e[n.name]=n.value,e))}),{})},sC=function(t){return Array.prototype.slice.call(t.dom().classList,0)},fC=function(t){var n=$e.fromHtml(t),e=nu(n),r=cC(n),o=sC(n),i=0===e.length?{}:{innerHtml:pu(n)};return m({tag:di(n),classes:o,attributes:r},i)},lC=tinymce.util.Tools.resolve("tinymce.util.I18n"),dC="tox-menu-nav__js",mC="tox-collection__item",gC="tox-swatch",pC={normal:dC,color:gC},hC="tox-collection__item--enabled",vC="tox-collection__group-heading",bC="tox-collection__item-icon",yC="tox-collection__item-label",wC="tox-collection__item-accessory",xC="tox-collection__item-caret",CC="tox-collection__item-checkmark",SC="tox-collection__item--active",kC="tox-collection__item-icon-rtl",OC=function(t){return qt(pC,t).getOr(dC)},TC=tinymce.util.Tools.resolve("tinymce.Env"),EC=function(t){var n={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},r=TC.mac?n:e,o=t.split("+"),i=W(o,(function(t){var n=t.toLowerCase().trim();return bt(r,n)?r[n]:t}));return TC.mac?i.join(""):i.join("+")},DC={convertText:EC},AC=function(t){return{dom:{tag:"div",classes:[bC],innerHtml:t}}},_C=function(t){return{dom:{tag:"div",classes:[yC]},components:[uc(lC.translate(t))]}},RC=function(t){return{dom:{tag:"div",classes:[yC],innerHtml:t}}},BC=function(t,n){return{dom:{tag:"div",classes:[yC]},components:[{dom:{tag:t.tag,attributes:{style:t.styleAttr}},components:[uc(lC.translate(n))]}]}},IC=function(t){return{dom:{tag:"div",classes:[wC],innerHtml:DC.convertText(t)}}},PC=function(t){return{dom:{tag:"div",classes:[bC,CC],innerHtml:zw("checkmark",t)}}},NC=function(t){return{dom:{tag:"div",classes:[xC],innerHtml:zw("chevron-right",t)}}},MC=function(t){return{dom:{tag:"div",classes:[xC],innerHtml:zw("chevron-down",t)}}},FC=function(t,n,e,r){var o="custom",i="remove",u=function(){var u=gC,a=e.getOr(""),c=t.map((function(t){return' title="'+r.translate(t)+'"'})).getOr("");return fC(n===o?'<button class="'+u+' tox-swatches__picker-btn"'+c+">"+a+"</button>":n===i?'<div class="'+u+' tox-swatch--remove"'+c+">"+a+"</div>":'<div class="'+u+'" style="background-color: '+n+'" data-mce-color="'+n+'"'+c+"></div>")};return{dom:u(),optComponents:[]}},LC=function(t,n,e,r,o){var i=e?t.checkMark.orThunk((function(){return n.or(x.some("")).map(AC)})):x.none(),u=t.ariaLabel.map((function(t){return{attributes:{title:lC.translate(t)}}})).getOr({}),a=Tt({tag:"div",classes:[dC,mC].concat(o?[kC]:[])},u),c=t.htmlContent.fold((function(){return t.textContent.map(r)}),(function(t){return x.some(RC(t))})),s={dom:a,optComponents:[i,c,t.shortcutContent.map(IC),t.caret]};return s},HC=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],zC=["list-bull-circle","list-bull-default","list-bull-square"],VC=function(t,n,e,r){void 0===r&&(r=x.none());var o=function(t){return t.map((function(t){return lC.isRtl()&&z(HC,t)?t+"-rtl":t}))},i=lC.isRtl()&&t.iconContent.exists((function(t){return z(zC,t)})),u=o(t.iconContent).map((function(t){return Vw(t,n.icons,r)})),c=x.from(t.meta).fold((function(){return _C}),(function(t){return bt(t,"style")?a(BC,t.style):_C}));return"color"===t.presets?FC(t.ariaLabel,t.value,u,n):LC(t,u,e,c,i)},jC=["input","button","textarea","select"],UC=function(t,n,e){n.disabled&&JC(t,n)},WC=function(t,n){return!0===n.useNative&&z(jC,di(t.element()))},GC=function(t){return Cu(t.element(),"disabled")},qC=function(t){yu(t.element(),"disabled","disabled")},XC=function(t){Su(t.element(),"disabled")},YC=function(t){return"true"===xu(t.element(),"aria-disabled")},KC=function(t){yu(t.element(),"aria-disabled","true")},$C=function(t){yu(t.element(),"aria-disabled","false")},JC=function(t,n,e){n.disableClass.each((function(n){Ra(t.element(),n)}));var r=WC(t,n)?qC:KC;r(t),n.onDisabled(t)},QC=function(t,n,e){n.disableClass.each((function(n){Ia(t.element(),n)}));var r=WC(t,n)?XC:$C;r(t),n.onEnabled(t)},ZC=function(t,n){return WC(t,n)?GC(t):YC(t)},tS=function(t,n,e,r){var o=r?JC:QC;o(t,n,e)},nS=Object.freeze({enable:QC,disable:JC,isDisabled:ZC,onLoad:UC,set:tS}),eS=function(t,n,e){return oa({classes:n.disabled?n.disableClass.map(ot).getOr([]):[]})},rS=function(t,n){return ki([Oi(Fo(),(function(n,e){return ZC(n,t)})),af(t,n,UC)])},oS=Object.freeze({exhibit:eS,events:rS}),iS=[Ie("disabled",!1),Ie("useNative",!0),Oe("disableClass"),ys("onDisabled"),ys("onEnabled")],uS=pf({fields:iS,name:"disabling",active:oS,apis:nS}),aS=function(t){return uS.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},cS=function(t){return uS.config({disabled:t})},sS=function(t){return uS.config({disabled:t,disableClass:"tox-tbtn--disabled"})},fS=function(t){return uS.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},lS={item:aS,button:cS,splitButton:sS,toolbarButton:fS},dS=function(t,n){var e=t.getApi(n);return function(t){t(e)}},mS=function(t,n){return Li((function(e){var r=dS(t,e);r((function(e){var r=t.onSetup(e);null!==r&&void 0!==r&&n.set(r)}))}))},gS=function(t,n){return Hi((function(e){return dS(t,e)(n.get())}))};(function(t){t[t["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",t[t["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(Yw||(Yw={}));var pS=Yw,hS=function(t,n){return Vi((function(e,r){dS(t,e)(t.onAction),t.triggersSubmenu||n!==pS.CLOSE_ON_EXECUTE||(ii(e,jo()),r.stop())}))},vS={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},bS=function(t){return tt(t,(function(t){return t.toArray()}))},yS=function(t,n,r){var o=We(e);return{type:"item",dom:n.dom,components:bS(n.optComponents),data:t.data,eventOrder:vS,hasSubmenu:t.triggersSubmenu,itemBehaviours:mf([fy("item-events",[hS(t,r),mS(t,o),gS(t,o)]),lS.item(t.disabled),cy.config({})].concat(t.itemBehaviours))}},wS=function(t){return{value:t.value,meta:Tt({text:t.text.getOr("")},t.meta)}},xS=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),CS=function(t,n){return vt(t,"tooltipWorker").map((function(t){return[aC.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:dm}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){aC.setComponents(n,[ac({element:$e.fromDom(t)})])}))}})]})).getOr([])},SS=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},kS=function(t){return xS.DOM.encode(t)},OS=function(t,n){var e=lC.translate(t),r=kS(e);if(n.length>0){var o=new RegExp(SS(n),"gi");return r.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return r},TS=function(t,n,e,r,o,i,u,a){void 0===a&&(a=!0);var c=VC({presets:r,textContent:x.none(),htmlContent:e?t.text.map((function(t){return OS(t,n)})):x.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:x.none(),checkMark:x.none(),caret:x.none(),value:t.value},u.providers,a,t.icon);return yS({data:wS(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(n){return o(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:CS(t.meta,u)},c,i)},ES=function(t,n,e,r,o,i,u){var a=function(t){return{setActive:function(n){Ly.set(t,n)},isActive:function(){return Ly.isOn(t)},isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)}}},c=VC({presets:e,textContent:n?t.text:x.none(),htmlContent:x.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:x.none(),checkMark:n?x.some(PC(u.icons)):x.none(),caret:x.none(),value:t.value},u,!0);return Ot(yS({data:wS(t),disabled:t.disabled,getApi:a,onAction:function(n){return r(t.value)},onSetup:function(t){return t.setActive(o),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i),{toggling:{toggleClass:hC,toggleOnExecute:!1,selected:t.active}})},DS=i(Dp(Jy(),Qy())),AS=Bu("cell-over"),_S=Bu("cell-execute"),RS=function(t,n,e){var r,o=function(e){return ui(e,AS,{row:t,col:n})},i=function(e){return ui(e,_S,{row:t,col:n})};return sc({dom:{tag:"div",attributes:(r={role:"button"},r["aria-labelledby"]=e,r)},behaviours:mf([fy("insert-table-picker-cell",[Di(Co(),yy.focus),Di(Fo(),i),Di(zo(),(function(t,n){n.stop(),i(t)}))]),Ly.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),yy.config({onFocus:o})])})},BS=function(t,n,e){for(var r=[],o=0;o<n;o++){for(var i=[],u=0;u<e;u++)i.push(RS(o,u,t));r.push(i)}return r},IS=function(t,n,e,r,o){for(var i=0;i<r;i++)for(var u=0;u<o;u++)Ly.set(t[i][u],i<=n&&u<=e)},PS=function(t){return tt(t,(function(t){return W(t,fc)}))},NS=function(t,n){return uc(n+1+"x"+(t+1))};function MS(t){var n=10,e=10,r=Bu("size-label"),o=BS(r,n,e),i=Lw({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:r}},components:[uc("0x0")],behaviours:mf([cy.config({})])});return{type:"widget",data:{value:Bu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[DS().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:PS(o).concat(i.asSpec()),behaviours:mf([fy("insert-table-picker",[Pi(AS,(function(t,r,u){var a=u.event().row(),c=u.event().col();IS(o,a,c,n,e),cy.set(i.get(t),[NS(a,c)])})),Pi(_S,(function(n,e,r){t.onAction({numRows:r.event().row()+1,numColumns:r.event().col()+1}),ii(n,jo())}))]),Qb.config({initSize:{numRows:n,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}}var FS=function(t){return{value:i(t)}},LS=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,HS=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,zS=function(t){return LS.test(t)||HS.test(t)},VS=function(t){var n=t.value().replace(LS,(function(t,n,e,r){return n+n+e+e+r+r}));return{value:i(n)}},jS=function(t){var n=VS(t),e=HS.exec(n.value());return null===e?["FFFFFF","FF","FF","FF"]:e},US=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},WS=function(t){var n=US(t.red())+US(t.green())+US(t.blue());return FS(n)},GS=Math.min,qS=Math.max,XS=Math.round,YS=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,KS=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,$S=function(t,n,e,r){return{red:i(t),green:i(n),blue:i(e),alpha:i(r)}},JS=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},QS=function(t){var n,e,r,o=(t.hue()||0)%360,i=t.saturation()/100,u=t.value()/100;if(i=qS(0,GS(i,1)),u=qS(0,GS(u,1)),0===i)return n=e=r=XS(255*u),$S(n,e,r,1);var a=o/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,r=0;break;case 1:n=s,e=c,r=0;break;case 2:n=0,e=c,r=s;break;case 3:n=0,e=s,r=c;break;case 4:n=s,e=0,r=c;break;case 5:n=c,e=0,r=s;break;default:n=e=r=0}return n=XS(255*(n+f)),e=XS(255*(e+f)),r=XS(255*(r+f)),$S(n,e,r,1)},ZS=function(t){var n=jS(t),e=parseInt(n[1],16),r=parseInt(n[2],16),o=parseInt(n[3],16);return $S(e,r,o,1)},tk=function(t,n,e,r){var o=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(r);return $S(o,i,u,a)},nk=function(t){if("transparent"===t)return x.some($S(0,0,0,0));var n=YS.exec(t);if(null!==n)return x.some(tk(n[1],n[2],n[3],"1"));var e=KS.exec(t);return null!==e?x.some(tk(e[1],e[2],e[3],e[4])):x.none()},ek=function(t){return"rgba("+t.red()+","+t.green()+","+t.blue()+","+t.alpha()+")"},rk=i($S(255,0,0,1)),ok=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),ik="tinymce-custom-colors";function uk(t){void 0===t&&(t=10);var n=ok.getItem(ik),e=D(n)?JSON.parse(n):[],r=function(n){var e=t-n.length;return e<0?n.slice(0,t):n},o=r(e),i=function(n){H(o,n).each(u),o.unshift(n),o.length>t&&o.pop(),ok.setItem(ik,JSON.stringify(o))},u=function(t){o.splice(t,1)},a=function(){return o.slice(0)};return{add:i,state:a}}var ak="choiceitem",ck=[{type:ak,text:"Light Green",value:"#BFEDD2"},{type:ak,text:"Light Yellow",value:"#FBEEB8"},{type:ak,text:"Light Red",value:"#F8CAC6"},{type:ak,text:"Light Purple",value:"#ECCAFA"},{type:ak,text:"Light Blue",value:"#C2E0F4"},{type:ak,text:"Green",value:"#2DC26B"},{type:ak,text:"Yellow",value:"#F1C40F"},{type:ak,text:"Red",value:"#E03E2D"},{type:ak,text:"Purple",value:"#B96AD9"},{type:ak,text:"Blue",value:"#3598DB"},{type:ak,text:"Dark Turquoise",value:"#169179"},{type:ak,text:"Orange",value:"#E67E23"},{type:ak,text:"Dark Red",value:"#BA372A"},{type:ak,text:"Dark Purple",value:"#843FA1"},{type:ak,text:"Dark Blue",value:"#236FA1"},{type:ak,text:"Light Gray",value:"#ECF0F1"},{type:ak,text:"Medium Gray",value:"#CED4D9"},{type:ak,text:"Gray",value:"#95A5A6"},{type:ak,text:"Dark Gray",value:"#7E8C8D"},{type:ak,text:"Navy Blue",value:"#34495E"},{type:ak,text:"Black",value:"#000000"},{type:ak,text:"White",value:"#ffffff"}],sk=uk(10),fk=function(t){var e=[],r=n.document.createElement("canvas");r.height=1,r.width=1;for(var o=r.getContext("2d"),i=function(t,n){var e=255,r=n/255,o=Math.round(t*r+e*(1-r));return("0"+o.toString(16)).slice(-2).toUpperCase()},u=function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,r.width,r.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var n=o.getImageData(0,0,1,1).data,e=n[0],u=n[1],a=n[2],c=n[3];return"#"+i(e,c)+i(u,c)+i(a,c)},a=0;a<t.length;a+=2)e.push({text:t[a+1],value:u(t[a]),type:"choiceitem"});return e},lk=function(t,n){return t.getParam("color_cols",n,"number")},dk=function(t){return!1!==t.getParam("custom_colors")},mk=function(t){return t.getParam("color_map")},gk=function(t){var n=mk(t);return void 0!==n?fk(n):ck},pk=function(){return W(sk.state(),(function(t){return{type:ak,text:t,value:t}}))},hk=function(t){sk.add(t)},vk={mapColors:fk,getColorCols:lk,hasCustomColors:dk,getColorMap:mk,getColors:gk,getCurrentColors:pk,addColor:hk},bk=function(t){return t.fire("SkinLoaded")},yk=function(t){return t.fire("ResizeEditor")},wk=function(t){return t.fire("BeforeRenderUI")},xk=function(t,n){return t.fire("ResizeContent",n)},Ck=function(t,n){return t.fire("ScrollContent",n)},Sk=function(t,n){return t.fire("TextColorChange",n)},kk={fireSkinLoaded:bk,fireResizeEditor:yk,fireScrollContent:Ck,fireBeforeRenderUI:wk,fireResizeContent:xk,fireTextColorChange:Sk},Ok=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var r;(r=t.style["forecolor"===n?"color":"background-color"])&&(e=e||r)})),e},Tk=function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))},Ek=function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))},Dk=function(t){t.addCommand("mceApplyTextcolor",(function(n,e){Tk(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){Ek(t,n)}))},Ak=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},_k=function(t){var n=vk.getColors(t),e=Ak(n.length);return vk.getColorCols(t,e)},Rk=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},r={type:n,text:"Custom color",icon:"color-picker",value:"custom"};return t?[e,r]:[e]},Bk=function(t,n,e,r){if("custom"===e){var o=Lk(t);o((function(e){e.each((function(e){vk.addColor(e),t.execCommand("mceApplyTextcolor",n,e),r(e)}))}),"#000000")}else"remove"===e?(r(""),t.execCommand("mceRemoveTextcolor",n)):(r(e),t.execCommand("mceApplyTextcolor",n,e))},Ik=function(t,n){return t.concat(vk.getCurrentColors().concat(Rk(n)))},Pk=function(t,n){return function(e){e(Ik(t,n))}},Nk=function(t,n,e){var r=function(n,e){t.setIconFill(n,e),t.setIconStroke(n,e)},o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";r(o,e)},Mk=function(t,n,e,r,o){t.ui.registry.addSplitButton(n,{tooltip:r,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var r=x.from(Ok(t,e));return r.bind((function(t){return nk(t).map((function(t){var e=WS(t).value();return Pr(n.toLowerCase(),e)}))})).getOr(!1)},columns:_k(t),fetch:Pk(vk.getColors(t),vk.hasCustomColors(t)),onAction:function(n){null!==o.get()&&Bk(t,e,o.get(),(function(){}))},onItemAction:function(r,i){Bk(t,e,i,(function(e){o.set(e),kk.fireTextColorChange(t,{name:n,color:e})}))},onSetup:function(e){null!==o.get()&&Nk(e,n,o.get());var r=function(t){t.name===n&&Nk(e,t.name,t.color)};return t.on("TextColorChange",r),function(){t.off("TextColorChange",r)}}})},Fk=function(t,n,r,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){Bk(t,r,n.value,e)}}]}})},Lk=function(t){return function(n,e){var r=function(t){return function(n){var e=n.getData();t(x.from(e.colorpicker)),n.close()}},o=function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},i={colorpicker:e},u=r(n);t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:o,onSubmit:u,onClose:function(){},onCancel:function(){n(x.none())}})}},Hk=function(t){Dk(t);var n=We(null),e=We(null);Mk(t,"forecolor","forecolor","Text color",n),Mk(t,"backcolor","hilitecolor","Background color",e),Fk(t,"forecolor","forecolor","Text color"),Fk(t,"backcolor","hilitecolor","Background color")},zk={register:Hk,getColors:Ik,getFetch:Pk,colorPickerDialog:Lk,getCurrentColor:Ok,getColorCols:_k,calcCols:Ak},Vk=function(t,n){return function(e){var r=U(e,n);return W(r,(function(n){return{dom:t,components:n}}))}},jk=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[sw.parts().items({preprocess:"auto"!==t?Vk({tag:"div",classes:["tox-swatches__row"]},t):u})]}]}},Uk=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[sw.parts().items({preprocess:Vk({tag:"div",classes:["tox-collection__group"]},t)})]}},Wk=function(t,n){var e=[],r=[];return G(t,(function(t,o){n(t,o)?(r.length>0&&e.push(r),r=[],bt(t.dom,"innerHtml")&&r.push(t)):r.push(t)})),r.length>0&&e.push(r),W(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Gk=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[sw.parts().items({preprocess:function(e){return"auto"!==t&&t>1?Vk({tag:"div",classes:["tox-collection__group"]},t)(e):Wk(e,(function(t,e){return"separator"===n[e].type}))}})]}},qk=function(t,n){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[sw.parts().items({preprocess:function(n){return Wk(n,(function(n,e){return"separator"===t[e].type}))}})]}},Xk=function(t){return"color"===t?"tox-swatches":"tox-menu"},Yk=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Xk(t),tieredMenu:"tox-tiered-menu"}},Kk=function(t){var n=Yk(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:OC(t)}},$k=function(t,n,e){var r=Yk(e);return{tag:"div",classes:Z([[r.menu,"tox-menu-"+n+"-column"],t?[r.hasIcons]:[]])}},Jk=[sw.parts().items({})],Qk=function(t,n,e){var r=Yk(e),o={tag:"div",classes:Z([[r.tieredMenu]])};return{dom:o,markers:Kk(e)}},Zk=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},tO=function(t){return V(t,Zk)},nO=function(t){return n.console.error(ee(t)),n.console.log(t),x.none()},eO=function(t,n,e,r,o){var i=qk(e);return{value:t,dom:i.dom,components:i.components,items:e}},rO=function(t,n,e,r,o){if("color"===o){var i=jk(r);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===o&&"auto"===r){i=Gk(r,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===o&&1===r){i=Gk(1,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===o){i=Gk(r,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("listpreview"===o&&"auto"!==r){i=Uk(r);return{value:t,dom:i.dom,components:i.components,items:e}}return{value:t,dom:$k(n,r,o),components:Jk,items:e}},oO=function(t,n,e,r,o,i,u,a){var c=tO(n),s="color"!==o?"normal":"color",f=iO(n,e,r,s,i,u,a);return rO(t,c,f,r,o)},iO=function(t,n,e,r,o,i,u){return Jc(W(t,(function(t){return"choiceitem"===t.type?jx(t).fold(nO,(function(a){return x.some(ES(a,1===e,r,n,i(t.value),o,u))})):x.none()})))},uO=function(t,n){var e=Kk(n);if(1===t)return{mode:"menu",moveOnTab:!0};if("auto"===t)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var r="color"===n?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+r}},aO=function(t,n){return 1===t?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===n?".tox-swatches__row":".tox-collection__group",cell:"color"===n?"."+gC:"."+mC}}};function cO(t,n){var e=zk.getColors(n.colorinput.getColors(),n.colorinput.hasCustomColors()),r=n.colorinput.getColorCols(),o="color",i=oO(Bu("menu-value"),e,(function(n){t.onAction({value:n})}),r,o,pS.CLOSE_ON_EXECUTE,(function(){return!1}),n.shared.providers),u=Ot(m(m({},i),{markers:Kk(o),movement:uO(r,o)}));return{type:"widget",data:{value:Bu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[DS().widget(sw.sketch(u))]}}var sO,fO={inserttable:MS,colorswatch:cO},lO=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)?x.some(t[n]):x.none()},dO=function(t,n){return lO(fO,t.fancytype).map((function(e){return e(t,n)}))},mO=function(t,n,e,r){void 0===r&&(r=!0);var o=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)}}},i=VC({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:x.none(),ariaLabel:t.text,caret:x.none(),checkMark:x.none(),shortcutContent:t.shortcut},e,r);return yS({data:wS(t),getApi:o,disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n)},gO=function(t,n,r,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var u=i?MC(r.icons):NC(r.icons),a=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)}}},c=VC({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:x.none(),ariaLabel:t.text,caret:x.some(u),checkMark:x.none(),shortcutContent:t.shortcut},r,o);return yS({data:wS(t),getApi:a,disabled:t.disabled,onAction:e,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,n)},pO=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:m({tag:"div",classes:[mC,vC]},n),components:[]}},hO=function(t,n,e){var r=function(t){return{setActive:function(n){Ly.set(t,n)},isActive:function(){return Ly.isOn(t)},isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)}}},o=VC({iconContent:x.none(),textContent:t.text,htmlContent:x.none(),ariaLabel:t.text,checkMark:x.some(PC(e.icons)),caret:x.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,!0);return Ot(yS({data:wS(t),disabled:t.disabled,getApi:r,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n),{toggling:{toggleClass:hC,toggleOnExecute:!1,selected:t.active}})},vO=TS,bO=pO,yO=mO,wO=gO,xO=hO,CO=dO;(function(t){t[t["ContentFocus"]=0]="ContentFocus",t[t["UiFocus"]=1]="UiFocus"})(sO||(sO={}));var SO=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},kO=function(t){return V(t,SO)},OO=function(t,e,r,o,i){var u=r.shared.providers,a=function(t){return i?m(m({},t),{shortcut:x.none(),icon:t.text.isSome()?x.none():t.icon}):t};switch(t.type){case"menuitem":return Mx(t).fold(nO,(function(t){return x.some(yO(a(t),e,u,o))}));case"nestedmenuitem":return Lx(t).fold(nO,(function(t){return x.some(wO(a(t),e,u,o,i))}));case"togglemenuitem":return zx(t).fold(nO,(function(t){return x.some(xO(a(t),e,u))}));case"separator":return Tx(t).fold(nO,(function(t){return x.some(bO(t))}));case"fancymenuitem":return Gx(t).fold(nO,(function(t){return CO(a(t),r)}));default:return n.console.error("Unknown item in general menu",t),x.none()}},TO=function(t,n,e,r,o,i){var u=1===r,a=!u||kO(t);return Jc(W(t,(function(t){return"separator"===t.type?Ax(t).fold(nO,(function(t){return x.some(bO(t))})):_x(t).fold(nO,(function(t){return x.some(vO(t,n,u,"normal",e,o,i,a))}))})))},EO=function(t,n,e,r,o){var i=kO(n),u=Jc(W(n,(function(t){var n=function(t){return o?!t.hasOwnProperty("text"):i},u=function(t){return OO(t,e,r,n(t),o)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?u(Tt(t,{disabled:!0})):u(t)}))),a=o?eO:rO;return a(t,i,u,1,"normal")},DO=function(t){return xw.singleData(t.value,t)},AO=function(t,n,e,r){var o=e===sO.ContentFocus?Yh():Xh(),i=uO(n,r),u=Kk(r);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===sO.ContentFocus,focusManager:o,menuBehaviours:Kx.unnamedEvents("auto"!==n?[]:[Li((function(t,n){qx(t,4,u.item).each((function(n){var e=n.numColumns,r=n.numRows;Qb.setGridSize(t,r,e)}))}))])}},_O=function(t,e){var r=We(x.none()),o=We(!1),i=sc(kw.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:mf([fy("dismissAutocompleter",[Di(Jo(),(function(){return s()}))])]),lazySink:e.getSink})),u=function(){return kw.isOpen(i)},a=function(){return r.get().isSome()},c=function(){a()&&kw.hide(i)},s=function(){if(a()){var n=r.get().map((function(t){return t.element}));ux(n.getOr($e.fromDom(t.selection.getNode()))).each(gu),c(),r.set(x.none()),o.set(!1)}},f=Et((function(){return Ix(t)})),l=function(r,i){var u=Zc(i,(function(t){return x.from(t.columns)})).getOr(1);return tt(i,(function(i){var a=i.items;return TO(a,i.matchText,(function(e,u){var a=t.selection.getRng();dx(t.dom,a,r).fold((function(){return n.console.error("Lost context. Cursor probably moved")}),(function(t){var n=t.range,r={hide:function(){s()},reload:function(t){c(),p(t)}};o.set(!0),i.onAction(r,n,e,u),o.set(!1)}))}),u,pS.BUBBLE_TO_SANDBOX,e)}))},d=function(n){if(!a()){var e=ix(t,n.range);r.set(x.some({triggerChar:n.triggerChar,element:e,matchLength:n.text.length})),o.set(!1)}},m=function(n,e,r,o){n.matchLength=e.text.length;var u=Zc(r,(function(t){return x.from(t.columns)})).getOr(1);kw.showAt(i,{anchor:"node",root:$e.fromDom(t.getBody()),node:x.from(n.element)},sw.sketch(AO(rO("autocompleter-value",!0,o,u,"normal"),u,sO.ContentFocus,"normal"))),kw.getContent(i).each(Oh.highlightFirst)},g=function(n){return r.get().map((function(e){return dx(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return kx(t,f,e,n)}))})).getOrThunk((function(){return Sx(t,f)}))},p=function(t){g(t).fold(s,(function(t){d(t.context),t.lookupData.then((function(n){r.get().map((function(e){var r=t.context;if(e.triggerChar===r.triggerChar){var o=l(r.triggerChar,n);o.length>0?m(e,r,n,o):r.text.length-e.matchLength>=10?s():c()}}))}))}))},h=$w((function(t){27!==t.which&&p()}),50),v={onKeypress:h,cancelIfNecessary:s,isMenuOpen:u,isActive:a,isProcessingAction:o.get,getView:function(){return kw.getContent(i)}};gx.setup(v,t)},RO={register:_O},BO=function(t,n,e,r,o,u,a){return{target:i(t),x:i(n),y:i(e),stop:r,prevent:o,kill:u,raw:i(a)}},IO=function(t){var n=$e.fromDom(t.target),e=function(){t.stopPropagation()},r=function(){t.preventDefault()},i=o(r,e);return BO(n,t.clientX,t.clientY,e,r,i,t)},PO=function(t,n){return function(e){t(e)&&n(IO(e))}},NO=function(t,n,e,r,o){var i=PO(e,r);return t.dom().addEventListener(n,i,o),{unbind:a(LO,t,n,i,o)}},MO=function(t,n,e,r){return NO(t,n,e,r,!1)},FO=function(t,n,e,r){return NO(t,n,e,r,!0)},LO=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},HO=i(!0),zO=function(t,n,e){return MO(t,n,HO,e)},VO=function(t,n,e){return FO(t,n,HO,e)},jO=IO,UO=function(t,n,e){return qc(t,n,e).isSome()};function WO(t,e){var r=null,o=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r=n.setTimeout((function(){t.apply(null,o),r=null}),e)},i=function(){null!==r&&(n.clearTimeout(r),r=null)};return{cancel:i,schedule:o}}var GO=5,qO=400,XO=function(t){var n=t.raw();return void 0===n.touches||1!==n.touches.length?x.none():x.some(n.touches[0])},YO=function(t,n){var e=Math.abs(t.clientX-n.x()),r=Math.abs(t.clientY-n.y());return e>GO||r>GO},KO=function(t){var n=We(x.none()),e=We(!1),r=WO((function(n){t.triggerEvent(Vo(),n),e.set(!0)}),qO),o=function(t){return XO(t).each((function(o){r.cancel();var u={x:i(o.clientX),y:i(o.clientY),target:t.target};r.schedule(t),e.set(!1),n.set(x.some(u))})),x.none()},u=function(t){return r.cancel(),XO(t).each((function(t){n.get().each((function(e){YO(t,e)&&n.set(x.none())}))})),x.none()},a=function(o){r.cancel();var i=function(t){return eo(t.target(),o.target())};return n.get().filter(i).map((function(n){return e.get()?(o.prevent(),!1):t.triggerEvent(Ho(),o)}))},c=Yt([{key:go(),value:o},{key:po(),value:u},{key:ho(),value:a}]),s=function(t,n){return qt(c,n).bind((function(n){return n(t)}))};return{fireIfReady:s}},$O=function(t){var n=t.raw();return n.which===Th()[0]&&!z(["input","textarea"],di(t.target()))&&!UO(t.target(),'[contenteditable="true"]')},JO=qr().browser.isFirefox(),QO=Mn([we("triggerEvent"),Ie("stopBackspace",!0)]),ZO=function(t,n){return JO?VO(t,"focus",n):zO(t,"focusin",n)},tT=function(t,n){return JO?VO(t,"blur",n):zO(t,"focusout",n)},nT=function(t,e){var r=ne("Getting GUI events settings",QO,e),o=qr().deviceType.isTouch()?["touchstart","touchmove","touchend","touchcancel","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],i=KO(r),u=W(o.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return zO(t,n,(function(t){i.fireIfReady(t,n).each((function(n){n&&t.kill()}));var e=r.triggerEvent(n,t);e&&t.kill()}))})),a=We(x.none()),c=zO(t,"paste",(function(t){i.fireIfReady(t,"paste").each((function(n){n&&t.kill()}));var e=r.triggerEvent("paste",t);e&&t.kill(),a.set(x.some(n.setTimeout((function(){r.triggerEvent(No(),t)}),0)))})),s=zO(t,"keydown",(function(t){var n=r.triggerEvent("keydown",t);n?t.kill():!0===r.stopBackspace&&$O(t)&&t.prevent()})),f=ZO(t,(function(t){var n=r.triggerEvent("focusin",t);n&&t.kill()})),l=We(x.none()),d=tT(t,(function(t){var e=r.triggerEvent("focusout",t);e&&t.kill(),l.set(x.some(n.setTimeout((function(){r.triggerEvent(Po(),t)}),0)))})),m=function(){G(u,(function(t){t.unbind()})),s.unbind(),f.unbind(),d.unbind(),c.unbind(),a.get().each(n.clearTimeout),l.get().each(n.clearTimeout)};return{unbind:m}},eT=function(t,n){var e=qt(t,"target").map((function(t){return t()})).getOr(n);return We(e)},rT=function(t,n){var e=We(!1),r=We(!1),o=function(){e.set(!0)},u=function(){r.set(!0)};return{stop:o,cut:u,isStopped:e.get,isCut:r.get,event:i(t),setSource:n.set,getSource:n.get}},oT=function(t){var n=We(!1),r=function(){n.set(!0)};return{stop:r,cut:e,isStopped:n.get,isCut:i(!1),event:i(t),setSource:s("Cannot set source of a broadcasted event"),getSource:s("Cannot get source of a broadcasted event")}},iT=wt.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),uT=function(t,n,e,r,o,i){var u=t(n,r),a=rT(e,o);return u.fold((function(){return i.logEventNoHandlers(n,r),iT.complete()}),(function(t){var e=t.descHandler(),r=la(e);return r(a),a.isStopped()?(i.logEventStopped(n,t.element(),e.purpose()),iT.stopped()):a.isCut()?(i.logEventCut(n,t.element(),e.purpose()),iT.complete()):Qi(t.element()).fold((function(){return i.logNoParent(n,t.element(),e.purpose()),iT.complete()}),(function(r){return i.logEventResponse(n,t.element(),e.purpose()),iT.resume(r)}))}))},aT=function(t,n,e,r,o,i){return uT(t,n,e,r,o,i).fold((function(){return!0}),(function(r){return aT(t,n,e,r,o,i)}),(function(){return!1}))},cT=function(t,n,e,r,o){var i=eT(e,r);return uT(t,n,e,r,i,o)},sT=function(t,n,e){var r=oT(n);return G(t,(function(t){var n=t.descHandler(),e=la(n);e(r)})),r.isStopped()},fT=function(t,n,e,r){var o=e.target();return lT(t,n,e,o,r)},lT=function(t,n,e,r,o){var i=eT(e,r);return aT(t,n,e,r,i,o)},dT=ji("element","descHandler"),mT=function(t,n){return{id:i(t),descHandler:i(n)}};function gT(){var t={},n=function(n,e,r){lt(r,(function(r,o){var i=void 0!==t[o]?t[o]:{};i[e]=fa(r,n),t[o]=i}))},e=function(t,n){return Hu(n).fold((function(){return x.none()}),(function(e){var r=Wt(e);return t.bind(r).map((function(t){return dT(n,t)}))}))},r=function(n){return qt(t,n).map((function(t){return gt(t,(function(t,n){return mT(n,t)}))})).getOr([])},o=function(n,r,o){var i=Wt(r),u=i(t);return Si(o,(function(t){return e(u,t)}),n)},i=function(n){lt(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))};return{registerId:n,unregisterId:i,filterByType:r,find:o}}function pT(){var t=gT(),n={},e=function(t){var n=t.element();return Hu(n).fold((function(){return Fu("uid-",t.element())}),(function(t){return t}))},r=function(t,e){var r=n[e];if(r!==t)throw new Error('The tagId "'+e+'" is already used by: '+Eu(r.element())+"\nCannot use it for: "+Eu(t.element())+"\nThe conflicting element is"+(vi(r.element())?" ":" not ")+"already in the DOM");i(t)},o=function(o){var i=e(o);Qt(n,i)&&r(o,i);var u=[o];t.registerId(u,i,o.events()),n[i]=o},i=function(e){Hu(e.element()).each((function(e){delete n[e],t.unregisterId(e)}))},u=function(n){return t.filterByType(n)},a=function(n,e,r){return t.find(n,e,r)},c=function(t){return Wt(t)(n)};return{find:a,filter:u,register:o,unregister:i,getById:c}}var hT,vT=function(t){var n=t.dom,e=n.attributes,r=g(n,["attributes"]);return{uid:t.uid,dom:m({tag:"div",attributes:m({role:"presentation"},e)},r),components:t.components,behaviours:Wg(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},bT=Zp({name:"Container",factory:vT,configFields:[Ie("components",[]),Ug("containerBehaviours",[]),Ie("events",{}),Ie("domModification",{}),Ie("eventOrder",{})]}),yT=function(t){var n=function(n){return Qi(t.element()).fold((function(){return!0}),(function(t){return eo(n,t)}))},r=pT(),o=function(t,e){return r.find(n,t,e)},u=nT(t.element(),{triggerEvent:function(t,n){return ss(t,n.target(),(function(e){return fT(o,t,n,e)}))}}),a={debugInfo:i("real"),triggerEvent:function(t,n,e){ss(t,n,(function(r){lT(o,t,e,n,r)}))},triggerFocus:function(t,n){Hu(t).fold((function(){Tf(t)}),(function(r){ss(Io(),t,(function(r){cT(o,Io(),{originator:i(n),kill:e,prevent:e,target:i(t)},t,r)}))}))},triggerEscape:function(t,n){a.triggerEvent("keydown",t.element(),n.event())},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:sc,addToGui:function(t){f(t)},removeFromGui:function(t){l(t)},addToWorld:function(t){c(t)},removeFromWorld:function(t){s(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:i(!0)},c=function(t){t.connect(a),hi(t.element())||(r.register(t),G(t.components(),c),a.triggerEvent(Wo(),t.element(),{target:i(t.element())}))},s=function(t){hi(t.element())||(G(t.components(),s),r.unregister(t)),t.disconnect()},f=function(n){Bm(t,n)},l=function(t){Nm(t)},d=function(){u.unbind(),mu(t.element())},m=function(t){var n=r.filter(Mo());G(n,(function(n){var e=n.descHandler(),r=la(e);r(t)}))},g=function(t){m({universal:i(!0),data:i(t)})},p=function(t,n){m({universal:i(!1),channels:i(t),data:i(n)})},h=function(t,n){var e=r.filter(t);return sT(e,n)},v=function(t){return r.getById(t).fold((function(){return O.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),O.value)},b=function(t){var n=Hu(t).getOr("not found");return v(n)};return c(t),{root:i(t),element:t.element,destroy:d,add:f,remove:l,getByUid:v,getByDom:b,addToWorld:c,removeFromWorld:s,broadcast:g,broadcastOn:p,broadcastEvent:h}},wT=tinymce.util.Tools.resolve("tinymce.EditorManager"),xT=function(t){var n=t.settings,e=n.skin,r=n.skin_url;if(!1!==e){var o=e||"oxide";r=r?t.documentBaseURI.toAbsolute(r):wT.baseURL+"/skins/ui/"+o}return r},CT=function(t){return t.getParam("readonly",!1,"boolean")},ST=function(t){return!1===t.getParam("skin")},kT=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},OT=function(t){return t.getParam("width",xS.DOM.getStyle(t.getElement(),"width"))},TT=function(t){return x.from(t.settings.min_width).filter(I)},ET=function(t){return x.from(t.settings.min_height).filter(I)},DT=function(t){return x.from(t.getParam("max_width")).filter(I)},AT=function(t){return x.from(t.getParam("max_height")).filter(I)},_T=function(t){return x.from(t.getParam("style_formats")).filter(_)},RT=function(t){return t.getParam("style_formats_merge",!1,"boolean")},BT=function(t){return t.getParam("removed_menuitems","")},IT=function(t){return!1!==t.getParam("menubar",!0,"boolean")},PT=function(t){var n=t.getParam("toolbar",!0),e=!0===n,r=D(n),o=_(n)&&n.length>0;return!MT(t)&&(o||r||e)},NT=function(t){var n=st(t.settings),e=Y(n,(function(t){return/^toolbar([1-9])$/.test(t)})),r=W(e,(function(n){return t.getParam(n,!1,"string")})),o=Y(r,(function(t){return"string"===typeof t}));return o.length>0?x.some(o):x.none()},MT=function(t){return NT(t).fold((function(){var n=t.getParam("toolbar",[],"string[]");return n.length>0}),(function(){return!0}))};(function(t){t["default"]="",t["floating"]="floating",t["sliding"]="sliding",t["scrolling"]="scrolling"})(hT||(hT={}));var FT=function(t){return t.getParam("toolbar_drawer","","string")},LT=function(t){return t.getParam("fixed_toolbar_container","","string")},HT=function(t){var n=LT(t);return n.length>0&&t.inline?Gc(bi(),n):x.none()},zT=function(t){return t.inline&&HT(t).isSome()},VT=function(t){var n=HT(t);return n.getOr(bi())},jT=function(t){return t.inline&&!IT(t)&&!PT(t)&&!MT(t)},UT=function(t){var n=t.getParam("toolbar_sticky",!1,"boolean");return(n||t.inline)&&!zT(t)&&!jT(t)},WT=function(t){return t.getParam("draggable_modal",!1,"boolean")},GT=5,qT=400,XT=function(t){return void 0===t.touches||1!==t.touches.length?x.none():x.some(t.touches[0])},YT=function(t,n){var e=Math.abs(t.clientX-n.x()),r=Math.abs(t.clientY-n.y());return e>GT||r>GT},KT=function(t){var n=We(x.none()),e=We(!1),r=$w((function(n){t.fire("longpress",m(m({},n),{type:"longpress"})),e.set(!0)}),qT);t.on("touchstart",(function(t){XT(t).each((function(o){r.cancel();var u={x:i(o.clientX),y:i(o.clientY),target:i(t.target)};r.throttle(t),e.set(!1),n.set(x.some(u))}))}),!0),t.on("touchmove",(function(o){r.cancel(),XT(o).each((function(r){n.get().each((function(o){YT(r,o)&&(n.set(x.none()),e.set(!1),t.fire("longpresscancel"))}))}))}),!0),t.on("touchend touchcancel",(function(o){r.cancel(),"touchcancel"!==o.type&&n.get().filter((function(t){return t.target().isEqualNode(o.target)})).each((function(){if(e.get())o.preventDefault();else{var n=t.fire("tap");n.isDefaultPrevented()&&o.preventDefault()}}))}),!0)},$T={setup:KT},JT=Bu("form-component-change"),QT=Bu("form-close"),ZT=Bu("form-cancel"),tE=Bu("form-action"),nE=Bu("form-submit"),eE=Bu("form-block"),rE=Bu("form-unblock"),oE=Bu("form-tabchange"),iE=Bu("form-resize"),uE=function(t,n){return bT.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Fw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:zw(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){ui(n,tE,{name:"alert-banner",value:t.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})},aE=function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(t.items,n.interpreter)}},cE=i([Ie("prefix","form-field"),Ug("fieldBehaviours",[ih,jg])]),sE=i([Cp({schema:[ge("dom")],name:"label"}),Cp({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[ge("text")],name:"aria-descriptor"}),wp({factory:{sketch:function(t){var n=Ut(t,["factory"]);return t.factory.sketch(n)}},schema:[ge("factory")],name:"field"})]),fE=function(t,n,e,r){var o=Gg(t.fieldBehaviours,[ih.config({find:function(n){return Np(n,t,"field")}}),jg.config({store:{mode:"manual",getValue:function(t){return ih.getCurrent(t).bind(jg.getValue)},setValue:function(t,n){ih.getCurrent(t).each((function(t){jg.setValue(t,n)}))}}})]),i=ki([Li((function(n,e){var r=Fp(n,t,["label","field","aria-descriptor"]);r.field().each((function(n){var e=Bu(t.prefix);r.label().each((function(t){yu(t.element(),"for",e),yu(n.element(),"id",e)})),r["aria-descriptor"]().each((function(e){var r=Bu(t.prefix);yu(e.element(),"id",r),yu(n.element(),"aria-describedby",r)}))}))}))]),u={getField:function(n){return Np(n,t,"field")},getLabel:function(n){return Np(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:o,events:i,apis:u}},lE=th({name:"FormField",configFields:cE(),partFields:sE(),factory:fE,apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),dE=i([Oe("data"),Ie("inputAttributes",{}),Ie("inputStyles",{}),Ie("tag","input"),Ie("inputClasses",[]),ys("onSetValue"),Ie("styles",{}),Ie("eventOrder",{}),Ug("inputBehaviours",[jg,yy]),Ie("selectOnFocus",!0)]),mE=function(t){return mf([yy.config({onFocus:!1===t.selectOnFocus?e:function(t){var n=t.element(),e=Ka(n);n.dom().setSelectionRange(0,e.length)}})])},gE=function(t){return m(m({},mE(t)),Gg(t.inputBehaviours,[jg.config({store:{mode:"manual",initialValue:t.data.getOr(void 0),getValue:function(t){return Ka(t.element())},setValue:function(t,n){var e=Ka(t.element());e!==n&&$a(t.element(),n)}},onSetValue:t.onSetValue})]))},pE=function(t){return{tag:t.tag,attributes:m({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},hE=function(t,n){return{uid:t.uid,dom:pE(t),components:[],behaviours:gE(t),eventOrder:t.eventOrder}},vE=Zp({name:"Input",configFields:dE(),factory:hE}),bE={},yE={exports:bE};(function(n,e,r,o){(function(o){if("object"===typeof e&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof n&&n.amd)n([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(n,e,r){function i(a,c){if(!e[a]){if(!n[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};n[a][0].call(l.exports,(function(t){var e=n[a][1][t];return i(e||t)}),l,l.exports,t,n,e,r)}return e[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,n,e){var r,o,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var t=c(g);d=!0;var n=l.length;while(n){f=l,l=[];while(++m<n)f&&f[m].run();m=-1,n=l.length}f=null,d=!1,s(t)}}function h(t,n){this.fun=t,this.array=n}function v(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new h(t,n)),1!==l.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){(function(e){var r=setTimeout;function o(){}function i(t,n){return function(){t.apply(n,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,n){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(o){return void s(n.promise,o)}c(n.promise,r)}else(1===t._state?c:s)(n.promise,t._value)}))):t._deferreds.push(n)}function c(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void f(t);if("function"===typeof e)return void d(i(e,n),t)}t._state=1,t._value=n,f(t)}catch(r){s(t,r)}}function s(t,n){t._state=2,t._value=n,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)a(t,t._deferreds[n]);t._deferreds=null}function l(t,n,e){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof n?n:null,this.promise=e}function d(t,n){var e=!1;try{t((function(t){e||(e=!0,c(n,t))}),(function(t){e||(e=!0,s(n,t))}))}catch(r){if(e)return;e=!0,s(n,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,n){var e=new this.constructor(o);return a(this,new l(t,n,e)),e},u.all=function(t){var n=Array.prototype.slice.call(t);return new u((function(t,e){if(0===n.length)return t([]);var r=n.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),e)}n[i]=u,0===--r&&t(n)}catch(c){e(c)}}for(var i=0;i<n.length;i++)o(i,n[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(n){n(t)}))},u.reject=function(t){return new u((function(n,e){e(t)}))},u.race=function(t){return new u((function(n,e){for(var r=0,o=t.length;r<o;r++)t[r].then(n,e)}))},u._immediateFn="function"===typeof t?function(n){t(n)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof n&&n.exports?n.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"===typeof n?n:function(t){var n=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,o((function(){a[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();n.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,bE,yE,void 0);var wE,xE=yE.exports.boltExport,CE=function(t){var e=x.none(),r=[],o=function(t){return CE((function(n){i((function(e){n(t(e))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){e=x.some(t),c(r),r=[]},a=function(){return e.isSome()},c=function(t){G(t,s)},s=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t(u),{get:i,map:o,isReady:a}},SE=function(t){return CE((function(n){n(t)}))},kE={nu:CE,pure:SE},OE=function(t){n.setTimeout((function(){throw t}),0)},TE=function(t){var n=function(n){t().then(n,OE)},e=function(n){return TE((function(){return t().then(n)}))},r=function(n){return TE((function(){return t().then((function(t){return n(t).toPromise()}))}))},o=function(n){return TE((function(){return t().then((function(){return n.toPromise()}))}))},i=function(){return kE.nu(n)},u=function(){var n=null;return TE((function(){return null===n&&(n=t()),n}))},a=t;return{map:e,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:n}},EE=function(t){return TE((function(){return new xE(t)}))},DE=function(t){return TE((function(){return xE.resolve(t)}))},AE={nu:EE,pure:DE},_E=["input","textarea"],RE=function(t){var n=di(t);return z(_E,n)},BE=function(t,n){var e=n.getRoot(t).getOr(t.element());Ia(e,n.invalidClass),n.notify.each((function(n){RE(t.element())&&yu(t.element(),"aria-invalid",!1),n.getContainer(t).each((function(t){hu(t,n.validHtml)})),n.onValid(t)}))},IE=function(t,n,e,r){var o=n.getRoot(t).getOr(t.element());Ra(o,n.invalidClass),n.notify.each((function(n){RE(t.element())&&yu(t.element(),"aria-invalid",!0),n.getContainer(t).each((function(t){hu(t,r)})),n.onInvalid(t,r)}))},PE=function(t,n,e){return n.validator.fold((function(){return AE.pure(O.value(!0))}),(function(n){return n.validate(t)}))},NE=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),PE(t,n).map((function(r){return t.getSystem().isConnected()?r.fold((function(r){return IE(t,n,e,r),O.error(r)}),(function(e){return BE(t,n),O.value(e)})):O.error("No longer in system")}))},ME=function(t,n){var e=n.getRoot(t).getOr(t.element());return Pa(e,n.invalidClass)},FE=Object.freeze({markValid:BE,markInvalid:IE,query:PE,run:NE,isInvalid:ME}),LE=function(t,n){return t.validator.map((function(r){return ki([Di(r.onEvent,(function(e){NE(e,t,n).get(u)}))].concat(r.validateOnLoad?[Li((function(r){NE(r,t,n).get(e)}))]:[]))})).getOr({})},HE=Object.freeze({events:LE}),zE=[ge("invalidClass"),Ie("getRoot",x.none),Re("notify",[Ie("aria","alert"),Ie("getContainer",x.none),Ie("validHtml",""),ys("onValid"),ys("onInvalid"),ys("onValidate")]),Re("validator",[ge("validate"),Ie("onEvent","input"),Ie("validateOnLoad",!0)])],VE=pf({fields:zE,name:"invalidating",active:HE,apis:FE,extra:{validation:function(t){return function(n){var e=jg.getValue(n);return AE.pure(t(e))}}}}),jE=function(t,n){return oa({attributes:Yt([{key:n.tabAttr,value:"true"}])})},UE=Object.freeze({exhibit:jE}),WE=[Ie("tabAttr","data-alloy-tabstop")],GE=pf({fields:WE,name:"tabstopping",active:UE}),qE=function(t,n,e,r){var o=YE(t,n,e,r);return lE.sketch(o)},XE=function(t,n){return qE(t,n,[],[])},YE=function(t,n,e,r){return{dom:$E(e),components:t.toArray().concat([n]),fieldBehaviours:mf(r)}},KE=function(){return $E([])},$E=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},JE=function(t,n){return lE.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},QE=function(t,n,e,r){return e.getOrCreate(t,n,r)},ZE=Object.freeze({getCoupled:QE}),tD=[pe("others",Jn(O.value,ie()))],nD=function(t){var n={},e=function(t,e,r){var o=st(e.others);if(o)return qt(n,r).getOrThunk((function(){var o=qt(e.others,r).getOrDie("No information found for coupled component: "+r),i=o(t),u=t.getSystem().build(i);return n[r]=u,u}));throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(o,null,2))},r=i({});return Zu({readState:r,getOrCreate:e})},eD=Object.freeze({init:nD}),rD=pf({fields:tD,name:"coupling",apis:ZE,state:eD}),oD=i("sink"),iD=i(Cp({name:oD(),overrides:i({dom:{tag:"div"},behaviours:mf([Tm.config({useFixed:l})]),events:ki([Ni(Oo()),Ni(bo()),Ni(Ao())])})}));(function(t){t[t["HighlightFirst"]=0]="HighlightFirst",t[t["HighlightNone"]=1]="HighlightNone"})(wE||(wE={}));var uD=function(t,n){var e=t.getHotspot(n).getOr(n),r="hotspot",o=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:r,hotspot:e,overrides:o}}),(function(t){return{anchor:r,hotspot:e,overrides:o,layouts:t}}))},aD=function(t,n,e){var r=t.fetch;return r(e).map(n)},cD=function(t,n,e,r,o,i,u){var a=aD(t,n,r),c=mD(r,t);return a.map((function(t){return t.bind((function(t){return x.from(xw.sketch(m(m({},i.menu()),{uid:zu(""),data:t,highlightImmediately:u===wE.HighlightFirst,onOpenMenu:function(t,n){var r=c().getOrDie();Tm.position(r,e,n),ug.decloak(o)},onOpenSubmenu:function(t,n,e){var r=c().getOrDie();Tm.position(r,{anchor:"submenu",item:n},e),ug.decloak(o)},onRepositionMenu:function(t,n,r){var o=c().getOrDie();Tm.position(o,e,n),G(r,(function(t){Tm.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return yy.focus(r),ug.close(o),x.some(!0)}})))}))}))},sD=function(t,n,e,r,o,i,u){var a=uD(t,e),c=cD(t,n,a,e,r,o,u);return c.map((function(t){return t.fold((function(){ug.isOpen(r)&&ug.close(r)}),(function(t){ug.cloak(r),ug.open(r,t),i(r)})),r}))},fD=function(t,n,e,r,o,i,u){return ug.close(r),AE.pure(r)},lD=function(t,n,e,r,o,i){var u=rD.getCoupled(e,"sandbox"),a=ug.isOpen(u),c=a?fD:sD;return c(t,n,e,u,r,o,i)},dD=function(t,n,e){var r=ih.getCurrent(n).getOr(n),o=Oc(t.element());e?za(r.element(),"min-width",o+"px"):kc(r.element(),o)},mD=function(t,n){return t.getSystem().getByUid(n.uid+"-"+oD()).map((function(t){return function(){return O.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return O.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},gD=function(t){ug.getState(t).each((function(t){xw.repositionMenus(t)}))},pD=function(t,n,e){var r=Yc(),o=function(o,i){var u=uD(t,n);r.link(n.element()),t.matchWidth&&dD(u.hotspot,i,t.useMinWidth),t.onOpen(u,o,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(o,i)},u=function(t,o){r.unlink(n.element()),void 0!==e&&void 0!==e.onClose&&e.onClose(t,o)},a=mD(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:r.id(),role:"listbox"}},behaviours:qg.augment(t.sandboxBehaviours,[jg.config({store:{mode:"memory",initialValue:n}}),ug.config({onOpen:o,onClose:u,isPartOf:function(t,e,r){return $c(e,r)||$c(n,r)},getAttachPoint:function(){return a().getOrDie()}}),ih.config({find:function(t){return ug.getState(t).bind((function(t){return ih.getCurrent(t)}))}}),Sf.config({channels:m(m({},lg({isExtraPart:i(!1)})),mg({isExtraPart:i(!1),doReposition:gD}))})])}},hD=function(t){var n=rD.getCoupled(t,"sandbox");gD(n)},vD=function(){return[Ie("sandboxClasses",[]),qg.field("sandboxBehaviours",[ih,Sf,ug,jg])]},bD=i([ge("dom"),ge("fetch"),ys("onOpen"),ws("onExecute"),Ie("getHotspot",x.some),Ie("getAnchorOverrides",i({})),Ie("layouts",x.none()),Ug("dropdownBehaviours",[Ly,rD,Qb,yy]),ge("toggleClass"),Ie("eventOrder",{}),Oe("lazySink"),Ie("matchWidth",!1),Ie("useMinWidth",!1),Oe("role")].concat(vD())),yD=i([xp({schema:[hs()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),iD()]),wD=function(t,n,r,o){var i,u=function(n){return qt(t.dom,"attributes").bind((function(t){return qt(t,n)}))},a=function(t){ug.getState(t).each((function(t){xw.highlightPrimary(t)}))},c=function(n){var r=a;lD(t,(function(t){return t}),n,o,r,wE.HighlightFirst).get(e)},s={expand:function(n){Ly.isOn(n)||lD(t,(function(t){return t}),n,o,e,wE.HighlightNone).get(e)},open:function(n){Ly.isOn(n)||lD(t,(function(t){return t}),n,o,e,wE.HighlightFirst).get(e)},isOpen:Ly.isOn,close:function(n){Ly.isOn(n)&&lD(t,(function(t){return t}),n,o,e,wE.HighlightFirst).get(e)},repositionMenus:function(t){Ly.isOn(t)&&hD(t)}},f=function(t,n){return ai(t),x.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Gg(t.dropdownBehaviours,[Ly.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),rD.config({others:{sandbox:function(n){return pD(t,n,{onOpen:function(){Ly.on(n)},onClose:function(){Ly.off(n)}})}}}),Qb.config({mode:"special",onSpace:f,onEnter:f,onDown:function(t,n){if(xD.isOpen(t)){var e=rD.getCoupled(t,"sandbox");a(e)}else xD.open(t);return x.some(!0)},onEscape:function(t,n){return xD.isOpen(t)?(xD.close(t),x.some(!0)):x.none()}}),yy.config({})]),events:zy(x.some(c)),eventOrder:m(m({},t.eventOrder),(i={},i[Fo()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:s,domModification:{attributes:m(m({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:u("type").getOr("button")}:{})}}},xD=th({name:"Dropdown",configFields:bD(),partFields:yD(),factory:wD,apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),CD=function(t,n){return oa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},SD=function(t){return ki([Oi(Ro(),i(!0))])},kD=Object.freeze({events:SD,exhibit:CD}),OD=pf({fields:[],name:"unselecting",active:kD}),TD=function(t,n){return xD.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:mf([OD.config({}),GE.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return AE.nu((function(n){return t.fetch(n)})).map((function(r){return x.from(DO(Ot(oO(Bu("menu-value"),r,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,pS.CLOSE_ON_EXECUTE,(function(){return!1}),n.providers),{movement:uO(t.columns,t.presets)})))}))},parts:{menu:Qk(!1,1,t.presets)}})},ED=Bu("color-input-change"),DD=Bu("color-swatch-change"),AD=Bu("color-picker-cancel"),_D=function(t,n,e){var r=lE.parts().field({factory:vE,inputClasses:["tox-textfield"],onSetValue:function(t){return VE.run(t).get((function(){}))},inputBehaviours:mf([GE.config({}),VE.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Qi(t.element())},notify:{onValid:function(t){var n=jg.getValue(t);ui(t,ED,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=jg.getValue(t);if(0===n.length)return AE.pure(O.value(!0));var e=$e.fromTag("span");za(e,"background-color",n);var r=Ga(e,"background-color").fold((function(){return O.error("blah")}),(function(t){return O.value(n)}));return AE.pure(r)}}})]),selectOnFocus:!1}),o=t.label.map((function(t){return JE(t,n.providers)})),i=function(t,n){ui(t,DD,{value:n})},u=function(t,n){a.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return ii(t,AD)}),(function(n){i(t,n),vk.addColor(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))},a=Lw(TD({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:x.some({onRtl:function(){return[Xs]},onLtr:function(){return[Ys]}}),components:[],fetch:zk.getFetch(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},n));return lE.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:o.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,a.asSpec()]}]),fieldBehaviours:mf([fy("form-field-events",[Di(ED,(function(n,e){a.getOpt(n).each((function(t){za(t.element(),"background-color",e.event().color())})),ui(n,JT,{name:t.name})})),Di(DD,(function(t,n){lE.getField(t).each((function(e){jg.setValue(e,n.event().value()),ih.getCurrent(t).each(yy.focus)}))})),Di(AD,(function(t,n){lE.getField(t).each((function(n){ih.getCurrent(t).each(yy.focus)}))}))])])})},RD=function(t,n,e){return{hue:i(t),saturation:i(n),value:i(e)}},BD=function(t){var n=0,e=0,r=0,o=t.red()/255,i=t.green()/255,u=t.blue()/255,a=Math.min(o,Math.min(i,u)),c=Math.max(o,Math.max(i,u));if(a===c)return r=a,RD(0,0,100*r);var s=o===a?i-u:u===a?o-i:u-o;return n=o===a?3:u===a?1:5,n=60*(n-s/(c-a)),e=(c-a)/c,r=c,RD(Math.round(n),Math.round(100*e),Math.round(100*r))},ID=function(t){var n=(100-t)/100*360,e=RD(n,100,100),r=QS(e);return WS(r)},PD=i(Bu("rgb-hex-update")),ND=i(Bu("slider-update")),MD=i(Bu("palette-update")),FD=qr(),LD=FD.deviceType.isTouch(),HD=Cp({schema:[ge("dom")],name:"label"}),zD=function(t){return Cp({name:t+"-edge",overrides:function(n){var e=n.model.manager.edgeActions[t];return e.fold((function(){return{}}),(function(t){var e=ki([Ai(go(),t,[n])]),r=ki([Ai(bo(),t,[n]),Ai(yo(),(function(n,e){e.mouseIsDown.get()&&t(n,e)}),[n])]);return{events:LD?e:r}}))}})},VD=zD("top-left"),jD=zD("top"),UD=zD("top-right"),WD=zD("right"),GD=zD("bottom-right"),qD=zD("bottom"),XD=zD("bottom-left"),YD=zD("left"),KD=wp({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:ki([Ii(go(),t,"spectrum"),Ii(po(),t,"spectrum"),Ii(ho(),t,"spectrum"),Ii(bo(),t,"spectrum"),Ii(yo(),t,"spectrum"),Ii(xo(),t,"spectrum")])}}}),$D=wp({schema:[Ue("mouseIsDown",(function(){return We(!1)}))],name:"spectrum",overrides:function(t){var n=t.model,e=n.manager,r=function(n,r){return e.getValueFromEvent(r).map((function(r){return e.setValueFrom(n,t,r)}))},o=ki([Di(go(),r),Di(po(),r)]),i=ki([Di(bo(),r),Di(yo(),(function(n,e){t.mouseIsDown.get()&&r(n,e)}))]);return{behaviours:mf(LD?[]:[Qb.config({mode:"special",onLeft:function(n){return e.onLeft(n,t)},onRight:function(n){return e.onRight(n,t)},onUp:function(n){return e.onUp(n,t)},onDown:function(n){return e.onDown(n,t)}}),yy.config({})]),events:LD?o:i}}}),JD=[HD,YD,WD,jD,qD,VD,UD,XD,GD,KD,$D],QD=qr().deviceType.isTouch(),ZD="slider.change.value",tA=i(ZD),nA=function(t){var n=t.event().raw();if(QD){var e=n;return void 0!==e.touches&&1===e.touches.length?x.some(e.touches[0]).map((function(t){return bc(t.clientX,t.clientY)})):x.none()}var r=n;return void 0!==r.clientX?x.some(r).map((function(t){return bc(t.clientX,t.clientY)})):x.none()},eA="top",rA="right",oA="bottom",iA="left",uA=function(t){return t.model.minX},aA=function(t){return t.model.minY},cA=function(t){return t.model.minX-1},sA=function(t){return t.model.minY-1},fA=function(t){return t.model.maxX},lA=function(t){return t.model.maxY},dA=function(t){return t.model.maxX+1},mA=function(t){return t.model.maxY+1},gA=function(t,n,e){return n(t)-e(t)},pA=function(t){return gA(t,fA,uA)},hA=function(t){return gA(t,lA,aA)},vA=function(t){return pA(t)/2},bA=function(t){return hA(t)/2},yA=function(t){return t.stepSize},wA=function(t){return t.snapToGrid},xA=function(t){return t.snapStart},CA=function(t){return t.rounded},SA=function(t,n){return void 0!==t[n+"-edge"]},kA=function(t){return SA(t,iA)},OA=function(t){return SA(t,rA)},TA=function(t){return SA(t,eA)},EA=function(t){return SA(t,oA)},DA=function(t){return t.model.value.get()},AA=function(t){return{x:i(t)}},_A=function(t){return{y:i(t)}},RA=function(t,n){return{x:i(t),y:i(n)}},BA=function(t,n){ui(t,tA(),{value:n})},IA=function(t,n){BA(t,RA(cA(n),sA(n)))},PA=function(t,n){BA(t,_A(sA(n)))},NA=function(t,n){BA(t,RA(vA(n),sA(n)))},MA=function(t,n){BA(t,RA(dA(n),sA(n)))},FA=function(t,n){BA(t,AA(dA(n)))},LA=function(t,n){BA(t,RA(dA(n),bA(n)))},HA=function(t,n){BA(t,RA(dA(n),mA(n)))},zA=function(t,n){BA(t,_A(mA(n)))},VA=function(t,n){BA(t,RA(vA(n),mA(n)))},jA=function(t,n){BA(t,RA(cA(n),mA(n)))},UA=function(t,n){BA(t,AA(cA(n)))},WA=function(t,n){BA(t,RA(cA(n),bA(n)))},GA=function(t,n,e,r){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-r)},qA=function(t,n,e,r){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+r)},XA=function(t,n,e){return Math.max(n,Math.min(e,t))},YA=function(t,n,e,r,o){return o.fold((function(){var o=t-n,i=Math.round(o/r)*r;return XA(n+i,n-1,e+1)}),(function(n){var o=(t-n)%r,i=Math.round(o/r),u=Math.floor((t-n)/r),a=Math.floor((e-n)/r),c=Math.min(a,u+i),s=n+c*r;return Math.max(n,s)}))},KA=function(t,n,e){return Math.min(e,Math.max(t,n))-n},$A=function(t){var n=t.min,e=t.max,r=t.range,o=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(o<l)return g;if(o>d)return p;var h=KA(o,l,d),v=XA(h/m*r+n,g,p);return u&&v>=n&&v<=e?YA(v,n,e,i,a):c?Math.round(v):v},JA=function(t){var n=t.min,e=t.max,r=t.range,o=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return o<n?i?0:s:o>e?u?a:f:(o-n)/r*c},QA="top",ZA="right",t_="bottom",n_="left",e_="width",r_="height",o_=function(t){return t.element().dom().getBoundingClientRect()},i_=function(t,n){return t[n]},u_=function(t){var n=o_(t);return i_(n,n_)},a_=function(t){var n=o_(t);return i_(n,ZA)},c_=function(t){var n=o_(t);return i_(n,QA)},s_=function(t){var n=o_(t);return i_(n,t_)},f_=function(t){var n=o_(t);return i_(n,e_)},l_=function(t){var n=o_(t);return i_(n,r_)},d_=function(t,n,e){return(t+n)/2-e},m_=function(t,n){var e=o_(t),r=o_(n),o=i_(e,n_),i=i_(e,ZA),u=i_(r,n_);return d_(o,i,u)},g_=function(t,n){var e=o_(t),r=o_(n),o=i_(e,QA),i=i_(e,t_),u=i_(r,QA);return d_(o,i,u)},p_=function(t,n){ui(t,tA(),{value:n})},h_=function(t){return{x:i(t)}},v_=function(t,n,e){var r={min:uA(n),max:fA(n),range:pA(n),value:e,step:yA(n),snap:wA(n),snapStart:xA(n),rounded:CA(n),hasMinEdge:kA(n),hasMaxEdge:OA(n),minBound:u_(t),maxBound:a_(t),screenRange:f_(t)};return $A(r)},b_=function(t,n,e){var r=v_(t,n,e),o=h_(r);return p_(t,o),r},y_=function(t,n){var e=uA(n);p_(t,h_(e))},w_=function(t,n){var e=fA(n);p_(t,h_(e))},x_=function(t,n,e){var r=t>0?qA:GA,o=r(DA(e).x(),uA(e),fA(e),yA(e));return p_(n,h_(o)),x.some(o)},C_=function(t){return function(n,e){return x_(t,n,e).map((function(){return!0}))}},S_=function(t){var n=nA(t);return n.map((function(t){return t.left()}))},k_=function(t,n,e,r,o){var i=0,u=f_(t),a=r.bind((function(n){return x.some(m_(n,t))})).getOr(i),c=o.bind((function(n){return x.some(m_(n,t))})).getOr(u),s={min:uA(n),max:fA(n),range:pA(n),value:e,hasMinEdge:kA(n),hasMaxEdge:OA(n),minBound:u_(t),minOffset:i,maxBound:a_(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return JA(s)},O_=function(t,n,e,r,o,i){var u=k_(n,i,e,r,o);return u_(n)-u_(t)+u},T_=function(t,n,e,r){var o=DA(e),i=O_(t,r.getSpectrum(t),o.x(),r.getLeftEdge(t),r.getRightEdge(t),e),u=Oc(n.element())/2;za(n.element(),"left",i-u+"px")},E_=C_(-1),D_=C_(1),A_=x.none,__=x.none,R_={"top-left":x.none(),top:x.none(),"top-right":x.none(),right:x.some(FA),"bottom-right":x.none(),bottom:x.none(),"bottom-left":x.none(),left:x.some(UA)},B_=Object.freeze({setValueFrom:b_,setToMin:y_,setToMax:w_,findValueOfOffset:v_,getValueFromEvent:S_,findPositionOfValue:O_,setPositionFromValue:T_,onLeft:E_,onRight:D_,onUp:A_,onDown:__,edgeActions:R_}),I_=function(t,n){ui(t,tA(),{value:n})},P_=function(t){return{y:i(t)}},N_=function(t,n,e){var r={min:aA(n),max:lA(n),range:hA(n),value:e,step:yA(n),snap:wA(n),snapStart:xA(n),rounded:CA(n),hasMinEdge:TA(n),hasMaxEdge:EA(n),minBound:c_(t),maxBound:s_(t),screenRange:l_(t)};return $A(r)},M_=function(t,n,e){var r=N_(t,n,e),o=P_(r);return I_(t,o),r},F_=function(t,n){var e=aA(n);I_(t,P_(e))},L_=function(t,n){var e=lA(n);I_(t,P_(e))},H_=function(t,n,e){var r=t>0?qA:GA,o=r(DA(e).y(),aA(e),lA(e),yA(e));return I_(n,P_(o)),x.some(o)},z_=function(t){return function(n,e){return H_(t,n,e).map((function(){return!0}))}},V_=function(t){var n=nA(t);return n.map((function(t){return t.top()}))},j_=function(t,n,e,r,o){var i=0,u=l_(t),a=r.bind((function(n){return x.some(g_(n,t))})).getOr(i),c=o.bind((function(n){return x.some(g_(n,t))})).getOr(u),s={min:aA(n),max:lA(n),range:hA(n),value:e,hasMinEdge:TA(n),hasMaxEdge:EA(n),minBound:c_(t),minOffset:i,maxBound:s_(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return JA(s)},U_=function(t,n,e,r,o,i){var u=j_(n,i,e,r,o);return c_(n)-c_(t)+u},W_=function(t,n,e,r){var o=DA(e),i=U_(t,r.getSpectrum(t),o.y(),r.getTopEdge(t),r.getBottomEdge(t),e),u=gc(n.element())/2;za(n.element(),"top",i-u+"px")},G_=x.none,q_=x.none,X_=z_(-1),Y_=z_(1),K_={"top-left":x.none(),top:x.some(PA),"top-right":x.none(),right:x.none(),"bottom-right":x.none(),bottom:x.some(zA),"bottom-left":x.none(),left:x.none()},$_=Object.freeze({setValueFrom:M_,setToMin:F_,setToMax:L_,findValueOfOffset:N_,getValueFromEvent:V_,findPositionOfValue:U_,setPositionFromValue:W_,onLeft:G_,onRight:q_,onUp:X_,onDown:Y_,edgeActions:K_}),J_=function(t,n){ui(t,tA(),{value:n})},Q_=function(t,n){return{x:i(t),y:i(n)}},Z_=function(t,n,e){var r=v_(t,n,e.left()),o=N_(t,n,e.top()),i=Q_(r,o);return J_(t,i),i},tR=function(t,n,e,r){var o=t>0?qA:GA,i=n?DA(r).x():o(DA(r).x(),uA(r),fA(r),yA(r)),u=n?o(DA(r).y(),aA(r),lA(r),yA(r)):DA(r).y();return J_(e,Q_(i,u)),x.some(i)},nR=function(t,n){return function(e,r){return tR(t,n,e,r).map((function(){return!0}))}},eR=function(t,n){var e=uA(n),r=aA(n);J_(t,Q_(e,r))},rR=function(t,n){var e=fA(n),r=lA(n);J_(t,Q_(e,r))},oR=function(t){return nA(t)},iR=function(t,n,e,r){var o=DA(e),i=O_(t,r.getSpectrum(t),o.x(),r.getLeftEdge(t),r.getRightEdge(t),e),u=U_(t,r.getSpectrum(t),o.y(),r.getTopEdge(t),r.getBottomEdge(t),e),a=Oc(n.element())/2,c=gc(n.element())/2;za(n.element(),"left",i-a+"px"),za(n.element(),"top",u-c+"px")},uR=nR(-1,!1),aR=nR(1,!1),cR=nR(-1,!0),sR=nR(1,!0),fR={"top-left":x.some(IA),top:x.some(NA),"top-right":x.some(MA),right:x.some(LA),"bottom-right":x.some(HA),bottom:x.some(VA),"bottom-left":x.some(jA),left:x.some(WA)},lR=Object.freeze({setValueFrom:Z_,setToMin:eR,setToMax:rR,getValueFromEvent:oR,setPositionFromValue:iR,onLeft:uR,onRight:aR,onUp:cR,onDown:sR,edgeActions:fR}),dR=qr().deviceType.isTouch(),mR=[Ie("stepSize",1),Ie("onChange",e),Ie("onChoose",e),Ie("onInit",e),Ie("onDragStart",e),Ie("onDragEnd",e),Ie("snapToGrid",!1),Ie("rounded",!0),Oe("snapStart"),pe("model",oe("mode",{x:[Ie("minX",0),Ie("maxX",100),Ue("value",(function(t){return We(t.mode.minX)})),ge("getInitialValue"),Ss("manager",B_)],y:[Ie("minY",0),Ie("maxY",100),Ue("value",(function(t){return We(t.mode.minY)})),ge("getInitialValue"),Ss("manager",$_)],xy:[Ie("minX",0),Ie("maxX",100),Ie("minY",0),Ie("maxY",100),Ue("value",(function(t){return We({x:i(t.mode.minX),y:i(t.mode.minY)})})),ge("getInitialValue"),Ss("manager",lR)]})),Ug("sliderBehaviours",[Qb,jg])].concat(dR?[]:[Ue("mouseIsDown",(function(){return We(!1)}))]),gR=qr().deviceType.isTouch(),pR=function(t,n,e,r){var o=function(n){return Mp(n,t,"thumb")},u=function(n){return Mp(n,t,"spectrum")},a=function(n){return Np(n,t,"left-edge")},c=function(n){return Np(n,t,"right-edge")},s=function(n){return Np(n,t,"top-edge")},f=function(n){return Np(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(n,e){l.value.set(e);var r=o(n);return m(n,r),t.onChange(n,r,e),x.some(!0)},p=function(n){d.setToMin(n,t)},h=function(n){d.setToMax(n,t)},v=[Di(go(),(function(n,e){t.onDragStart(n,o(n))})),Di(ho(),(function(n,e){t.onDragEnd(n,o(n))}))],b=[Di(bo(),(function(n,e){e.stop(),t.onDragStart(n,o(n)),t.mouseIsDown.set(!0)})),Di(xo(),(function(n,e){t.onDragEnd(n,o(n))}))],y=gR?v:b;return{uid:t.uid,dom:t.dom,components:n,behaviours:Gg(t.sliderBehaviours,Z([gR?[]:[Qb.config({mode:"special",focusIn:function(n){return Np(n,t,"spectrum").map(Qb.focusIn).map(i(!0))}})],[jg.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),Sf.config({channels:{"mouse.released":{onReceive:function(n,e){var r=function(){Np(n,t,"thumb").each((function(e){var r=l.value.get();t.onChoose(n,e,r)}))};if(gR)r();else{var o=t.mouseIsDown.get();t.mouseIsDown.set(!1),o&&r()}}}}})]])),events:ki([Di(tA(),(function(t,n){g(t,n.event().value())})),Li((function(n,e){var r=l.getInitialValue();l.value.set(r);var i=o(n);m(n,i);var a=u(n);t.onInit(n,i,a,l.value.get())}))].concat(y)),apis:{resetToMin:p,resetToMax:h,changeValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},hR=th({name:"Slider",configFields:mR,partFields:JD,factory:pR,apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),vR=function(t,n){var e=hR.parts().spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=hR.parts().thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return hR.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:i({y:i(0)})},components:[e,r],sliderBehaviours:mf([yy.config({})]),onChange:function(t,n,e){ui(t,ND(),{value:e})}})},bR={sliderFactory:vR},yR="form",wR=[Ug("formBehaviours",[jg])],xR=function(t){return"<alloy.field."+t+">"},CR=function(t){var n=function(){var t=[],n=function(n,e){return t.push(n),_p(yR,xR(n),e)};return{field:n,record:function(){return t}}}(),e=t(n),r=n.record(),o=W(r,(function(t){return wp({name:t,pname:xR(t)})}));return Xp(yR,wR,o,kR,e)},SR=function(t,n){return t.fold((function(){return O.error(n)}),O.value)},kR=function(t,n,e){return{uid:t.uid,dom:t.dom,components:n,behaviours:Gg(t.formBehaviours,[jg.config({store:{mode:"manual",getValue:function(n){var e=Lp(n,t);return dt(e,(function(t,n){return t().bind((function(t){var n=ih.getCurrent(t);return SR(n,"missing current")})).map(jg.getValue)}))},setValue:function(n,e){lt(e,(function(e,r){Np(n,t,r).each((function(t){ih.getCurrent(t).each((function(t){jg.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Np(n,t,e).bind(ih.getCurrent)}}}},OR={getField:Ju((function(t,n,e){return t.getField(n,e)})),sketch:CR},TR=Bu("valid-input"),ER=Bu("invalid-input"),DR=Bu("validating-input"),AR="colorcustom.rgb.",_R=function(t,n,r,o){var u=function(e,r){return VE.config({invalidClass:n("invalid"),notify:{onValidate:function(t){ui(t,DR,{type:e})},onValid:function(t){ui(t,TR,{type:e,value:jg.getValue(t)})},onInvalid:function(t){ui(t,ER,{type:e,value:jg.getValue(t)})}},validator:{validate:function(n){var e=jg.getValue(n),o=r(e)?O.value(!0):O.error(t("aria.input.invalid"));return AE.pure(o)},validateOnLoad:!1}})},a=function(r,o,i,a,c){var s=t(AR+"range"),f=lE.parts().label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":a}}}),l=lE.parts().field({data:c,factory:vE,inputAttributes:m({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:mf([u(o,r),GE.config({})]),onSetValue:function(t){if(VE.isInvalid(t)){var n=VE.run(t);n.get(e)}}}),d=[f,l],g="hex"!==o?[lE.parts()["aria-descriptor"]({text:s})]:[],p=d.concat(g);return{dom:{tag:"div",attributes:{role:"presentation"}},components:p}},c=function(t,n){var e=WS(n);return OR.getField(t,"hex").each((function(n){yy.isFocused(n)||jg.setValue(t,{hex:e.value()})})),e},s=function(t,n){var e=n.red(),r=n.green(),o=n.blue();jg.setValue(t,{red:e,green:r,blue:o})},f=Lw({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=function(t,n){f.getOpt(t).each((function(t){za(t.element(),"background-color","#"+n.value())}))},d=function(){var e={red:i(We(x.some(255))),green:i(We(x.some(255))),blue:i(We(x.some(255))),hex:i(We(x.some("ffffff")))},u=function(t,n){var e=ZS(n);s(t,e),p(e)},d=function(t){return e[t]().get()},m=function(t,n){e[t]().set(n)},g=function(){return d("red").bind((function(t){return d("green").bind((function(n){return d("blue").map((function(e){return $S(t,n,e,1)}))}))}))},p=function(t){var n=t.red(),e=t.green(),r=t.blue();m("red",x.some(n)),m("green",x.some(e)),m("blue",x.some(r))},h=function(t,n){var e=n.event();"hex"!==e.type()?m(e.type(),x.none()):o(t)},v=function(t,n){r(t);var e=FS(n);m("hex",x.some(n));var o=ZS(e);s(t,o),p(o),ui(t,PD(),{hex:e}),l(t,e)},b=function(t,n,e){var r=parseInt(e,10);m(n,x.some(r)),g().each((function(n){var e=c(t,n);l(t,e)}))},y=function(t){return"hex"===t.type()},w=function(t,n){var e=n.event();y(e)?v(t,e.value()):b(t,e.type(),e.value())},C=function(n){return{label:t(AR+n+".label"),description:t(AR+n+".description")}},S=C("red"),k=C("green"),O=C("blue"),T=C("hex");return Ot(OR.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",lE.sketch(a(JS,"red",S.label,S.description,255))),e.field("green",lE.sketch(a(JS,"green",k.label,k.description,255))),e.field("blue",lE.sketch(a(JS,"blue",O.label,O.description,255))),e.field("hex",lE.sketch(a(zS,"hex",T.label,T.description,"ffffff"))),f.asSpec()],formBehaviours:mf([VE.config({invalidClass:n("form-invalid")}),fy("rgb-form-events",[Di(TR,w),Di(ER,h),Di(DR,h)])])}})),{apis:{updateHex:function(t,n){jg.setValue(t,{hex:n.value()}),u(t,n),l(t,n)}}})},g=Zp({factory:d,name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}});return g},RR={rgbFormFactory:_R},BR=function(t,n){var e=hR.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),r=hR.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),o=function(t,n){var e=t.width,r=t.height,o=t.getContext("2d");if(null!==o){o.fillStyle=n,o.fillRect(0,0,e,r);var i=o.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=i,o.fillRect(0,0,e,r);var u=o.createLinearGradient(0,0,0,r);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),o.fillStyle=u,o.fillRect(0,0,e,r)}},u=function(t,n){var e=t.components()[0].element().dom();o(e,ek(n))},a=function(t){var u=i({x:i(0),y:i(0)}),a=function(t,n,e){ui(t,MD(),{value:e})},c=function(t,n,e,r){o(e.element().dom(),ek(rk()))},s=mf([ih.config({find:x.some}),yy.config({})]);return hR.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,r],onChange:a,onInit:c,sliderBehaviours:s})},c=Zp({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){u(n,e)}},extraApis:{}});return c},IR={paletteFactory:BR},PR=function(t,n){var r=function(e){var r=RR.rgbFormFactory(t,n,e.onValidHex,e.onInvalidHex),o=IR.paletteFactory(t,n),u={paletteRgba:i(We(rk()))},a=Lw(o.sketch({})),c=Lw(r.sketch({})),s=function(t,n){a.getOpt(t).each((function(t){var e=ZS(n);u.paletteRgba().set(e),o.setRgba(t,e)}))},f=function(t,n){c.getOpt(t).each((function(t){r.updateHex(t,n)}))},l=function(t,n,e){G(e,(function(e){e(t,n)}))},d=function(){var t=[f];return function(n,e){var r=e.event().value(),o=u.paletteRgba().get(),i=BD(o),a=RD(i.hue(),r.x(),100-r.y()),c=QS(a),s=WS(c);l(n,s,t)}},m=function(){var t=[s,f];return function(n,e){var r=e.event().value(),o=ID(r.y());l(n,o,t)}};return{uid:e.uid,dom:e.dom,components:[a.asSpec(),bR.sliderFactory(t,n),c.asSpec()],behaviours:mf([fy("colour-picker-events",[Di(MD(),d()),Di(ND(),m())]),ih.config({find:function(t){return c.getOpt(t)}}),Qb.config({mode:"acyclic"})])}},o=Zp({name:"ColourPicker",configFields:[ge("dom"),Ie("onValidHex",e),Ie("onInvalidHex",e)],factory:r});return o},NR={makeFactory:PR},MR=function(){return ih.config({find:x.some})},FR=function(t){return ih.config({find:t.getOpt})},LR=function(t){return ih.config({find:function(n){return eu(n.element(),t).bind((function(t){return n.getSystem().getByDom(t).toOption()}))}})},HR={self:MR,memento:FR,childAt:LR},zR={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},VR=function(t){return zR[t]},jR=function(t){return VR(t)},UR=function(t){var e=function(t){return"tox-"+t},r=NR.makeFactory(jR,e),o=function(t){ui(t,tE,{name:"hex-valid",value:!0})},i=function(t){ui(t,tE,{name:"hex-valid",value:!1})},u=Lw(r.sketch({dom:{tag:"div",classes:[e("color-picker-container")],attributes:{role:"presentation"}},onValidHex:o,onInvalidHex:i}));return{dom:{tag:"div"},components:[u.asSpec()],behaviours:mf([jg.config({store:{mode:"manual",getValue:function(t){var n=u.get(t),e=ih.getCurrent(n),r=e.bind((function(t){var n=jg.getValue(t);return n.hex}));return r.map((function(t){return"#"+t})).getOr("")},setValue:function(t,e){var r=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,o=r.exec(e),i=u.get(t),a=ih.getCurrent(i);a.fold((function(){n.console.log("Can not find form")}),(function(t){jg.setValue(t,{hex:x.from(o[1]).getOr("")}),OR.getField(t,"hex").each((function(t){ii(t,Eo())}))}))}}}),HR.self()])}},WR=tinymce.util.Tools.resolve("tinymce.Resource"),GR=function(t){return Object.prototype.hasOwnProperty.call(t,"init")},qR=function(t){var n=We(x.none()),e=Lw({dom:{tag:t.tag}}),r=We(x.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:mf([fy("editor-foo-events",[Li((function(o){e.getOpt(o).each((function(e){(GR(t)?t.init(e.element().dom()):WR.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element().dom(),t.settings)}))).then((function(t){r.get().each((function(n){t.setValue(n)})),r.set(x.none()),n.set(x.some(t))}))}))}))]),jg.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return r.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){r.set(x.some(e))}),(function(t){return t.setValue(e)}))}}}),HR.self()]),components:[e.asSpec()]}},XR=Fn([Ie("preprocess",u),Ie("postprocess",u)]),YR=function(t,n){var e=ne("RepresentingConfigs.memento processors",XR,n);return jg.config({store:{mode:"manual",getValue:function(n){var r=t.get(n),o=jg.getValue(r);return e.postprocess(o)},setValue:function(n,r){var o=e.preprocess(r),i=t.get(n);jg.setValue(i,o)}}})},KR=function(t,n,e){return jg.config(Ot({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},$R=function(t,n,e){return KR(t,(function(t){return n(t.element())}),(function(t,n){return e(t.element(),n)}))},JR=function(t){return $R(t,Ka,$a)},QR=function(t){return $R(t,pu,hu)},ZR=function(t){return jg.config({store:{mode:"memory",initialValue:t}})},tB={memento:YR,withElement:$R,withComp:KR,domValue:JR,domHtml:QR,memory:ZR},nB=".jpg,.jpeg,.png,.gif",eB=function(t){var n=new RegExp("("+nB.split(/\s*,\s*/).join("|")+")$","i");return Y(ct(t),(function(t){return n.test(t.name)}))},rB=function(t,n){var e=function(t,n){n.stop()},r=function(t){return function(n,e){G(t,(function(t){t(n,e)}))}},o=function(t,n){if(!uS.isDisabled(t)){var e=n.event().raw();u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event().raw().target.files;u(t,e)},u=function(n,e){jg.setValue(n,eB(e)),ui(n,JT,{name:t.name})},a=Lw({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:mf([fy("input-file-events",[Ni(zo())])])}),c=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:mf([tB.memory([]),HR.self(),uS.config({}),Ly.config({toggleClass:"dragenter",toggleOnExecute:!1}),fy("dropzone-events",[Di("dragenter",r([e,Ly.toggle])),Di("dragleave",r([e,Ly.toggle])),Di("dragover",e),Di("drop",r([e,o])),Di(Do(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Fw.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){var n=a.get(t);n.element().dom().click()},buttonBehaviours:mf([GE.config({})])})]}]}},s=t.label.map((function(t){return JE(t,n)})),f=lE.parts().field({factory:{sketch:c}});return qE(s,f,["tox-form__group--stretched"],[])},oB=function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:W(t.items,n.interpreter)}},iB=Bu("alloy-fake-before-tabstop"),uB=Bu("alloy-fake-after-tabstop"),aB=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:mf([yy.config({ignore:!0}),GE.config({})])}},cB=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[aB([iB]),t,aB([uB])],behaviours:mf([HR.childAt(1)])}},sB=function(t,n){ui(t,Oo(),{raw:{which:9,shiftKey:n}})},fB=function(t,n){var e=n.element();Pa(e,iB)?sB(t,!0):Pa(e,uB)&&sB(t,!1)},lB=function(t){return UO(t,["."+iB,"."+uB].join(","),i(!1))},dB={isPseudoStop:lB,onFocus:fB,craft:cB},mB=!(qr().browser.isIE()||qr().browser.isEdge()),gB=function(t){var n=We("");return{getValue:function(t){return n.get()},setValue:function(e,r){if(t)yu(e.element(),"srcdoc",r);else{yu(e.element(),"src","javascript:''");var o=e.element().dom().contentWindow.document;o.open(),o.write(r),o.close()}n.set(r)}}},pB=function(t,n){var e=mB&&t.sandboxed,r=m(m({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),o=gB(e),i=t.label.map((function(t){return JE(t,n)})),u=function(t){return dB.craft({uid:t.uid,dom:{tag:"iframe",attributes:r},behaviours:mf([GE.config({}),yy.config({}),tB.withComp(x.none(),o.getValue,o.setValue)])})},a=lE.parts().field({factory:{sketch:u}});return qE(i,a,["tox-form__group--stretched"],[])};function hB(t,e){return yB(n.document.createElement("canvas"),t,e)}function vB(t){var n=hB(t.width,t.height),e=bB(n);return e.drawImage(t,0,0),n}function bB(t){return t.getContext("2d")}function yB(t,n,e){return t.width=n,t.height=e,t}function wB(t){return t.naturalWidth||t.width}function xB(t){return t.naturalHeight||t.height}var CB=function(){var t=function(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(t,r(u,this),r(a,this))},e=t.immediateFn||"function"===typeof window.setImmediate&&window.setImmediate||function(t){n.setTimeout(t,1)};function r(t,n){return function(){return t.apply(n,arguments)}}var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t){var n=this;null!==this._state?e((function(){var e=n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(o){return void t.reject(o)}t.resolve(r)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function u(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var n=t.then;if("function"===typeof n)return void f(r(n,t),r(u,this),r(a,this))}this._state=!0,this._value=t,c.call(this)}catch(e){a.call(this,e)}}function a(t){this._state=!1,this._value=t,c.call(this)}function c(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];i.call(this,e)}this._deferreds=[]}function s(t,n,e,r){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof n?n:null,this.resolve=e,this.reject=r}function f(t,n,e){var r=!1;try{t((function(t){r||(r=!0,n(t))}),(function(t){r||(r=!0,e(t))}))}catch(o){if(r)return;r=!0,e(o)}}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.then=function(n,e){var r=this;return new t((function(t,o){i.call(r,new s(n,e,t,o))}))},t.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=Array.prototype.slice.call(1===n.length&&o(n[0])?n[0]:n);return new t((function(t,n){if(0===r.length)return t([]);var e=r.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),n)}r[i]=u,0===--e&&t(r)}catch(c){n(c)}}for(var i=0;i<r.length;i++)o(i,r[i])}))},t.resolve=function(n){return n&&"object"===typeof n&&n.constructor===t?n:new t((function(t){t(n)}))},t.reject=function(n){return new t((function(t,e){e(n)}))},t.race=function(n){return new t((function(t,e){for(var r=0,o=n;r<o.length;r++){var i=o[r];i.then(t,e)}}))},t},SB=window.Promise?window.Promise:CB();function kB(t){return new SB((function(e,r){var o=n.URL.createObjectURL(t),i=new n.Image,u=function(){i.removeEventListener("load",a),i.removeEventListener("error",c)};function a(){u(),e(i)}function c(){u(),r("Unable to load data of type "+t.type+": "+o)}i.addEventListener("load",a),i.addEventListener("error",c),i.src=o,i.complete&&a()}))}function OB(t){var e=t.split(","),r=/data:([^;]+)/.exec(e[0]);if(!r)return x.none();for(var o=r[1],i=e[1],u=1024,a=n.atob(i),c=a.length,s=Math.ceil(c/u),f=new Array(s),l=0;l<s;++l){for(var d=l*u,m=Math.min(d+u,c),g=new Array(m-d),p=d,h=0;p<m;++h,++p)g[h]=a[p].charCodeAt(0);f[l]=new Uint8Array(g)}return x.some(new n.Blob(f,{type:o}))}function TB(t){return new SB((function(n,e){OB(t).fold((function(){e("uri is not base64: "+t)}),n)}))}function EB(t,e,r){return e=e||"image/png",n.HTMLCanvasElement.prototype.toBlob?new SB((function(n,o){t.toBlob((function(t){t?n(t):o()}),e,r)})):TB(t.toDataURL(e,r))}function DB(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}function AB(t){return kB(t).then((function(t){RB(t);var n=hB(wB(t),xB(t)),e=bB(n);return e.drawImage(t,0,0),n}))}function _B(t){return new SB((function(e){var r=new n.FileReader;r.onloadend=function(){e(r.result)},r.readAsDataURL(t)}))}function RB(t){n.URL.revokeObjectURL(t.src)}function BB(t,n,e){var r=n.type,o=i(r);function u(){return SB.resolve(n)}function a(){return e}function c(){return e.split(",")[1]}function s(n,e){return t.then((function(t){return EB(t,n,e)}))}function f(n,e){return t.then((function(t){return DB(t,n,e)}))}function l(t,n){return f(t,n).then((function(t){return t.split(",")[1]}))}function d(){return t.then(vB)}return{getType:o,toBlob:u,toDataURL:a,toBase64:c,toAdjustedBlob:s,toAdjustedDataURL:f,toAdjustedBase64:l,toCanvas:d}}function IB(t){return _B(t).then((function(n){return BB(AB(t),t,n)}))}function PB(t,n){return EB(t,n).then((function(n){return BB(SB.resolve(t),n,t.toDataURL())}))}var NB=function(t){return IB(t)};function MB(t,n,e){var r="string"===typeof t?parseFloat(t):t;return r>e?r=e:r<n&&(r=n),r}function FB(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var LB=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function HB(t,n){for(var e,r=[],o=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)r[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*r[a];o[u+5*i]=e}}return o}function zB(t,n){var e;return n=MB(n,-1,1),n*=100,n<0?e=127+n/100*127:(e=n%1,e=0===e?LB[n]:LB[Math.floor(n)]*(1-e)+LB[Math.floor(n)+1]*e,e=127*e+127),HB(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}function VB(t,n){return n=MB(255*n,-255,255),HB(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}function jB(t,n,e,r){return n=MB(n,0,2),e=MB(e,0,2),r=MB(r,0,2),HB(t,[n,0,0,0,0,0,e,0,0,0,0,0,r,0,0,0,0,0,1,0,0,0,0,0,1])}function UB(t,n){return t.toCanvas().then((function(e){return WB(e,t.getType(),n)}))}function WB(t,n,e){var r=bB(t);function o(t,n){for(var e,r,o,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],w=n[13],x=n[14],C=n[15],S=n[16],k=n[17],O=n[18],T=n[19],E=0;E<u.length;E+=4)e=u[E],r=u[E+1],o=u[E+2],i=u[E+3],u[E]=e*a+r*c+o*s+i*f+l,u[E+1]=e*d+r*m+o*g+i*p+h,u[E+2]=e*v+r*b+o*y+i*w+x,u[E+3]=e*C+r*S+o*k+i*O+T;return t}var i=o(r.getImageData(0,0,t.width,t.height),e);return r.putImageData(i,0,0),PB(t,n)}function GB(t,n){return t.toCanvas().then((function(e){return qB(e,t.getType(),n)}))}function qB(t,n,e){var r=bB(t);function o(t,n,e){function r(t,n,e){return t>e?t=e:t<n&&(t=n),t}for(var o=Math.round(Math.sqrt(e.length)),i=Math.floor(o/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<o;p++)for(var h=0;h<o;h++){var v=r(l+h-i,0,c-1),b=r(f+p-i,0,s-1),y=4*(b*c+v),w=e[p*o+h];d+=u[y]*w,m+=u[y+1]*w,g+=u[y+2]*w}var x=4*(f*c+l);a[x]=r(d,0,255),a[x+1]=r(m,0,255),a[x+2]=r(g,0,255)}return n}var i=r.getImageData(0,0,t.width,t.height),u=r.getImageData(0,0,t.width,t.height);return u=o(i,u,e),r.putImageData(u,0,0),PB(t,n)}function XB(t){var n=function(n,e,r){var o=bB(n),i=new Array(256);function u(t,n){for(var e=t.data,r=0;r<e.length;r+=4)e[r]=n[e[r]],e[r+1]=n[e[r+1]],e[r+2]=n[e[r+2]];return t}for(var a=0;a<i.length;a++)i[a]=t(a,r);var c=u(o.getImageData(0,0,n.width,n.height),i);return o.putImageData(c,0,0),PB(n,e)};return function(t,e){return t.toCanvas().then((function(r){return n(r,t.getType(),e)}))}}function YB(t){return function(n,e){return UB(n,t(FB(),e))}}function KB(t){return function(n){return UB(n,t)}}function $B(t){return function(n){return GB(n,t)}}var JB=KB([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),QB=YB(VB),ZB=YB(zB),tI=function(t,n,e,r){return UB(t,jB(FB(),n,e,r))},nI=$B([0,-1,0,-1,5,-1,0,-1,0]),eI=XB((function(t,n){return 255*Math.pow(t/255,1-n)}));function rI(t,n,e){var r=wB(t),o=xB(t),i=n/r,u=e/o,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=oI(t,i,u);return a?c.then((function(t){return rI(t,n,e)})):c}function oI(t,n,e){return new SB((function(r){var o=wB(t),i=xB(t),u=Math.floor(o*n),a=Math.floor(i*e),c=hB(u,a),s=bB(c);s.drawImage(t,0,0,o,i,0,0,u,a),r(c)}))}function iI(t,n){return t.toCanvas().then((function(e){return uI(e,t.getType(),n)}))}function uI(t,n,e){var r=hB(t.width,t.height),o=bB(r),i=0,u=0;return e=e<0?360+e:e,90!==e&&270!==e||yB(r,r.height,r.width),90!==e&&180!==e||(i=r.width),270!==e&&180!==e||(u=r.height),o.translate(i,u),o.rotate(e*Math.PI/180),o.drawImage(t,0,0),PB(r,n)}function aI(t,n){return t.toCanvas().then((function(e){return cI(e,t.getType(),n)}))}function cI(t,n,e){var r=hB(t.width,t.height),o=bB(r);return"v"===e?(o.scale(1,-1),o.drawImage(t,0,-r.height)):(o.scale(-1,1),o.drawImage(t,-r.width,0)),PB(r,n)}function sI(t,n,e,r,o){return t.toCanvas().then((function(i){return fI(i,t.getType(),n,e,r,o)}))}function fI(t,n,e,r,o,i){var u=hB(o,i),a=bB(u);return a.drawImage(t,-e,-r),PB(u,n)}function lI(t,n,e){return t.toCanvas().then((function(r){return rI(r,n,e).then((function(n){return PB(n,t.getType())}))}))}var dI=function(t){return JB(t)},mI=function(t){return nI(t)},gI=function(t,n){return eI(t,n)},pI=function(t,n,e,r){return tI(t,n,e,r)},hI=function(t,n){return QB(t,n)},vI=function(t,n){return ZB(t,n)},bI=function(t,n){return aI(t,n)},yI=function(t,n,e,r,o){return sI(t,n,e,r,o)},wI=function(t,n,e){return lI(t,n,e)},xI=function(t,n){return iI(t,n)},CI=function(t,n){return m({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},SI=function(t,n){return CI(zw(t,n),{})},kI=function(t,n){return CI(zw(t,n),{behaviours:mf([cy.config({})])})},OI=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:mf([cy.config({})])}},TI=Bu("toolbar.button.execute"),EI=function(t){return Vi((function(n,e){dS(t,n)((function(e){ui(n,TI,{buttonApi:e}),t.onAction(e)}))}))},DI={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},AI=Bu("update-menu-text"),_I=Bu("update-menu-icon"),RI=function(t,n,r){var o=We(e),i=t.text.map((function(t){return Lw(OI(t,n,r.providers))})),u=t.icon.map((function(t){return Lw(kI(t,r.providers.icons))})),a=function(t,n){var e=jg.getValue(t);return yy.focus(e),ui(e,"keydown",{raw:n.event().raw()}),xD.close(e),x.some(!0)},c=t.role.fold((function(){return{}}),(function(t){return{role:t}})),s=t.tooltip.fold((function(){return{}}),(function(t){var n=r.providers.translate(t);return{title:n,"aria-label":n}})),f=Lw(xD.sketch(m(m({},c),{dom:{tag:"button",classes:[n,n+"--select"].concat(W(t.classes,(function(t){return n+"--"+t}))),attributes:m({},s)},components:bS([u.map((function(t){return t.asSpec()})),i.map((function(t){return t.asSpec()})),x.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:zw("chevron-down",r.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:mf(p(t.dropdownBehaviours,[lS.button(t.disabled),OD.config({}),cy.config({}),fy("dropdown-events",[mS(t,o),gS(t,o)]),fy("menubutton-update-display-text",[Di(AI,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){cy.set(t,[uc(r.providers.translate(n.event().text()))])}))})),Di(_I,(function(t,n){u.bind((function(n){return n.getOpt(t)})).each((function(t){cy.set(t,[kI(n.event().icon(),r.providers.icons)])}))}))])])),eventOrder:Ot(DI,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:mf([Qb.config({mode:"special",onLeft:a,onRight:a})]),lazySink:r.getSink,toggleClass:n+"--active",parts:{menu:Qk(!1,t.columns,t.presets)},fetch:function(){return AE.nu(t.fetch)}})));return f.asSpec()},BI=function(t){return D(t)},II=function(t){return"separator"===t.type},PI=function(t){return bt(t,"getSubmenuItems")},NI={type:"separator"},MI=function(t,n){var e=$(t,(function(t,e){return BI(e)?""===e?t:"|"===e?t.length>0&&!II(t[t.length-1])?t.concat([NI]):t:bt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return e.length>0&&II(e[e.length-1])&&e.pop(),e},FI=function(t,n){var e=t.getSubmenuItems(),r=zI(e,n),o=Ot(r.menus,Xt(t.value,r.items)),i=Ot(r.expansions,Xt(t.value,t.value));return{item:t,menus:o,expansions:i}},LI=function(t,n){return PI(t)?FI(t,n):{item:t,menus:{},expansions:{}}},HI=function(t){if(II(t))return t;var n=qt(t,"value").getOrThunk((function(){return Bu("generated-menu-item")}));return Ot({value:n},t)},zI=function(t,n){var e=MI(D(t)?t.split(" "):t,n);return K(e,(function(t,e){var r=HI(e),o=LI(r,n);return{menus:Ot(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Ot(t.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},VI=function(t,n,e,r){var o=Bu("primary-menu"),i=zI(t,e.shared.providers.menuItems());if(0===i.items.length)return x.none();var u=EO(o,i.items,n,e,r),a=dt(i.menus,(function(t,r){return EO(r,t,n,e,!1)})),c=Ot(a,Xt(o,u));return x.from(xw.tieredData(o,c,i.expansions))},jI=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)},setActive:function(n){var e=t.element();n?(Ra(e,"tox-tbtn--enabled"),yu(e,"aria-pressed",!0)):(Ia(e,"tox-tbtn--enabled"),Su(e,"aria-pressed"))},isActive:function(){return Pa(t.element(),"tox-tbtn--enabled")}}},UI=function(t,n,e,r){return RI({text:t.text,icon:t.icon,tooltip:t.tooltip,role:r,fetch:function(n){t.fetch((function(t){n(VI(t,pS.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:jI,columns:1,presets:"normal",classes:[],dropdownBehaviours:[GE.config({})]},n,e.shared)},WI=function(t,n,e){var r=function(t){return function(r){var o=!r.isActive();r.setActive(o),t.storage.set(o),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){Tf(n.element()),ui(n,tE,{name:t.name,value:t.storage.get()})}))}))}},o=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(W(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return m(m({type:t.type},n),{onAction:r(t),onSetup:o(t)})})))}},GI=function(t,n,e,r,o){void 0===e&&(e=[]);var i=n.fold((function(){return{}}),(function(t){return{action:t}})),u=m({buttonBehaviours:mf([lS.button(t.disabled),GE.config({}),fy("button press",[Ei("click"),Ei("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),a=Ot(u,{dom:r});return Ot(a,{components:o})},qI=function(t,n,e,r){void 0===r&&(r=[]);var o=t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:o},u=t.icon.map((function(t){return SI(t,e.icons)})),a=bS([u]);return GI(t,n,r,i,a)},XI=function(t,n,e,r){void 0===r&&(r=[]);var o=qI(t,x.some(n),e,r);return Fw.sketch(o)},YI=function(t,n,e,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return SI(t,e.icons)})):x.none(),a=u.isSome()?bS([u]):[],c=u.isSome()?{}:{innerHtml:i},s=p(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],o),f=m(m({tag:"button",classes:s},c),{attributes:{title:i}});return GI(t,n,r,f,a)},KI=function(t,n,e,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=YI(t,x.some(n),e,r,o);return Fw.sketch(i)},$I=function(t,e){return function(r){"custom"===e?ui(r,tE,{name:t,value:{}}):"submit"===e?ii(r,nE):"cancel"===e?ii(r,ZT):n.console.error("Unknown button type: ",e)}},JI=function(t,n){return"menu"===n},QI=function(t,n){return"custom"===n||"cancel"===n||"submit"===n},ZI=function(t,e,r){if(JI(t,e)){var o=function(){return a},i=t,u=m(m({},t),{fetch:WI(i.items,o,r)}),a=Lw(UI(u,"tox-tbtn",r,x.none()));return a.asSpec()}if(QI(t,e)){var c=$I(t.name,e),s=m(m({},t),{borderless:!1});return KI(s,c,r.shared.providers,[])}n.console.error("Unknown footer button type: ",e)},tP=function(t,n){var e=$I(t.name,"custom");return XE(x.none(),lE.parts().field(m({factory:Fw},YI(t,x.some(e),n,[tB.memory(""),HR.self()]))))},nP=i([Ie("field1Name","field1"),Ie("field2Name","field2"),xs("onLockedChange"),vs(["lockClass"]),Ie("locked",!1),qg.field("coupledFieldBehaviours",[ih,jg])]),eP=function(t,n,e){return Np(t,n,e).bind(ih.getCurrent)},rP=function(t,n){return wp({factory:lE,name:t,overrides:function(t){return{fieldBehaviours:mf([fy("coupled-input-behaviour",[Di(Eo(),(function(e){eP(e,t,n).each((function(n){Np(e,t,"lock").each((function(r){Ly.isOn(r)&&t.onLockedChange(e,n,r)}))}))}))])])}}})},oP=i([rP("field1","field2"),rP("field2","field1"),wp({factory:Fw,schema:[ge("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:mf([Ly.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),iP=function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,behaviours:qg.augment(t.coupledFieldBehaviours,[ih.config({find:x.some}),jg.config({store:{mode:"manual",getValue:function(n){var e,r=zp(n,t,["field1","field2"]);return e={},e[t.field1Name]=jg.getValue(r.field1()),e[t.field2Name]=jg.getValue(r.field2()),e},setValue:function(n,e){var r=zp(n,t,["field1","field2"]);Qt(e,t.field1Name)&&jg.setValue(r.field1(),e[t.field1Name]),Qt(e,t.field2Name)&&jg.setValue(r.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Np(n,t,"field1")},getField2:function(n){return Np(n,t,"field2")},getLock:function(n){return Np(n,t,"lock")}}}},uP=th({name:"FormCoupledInputs",configFields:nP(),partFields:oP(),factory:iP,apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),aP=function(t){var n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(t){return t in n?n[t]:1},r=t.value.toFixed(e(t.unit));return-1!==r.indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+t.unit},cP=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=n.exec(t);if(null!==e){var r=parseFloat(e[1]),o=e[2];return O.value({value:r,unit:o})}return O.error(t)},sP=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},r=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?x.some(t.value):r(t.unit)&&r(n)?e[t.unit]===e[n]?x.some(t.value):x.some(t.value/e[t.unit]*e[n]):x.none()},fP=function(t){return x.none()},lP=function(t,n){return function(e){return sP(e,n).map((function(e){return{value:e*t,unit:n}}))}},dP=function(t,n){var e=cP(t).toOption(),r=cP(n).toOption();return ts(e,r,(function(t,n){return sP(t,n.unit).map((function(t){return n.value/t})).map((function(t){return lP(t,n.unit)})).getOr(fP)})).getOr(fP)},mP=function(t,n){var e=fP,r=Bu("ratio-event"),o=uP.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:zw("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:zw("unlock",n.icons)}}],buttonBehaviours:mf([lS.button(t.disabled),GE.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(n){return lE.parts().field({factory:vE,inputClasses:["tox-textfield"],inputBehaviours:mf([uS.config({disabled:t.disabled}),GE.config({}),fy("size-input-events",[Di(So(),(function(t,e){ui(t,r,{isField1:n})})),Di(Do(),(function(n,e){ui(n,JT,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=uP.parts().field1(i([lE.parts().label(a("Width")),u(!0)])),s=uP.parts().field2(i([lE.parts().label(a("Height")),u(!1)]));return uP.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,r){cP(jg.getValue(t)).each((function(t){e(t).each((function(t){jg.setValue(n,aP(t))}))}))},coupledFieldBehaviours:mf([uS.config({disabled:t.disabled,onDisabled:function(t){uP.getField1(t).bind(lE.getField).each(uS.disable),uP.getField2(t).bind(lE.getField).each(uS.disable),uP.getLock(t).each(uS.disable)},onEnabled:function(t){uP.getField1(t).bind(lE.getField).each(uS.enable),uP.getField2(t).bind(lE.getField).each(uS.enable),uP.getLock(t).each(uS.enable)}}),fy("size-input-events2",[Di(r,(function(t,n){var r=n.event().isField1(),o=r?uP.getField1(t):uP.getField2(t),i=r?uP.getField2(t):uP.getField1(t),u=o.map(jg.getValue).getOr(""),a=i.map(jg.getValue).getOr("");e=dP(u,a)}))])])})},gP=i(Bu("undo")),pP=i(Bu("redo")),hP=i(Bu("zoom")),vP=i(Bu("back")),bP=i(Bu("apply")),yP=i(Bu("swap")),wP=i(Bu("transform")),xP=i(Bu("temp-transform")),CP=i(Bu("transform-apply")),SP={undo:gP,redo:pP,zoom:hP,back:vP,apply:bP,swap:yP,transform:wP,tempTransform:xP,transformApply:CP},kP=i("save-state"),OP=i("disable"),TP=i("enable"),EP={formActionEvent:tE,saveState:kP,disable:OP,enable:TP},DP=function(t,n){var r=function(t,e,r,o){return Lw(KI({name:t,text:t,disabled:r,primary:o,icon:x.none(),borderless:!1},e,n))},o=function(t,e,r,o){return Lw(XI({name:t,icon:x.some(t),tooltip:x.some(e),disabled:o,primary:!1,borderless:!1},r,n))},u=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(uS)&&uS.disable(e)}))},a=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(uS)&&uS.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=e,f=function(t,n,e){ui(t,n,e)},l=function(t){return ii(t,EP.disable())},d=function(t){return ii(t,EP.enable())},m=function(t,n){l(t),f(t,SP.transform(),{transform:n}),d(t)},g=function(t,n){l(t),f(t,SP.tempTransform(),{transform:n}),d(t)},p=function(t){return function(){ut.getOpt(t).each((function(t){cy.set(t,[ot])}))}},h=function(t,n){l(t),f(t,SP.transformApply(),{transform:n,swap:p(t)}),d(t)},v=function(){return r("Back",(function(t){return f(t,SP.back(),{swap:p(t)})}),!1,!1)},b=function(){return Lw({dom:{tag:"div",classes:["tox-spacer"]},behaviours:mf([uS.config({})])})},y=function(){return r("Apply",(function(t){return f(t,SP.apply(),{swap:p(t)})}),!0,!0)},w=function(){return function(n){var e=t.getRect();return yI(n,e.x,e.y,e.w,e.h)}},C=[v(),b(),r("Apply",(function(n){var e=w();h(n,e),t.hideCrop()}),!1,!0)],S=bT.sketch({dom:c,components:C.map((function(t){return t.asSpec()})),containerBehaviours:mf([fy("image-tools-crop-buttons-events",[Di(EP.disable(),(function(t,n){u(C,t)})),Di(EP.enable(),(function(t,n){a(C,t)}))])])}),k=Lw(mP({name:"size",label:x.none(),constrain:!0,disabled:!1},n)),O=function(t,n){return function(e){return wI(e,t,n)}},T=[v(),b(),k,b(),r("Apply",(function(t){k.getOpt(t).each((function(n){var e=jg.getValue(n),r=parseInt(e.width,10),o=parseInt(e.height,10),i=O(r,o);h(t,i)}))}),!1,!0)],E=bT.sketch({dom:c,components:T.map((function(t){return t.asSpec()})),containerBehaviours:mf([fy("image-tools-resize-buttons-events",[Di(EP.disable(),(function(t,n){u(T,t)})),Di(EP.enable(),(function(t,n){a(T,t)}))])])}),D=function(t,n){return function(e){return t(e,n)}},A=D(bI,"h"),_=D(bI,"v"),R=D(xI,-90),B=D(xI,90),I=function(t,n){g(t,n)},P=[v(),b(),o("flip-horizontally","Flip horizontally",(function(t){I(t,A)}),!1),o("flip-vertically","Flip vertically",(function(t){I(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){I(t,R)}),!1),o("rotate-right","Rotate clockwise",(function(t){I(t,B)}),!1),b(),y()],N=bT.sketch({dom:c,components:P.map((function(t){return t.asSpec()})),containerBehaviours:mf([fy("image-tools-fliprotate-buttons-events",[Di(EP.disable(),(function(t,n){u(P,t)})),Di(EP.enable(),(function(t,n){a(P,t)}))])])}),M=function(t,e,r,o,u){var a=hR.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),c=hR.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=hR.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Lw(hR.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:i({x:i(o)})},components:[a,c,s],sliderBehaviours:mf([yy.config({})]),onChoose:e}))},F=function(t,n,e,r,o){var i=function(t,e,r){var o=D(n,r.x()/100);m(t,o)};return M(t,i,e,r,o)},L=function(t,n,e,r,o){return[v(),F(t,n,e,r,o),y()]},H=function(t,n,e,r,o){var i=L(t,n,e,r,o);return bT.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:mf([fy("image-tools-filter-panel-buttons-events",[Di(EP.disable(),(function(t,n){u(i,t)})),Di(EP.enable(),(function(t,n){a(i,t)}))])])})},z=[v(),b(),y()],V=bT.sketch({dom:c,components:z.map((function(t){return t.asSpec()}))}),j=H("Brightness",hI,-100,0,100),U=H("Contrast",vI,-100,0,100),W=H("Gamma",gI,-100,0,100),G=function(t,n,e){return function(r){return pI(r,t,n,e)}},q=function(t){var n=function(t,n,e){var r=X.getOpt(t),o=K.getOpt(t),i=Y.getOpt(t);r.each((function(n){o.each((function(e){i.each((function(r){var o=jg.getValue(n).x()/100,i=jg.getValue(r).x()/100,u=jg.getValue(e).x()/100,a=G(o,i,u);m(t,a)}))}))}))};return M(t,n,0,100,200)},X=q("R"),Y=q("G"),K=q("B"),$=[v(),X,Y,K,y()],J=bT.sketch({dom:c,components:$.map((function(t){return t.asSpec()}))}),Q=function(t,n,e){return function(r){var o=function(){ut.getOpt(r).each((function(n){cy.set(n,[t]),e(n)}))};f(r,SP.swap(),{transform:n,swap:o})}},Z=function(n){t.showCrop()},tt=function(n){k.getOpt(n).each((function(n){var e=t.getMeasurements(),r=e.width,o=e.height;jg.setValue(n,{width:r,height:o})}))},nt=x.some(mI),et=x.some(dI),rt=[o("crop","Crop",Q(S,x.none(),Z),!1),o("resize","Resize",Q(E,x.none(),tt),!1),o("orientation","Orientation",Q(N,x.none(),s),!1),o("brightness","Brightness",Q(j,x.none(),s),!1),o("sharpen","Sharpen",Q(V,nt,s),!1),o("contrast","Contrast",Q(U,x.none(),s),!1),o("color-levels","Color levels",Q(J,x.none(),s),!1),o("gamma","Gamma",Q(W,x.none(),s),!1),o("invert","Invert",Q(V,et,s),!1)],ot=bT.sketch({dom:c,components:rt.map((function(t){return t.asSpec()}))}),it=bT.sketch({dom:{tag:"div"},components:[ot],containerBehaviours:mf([cy.config({})])}),ut=Lw(it),at=function(t){return ut.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))};return{memContainer:ut,getApplyButton:at}},AP=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),_P=tinymce.util.Tools.resolve("tinymce.geom.Rect"),RP=tinymce.util.Tools.resolve("tinymce.util.Observable"),BP=tinymce.util.Tools.resolve("tinymce.util.Tools"),IP=tinymce.util.Tools.resolve("tinymce.util.VK");function PP(t){var n,e,r,o,i,u,a,c,s=Math.max;return n=t.documentElement,e=t.body,r=s(n.scrollWidth,e.scrollWidth),o=s(n.clientWidth,e.clientWidth),i=s(n.offsetWidth,e.offsetWidth),u=s(n.scrollHeight,e.scrollHeight),a=s(n.clientHeight,e.clientHeight),c=s(n.offsetHeight,e.offsetHeight),{width:r<i?o:r,height:u<c?a:u}}function NP(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function MP(t,e){var r,o,i,u,a,c,s,f=e.document||n.document;e=e||{};var l=f.getElementById(e.handle||t);i=function(t){var i,d,m=PP(f);NP(t),t.preventDefault(),o=t.button,i=l,c=t.screenX,s=t.screenY,d=n.window.getComputedStyle?n.window.getComputedStyle(i,null).getPropertyValue("cursor"):i.runtimeStyle.cursor,r=AP("<div></div>").css({position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(f.body),AP(f).on("mousemove touchmove",a).on("mouseup touchend",u),e.start(t)},a=function(t){if(NP(t),t.button!==o)return u(t);t.deltaX=t.screenX-c,t.deltaY=t.screenY-s,t.preventDefault(),e.drag(t)},u=function(t){NP(t),AP(f).off("mousemove touchmove",a).off("mouseup touchend",u),r.remove(),e.stop&&e.stop(t)},this.destroy=function(){AP(l).off()},AP(l).on("mousedown touchstart",i)}var FP=0,LP=function(t,n,e,r,o){var i,u,a,c="tox-",s=c+"crid-"+FP++,f=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}];a=["top","right","bottom","left"];var l=function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},d=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},m=function(){return d(e,t)};function g(n,r,o,u){var a,c,s,f,l;a=r.x,c=r.y,s=r.w,f=r.h,a+=o*n.deltaX,c+=u*n.deltaY,s+=o*n.deltaW,f+=u*n.deltaH,s<20&&(s=20),f<20&&(f=20),l=t=_P.clamp({x:a,y:c,w:s,h:f},e,"move"===n.name),l=d(e,l),i.fire("updateRect",{rect:l}),w(l)}function p(){function n(n){var e;return new MP(s,{document:r.ownerDocument,handle:s+"-"+n.name,start:function(){e=t},drag:function(t){g(n,e,t.deltaX,t.deltaY)}})}AP('<div id="'+s+'" class="'+c+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),BP.each(a,(function(t){AP("#"+s,r).append('<div id="'+s+"-"+t+'"class="'+c+'croprect-block" style="display: none" data-mce-bogus="all">')})),BP.each(f,(function(t){AP("#"+s,r).append('<div id="'+s+"-"+t.name+'" class="'+c+"croprect-handle "+c+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),u=BP.map(f,n),v(t),AP(r).on("focusin focusout",(function(t){AP(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),AP(r).on("keydown",(function(n){var e;function r(t,n,r,o,i){t.stopPropagation(),t.preventDefault(),g(e,r,o,i)}switch(BP.each(f,(function(t){if(n.target.id===s+"-"+t.name)return e=t,!1})),n.keyCode){case IP.LEFT:r(n,e,t,-10,0);break;case IP.RIGHT:r(n,e,t,10,0);break;case IP.UP:r(n,e,t,0,-10);break;case IP.DOWN:r(n,e,t,0,10);break;case IP.ENTER:case IP.SPACEBAR:n.preventDefault(),o();break}}))}function h(t){var n;n=BP.map(f,(function(t){return"#"+s+"-"+t.name})).concat(BP.map(a,(function(t){return"#"+s+"-"+t}))).join(","),t?AP(n,r).show():AP(n,r).hide()}function v(t){function e(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),AP("#"+s+"-"+t,r).css({left:n.x,top:n.y,width:n.w,height:n.h})}BP.each(f,(function(n){AP("#"+s+"-"+n.name,r).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function b(n){t=n,v(t)}function y(e){n=e,v(t)}function w(t){b(l(e,t))}function x(n){e=n,v(t)}function C(){BP.each(u,(function(t){t.destroy()})),u=[]}return p(),i=BP.extend({toggleVisibility:h,setClampRect:x,setRect:b,getInnerRect:m,setInnerRect:w,setViewPortRect:y,destroy:C},RP),i},HP={create:LP},zP=function(t){return new px((function(n){var e=function(){t.removeEventListener("load",e),n(t)};t.complete?n(t):t.addEventListener("load",e)}))},VP=function(t){var n=Lw({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=We(1),r=We(x.none()),o=We({x:0,y:0,w:1,h:1}),i=We({x:0,y:0,w:1,h:1}),u=function(t,i){g.getOpt(t).each((function(t){var u=e.get(),a=Oc(t.element()),c=gc(t.element()),s=i.dom().naturalWidth*u,f=i.dom().naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Va(i,m),n.getOpt(t).each((function(t){Va(t.element(),m)})),r.get().each((function(t){var n=o.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){g.getOpt(t).each((function(t){var r=Oc(t.element()),o=gc(t.element()),i=n.dom().naturalWidth,u=n.dom().naturalHeight,a=Math.min(r/i,o/u);a>=1?e.set(1):e.set(a)}))},c=function(t,n){var e=$e.fromTag("img");return yu(e,"src",n),zP(e.dom()).then((function(){return g.getOpt(t).map((function(t){var n=ac({element:e});cy.replaceAt(t,1,x.some(n));var r=i.get(),c={x:0,y:0,w:e.dom().naturalWidth,h:e.dom().naturalHeight};i.set(c);var s=_P.inflate(c,-20,-20);return o.set(s),r.w===c.w&&r.h===c.h||a(t,e),u(t,e),e}))}))},s=function(t,n){var r=e.get(),o=n>0?Math.min(2,r+.1):Math.max(.1,r-.1);e.set(o),g.getOpt(t).each((function(t){var n=t.components()[1].element();u(t,n)}))},f=function(){r.get().each((function(t){t.toggleVisibility(!0)}))},l=function(){r.get().each((function(t){t.toggleVisibility(!1)}))},d=function(){return o.get()},m=bT.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:mf([fy("image-panel-crop-events",[Li((function(t){g.getOpt(t).each((function(t){var n=t.element().dom(),i=HP.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,(function(){}));i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,r=e.get(),i={x:Math.round(n.x/r),y:Math.round(n.y/r),w:Math.round(n.w/r),h:Math.round(n.h/r)};o.set(i)})),r.set(x.some(i))}))}))])])}],containerBehaviours:mf([cy.config({}),fy("image-panel-events",[Li((function(n){c(n,t)}))])])}),g=Lw(m),p=function(){var t=i.get();return{width:t.w,height:t.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:f,hideCrop:l,getRect:d,getMeasurements:p}},jP=function(t,n,e,r,o){return XI({name:t,icon:x.some(n),disabled:e,tooltip:x.some(t),primary:!1,borderless:!1},r,o)},UP=function(t,n){n?uS.enable(t):uS.disable(t)},WP=function(t){var n=function(t,n,o){e.getOpt(t).each((function(t){UP(t,n)})),r.getOpt(t).each((function(t){UP(t,o)}))},e=Lw(jP("Undo","undo",!0,(function(t){ui(t,SP.undo(),{direction:1})}),t)),r=Lw(jP("Redo","redo",!0,(function(t){ui(t,SP.redo(),{direction:1})}),t)),o=bT.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),r.asSpec(),jP("Zoom in","zoom-in",!1,(function(t){ui(t,SP.zoom(),{direction:1})}),t),jP("Zoom out","zoom-out",!1,(function(t){ui(t,SP.zoom(),{direction:-1})}),t)]});return{container:o,updateButtonUndoStates:n}};function GP(){var t=[],n=-1;function e(e){var r;return r=t.splice(++n),t.push(e),{state:e,removed:r}}function r(){if(i())return t[--n]}function o(){if(u())return t[++n]}function i(){return n>0}function u(){return-1!==n&&n<t.length-1}return{data:t,add:e,undo:r,redo:o,canUndo:i,canRedo:u}}var qP,XP=function(t){var e=We(t),r=We(x.none()),o=GP();o.add(t);var i=function(){return e.get()},u=function(t){e.set(t)},a=function(){return r.get().fold((function(){return e.get()}),(function(t){return t}))},c=function(t){var n=s(t);return d(),r.set(x.some(n)),n.url},s=function(t){return{blob:t,url:n.URL.createObjectURL(t)}},f=function(t){n.URL.revokeObjectURL(t.url)},l=function(t){BP.each(t,f)},d=function(){r.get().each(f),r.set(x.none())},m=function(t){var n=s(t);u(n);var e=o.add(n).removed;return l(e),n.url},g=function(t){var n=s(t);return r.set(x.some(n)),n.url},p=function(t){return r.get().fold((function(){}),(function(n){m(n.blob),t()}))},h=function(){var t=o.undo();return u(t),t.url},v=function(){var t=o.redo();return u(t),t.url},b=function(){var t=o.canUndo(),n=o.canRedo();return{undoEnabled:t,redoEnabled:n}};return{getBlobState:i,setBlobState:u,addBlobState:m,getTempState:a,updateTempState:c,addTempState:g,applyTempState:p,destroyTempState:d,undo:h,redo:v,getHistoryStates:b}},YP=function(t,r){var o=XP(t.currentState),i=function(t,n){var e=n.event().direction();O.zoom(t,e)},u=function(t){var n=o.getHistoryStates();T.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),ui(t,EP.formActionEvent,{name:EP.saveState(),value:n.undoEnabled})},a=function(t){T.updateButtonUndoStates(t,!1,!1)},c=function(t,n){var e=o.undo();m(t,e).then((function(n){d(t),u(t)}))},s=function(t,n){var e=o.redo();m(t,e).then((function(n){d(t),u(t)}))},f=function(t){return t.toBlob()},l=function(t){ui(t,EP.formActionEvent,{name:EP.disable(),value:{}})},d=function(t){E.getApplyButton(t).each((function(t){uS.enable(t)})),ui(t,EP.formActionEvent,{name:EP.enable(),value:{}})},m=function(t,n){return l(t),O.updateSrc(t,n)},g=function(t,e,r,o,i){return l(t),NB(e).then(r).then(f).then(o).then((function(n){return m(t,n).then((function(n){return u(t),i(),d(t),n}))})).catch((function(e){return n.console.log(e),d(t),e}))},p=function(t,n,e){var r=o.getBlobState().blob,i=function(t){return o.updateTempState(t)};g(t,r,n,i,e)},h=function(t,n){var r=o.getTempState().blob,i=function(t){return o.addTempState(t)};g(t,r,n,i,e)},v=function(t,n,e){var r=o.getBlobState().blob,i=function(n){var e=o.addBlobState(n);return y(t),e};g(t,r,n,i,e)},b=function(t,n){var e=function(){y(t);var e=n.event().swap();e()};o.applyTempState(e)},y=function(t){var n=o.getBlobState().url;return o.destroyTempState(),u(t),n},w=function(t){var n=y(t);m(t,n).then((function(n){d(t)}))},x=function(t,n){w(t);var e=n.event().swap();e(),O.hideCrop()},C=function(t,n){return p(t,n.event().transform(),e)},S=function(t,n){return h(t,n.event().transform())},k=function(t,n){return v(t,n.event().transform(),n.event().swap())},O=VP(t.currentState.url),T=WP(r),E=DP(O,r),D=function(t,n){a(t);var e=n.event().transform(),r=n.event().swap();e.fold((function(){r()}),(function(n){p(t,n,r)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[E.memContainer.asSpec(),O.memContainer.asSpec(),T.container],behaviours:mf([jg.config({store:{mode:"manual",getValue:function(){return o.getBlobState()}}}),fy("image-tools-events",[Di(SP.undo(),c),Di(SP.redo(),s),Di(SP.zoom(),i),Di(SP.back(),x),Di(SP.apply(),b),Di(SP.transform(),C),Di(SP.tempTransform(),S),Di(SP.transformApply(),k),Di(SP.swap(),D)]),HR.self()])}},KP=function(t,n){var e=W(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),r=t.data.map((function(t){return Xt("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Gg(t.selectBehaviours,[yy.config({}),jg.config({store:m({mode:"manual",getValue:function(t){return Ka(t.element())},setValue:function(n,e){var r=J(t.options,(function(t){return t.value===e}));r.isSome()&&$a(n.element(),e)}},r)})])}},$P=Zp({name:"HtmlSelect",configFields:[ge("options"),Ug("selectBehaviours",[yy,jg]),Ie("selectClasses",[]),Ie("selectAttributes",{}),Oe("data")],factory:KP}),JP=function(t,n){var e=W(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),r=t.label.map((function(t){return JE(t,n)})),o=lE.parts().field({dom:{},selectAttributes:{size:t.size},options:e,factory:$P,selectBehaviours:mf([uS.config({disabled:t.disabled}),GE.config({}),fy("selectbox-change",[Di(Do(),(function(n,e){ui(n,JT,{name:t.name})}))])])}),i=t.size>1?x.none():x.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:zw("chevron-down",n.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:Z([[o],i.toArray()])};return lE.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Z([r.toArray(),[u]]),fieldBehaviours:mf([uS.config({disabled:t.disabled,onDisabled:function(t){lE.getField(t).each(uS.disable)},onEnabled:function(t){lE.getField(t).each(uS.enable)}})])})},QP=function(t,n){var e=t.label.map((function(t){return JE(t,n)})),r=[uS.config({disabled:t.disabled}),Qb.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return ii(t,nE),x.some(!0)}}),fy("textfield-change",[Di(Eo(),(function(n,e){ui(n,JT,{name:t.name})})),Di(No(),(function(n,e){ui(n,JT,{name:t.name})}))]),GE.config({})],o=t.validation.map((function(t){return VE.config({getRoot:function(t){return Qi(t.element())},invalidClass:"tox-invalid",validator:{validate:function(n){var e=jg.getValue(n),r=t.validator(e);return AE.pure(!0===r?O.value(e):O.error(r))},validateOnLoad:t.validateOnLoad}})})).toArray(),u=t.placeholder.fold(i({}),(function(t){return{placeholder:n.translate(t)}})),a=t.inputMode.fold(i({}),(function(t){return{inputmode:t}})),c=m(m({},u),a),s=lE.parts().field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:mf(Z([r,o])),selectOnFocus:!1,factory:vE}),f=t.flex?["tox-form__group--stretched"]:[],l=f.concat(t.maximized?["tox-form-group--maximize"]:[]),d=[uS.config({disabled:t.disabled,onDisabled:function(t){lE.getField(t).each(uS.disable)},onEnabled:function(t){lE.getField(t).each(uS.enable)}})];return qE(e,s,l,d)},ZP=function(t,n){return QP({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:x.none(),maximized:t.maximized},n)},tN=function(t,n){return QP({name:t.name,multiline:!0,label:t.label,inputMode:x.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:x.none(),maximized:t.maximized},n)},nN=function(t,n){var e=t.stream.streams,r=e.setup(t,n);return ki([Di(t.event,r),Hi((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Di(t,(function(){return n.cancel()}))]})).getOr([])))},eN=Object.freeze({events:nN}),rN=function(t){var n=We(null),e=function(){return{timer:null!==n.get()?"set":"unset"}},r=function(t){n.set(t)},o=function(){var t=n.get();null!==t&&t.cancel()};return Zu({readState:e,setTimer:r,cancel:o})},oN=function(t){return t.stream.streams.state(t)},iN=Object.freeze({throttle:rN,init:oN}),uN=function(t,n){var e=t.stream,r=$w(t.onStream,e.delay);return n.setTimer(r),function(t,n){r.throttle(t,n),e.stopEvent&&n.stop()}},aN=[pe("stream",oe("mode",{throttle:[ge("delay"),Ie("stopEvent",!0),Ss("streams",{setup:uN,state:rN})]})),Ie("event","input"),Oe("cancelEvent"),xs("onStream")],cN=pf({fields:aN,name:"streaming",active:eN,state:iN}),sN=function(t,n,e){var r=jg.getValue(e);jg.setValue(n,r),lN(n)},fN=function(t,n){var e=t.element(),r=Ka(e),o=e.dom();"number"!==xu(e,"type")&&n(o,r)},lN=function(t){fN(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},dN=function(t,n){fN(t,(function(t,e){return t.setSelectionRange(n,e.length)}))},mN=function(t,n,e){if(t.selectsOver){var r=jg.getValue(n),o=t.getDisplayText(r),i=jg.getValue(e),u=t.getDisplayText(i);return 0===u.indexOf(o)?x.some((function(){sN(t,n,e),dN(n,o.length)})):x.none()}return x.none()},gN=i("alloy.typeahead.itemexecute"),pN=function(t,n,r,o){var i=function(n,r,i){t.previewing.set(!1);var u=rD.getCoupled(n,"sandbox");if(ug.isOpen(u))ih.getCurrent(u).each((function(t){Oh.getHighlighted(t).fold((function(){i(t)}),(function(){fi(u,t.element(),"keydown",r)}))}));else{var c=function(t){ih.getCurrent(t).each(i)};sD(t,a(n),n,u,o,c,wE.HighlightFirst).get(e)}},u=mE(t),a=function(t){return function(n){return n.map((function(n){var e=ht(n.menus),r=tt(e,(function(t){return Y(t.items,(function(t){return"item"===t.type}))})),o=jg.getState(t);return o.update(W(r,(function(t){return t.data}))),n}))}},c=[yy.config({}),jg.config({onSetValue:t.onSetValue,store:m({mode:"dataset",getDataKey:function(t){return Ka(t.element())},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){$a(n.element(),t.model.getDisplayText(e))}},t.initialData.map((function(t){return Xt("initialValue",t)})).getOr({}))}),cN.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,r){var i=rD.getCoupled(n,"sandbox"),u=yy.isFocused(n);if(u&&Ka(n.element()).length>=t.minChars){var c=ih.getCurrent(i).bind((function(t){return Oh.getHighlighted(t).map(jg.getValue)}));t.previewing.set(!0);var s=function(n){ih.getCurrent(i).each((function(n){c.fold((function(){t.model.selectsOver&&Oh.highlightFirst(n)}),(function(t){Oh.highlightBy(n,(function(n){var e=jg.getValue(n);return e.value===t.value})),Oh.getHighlighted(n).orThunk((function(){return Oh.highlightFirst(n),x.none()}))}))}))};sD(t,a(n),n,i,o,s,wE.HighlightFirst).get(e)}},cancelEvent:Uo()}),Qb.config({mode:"special",onDown:function(t,n){return i(t,n,Oh.highlightFirst),x.some(!0)},onEscape:function(t){var n=rD.getCoupled(t,"sandbox");return ug.isOpen(n)?(ug.close(n),x.some(!0)):x.none()},onUp:function(t,n){return i(t,n,Oh.highlightLast),x.some(!0)},onEnter:function(n){var e=rD.getCoupled(n,"sandbox"),r=ug.isOpen(e);if(r&&!t.previewing.get())return ih.getCurrent(e).bind((function(t){return Oh.getHighlighted(t)})).map((function(t){return ui(n,gN(),{item:t}),!0}));var o=jg.getValue(n);return ii(n,Uo()),t.onExecute(e,n,o),r&&ug.close(e),x.some(!0)}}),Ly.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),rD.config({others:{sandbox:function(n){return pD(t,n,{onOpen:function(){return Ly.on(n)},onClose:function(){return Ly.off(n)}})}}}),fy("typeaheadevents",[Vi((function(n){var r=e;lD(t,a(n),n,o,r,wE.HighlightFirst).get(e)})),Di(gN(),(function(n,e){var r=rD.getCoupled(n,"sandbox");sN(t.model,n,e.event().item()),ii(n,Uo()),t.onItemExecute(n,r,e.event().item(),jg.getValue(n)),ug.close(r),lN(n)}))].concat(t.dismissOnBlur?[Di(Po(),(function(t){var n=rD.getCoupled(t,"sandbox");_f(n.element()).isNone()&&ug.close(n)}))]:[]))];return{uid:t.uid,dom:pE(Ot(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:m(m({},u),Gg(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}},hN=i([Oe("lazySink"),ge("fetch"),Ie("minChars",5),Ie("responseTime",1e3),ys("onOpen"),Ie("getHotspot",x.some),Ie("getAnchorOverrides",i({})),Ie("layouts",x.none()),Ie("eventOrder",{}),je("model",{},[Ie("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),Ie("selectsOver",!0),Ie("populateFromBrowse",!0)]),ys("onSetValue"),ws("onExecute"),ys("onItemExecute"),Ie("inputClasses",[]),Ie("inputAttributes",{}),Ie("inputStyles",{}),Ie("matchWidth",!0),Ie("useMinWidth",!1),Ie("dismissOnBlur",!0),vs(["openClass"]),Oe("initialData"),Ug("typeaheadBehaviours",[yy,jg,cN,Qb,Ly,rD]),Ue("previewing",(function(){return We(!0)}))].concat(dE()).concat(vD())),vN=i([xp({schema:[hs()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(r){mN(t.model,r,e).fold((function(){return Oh.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&sN(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOption().map((function(t){return ui(t,gN(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&sN(t.model,n,e)}))}}}})]),bN=th({name:"Typeahead",configFields:hN(),partFields:vN(),factory:pN}),yN=function(t){var e=function(){return yN(t.toCached())},r=function(n){return yN(t.bind((function(t){return t.fold((function(t){return AE.pure(O.error(t))}),(function(t){return n(t)}))})))},o=function(n){return yN(t.map((function(t){return t.bind(n)})))},i=function(n){return yN(t.map((function(t){return t.map(n)})))},u=function(n){return yN(t.map((function(t){return t.mapError(n)})))},a=function(n,e){return t.map((function(t){return t.fold(n,e)}))},c=function(e,r){return yN(AE.nu((function(o){var i=!1,u=n.setTimeout((function(){i=!0,o(O.error(r()))}),e);t.get((function(t){i||(n.clearTimeout(u),o(t))}))})))};return m(m({},t),{toCached:e,bindFuture:r,bindResult:o,mapResult:i,mapError:u,foldResult:a,withTimeout:c})},wN=function(t){return yN(AE.nu(t))},xN=function(t){return yN(AE.pure(O.value(t)))},CN=function(t){return yN(AE.pure(O.error(t)))},SN=function(t){return yN(AE.pure(t))},kN=function(t){return yN(t.map(O.value))},ON=function(t){return wN((function(n){t.then((function(t){n(O.value(t))}),(function(t){n(O.error(t))}))}))},TN={nu:wN,wrap:yN,pure:xN,value:xN,error:CN,fromResult:SN,fromFuture:kN,fromPromise:ON},EN={type:"separator"},DN=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},AN=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:function(){}}},_N=function(t){return W(t,DN)},RN=function(t,n){return Y(n,(function(n){return n.type===t}))},BN=function(t,n){return _N(RN(t,n))},IN=function(t){return BN("header",t.targets)},PN=function(t){return BN("anchor",t.targets)},NN=function(t){return x.from(t.anchorTop).map((function(t){return AN("<top>",t)})).toArray()},MN=function(t){return x.from(t.anchorBottom).map((function(t){return AN("<bottom>",t)})).toArray()},FN=function(t){return W(t,(function(t){return AN(t,t)}))},LN=function(t){return $(t,(function(t,n){var e=0===t.length||0===n.length;return e?t.concat(n):t.concat(EN,n)}),[])},HN=function(t,n){var e=t.toLowerCase();return Y(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return Pr(n.toLowerCase(),e)||Pr(t.value.toLowerCase(),e)}))},zN=function(t,n,e){var r=jg.getValue(n),o=void 0!==r.meta.text?r.meta.text:r.value,i=e.getLinkInformation();return i.fold((function(){return[]}),(function(n){var r=HN(o,FN(e.getHistory(t)));return"file"===t?LN([r,HN(o,IN(n)),HN(o,Z([NN(n),PN(n),MN(n)]))]):r}))},VN=Bu("aria-invalid"),jN=function(t,n,r){var o,i=n.shared.providers,u=function(n){var e=jg.getValue(n);r.addToHistory(e.value,t.filetype)},a=lE.parts().field({factory:bN,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":VN,type:"url"},minChars:0,responseTime:0,fetch:function(e){var o=zN(t.filetype,e,r),i=VI(o,pS.BUBBLE_TO_SANDBOX,n,!1);return AE.pure(i)},getHotspot:function(t){return p.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(VE)&&VE.run(t).get(e)},typeaheadBehaviours:mf(Z([r.getValidationHandler().map((function(n){return VE.config({getRoot:function(t){return Qi(t.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){f.getOpt(t).each((function(t){yu(t.element(),"title",i.translate(n))}))}},validator:{validate:function(e){var r=jg.getValue(e);return TN.nu((function(e){n({type:t.filetype,url:r.value},(function(t){if("invalid"===t.status){var n=O.error(t.message);e(n)}else{var r=O.value(t.message);e(r)}}))}))},validateOnLoad:!1}})})).toArray(),[uS.config({disabled:t.disabled}),GE.config({}),fy("urlinput-events",Z(["file"===t.filetype?[Di(Eo(),(function(n){ui(n,JT,{name:t.name})}))]:[],[Di(Do(),(function(n){ui(n,JT,{name:t.name}),u(n)})),Di(No(),(function(n){ui(n,JT,{name:t.name}),u(n)}))]]))]])),eventOrder:(o={},o[Eo()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Qk(!1,1,"normal")},onExecute:function(t,n,e){ui(n,nE,{})},onItemExecute:function(n,e,r,o){u(n),ui(n,JT,{name:t.name})}}),c=t.label.map((function(t){return JE(t,i)})),s=function(t,n,e,r){return void 0===e&&(e=t),void 0===r&&(r=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:zw(e,i.icons),attributes:m({title:i.translate(r),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))}}},f=Lw(s("invalid",x.some(VN),"warning")),l=Lw({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),d=r.getUrlPicker(t.filetype),g=Bu("browser.url.event"),p=Lw({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,l.asSpec()],behaviours:mf([uS.config({disabled:t.disabled})])}),h=Lw(KI({name:t.name,icon:x.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return ii(t,g)}),i,[],["tox-browse-url"])),v=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Z([[p.asSpec()],d.map((function(){return h.asSpec()})).toArray()])}},b=function(n){ih.getCurrent(n).each((function(e){var r=jg.getValue(e);d.each((function(o){o(r).get((function(r){jg.setValue(e,r),ui(n,JT,{name:t.name})}))}))}))};return lE.sketch({dom:KE(),components:c.toArray().concat([v()]),fieldBehaviours:mf([uS.config({disabled:t.disabled,onDisabled:function(t){lE.getField(t).each(uS.disable),h.getOpt(t).each(uS.disable)},onEnabled:function(t){lE.getField(t).each(uS.enable),h.getOpt(t).each(uS.enable)}}),fy("url-input-events",[Di(g,b)])])})},UN=function(t,n){var e=jg.config({store:{mode:"manual",getValue:function(t){var n=t.element().dom();return n.checked},setValue:function(t,n){var e=t.element().dom();e.checked=n}}}),r=function(t){return t.element().dom().click(),x.some(!0)},o=lE.parts().field({factory:{sketch:u},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:mf([HR.self(),uS.config({disabled:t.disabled}),GE.config({}),yy.config({}),e,Qb.config({mode:"special",onEnter:r,onSpace:r,stopSpaceKeyup:!0}),fy("checkbox-events",[Di(Do(),(function(n,e){ui(n,JT,{name:t.name})}))])])}),i=lE.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:mf([OD.config({})])}),a=function(t){var e="checked"===t?"selected":"unselected";return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:zw(e,n.icons)}}},c=Lw({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return lE.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[o,c.asSpec(),i],fieldBehaviours:mf([uS.config({disabled:t.disabled,disableClass:"tox-checkbox--disabled",onDisabled:function(t){lE.getField(t).each(uS.disable)},onEnabled:function(t){lE.getField(t).each(uS.enable)}})])})},WN=function(t){return"presentation"===t.presets?bT.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):bT.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:mf([GE.config({}),yy.config({})])})},GN=function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},r=W(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(r),behaviours:mf([HR.self(),cy.config({}),tB.domHtml(x.none()),Qb.config({mode:"acyclic"})])}},qN=function(t,n){var e=t.label.map((function(t){return JE(t,n)})),r=function(t){return function(n,e){qc(e.event().target(),"[data-collection-item-value]").each((function(r){t(n,e,r,xu(r,"data-collection-item-value"))}))}},o=function(t){return'"'===t?"&quot;":t},i=function(n,e){var r=W(e,(function(n){var e=lC.translate(n.text),r=1===t.columns?'<div class="tox-collection__item-label">'+e+"</div>":"",i='<div class="tox-collection__item-icon">'+n.icon+"</div>",u={_:" "," - ":" ","-":" "},a=e.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+o(n.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i=t.columns>1&&"auto"!==t.columns?U(r,t.columns):[r],u=W(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));hu(n.element(),u.join(""))},a=[Di(Co(),r((function(t,n,e){Tf(e)}))),Di(zo(),r((function(n,e,r,o){e.stop(),ui(n,tE,{name:t.name,value:o})}))),Di(So(),r((function(t,n,e){Gc(t.element(),"."+SC).each((function(t){Ia(t,SC)})),Ra(e,SC)}))),Di(ko(),r((function(t){Gc(t.element(),"."+SC).each((function(t){Ia(t,SC)}))}))),Vi(r((function(n,e,r,o){ui(n,tE,{name:t.name,value:o})})))],c=lE.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:u},behaviours:mf([cy.config({}),jg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){i(n,e),"auto"===t.columns&&qx(n,5,"tox-collection__item").each((function(t){var e=t.numRows,r=t.numColumns;Qb.setGridSize(n,e,r)})),ii(n,iE)}}),GE.config({}),Qb.config(aO(t.columns,"normal")),fy("collection-events",a)])}),s=["tox-form__group--collection"];return qE(e,c,s,[])},XN=function(t,n){var e=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},r=function(t){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(t,e)}]}},o=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},i=function(t){return{dom:{tag:"tr"},components:W(t,o)}},u=function(t){return{dom:{tag:"tbody"},components:W(t,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[r(t.header),u(t.cells)],behaviours:mf([GE.config({}),yy.config({})])}},YN=function(t,n){return{dom:{tag:"div",classes:t.classes},components:W(t.items,n.shared.interpreter)}},KN=function(t){return function(n,e,r){return qt(e,"name").fold((function(){return t(e,r)}),(function(o){return n.field(o,t(e,r))}))}},$N=function(t){return function(n,e,r){var o=Ot(e,{source:"dynamic"});return KN(t)(n,o,r)}},JN={bar:KN((function(t,n){return aE(t,n.shared)})),collection:KN((function(t,n){return qN(t,n.shared.providers)})),alertbanner:KN((function(t,n){return uE(t,n.shared.providers)})),input:KN((function(t,n){return ZP(t,n.shared.providers)})),textarea:KN((function(t,n){return tN(t,n.shared.providers)})),label:KN((function(t,n){return GN(t,n.shared)})),iframe:$N((function(t,n){return pB(t,n.shared.providers)})),button:KN((function(t,n){return tP(t,n.shared.providers)})),checkbox:KN((function(t,n){return UN(t,n.shared.providers)})),colorinput:KN((function(t,n){return _D(t,n.shared,n.colorinput)})),colorpicker:KN(UR),dropzone:KN((function(t,n){return rB(t,n.shared.providers)})),grid:KN((function(t,n){return oB(t,n.shared)})),selectbox:KN((function(t,n){return JP(t,n.shared.providers)})),sizeinput:KN((function(t,n){return mP(t,n.shared.providers)})),urlinput:KN((function(t,n){return jN(t,n,n.urlinput)})),customeditor:KN(qR),htmlpanel:KN(WN),imagetools:KN((function(t,n){return YP(t,n.shared.providers)})),table:KN((function(t,n){return XN(t,n.shared.providers)})),panel:KN((function(t,n){return YN(t,n)}))},QN={field:function(t,n){return n}},ZN=function(t,n,e){var r=Ot(e,{shared:{interpreter:function(n){return tM(t,n,r)}}});return tM(t,n,r)},tM=function(t,e,r){return qt(JN,e.type).fold((function(){return n.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e}),(function(n){return n(t,e,r)}))},nM=function(t,n){var e=QN;return tM(e,t,n)},eM=i((function(t,n){Ec(t,Math.floor(n))})),rM={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},oM=function(t,n,e){var r=function(){return{anchor:"node",root:t(),node:x.from(t()),bubble:If(-12,-12,rM),layouts:{onRtl:function(){return[Bw]},onLtr:function(){return[Iw]}},overrides:{maxHeightFunction:dm()}}},o=function(){return{anchor:"hotspot",hotspot:n(),bubble:If(-12,12,rM),layouts:{onRtl:function(){return[Xs]},onLtr:function(){return[Ys]}},overrides:{maxHeightFunction:dm()}}};return e?r:o},iM=function(t,n,e){var r=function(){return{anchor:"node",root:t(),node:x.from(t()),layouts:{onRtl:function(){return[Pw]},onLtr:function(){return[Pw]}}}},o=function(){return{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Qs]},onLtr:function(){return[Qs]}}}};return e?r:o},uM=function(t){return function(){return{anchor:"hotspot",hotspot:t(),overrides:{maxWidthFunction:eM()},layouts:{onRtl:function(){return[Xs,Ys]},onLtr:function(){return[Ys,Xs]}}}}},aM=function(t,n){return function(){return{anchor:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return x.some(yl.range($e.fromDom(n.startContainer),n.startOffset,$e.fromDom(n.endContainer),n.endOffset))}}}},cM=function(t){return function(n){return{anchor:"node",root:t(),node:n}}},sM=function(t,n,e){var r=zT(t),o=function(){return $e.fromDom(t.getBody())};return{toolbar:oM(o,n,r),toolbarOverflow:uM(e),banner:iM(o,n,r),cursor:aM(t,o),node:cM(o)}},fM={getAnchors:sM},lM=function(t){return function(n,e){var r=zk.colorPickerDialog(t);r(n,e)}},dM=function(t){return function(){return vk.hasCustomColors(t)}},mM=function(t){return function(){return vk.getColors(t)}},gM=function(t){return function(){return zk.getColorCols(t)}},pM=function(t){return{colorPicker:lM(t),hasCustomColors:dM(t),getColors:mM(t),getColorCols:gM(t)}},hM=function(t){return function(){return WT(t)}},vM=function(t){return{isDraggableModal:hM(t)}},bM=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],yM=function(t){return bt(t,"items")},wM=function(t){return bt(t,"block")},xM=function(t){return bt(t,"inline")},CM=function(t){return bt(t,"selector")},SM=function(t){return $(t,(function(t,n){if(yM(n)){var e=SM(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(xM(n)||wM(n)||CM(n)){var r="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return m(m({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},kM=function(t,n){var e=SM(n),r=function(n){G(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))};return t.formatter?r(e.customFormats):t.on("init",(function(){r(e.customFormats)})),e.formats},OM=function(t){return _T(t).map((function(n){var e=kM(t,n);return RT(t)?bM.concat(e):e})).getOr(bM)},TM=function(t,n,e){var r={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Ot(t,r)},EM=function(t,n,e,r){var o=function(t){return TM(t,e,r)},u=function(t){var n={type:"submenu",isSelected:i(!1),getStylePreview:function(){return x.none()}};return Ot(t,n)},a=function(n){var o=Bu(n.title),i={type:"formatter",format:o,isSelected:e(o),getStylePreview:r(o)},u=Ot(n,i);return t.formatter.register(o,u),u},c=function(t){return W(t,(function(t){var n=st(t);if(Qt(t,"items")){var e=c(t.items);return Ot(u(t),{getStyleItems:function(){return e}})}return Qt(t,"format")?o(t):1===n.length&&z(n,"title")?Ot(t,{type:"separator"}):a(t)}))};return c(n)},DM=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?x.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)}):x.none()}},r=function(t){var n=t.items;return void 0!==n&&n.length>0?tt(n,r):[t.format]},o=We([]),i=We([]),u=We([]),a=We([]),c=We(!1);t.on("init",(function(){var u=OM(t),a=EM(t,u,n,e);o.set(a),i.set(tt(a,r))})),t.on("addStyleModifications",(function(o){var i=EM(t,o.items,n,e);u.set(i),c.set(o.replace),a.set(tt(i,r))}));var s=function(){var t=c.get()?[]:o.get(),n=u.get();return t.concat(n)},f=function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)};return{getData:s,getFlattenedKeys:f}},AM=BP.trim,_M=function(t){return function(n){if(n&&1===n.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},RM=_M("true"),BM=_M("false"),IM=function(t,n,e,r,o){return{type:t,title:n,url:e,level:r,attach:o}},PM=function(t){while(t=t.parentNode){var n=t.contentEditable;if(n&&"inherit"!==n)return RM(t)}return!1},NM=function(t,n){return W(cd($e.fromDom(n),t),(function(t){return t.dom()}))},MM=function(t){return t.innerText||t.textContent},FM=function(t){return t.id?t.id:Bu("h")},LM=function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)},HM=function(t){return LM(t)&&VM(t)},zM=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},VM=function(t){return PM(t)&&!BM(t)},jM=function(t){return zM(t)&&VM(t)},UM=function(t){return zM(t)?parseInt(t.nodeName.substr(1),10):0},WM=function(t){var n=FM(t),e=function(){t.id=n};return IM("header",MM(t),"#"+n,UM(t),e)},GM=function(t){var n=t.id||t.name,r=MM(t);return IM("anchor",r||"#"+n,"#"+n,0,e)},qM=function(t){return W(Y(t,jM),WM)},XM=function(t){return W(Y(t,HM),GM)},YM=function(t){var n=NM("h1,h2,h3,h4,h5,h6,a:not([href])",t);return n},KM=function(t){return AM(t.title).length>0},$M=function(t){var n=YM(t);return Y(qM(n).concat(XM(n)),KM)},JM={find:$M},QM="tinymce-url-history",ZM=5,tF=function(t){return D(t)&&/^https?/.test(t)},nF=function(t){return _(t)&&t.length<=ZM&&nt(t,tF)},eF=function(t){return A(t)&&pt(t,(function(t){return!nF(t)})).isNone()},rF=function(){var t,e=n.localStorage.getItem(QM);if(null===e)return{};try{t=JSON.parse(e)}catch(r){if(r instanceof SyntaxError)return n.console.log("Local storage "+QM+" was not valid JSON",r),{};throw r}return eF(t)?t:(n.console.log("Local storage "+QM+" was not valid format",t),{})},oF=function(t){if(!eF(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));n.localStorage.setItem(QM,JSON.stringify(t))},iF=function(t){var n=rF();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},uF=function(t,n){if(tF(t)){var e=rF(),r=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],o=Y(r,(function(n){return n!==t}));e[n]=[t].concat(o).slice(0,ZM),oF(e)}},aF=Object.prototype.hasOwnProperty,cF=function(t){return!!t},sF=function(t){return dt(BP.makeMap(t,/[, ]/),cF)},fF=function(t,n){return aF.call(t,n)?x.some(t[n]):x.none()},lF=function(t,n,e){var r=fF(t,n).getOr(e);return D(r)?x.some(r):x.none()},dF=function(t){return x.some(t.file_picker_callback).filter(B)},mF=function(t){var n=x.some(t.file_picker_types).filter(cF),e=x.some(t.file_browser_callback_types).filter(cF),r=n.or(e).map(sF);return dF(t).fold((function(){return!1}),(function(t){return r.fold((function(){return!0}),(function(t){return st(t).length>0&&t}))}))},gF=function(t,n){var e=mF(t);return R(e)?e?dF(t):x.none():e[n]?dF(t):x.none()},pF=function(t,n){return gF(t.settings,n).map((function(e){return function(r){return AE.nu((function(o){var i=function(t,n){if(!D(t))throw new Error("Expected value to be string");if(void 0!==n&&!A(n))throw new Error("Expected meta to be a object");var e={value:t,meta:n};o(e)},u=BP.extend({filetype:n},x.from(r.meta).getOr({}));e.call(t,i,r.value,u)}))}}))},hF=function(t){return!1===t.settings.typeahead_urls?x.none():x.some({targets:JM.find(t.getBody()),anchorTop:lF(t.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:lF(t.settings,"anchor_bottom","#bottom").getOrUndefined()})},vF=function(t){var n=x.from(t.settings.file_picker_validator_handler).filter(B);return n.orThunk((function(){return x.from(t.settings.filepicker_validator_handler).filter(B)}))},bF=function(t){return{getHistory:iF,addToHistory:uF,getLinkInformation:function(){return hF(t)},getValidationHandler:function(){return vF(t)},getUrlPicker:function(n){return pF(t,n)}}},yF=function(t,n,e,r){var o=We(!1),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:lC.translate},interpreter:function(t){return nM(t,i)},anchors:fM.getAnchors(n,e,r),getSink:function(){return O.value(t)}},urlinput:bF(n),styleselect:DM(n),colorinput:pM(n),dialog:vM(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i},wF="contexttoolbar-show",xF="contexttoolbar-hide",CF=i([ge("dom"),Ie("shell",!0),Ug("toolbarBehaviours",[cy])]),SF=function(t){return{behaviours:mf([cy.config({})])}},kF=i([Cp({name:"groups",overrides:SF})]),OF=function(t,e,r,o){var i=function(t,e){u(t).fold((function(){throw n.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){cy.set(t,e)}))},u=function(n){return t.shell?x.some(n):Np(n,t,"groups")},a=t.shell?{behaviours:[cy.config({})],components:[]}:{behaviours:[],components:e};return{uid:t.uid,dom:t.dom,components:a.components,behaviours:Gg(t.toolbarBehaviours,a.behaviours),apis:{setGroups:i},domModification:{attributes:{role:"group"}}}},TF=th({name:"Toolbar",configFields:CF(),partFields:kF(),factory:OF,apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),EF=function(t,n){var e={len:0,list:[]},r=$(t,(function(t,e){var r=n(e,t.len);return r.fold(i(t),(function(n){return{len:n.finish(),list:t.list.concat([n])}}))}),e);return r.list},DF=ji("within","extra","withinWidth"),AF=function(t,n,e){var r=EF(t,(function(t,n){var r=e(t);return x.some({element:i(t),start:i(n),finish:i(n+r),width:i(r)})})),o=Y(r,(function(t){return t.finish()<=n})),u=K(o,(function(t,n){return t+n.width()}),0),a=r.slice(o.length);return{within:i(o),extra:i(a),withinWidth:i(u)}},_F=function(t){return W(t,(function(t){return t.element()}))},RF=function(t,n,e){var r=_F(t.concat(n));return DF(r,[],e)},BF=function(t,n,e,r){var o=_F(t).concat([e]);return DF(o,_F(n),r)},IF=function(t,n,e){return DF(_F(t),[],e)},PF=function(t,n,e){var r=AF(n,t,e);return 0===r.extra().length?x.some(r):x.none()},NF=function(t,n,e,r){var o=PF(t,n,e).getOrThunk((function(){return AF(n,t-e(r),e)})),i=o.within(),u=o.extra(),a=o.withinWidth();return 1===u.length&&u[0].width()<=e(r)?RF(i,u,a):u.length>=1?BF(i,u,r,a):IF(i,u,a)},MF=function(t,n){var e=W(n,(function(t){return fc(t)}));TF.setGroups(t,e)},FF=function(t,n){return t.bind((function(t){return _f(t.element()).bind((function(n){return t.getSystem().getByDom(n).toOption()}))})).orThunk((function(){return n.filter(yy.isFocused)}))},LF=function(t,n,e,r){var o=Mp(t,n,"primary"),i=Np(t,n,"overflow-button"),u=rD.getCoupled(t,"overflowGroup");za(o.element(),"visibility","hidden");var a=FF(e,i);e.each((function(t){TF.setGroups(t,[])}));var c=n.builtGroups.get();MF(o,c.concat([u]));var s=Oc(o.element()),f=NF(s,c,(function(t){return Oc(t.element())}),u);0===f.extra().length?(cy.remove(o,u),e.each((function(t){TF.setGroups(t,[])}))):(MF(o,f.within()),e.each((function(t){MF(t,f.extra())}))),Xa(o.element(),"visibility"),Ya(o.element()),e.each((function(t){i.each((function(n){return Ly.set(n,r(t))})),a.each(yy.focus)}))},HF=i([ge("items"),vs(["itemSelector"]),Ug("tgroupBehaviours",[Qb])]),zF=i([Sp({name:"items",unit:"item"})]),VF=function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,behaviours:Gg(t.tgroupBehaviours,[Qb.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},jF=th({name:"ToolbarGroup",configFields:HF(),partFields:zF(),factory:VF}),UF=i([Ug("splitToolbarBehaviours",[rD]),Ue("builtGroups",(function(){return We([])}))]),WF=function(t,n,e,r,o){var i="alloy.toolbar.toggle",u=function(n,e){var r=W(e,n.getSystem().build);t.builtGroups.set(r)},a=function(t,n){u(t,n),o.apis.refresh(t)},c=function(n){return Np(n,t,"overflow-button")};return{uid:t.uid,dom:t.dom,components:n,behaviours:Gg(t.splitToolbarBehaviours,[rD.config({others:m(m({},o.coupling),{overflowGroup:function(t){return jF.sketch(m(m({},r["overflow-group"]()),{items:[Fw.sketch(m(m({},r["overflow-button"]()),{action:function(n){ii(t,i)}}))]}))}})}),fy("toolbar-toggle-events",[Di(i,(function(t){o.apis.toggle(t)}))])]),apis:m({setGroups:a,getMoreButton:function(t){return c(t)}},o.apis),domModification:{attributes:{role:"group"}}}},GF=i([vs(["overflowToggledClass"]),ge("getAnchor"),Ae("getOverflowBounds"),ge("lazySink")].concat(UF())),qF=i([wp({factory:TF,schema:CF(),name:"primary"}),xp({factory:TF,schema:CF(),name:"overflow",overrides:function(t){return{toolbarBehaviours:mf([Qb.config({mode:"cyclic",onEscape:function(n){return Np(n,t,"overflow-button").each(yy.focus),x.none()}})])}}}),xp({name:"overflow-button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:mf([Ly.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),xp({name:"overflow-group"})]),XF=function(t,n,e){var r=rD.getCoupled(t,"sandbox");ug.isOpen(r)?ug.close(r):ug.open(r,e.overflow())},YF=function(t){return t.getSystem().isConnected()},KF=function(t,n,e){var r=n.lazySink(t).getOrDie(),o=n.getAnchor(t),i=n.getOverflowBounds.map((function(t){return t()}));Tm.positionWithinBounds(r,o,e,i)},$F=function(t,n){var e=ug.getState(rD.getCoupled(t,"sandbox"));LF(t,n,e,YF),e.each((function(e){return KF(t,n,e)}))},JF=function(t,n){var e=ug.getState(rD.getCoupled(t,"sandbox"));e.each((function(e){return KF(t,n,e)}))},QF=function(t,n){var e=Yc(),r=function(r,o){$F(t,n),Np(t,n,"overflow-button").each((function(t){Ly.on(t),e.link(t.element())})),Qb.focusIn(o)},o=function(){Np(t,n,"overflow-button").each((function(t){Ly.off(t),yy.focus(t),e.unlink(t.element())}))};return{dom:{tag:"div",attributes:{id:e.id()}},behaviours:mf([Qb.config({mode:"special",onEscape:function(t){return ug.close(t),x.some(!0)}}),ug.config({onOpen:r,onClose:o,isPartOf:function(n,e,r){return $c(e,r)||$c(t,r)},getAttachPoint:function(){return n.lazySink(t).getOrDie()}}),Sf.config({channels:m({},mg({isExtraPart:i(!1),doReposition:function(){return JF(t,n)}}))})])}},ZF=function(t,n,e,r){return WF(t,n,e,r,{coupling:{sandbox:function(n){return QF(n,t)}},apis:{refresh:function(n){return $F(n,t)},toggle:function(n){return XF(n,t,r)},getOverflow:function(t){return ug.getState(rD.getCoupled(t,"sandbox"))},reposition:function(n){return JF(n,t)}}})},tL=th({name:"SplitFloatingToolbar",configFields:GF(),partFields:qF(),factory:ZF,apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)},toggle:function(t,n){t.toggle(n)}}}),nL=function(t,n){return n.getAnimationRoot.fold((function(){return t.element()}),(function(n){return n(t)}))},eL=function(t){return t.dimension.property},rL=function(t,n){return t.dimension.getDimension(n)},oL=function(t,n){var e=nL(t,n);Ma(e,[n.shrinkingClass,n.growingClass])},iL=function(t,n){Ia(t.element(),n.openClass),Ra(t.element(),n.closedClass),za(t.element(),eL(n),"0px"),Ya(t.element())},uL=function(t,n){Ia(t.element(),n.closedClass),Ra(t.element(),n.openClass),Xa(t.element(),eL(n))},aL=function(t,n,e,r){e.setCollapsed(),za(t.element(),eL(n),rL(n,t.element())),Ya(t.element()),oL(t,n),iL(t,n),n.onStartShrink(t),n.onShrunk(t)},cL=function(t,n,e,r){var o=r.getOrThunk((function(){return rL(n,t.element())}));e.setCollapsed(),za(t.element(),eL(n),o),Ya(t.element());var i=nL(t,n);Ia(i,n.growingClass),Ra(i,n.shrinkingClass),iL(t,n),n.onStartShrink(t)},sL=function(t,n,e){var r=rL(n,t.element()),o="0px"===r?aL:cL;o(t,n,e,x.some(r))},fL=function(t,n,e){var r=nL(t,n),o=Pa(r,n.shrinkingClass),i=rL(n,t.element());uL(t,n);var u=rL(n,t.element()),a=function(){za(t.element(),eL(n),i),Ya(t.element())},c=function(){iL(t,n)},s=o?a:c;s(),Ia(r,n.shrinkingClass),Ra(r,n.growingClass),uL(t,n),za(t.element(),eL(n),u),e.setExpanded(),n.onStartGrow(t)},lL=function(t,n,e){if(e.isExpanded()){Xa(t.element(),eL(n));var r=rL(n,t.element());za(t.element(),eL(n),r)}},dL=function(t,n,e){e.isExpanded()||fL(t,n,e)},mL=function(t,n,e){e.isExpanded()&&sL(t,n,e)},gL=function(t,n,e){e.isExpanded()&&aL(t,n,e)},pL=function(t,n,e){return e.isExpanded()},hL=function(t,n,e){return e.isCollapsed()},vL=function(t,n,e){var r=nL(t,n);return!0===Pa(r,n.growingClass)},bL=function(t,n,e){var r=nL(t,n);return!0===Pa(r,n.shrinkingClass)},yL=function(t,n,e){return!0===vL(t,n)||!0===bL(t,n)},wL=function(t,n,e){var r=e.isExpanded()?sL:fL;r(t,n,e)},xL=Object.freeze({refresh:lL,grow:dL,shrink:mL,immediateShrink:gL,hasGrown:pL,hasShrunk:hL,isGrowing:vL,isShrinking:bL,isTransitioning:yL,toggleGrow:wL,disableTransitions:oL}),CL=function(t,n){var e=n.expanded;return oa(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Xt(n.dimension.property,"0px")})},SL=function(t,n){return ki([Fi(_o(),(function(e,r){var o=r.event().raw();if(o.propertyName===t.dimension.property){oL(e,t),n.isExpanded()&&Xa(e.element(),t.dimension.property);var i=n.isExpanded()?t.onGrown:t.onShrunk;i(e)}}))])},kL=Object.freeze({exhibit:CL,events:SL}),OL=[ge("closedClass"),ge("openClass"),ge("shrinkingClass"),ge("growingClass"),Oe("getAnimationRoot"),ys("onShrunk"),ys("onStartShrink"),ys("onGrown"),ys("onStartGrow"),Ie("expanded",!1),pe("dimension",oe("property",{width:[Ss("property","width"),Ss("getDimension",(function(t){return Oc(t)+"px"}))],height:[Ss("property","height"),Ss("getDimension",(function(t){return gc(t)+"px"}))]}))],TL=function(t){var n=We(t.expanded),e=function(){return"expanded: "+n.get()};return Zu({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:a(n.set,!1),setExpanded:a(n.set,!0),readState:e})},EL=Object.freeze({init:TL}),DL=pf({fields:OL,name:"sliding",active:kL,apis:xL,state:EL}),AL=i([vs(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),ys("onOpened"),ys("onClosed")].concat(UF())),_L=i([wp({factory:TF,schema:CF(),name:"primary"}),wp({factory:TF,schema:CF(),name:"overflow",overrides:function(t){return{toolbarBehaviours:mf([DL.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Np(n,t,"overflow-button").each((function(t){Ly.off(t),yy.focus(t)})),t.onClosed(n)},onGrown:function(n){Qb.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Np(n,t,"overflow-button").each(Ly.on)}}),Qb.config({mode:"acyclic",onEscape:function(n){return Np(n,t,"overflow-button").each(yy.focus),x.some(!0)}})])}}}),xp({name:"overflow-button",overrides:function(t){return{buttonBehaviours:mf([Ly.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),xp({name:"overflow-group"})]),RL=function(t,n){Np(t,n,"overflow").each((function(e){IL(t,n),DL.toggleGrow(e)}))},BL=function(t){return DL.hasGrown(t)},IL=function(t,n){var e=Np(t,n,"overflow");LF(t,n,e,BL),e.each(DL.refresh)},PL=function(t,n,e,r){return WF(t,n,e,r,{coupling:{},apis:{refresh:function(n){return IL(n,t)},toggle:function(n){return RL(n,t)},getOverflow:function(n){return Np(n,t,"overflow")}}})},NL=th({name:"SplitSlidingToolbar",configFields:AL(),partFields:_L(),factory:PL,apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)},toggle:function(t,n){t.toggle(n)}}}),ML=i(Bu("toolbar-height-change")),FL="silver.readonly",LL=Fn([ye("readonly")]),HL=function(t,n){to("*",t.element()).forEach((function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(uS)&&uS.set(t,n)}))}))},zL=function(t,n){var e=t.outerContainer,r=e.element();n&&(t.mothership.broadcastOn([ag()],{target:r}),t.uiMothership.broadcastOn([ag()],{target:r})),t.mothership.broadcastOn([FL],{readonly:n}),t.uiMothership.broadcastOn([FL],{readonly:n})},VL=function(t,n){var e=t.outerContainer;zL(t,n),to("*",e.element()).forEach((function(t){e.getSystem().getByDom(t).each((function(t){t.hasConfigured(uS)&&uS.set(t,n)}))}))},jL=function(t,n){t.on("init",(function(){t.readonly&&VL(n,!0)})),t.on("SwitchMode",(function(){return VL(n,t.readonly)})),CT(t)&&t.setMode("readonly")},UL=function(t){var n;return Sf.config({channels:(n={},n[FL]={schema:LL,onReceive:function(n,e){t(n).each((function(t){HL(t,e.readonly)}))}},n)})},WL=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:m({tag:"div",classes:["tox-toolbar__group"]},n),components:[jF.parts().items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:mf([GE.config({}),yy.config({})])}},GL=function(t){return jF.sketch(WL(t))},qL=function(t,n,e){var r=Li((function(n){var e=W(t.initGroups,GL);TF.setGroups(n,e)}));return mf([Qb.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),fy("toolbar-events",[r]),UL(e)])},XL=function(t,n){var e=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":WL({title:x.none(),items:[]}),"overflow-button":qI({name:"more",icon:x.some("more-drawer"),disabled:!1,tooltip:x.some("More..."),primary:!1,borderless:!1},x.none(),t.backstage.shared.providers)},splitToolbarBehaviours:qL(t,e,n)}},YL=function(t){var n=XL(t,tL.getOverflow),e=4,r=tL.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return tL.sketch(m(m({},n),{lazySink:t.getSink,getAnchor:function(){return t.backstage.shared.anchors.toolbarOverflow()},getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element(),r=Vc(n),o=$i(n),i=Vc(o);return Hc(r.x()+e,i.y(),r.width()-2*e,i.height())},parts:m(m({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"]}}}),components:[r],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},KL=function(t){var n=NL.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=NL.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),r=XL(t,NL.getOverflow);return NL.sketch(m(m({},r),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([ML()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([ML()],{type:"closed"})}}))},$L=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return TF.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===hT.scrolling?["tox-toolbar--scrolling"]:[])},components:[TF.parts().groups({})],toolbarBehaviours:qL(t,n,i(x.none()))})},JL=[Le("disabled",!1),De("tooltip"),De("icon"),De("text"),He("onSetup",(function(){return e}))],QL=Fn([ve("type"),we("onAction")].concat(JL)),ZL=function(t){return Zn("toolbarbutton",QL,t)},tH=[De("text"),De("tooltip"),De("icon"),we("fetch"),He("onSetup",(function(){return e}))],nH=Fn(p([ve("type")],tH)),eH=function(t){return Zn("menubutton",nH,t)},rH=Fn([ve("type"),De("tooltip"),De("icon"),De("text"),Ae("select"),we("fetch"),He("onSetup",(function(){return e})),Fe("presets","normal",["normal","color","listpreview"]),Ie("columns",1),we("onAction"),we("onItemAction")]),oH=function(t){return Zn("SplitButton",rH,t)},iH=[Le("active",!1)].concat(JL),uH=Fn(iH.concat([ve("type"),we("onAction")])),aH=function(t){return Zn("ToggleButton",uH,t)},cH=[He("predicate",(function(){return!1})),Fe("scope","node",["node","editor"]),Fe("position","selection",["node","selection","line"])],sH=JL.concat([Ie("type","contextformbutton"),Ie("primary",!1),we("onAction"),Ue("original",u)]),fH=iH.concat([Ie("type","contextformbutton"),Ie("primary",!1),we("onAction"),Ue("original",u)]),lH=JL.concat([Ie("type","contextformbutton")]),dH=iH.concat([Ie("type","contextformtogglebutton")]),mH=oe("type",{contextformbutton:sH,contextformtogglebutton:fH}),gH=Fn([Ie("type","contextform"),He("initValue",(function(){return""})),De("label"),ke("commands",mH),Te("launch",oe("type",{contextformbutton:lH,contextformtogglebutton:dH}))].concat(cH)),pH=Fn([Ie("type","contexttoolbar"),ve("items")].concat(cH)),hH=function(t){return Zn("ContextToolbar",pH,t)},vH=function(t){return Zn("ContextForm",gH,t)},bH=function(t,n,e){return e},yH=Object.freeze({getState:bH}),wH=function(t,n){var e=function(e,r){t.updateState.each((function(t){var o=t(e,r);n.set(o)})),t.renderComponents.each((function(t){var o=t(r,n.get()),i=W(o,e.getSystem().build);Rm(e,i)}))};return ki([Di(Mo(),(function(n,r){var o=t.channel;z(r.channels(),o)&&e(n,r.data())})),Li((function(n,r){t.initialData.each((function(t){e(n,t)}))}))])},xH=Object.freeze({events:wH}),CH=function(t){var n=We(x.none()),e=function(t){return n.set(t)},r=function(){return n.set(x.none())},o=function(){return n.get()},i=function(){return n.get().fold((function(){return"none"}),(function(t){return t}))};return{readState:i,get:o,set:e,clear:r}},SH=Object.freeze({init:CH}),kH=[ge("channel"),Oe("renderComponents"),Oe("updateState"),Oe("initialData")],OH=pf({fields:kH,name:"reflecting",active:xH,apis:yH,state:SH}),TH=i([ge("toggleClass"),ge("fetch"),xs("onExecute"),Ie("getHotspot",x.some),Ie("getAnchorOverrides",i({})),Ie("layouts",x.none()),xs("onItemExecute"),Oe("lazySink"),ge("dom"),ys("onOpen"),Ug("splitDropdownBehaviours",[rD,Qb,yy]),Ie("matchWidth",!1),Ie("useMinWidth",!1),Ie("eventOrder",{}),Oe("role")].concat(vD())),EH=wp({factory:Fw,schema:[ge("dom")],name:"arrow",defaults:function(t){return{buttonBehaviours:mf([yy.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(ai)},buttonBehaviours:mf([Ly.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),DH=wp({factory:Fw,schema:[ge("dom")],name:"button",defaults:function(t){return{buttonBehaviours:mf([yy.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),AH=i([EH,DH,Cp({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[ge("text")],name:"aria-descriptor"}),xp({schema:[hs()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(r){t.onItemExecute(r,n,e)}))}}}}),iD()]),_H=function(t,n,r,o){var i=function(t){ih.getCurrent(t).each((function(t){Oh.highlightFirst(t),Qb.focusIn(t)}))},u=function(n){var r=i;lD(t,(function(t){return t}),n,o,r,wE.HighlightFirst).get(e)},a=function(t){return u(t),x.some(!0)},c=function(n){var e=Mp(n,t,"button");return ai(e),x.some(!0)},s=Tt(ki([Li((function(n,e){var r=Np(n,t,"aria-descriptor");r.each((function(t){var e=Bu("aria");yu(t.element(),"id",e),yu(n.element(),"aria-describedby",e)}))}))]),zy(x.some(u))),f={repositionMenus:function(t){Ly.isOn(t)&&hD(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:f,eventOrder:m(m({},t.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:s,behaviours:Gg(t.splitDropdownBehaviours,[rD.config({others:{sandbox:function(n){var e=Mp(n,t,"arrow"),r={onOpen:function(){Ly.on(e),Ly.on(n)},onClose:function(){Ly.off(e),Ly.off(n)}};return pD(t,n,r)}}}),Qb.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),yy.config({}),Ly.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},RH=th({name:"SplitDropdown",configFields:TH(),partFields:AH(),factory:_H,apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),BH=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)}}},IH=function(t){return{setActive:function(n){Ly.set(t,n)},isActive:function(){return Ly.isOn(t)},isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)}}},PH=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},NH=Bu("focus-button"),MH=["checklist","ordered-list"],FH=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],LH=function(t,n,e,r,o,i){var u,a=function(t){return lC.isRtl()&&z(MH,t)?t+"-rtl":t},c=lC.isRtl()&&t.exists((function(t){return z(FH,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:PH(e,i)},components:bS([t.map((function(t){return SI(a(t),i.icons)})),n.map((function(t){return OI(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[bo()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:mf([fy("common-button-display-events",[Di(bo(),(function(t,n){n.event().prevent(),ii(t,NH)}))])].concat(r.map((function(e){return OH.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return bS([t.icon.map((function(t){return SI(a(t),i.icons)})),t.text.map((function(t){return OI(t,"tox-tbtn",i)}))])}})})).toArray()).concat(o.getOr([])))}},HH=function(t,n,r){var o=We(e),i=LH(t.icon,t.text,t.tooltip,x.none(),x.none(),r);return Fw.sketch({dom:i.dom,components:i.components,eventOrder:DI,buttonBehaviours:mf([fy("toolbar-button-events",[EI({onAction:t.onAction,getApi:n.getApi}),mS(n,o),gS(n,o)]),lS.toolbarButton(t.disabled)].concat(n.toolbarButtonBehaviours))})},zH=function(t,n){return VH(t,n,[])},VH=function(t,n,e){return HH(t,{toolbarButtonBehaviours:[].concat(e.length>0?[fy("toolbarButtonWith",e)]:[]),getApi:BH,onSetup:t.onSetup},n)},jH=function(t,n){return UH(t,n,[])},UH=function(t,n,e){return Ot(HH(t,{toolbarButtonBehaviours:[cy.config({}),Ly.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[fy("toolbarToggleButtonWith",e)]:[]),getApi:IH,onSetup:t.onSetup},n))},WH=function(t,n,e){return function(r){return AE.nu((function(t){return n.fetch(t)})).map((function(o){return x.from(DO(Ot(oO(Bu("menu-value"),o,(function(e){n.onItemAction(t(r),e)}),n.columns,n.presets,pS.CLOSE_ON_EXECUTE,n.select.getOr((function(){return!1})),e),{movement:uO(n.columns,n.presets),menuBehaviours:Kx.unnamedEvents("auto"!==n.columns?[]:[Li((function(t,e){qx(t,4,OC(n.presets)).each((function(n){var e=n.numRows,r=n.numColumns;Qb.setGridSize(t,e,r)}))}))])})))}))}},GH=function(t,n){var r,o=Bu("channel-update-split-dropdown-display"),i=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(n){return uS.set(t,n)},setIconFill:function(n,e){Gc(t.element(),'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){yu(t,"fill",e)}))},setIconStroke:function(n,e){Gc(t.element(),'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){yu(t,"stroke",e)}))},setActive:function(n){yu(t.element(),"aria-pressed",n),Gc(t.element(),"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Ly.set(t,n)}))}))},isActive:function(){return Gc(t.element(),"span").exists((function(n){return t.getSystem().getByDom(n).exists(Ly.isOn)}))}}},u=We(e),a={getApi:i,onSetup:t.onSetup};return RH.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:Tt({"aria-pressed":!1},PH(t.tooltip,n.providers))},onExecute:function(n){t.onAction(i(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:mf([lS.splitButton(!1),fy("split-dropdown-events",[Di(NH,yy.focus),mS(a,u),gS(a,u)]),OD.config({})]),eventOrder:(r={},r[Ko()]=["alloy.base.behaviour","split-dropdown-events"],r),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:WH(i,t,n.providers),parts:{menu:Qk(!1,t.columns,t.presets)},components:[RH.parts().button(LH(t.icon,t.text,x.none(),x.some(o),x.some([Ly.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),RH.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:zw("chevron-down",n.providers.icons)}}),RH.parts()["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},qH=function(t){return{hide:function(){return ii(t,jo())},getValue:function(){return jg.getValue(t)}}},XH=function(t,n){return Di(TI,(function(e,r){var o=t.get(e),i=qH(o);n.onAction(i,r.event().buttonApi())}))},YH=function(t,n,e){var r=n.original,o=(r.primary,g(r,["primary"])),i=te(ZL(m(m({},o),{type:"button",onAction:function(){}})));return VH(i,e.backstage.shared.providers,[XH(t,n)])},KH=function(t,n,e){var r=n.original,o=(r.primary,g(r,["primary"])),i=te(aH(m(m({},o),{type:"togglebutton",onAction:function(){}})));return UH(i,e.backstage.shared.providers,[XH(t,n)])},$H=function(t,n,e){var r={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?KH(t,n,r):YH(t,n,r)},JH=function(t,n,e){var r=W(n,(function(n){return Lw($H(t,n,e))})),o=function(){return W(r,(function(t){return t.asSpec()}))},i=function(t){return Zc(n,(function(n,e){return n.primary?x.from(r[e]).bind((function(n){return n.getOpt(t)})).filter(c(uS.isDisabled)):x.none()}))};return{asSpecs:o,findPrimary:i}},QH=function(t,n,e){var r=n.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=Lw(vE.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:r,selectOnFocus:!0,inputBehaviours:mf([Qb.config({mode:"special",onEnter:function(t){return i.findPrimary(t).map((function(t){return ai(t),!0}))},onLeft:function(t,n){return n.cut(),x.none()},onRight:function(t,n){return n.cut(),x.none()}})])})),i=JH(o,n.commands,e.shared.providers);return $L({type:t,uid:Bu("context-toolbar"),initGroups:[{title:x.none(),items:[o.asSpec()]},{title:x.none(),items:i.asSpecs()}],onEscape:x.none,cyclicKeying:!0,backstage:e,getSink:function(){return O.error("")}})},ZH={renderContextForm:QH},tz=function(t,n){var e=Math.max(n.x(),t.x()),r=t.right()-e,o=n.width()-(e-n.x()),i=Math.min(r,o);return{x:e,width:i}},nz=function(t,n,e){var r=tz(n,e),o=r.x,i=r.width,u=$e.fromDom(t.getContainer()),a=Gc(u,".tox-editor-header").getOr(u),c=zc(u),s=zc(a),f=Math.max(e.y(),n.y(),s.bottom()),l=c.bottom()-f,d=e.height()-(f-e.y()),m=Math.min(l,d);return Hc(o,f,i,m)},ez=function(t,n,e){var r=tz(n,e),o=r.x,i=r.width,u=$e.fromDom(t.getContainer()),a=Gc(u,".tox-editor-header").getOr(u),c=zc(a),s=e.height(),f=e.y();if(c.y()>=n.bottom()){var l=Math.min(s+f,c.y()),d=l-f;return Hc(o,f,i,d)}var m=Math.max(f,c.bottom());d=s-(m-f);return Hc(o,m,i,d)},rz=function(t,n,e){var r=tz(n,e),o=r.x,i=r.width;return Hc(o,e.y(),i,e.height())},oz=function(t){var e=IT(t)||PT(t)||MT(t),r=_c(n.window),o=zc($e.fromDom(t.getContentAreaContainer()));return t.inline&&!e?rz(t,o,r):t.inline?ez(t,o,r):nz(t,o,r)},iz=function(t,n,e){var r=t.dom(),o=B(e)?e:i(!1);while(r.parentNode){r=r.parentNode;var u=$e.fromDom(r),a=n(u);if(a.isSome())return a;if(o(u))break}return x.none()},uz=function(t,n){return Zc(n,(function(n){return n.predicate(t.dom())?x.some({toolbarApi:n,elem:t}):x.none()}))},az=function(t,n){var e=function(t){return t.dom()===n.getBody()},r=$e.fromDom(n.selection.getNode());return uz(r,t.inNodeScope).orThunk((function(){return uz(r,t.inEditorScope).orThunk((function(){return iz(r,(function(n){return uz(n,t.inNodeScope)}),e)}))}))},cz={lookup:az},sz=function(t,n){var e={},r=[],o=[],i={},u={},a=function(t,a){var c=te(vH(a));e[t]=c,c.launch.map((function(e){i["form:"+t]=m(m({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?o.push(c):r.push(c),u[t]=c},c=function(t,n){hH(n).each((function(e){"editor"===n.scope?o.push(e):r.push(e),u[t]=e}))},s=st(t);return G(s,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:r,inEditorScope:o,lookupTable:u,formNavigators:i}},fz={categorise:sz},lz=Bu("forward-slide"),dz=Bu("backward-slide"),mz=Bu("change-slide-event"),gz="tox-pop--resizing",pz=function(t){var n=We([]);return kw.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){n.set([]),kw.getContent(t).each((function(t){Xa(t.element(),"visibility")})),Ia(t.element(),gz),Xa(t.element(),"width")},inlineBehaviours:mf([fy("context-toolbar-events",[Fi(_o(),(function(t,n){kw.getContent(t).each((function(t){})),Ia(t.element(),gz),Xa(t.element(),"width")})),Di(mz,(function(t,n){Xa(t.element(),"width");var e=Oc(t.element());kw.setContent(t,n.event().contents()),Ra(t.element(),gz);var r=Oc(t.element());za(t.element(),"width",e+"px"),kw.getContent(t).each((function(e){n.event().focus().bind((function(n){return Tf(n),_f(t.element())})).orThunk((function(){return Qb.focusIn(e),Af()}))})),qw.setTimeout((function(){za(t.element(),"width",r+"px")}),0)})),Di(lz,(function(t,e){kw.getContent(t).each((function(t){n.set(n.get().concat([{bar:t,focus:Af()}]))})),ui(t,mz,{contents:e.event().forwardContents(),focus:x.none()})})),Di(dz,(function(t,e){at(n.get()).each((function(e){n.set(n.get().slice(0,n.get().length-1)),ui(t,mz,{contents:fc(e.bar),focus:e.focus})}))}))]),Qb.config({mode:"special",onEscape:function(e){return at(n.get()).fold((function(){return t.onEscape()}),(function(t){return ii(e,dz),x.some(!0)}))}})]),lazySink:function(){return O.value(t.sink)}})},hz=function(t,n){return function(e){var r=We(x.none()),o=function(){e.setActive(t.formatter.match(n));var o=t.formatter.formatChanged(n,e.setActive).unbind;r.set(x.some(o))};return t.initialized?o():t.on("init",o),function(){return r.get().each((function(t){return t()}))}}},vz=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},bz=function(t,n,e){var r=function(t,r,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return x.some({type:"separator",text:a});if("submenu"===t.type){var c=tt(t.getStyleItems(),(function(t){return o(t,r,u)}));return 0===r&&c.length<=0?x.none():x.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return tt(t.getStyleItems(),(function(t){return o(t,r,u)}))}})}return x.some(m({type:"togglemenuitem",text:a,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},o=function(t,n,o){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:r(t,n,!1,o).toArray():r(t,n,i,o).toArray()},i=function(t){var n=e.getCurrentValue(),r=e.shouldHide?0:1;return tt(t,(function(t){return o(t,r,n)}))},u=function(t,n){return function(e){var r=n(),o=i(r),u=VI(o,pS.CLOSE_ON_EXECUTE,t,!1);e(u)}};return{validateItems:i,getFetch:u}},yz=function(t,n,e){var r=e.dataset,o="basic"===r.type?function(){return W(r.data,(function(t){return TM(t,e.isSelectedFor,e.getPreviewFor)}))}:r.getData;return{items:bz(t,n,e),getStyleItems:o}},wz=function(t,n,r){var o=yz(t,n,r),i=o.items,u=o.getStyleItems,a=function(t){return{getComponent:function(){return t}}},c=function(n){return r.setInitialValue.each((function(t){return t(n.getComponent())})),r.nodeChangeHandler.map((function(e){var r=e(n.getComponent());return t.on("NodeChange",r),function(){t.off("NodeChange",r)}})).getOr(e)};return RI({text:r.icon.isSome()?x.none():x.some(""),icon:r.icon,tooltip:x.from(r.tooltip),role:x.none(),fetch:i.getFetch(n,u),onSetup:c,getApi:a,columns:1,presets:"normal",classes:r.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)},xz=function(t){return W(t,(function(t){var n=t,e=t,r=t.split("=");return r.length>1&&(n=r[0],e=r[1]),{title:n,format:e}}))},Cz=function(t){return{type:"basic",data:t}};(function(t){t[t["SemiColon"]=0]="SemiColon",t[t["Space"]=1]="Space"})(qP||(qP={}));var Sz,kz=function(t,n){return n===qP.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")},Oz=function(t,n,e,r){var o=qt(t.settings,n).getOr(e),i=xz(kz(o,r));return{type:"basic",data:i}},Tz=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],Ez=function(t){var n=function(){return J(Tz,(function(n){return t.formatter.match(n.format)}))},e=function(n){return function(){return t.formatter.match(n)}},r=function(t){return function(){return x.none()}},o=function(t){var e=n(),r=e.fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));ui(t,_I,{icon:"align-"+r})},u=x.some((function(t){return function(){return o(t)}})),a=x.some((function(t){return o(t)})),c=Cz(Tz);return{tooltip:"Align",icon:x.some("align-left"),isSelectedFor:e,getCurrentValue:i(x.none()),getPreviewFor:r,onAction:vz(t),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},Dz=function(t,n){return wz(t,n,Ez(t))},Az=function(t,n){var e=yz(t,n,Ez(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},_z="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Rz=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Bz=function(t){var n=t.split(/\s*,\s*/);return W(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},Iz=function(t){var n=function(){var n=Bz(t.toLowerCase());return nt(Rz,(function(t){return n.indexOf(t.toLowerCase())>-1}))};return 0===t.indexOf("-apple-system")&&n()},Pz=function(t){var n=function(){var n=function(t){return t?Bz(t)[0]:""},e=t.queryCommandValue("FontName"),r=s.data,o=e?e.toLowerCase():"",i=J(r,(function(t){var e=t.format;return e.toLowerCase()===o||n(e).toLowerCase()===n(o).toLowerCase()})).orThunk((function(){return Iz(o)?x.from({title:"System Font",format:o}):x.none()}));return{matchOpt:i,font:e}},e=function(t){return function(n){return n.exists((function(n){return n.format===t}))}},r=function(){var t=n().matchOpt;return t},o=function(t){return function(){return x.some({tag:"div",styleAttr:-1===t.indexOf("dings")?"font-family:"+t:""})}},i=function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},u=function(t){var e=n(),r=e.matchOpt,o=e.font,i=r.fold((function(){return o}),(function(t){return t.title}));ui(t,AI,{text:i})},a=x.some((function(t){return function(){return u(t)}})),c=x.some((function(t){return u(t)})),s=Oz(t,"font_formats",_z,qP.SemiColon);return{tooltip:"Fonts",icon:x.none(),isSelectedFor:e,getCurrentValue:r,getPreviewFor:o,onAction:i,setInitialValue:c,nodeChangeHandler:a,dataset:s,shouldHide:!1,isInvalid:function(){return!1}}},Nz=function(t,n){return wz(t,n,Pz(t))},Mz=function(t,n){var e=yz(t,n,Pz(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},Fz="8pt 10pt 12pt 14pt 18pt 24pt 36pt",Lz={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Hz=function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e},zz=function(t,n){return/[0-9.]+px$/.test(t)?Hz(72*parseInt(t,10)/96,n||0)+"pt":t},Vz=function(t){return vt(Lz,t).getOr("")},jz=function(t){var n=function(){var n=x.none(),e=f.data,r=t.queryCommandValue("FontSize");if(r)for(var o=function(t){var o=zz(r,t),i=Vz(o);n=J(e,(function(t){return t.format===r||t.format===o||t.format===i}))},i=3;n.isNone()&&i>=0;i--)o(i);return{matchOpt:n,px:r}},e=function(t){return function(n){return n.exists((function(n){return n.format===t}))}},r=function(){var t=n().matchOpt;return t},o=i(i(x.none())),u=function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},a=function(t){var e=n(),r=e.matchOpt,o=e.px,i=r.fold((function(){return o}),(function(t){return t.title}));ui(t,AI,{text:i})},c=x.some((function(t){return function(){return a(t)}})),s=x.some((function(t){return a(t)})),f=Oz(t,"fontsize_formats",Fz,qP.Space);return{tooltip:"Font sizes",icon:x.none(),isSelectedFor:e,getPreviewFor:o,getCurrentValue:r,onAction:u,setInitialValue:s,nodeChangeHandler:c,dataset:f,shouldHide:!1,isInvalid:function(){return!1}}},Uz=function(t,n){return wz(t,n,jz(t))},Wz=function(t,n){var e=yz(t,n,jz(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},Gz=function(t,n,e){var r=n();return Zc(e,(function(n){return J(r,(function(e){return t.formatter.matchNode(n,e.format)}))})).orThunk((function(){return t.formatter.match("p")?x.some({title:"Paragraph",format:"p"}):x.none()}))},qz=function(t){var n=t.selection.getStart(!0)||t.getBody();return t.dom.getParents(n,(function(){return!0}),t.getBody())},Xz="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",Yz=function(t){var n=function(n){return Gz(t,(function(){return c.data}),n)},e=function(n){return function(){return t.formatter.match(n)}},r=function(n){return function(){var e=t.formatter.get(n);return x.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)})}},o=function(t,e){var r=n(t),o=r.fold((function(){return"Paragraph"}),(function(t){return t.title}));ui(e,AI,{text:o})},u=x.some((function(t){return function(n){return o(n.parents,t)}})),a=x.some((function(n){var e=qz(t);o(e,n)})),c=Oz(t,"block_formats",Xz,qP.SemiColon);return{tooltip:"Blocks",icon:x.none(),isSelectedFor:e,getCurrentValue:i(x.none()),getPreviewFor:r,onAction:vz(t),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},Kz=function(t,n){return wz(t,n,Yz(t))},$z=function(t,n){var e=yz(t,n,Yz(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},Jz=function(t,n){var e=function(n){return function(){return t.formatter.match(n)}},r=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?x.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)}):x.none()}},o=function(n,e){var r=function(t){var n=t.items;return void 0!==n&&n.length>0?tt(n,r):[{title:t.title,format:t.format}]},o=tt(OM(t),r),i=Gz(t,(function(){return o}),n),u=i.fold((function(){return"Paragraph"}),(function(t){return t.title}));ui(e,AI,{text:u})},u=x.some((function(t){return function(n){return o(n.parents,t)}})),a=x.some((function(n){var e=qz(t);o(e,n)}));return{tooltip:"Formats",icon:x.none(),isSelectedFor:e,getCurrentValue:i(x.none()),getPreviewFor:r,onAction:vz(t),setInitialValue:a,nodeChangeHandler:u,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},Qz=function(t,n){var e=m({type:"advanced"},n.styleselect);return wz(t,n,Jz(t,e))},Zz=function(t,n){var e=m({type:"advanced"},n.styleselect),r=yz(t,n,Jz(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})},tV=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],nV=function(t,n){return function(e,r){var o=t(e).mapError((function(t){return ee(t)})).getOrDie();return n(o,r)}},eV={button:nV(ZL,(function(t,n){return zH(t,n.backstage.shared.providers)})),togglebutton:nV(aH,(function(t,n){return jH(t,n.backstage.shared.providers)})),menubutton:nV(eH,(function(t,n){return UI(t,"tox-tbtn",n.backstage,x.none())})),splitbutton:nV(oH,(function(t,n){return GH(t,n.backstage.shared)})),styleSelectButton:function(t,n){return Qz(t,n.backstage)},fontsizeSelectButton:function(t,n){return Uz(t,n.backstage)},fontSelectButton:function(t,n){return Nz(t,n.backstage)},formatButton:function(t,n){return Kz(t,n.backstage)},alignMenuButton:function(t,n){return Dz(t,n.backstage)}},rV=function(t,e){return vt(eV,t.type).fold((function(){return n.console.error("skipping button defined by",t),x.none()}),(function(n){return x.some(n(t,e))}))},oV={styleselect:eV.styleSelectButton,fontsizeselect:eV.fontsizeSelectButton,fontselect:eV.fontSelectButton,formatselect:eV.formatButton,align:eV.alignMenuButton},iV=function(t){var n=W(tV,(function(n){var e=Y(n.items,(function(n){return bt(t,n)||bt(oV,n)}));return{name:n.name,items:e}}));return Y(n,(function(t){return t.items.length>0}))},uV=function(t){var n=t.split("|");return W(n,(function(t){return{items:t.trim().split(" ")}}))},aV=function(t){return P(t,(function(t){return bt(t,"name")&&bt(t,"items")}))},cV=function(t){var e=t.toolbar,r=t.buttons;return!1===e?[]:void 0===e||!0===e?iV(r):D(e)?uV(e):aV(e)?e:(n.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},sV=function(t,n,e,r,o){return vt(n,e.toLowerCase()).orThunk((function(){return o.bind((function(t){return Zc(t,(function(t){return vt(n,t+e.toLowerCase())}))}))})).fold((function(){return vt(oV,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return x.none()}))}),(function(t){return rV(t,r)}))},fV=function(t,n,e,r){var o=cV(n),i=W(o,(function(o){var i=tt(o.items,(function(o){return 0===o.trim().length?[]:sV(t,n.buttons,o,e,r).toArray()}));return{title:x.from(t.translate(o.name)),items:i}}));return Y(i,(function(t){return t.items.length>0}))},lV=12,dV={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},mV={maxHeightFunction:dm(),maxWidthFunction:eM()},gV={onLtr:function(){return[Js,Qs,Ks,Xs,$s,Ys,Pw,Nw,Bw,_w,Iw,Rw]},onRtl:function(){return[Js,Qs,$s,Ys,Ks,Xs,Pw,Nw,Iw,Rw,Bw,_w]}},pV={onLtr:function(){return[Qs,Xs,Ys,Ks,$s,Js,Pw,Nw,Bw,_w,Iw,Rw]},onRtl:function(){return[Qs,Ys,Xs,$s,Ks,Js,Pw,Nw,Iw,Rw,Bw,_w]}},hV=function(t,n){return"line"===t?{bubble:If(lV,0,dV),layouts:{onLtr:function(){return[Zs]},onRtl:function(){return[tf]}},overrides:mV}:{bubble:If(0,lV,dV),layouts:n?pV:gV,overrides:mV}},vV=function(t,n,e,r){var o=qr().deviceType.isTouch,i=sc(pz({sink:e,onEscape:function(){return t.focus(),x.some(!0)}})),u=function(){return oz(t)},a=function(t,n,e,r){return Math.max(t,e)<=Math.min(n,r)},c=function(){var n=m.get().map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return t.selection.getRng().getBoundingClientRect()})),e=t.inline?Dc().top():Vc($e.fromDom(t.getBody())).y();return{y:n.top+e,bottom:n.bottom+e}},s=function(){if(o()&&r.backstage.isContextMenuOpen())return!0;var t=c(),n=u();return!a(t.y,t.bottom,n.y(),n.bottom())},f=function(){kw.hide(i)},l=function(){d.get().each((function(t){var n=i.element();Xa(n,"display"),s()?za(n,"display","none"):Tm.positionWithinBounds(e,t,i,x.some(u()))}))},d=We(x.none()),m=We(x.none()),g=We(null),p=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:mf([Qb.config({mode:"acyclic"}),fy("pop-dialog-wrap-events",[Li((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Qb.focusIn(n)}))})),Hi((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},h=Et((function(){return fz.categorise(n,(function(t){var n=v(t);ui(i,lz,{forwardContents:p(n)})}))})),v=function(n){var e=t.ui.registry.getAll().buttons,o=FT(t)===hT.scrolling?hT.scrolling:hT.default,i=h();return"contexttoolbar"===n.type?function(){var u=Tt(e,i.formNavigators),a=fV(t,{buttons:u,toolbar:n.items},r,x.some(["form:"]));return $L({type:o,uid:Bu("context-toolbar"),initGroups:a,onEscape:x.none,cyclicKeying:!0,backstage:r.backstage,getSink:function(){return O.error("")}})}():function(){return ZH.renderContextForm(o,n,r.backstage)}()};t.on(wF,(function(n){var e=h();qt(e.lookupTable,n.toolbarKey).each((function(e){y(e,n.target===t?x.none():x.some(n)),kw.getContent(i).each(Qb.focusIn)}))}));var b=function(t,n){var e="node"===t?r.backstage.shared.anchors.node(n):r.backstage.shared.anchors.cursor();return Ot(e,hV(t,o()))},y=function(t,n){if(C(),!o()||!r.backstage.isContextMenuOpen()){var e=v(t),a=n.map($e.fromDom),c=b(t.position,a);d.set(x.some(c)),m.set(n);var f=i.element();Xa(f,"display"),kw.showWithinBounds(i,c,p(e),(function(){return x.some(u())})),s()&&za(f,"display","none")}},w=function(){var n=h();cz.lookup(n,t).fold((function(){d.set(x.none()),kw.hide(i)}),(function(t){y(t.toolbarApi,x.some(t.elem.dom()))}))},C=function(){var t=g.get();null!==t&&(qw.clearTimeout(t),g.set(null))},S=function(t){C(),g.set(t)};t.on("init",(function(){t.on(xF,f),t.on("ScrollContent ScrollWindow longpress",l),t.on("click keyup SetContent ObjectResized ResizeEditor",(function(n){S(qw.setEditorTimeout(t,w,0))})),t.on("focusout",(function(n){qw.setEditorTimeout(t,(function(){_f(e.element()).isNone()&&_f(i.element()).isNone()&&(d.set(x.none()),kw.hide(i))}),0)})),t.on("SwitchMode",(function(){t.readonly&&(d.set(x.none()),kw.hide(i))})),t.on("NodeChange",(function(n){_f(i.element()).fold((function(){S(qw.setEditorTimeout(t,w,0))}),(function(t){}))}))}))},bV={register:vV},yV=function(t,e,r){var o=function(t,n){G([e,r],(function(e){e.broadcastEvent(t,n)}))},i=function(t,n){G([e,r],(function(e){e.broadcastOn([t],n)}))},u=function(t){return i(ag(),{target:t.target()})},a=zO($e.fromDom(n.document),"touchstart",u),c=zO($e.fromDom(n.document),"touchmove",(function(t){return o(Go(),t)})),s=zO($e.fromDom(n.document),"touchend",(function(t){return o(qo(),t)})),f=zO($e.fromDom(n.document),"mousedown",u),l=zO($e.fromDom(n.document),"mouseup",(function(t){0===t.raw().button&&i(sg(),{target:t.target()})})),d=function(t){return i(ag(),{target:$e.fromDom(t.target)})},m=function(t){0===t.button&&i(sg(),{target:$e.fromDom(t.target)})},g=function(t){return o(Xo(),jO(t))},p=function(t){i(cg(),{}),o(Yo(),jO(t))},h=function(){return i(cg(),{})};t.on("PostRender",(function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("ScrollWindow",g),t.on("ResizeWindow",p),t.on("ResizeEditor",h)})),t.on("remove",(function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("ScrollWindow",g),t.off("ResizeWindow",p),t.off("ResizeEditor",h),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),t.on("detach",(function(){zm(e),zm(r),e.destroy(),r.destroy()}))},wV={setup:yV},xV=Up,CV=Op,SV=i([Ie("shell",!1),ge("makeItem"),Ie("setupItem",e),qg.field("listBehaviours",[cy])]),kV=function(t){return{behaviours:mf([cy.config({})])}},OV=Cp({name:"items",overrides:kV}),TV=i([OV]),EV=i("CustomList"),DV=function(t,e,r,o){var i=function(e,r){a(e).fold((function(){throw n.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(n){var o=cy.contents(n),i=r.length,u=i-o.length,a=u>0?j(u,(function(){return t.makeItem()})):[],c=o.slice(i);G(c,(function(t){return cy.remove(n,t)})),G(a,(function(t){return cy.append(n,t)}));var s=cy.contents(n);G(s,(function(n,o){t.setupItem(e,n,r[o],o)}))}))},u=t.shell?{behaviours:[cy.config({})],components:[]}:{behaviours:[],components:e},a=function(n){return t.shell?x.some(n):Np(n,t,"items")};return{uid:t.uid,dom:t.dom,components:u.components,behaviours:Gg(t.listBehaviours,u.behaviours),apis:{setItems:i}}},AV=th({name:EV(),configFields:SV(),partFields:TV(),factory:DV,apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),_V=function(t){var n=Ga(t,"position").is("fixed"),e=n?x.none():Zi(t);return e.orThunk((function(){var n=$e.fromTag("span");iu(t,n);var e=Zi(n);return mu(n),e})).map(xc).getOrThunk((function(){return bc(0,0)}))},RV=wt.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),BV=function(t){return function(n){return n.translate(-t.left(),-t.top())}},IV=function(t){return function(n){return n.translate(t.left(),t.top())}},PV=function(t){return function(n,e){return $(t,(function(t,n){return n(t)}),bc(n,e))}},NV=function(t,n,e){return t.fold(PV([IV(e),BV(n)]),PV([BV(n)]),PV([]))},MV=function(t,n,e){return t.fold(PV([IV(e)]),PV([]),PV([IV(n)]))},FV=function(t,n,e){return t.fold(PV([]),PV([BV(e)]),PV([IV(n),BV(e)]))},LV=function(t,n,e,r,o,i){var u=MV(t,o,i),a=MV(n,o,i);return Math.abs(u.left()-a.left())<=e&&Math.abs(u.top()-a.top())<=r},HV=function(t,n,e,r,o,i){var u=MV(t,o,i),a=MV(n,o,i),c=Math.abs(u.left()-a.left()),s=Math.abs(u.top()-a.top());return bc(c,s)},zV=function(t,n,e){return t.fold((function(t,n){return{position:"absolute",left:t+"px",top:n+"px"}}),(function(t,n){return{position:"absolute",left:t-e.left()+"px",top:n-e.top()+"px"}}),(function(t,n){return{position:"fixed",left:t+"px",top:n+"px"}}))},VV=function(t,n,e){return t.fold((function(t,r){return RV.offset(t+n,r+e)}),(function(t,r){return RV.absolute(t+n,r+e)}),(function(t,r){return RV.fixed(t+n,r+e)}))},jV=function(t,n,e,r){var o=function(t,o){return function(i,u){var a=t(n,e,r);return o(i.getOr(a.left()),u.getOr(a.top()))}};return t.fold(o(FV,RV.offset),o(MV,RV.absolute),o(NV,RV.fixed))},UV=RV.offset,WV=RV.absolute,GV=RV.fixed,qV=wt.generate([{static:[]},{absolute:["x","y"]},{fixed:["x","y"]}]),XV=function(t,n){var e=t.element();Ra(e,n.transitionClass),Ia(e,n.fadeOutClass),Ra(e,n.fadeInClass),n.onShow(t)},YV=function(t,n){var e=t.element();Ra(e,n.transitionClass),Ia(e,n.fadeInClass),Ra(e,n.fadeOutClass),n.onHide(t)},KV=function(t,n){return t.y()<n.bottom()&&t.bottom()>n.y()},$V=function(t,n){return t.y()>=n.y()},JV=function(t,n){return t.bottom()<=n.bottom()},QV=function(t,n,e){return nt(t,(function(t){switch(t){case"bottom":return JV(n,e);case"top":return $V(n,e)}}))},ZV=function(t,n){return Cu(t,n)?x.some(parseInt(xu(t,n),10)):x.none()},tj=function(t,n){return ZV(t,n.leftAttr).bind((function(e){return ZV(t,n.topAttr).map((function(n){var r=Oc(t),o=gc(t);return Hc(e,n,r,o)}))}))},nj=function(t,n,e,r,o){yu(t,n.leftAttr,e),yu(t,n.topAttr,r),yu(t,n.positionAttr,o)},ej=function(t,n){Su(t,n.leftAttr),Su(t,n.topAttr),Su(t,n.positionAttr)},rj=function(t,n,e){var r=xu(t,n.positionAttr);switch(ej(t,n),r){case"static":return x.some(qV.static());case"absolute":return x.some(qV.absolute(e.x(),e.y()));default:return x.none()}},oj=function(t,n,e){return tj(t,n).filter((function(t){return QV(n.modes,t,e)})).bind((function(e){return rj(t,n,e)}))},ij=function(t,n,e,r,o){var i=zc(t);if(QV(n.modes,i,e))return x.none();var u=o(),a=Ua(t,"position");nj(t,n,i.x(),i.y(),a);var c=WV(i.x(),i.y()),s=NV(c,r,u),f=WV(e.x(),e.y()),l=NV(f,r,u),d=i.y()<=e.y()?l.top():l.top()+e.height()-i.height();return x.some(qV.fixed(s.left(),d))},uj=function(t,n,e,r,o){var i=t.element(),u=Ga(i,"position").is("fixed");return u?oj(i,n,e):ij(i,n,e,r,o)},aj=function(t,n){var e=t.element();return tj(e,n).bind((function(t){return rj(e,n,t)}))},cj=function(t,n){G(["left","top","position"],(function(n){return Xa(t.element(),n)})),n.onUndocked(t)},sj=function(t,n,e,r,o){var i=zV(o,e,r);Va(t.element(),i);var u="fixed"===i.position?n.onDocked:n.onUndocked;u(t)},fj=function(t,n,e,r,o){void 0===o&&(o=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=KV(i,r);if(u!==e.isVisible())if(e.setVisible(u),o&&!u)Na(t.element(),[n.fadeOutClass]),n.onHide(t);else{var a=u?XV:YV;a(t,n)}}))}))},lj=function(t,n,e){var r=n.lazyViewport(t),o=t.element(),i=Ki(o),u=Dc(i),a=Et((function(){return _V(o)})),c=e.isDocked();c&&fj(t,n,e,r),uj(t,n,r,u,a).each((function(o){e.setDocked(!c),o.fold((function(){return cj(t,n)}),(function(e,r){return sj(t,n,u,a(),WV(e,r))}),(function(o,i){fj(t,n,e,r,!0),sj(t,n,u,a(),GV(o,i))}))}))},dj=function(t,n,r){var o=t.element();r.setDocked(!1),aj(t,n).each((function(r){r.fold((function(){return cj(t,n)}),(function(e,r){var i=Ki(o),u=Dc(i),a=_V(o);sj(t,n,u,a,WV(e,r))}),e)})),r.setVisible(!0),n.contextual.each((function(n){Ma(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),mj(t,n,r)},mj=function(t,n,e){t.getSystem().isConnected()&&lj(t,n,e)},gj=function(t,n,e){e.isDocked()&&dj(t,n,e)},pj=function(t,n,e){return e.isDocked()},hj=Object.freeze({refresh:mj,reset:gj,isDocked:pj}),vj=function(t,n){return ki([Fi(_o(),(function(e,r){t.contextual.each((function(t){if(Pa(e.element(),t.transitionClass)){Ma(e.element(),[t.transitionClass,t.fadeInClass]);var o=n.isVisible()?t.onShown:t.onHidden;o(e)}r.stop()}))})),Di(Xo(),(function(e,r){mj(e,t,n)})),Di(Yo(),(function(e,r){gj(e,t,n)}))])},bj=Object.freeze({events:vj}),yj=[Re("contextual",[ve("fadeInClass"),ve("fadeOutClass"),ve("transitionClass"),we("lazyContext"),ys("onShow"),ys("onShown"),ys("onHide"),ys("onHidden")]),He("lazyViewport",jc),ve("leftAttr"),ve("topAttr"),ve("positionAttr"),Ve("modes",["top","bottom"],ce),ys("onDocked"),ys("onUndocked")],wj=function(){var t=We(!1),n=We(!0),e=function(){return"docked:  "+t.get()+", visible: "+n.get()};return Zu({isDocked:function(){return t.get()},setDocked:function(n){return t.set(n)},isVisible:function(){return n.get()},setVisible:function(t){return n.set(t)},readState:e})},xj=Object.freeze({init:wj}),Cj=pf({fields:yj,name:"docking",active:bj,apis:hj,state:xj}),Sj={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},kj="tox-tinymce--toolbar-sticky-on",Oj="tox-tinymce--toolbar-sticky-off",Tj=function(t){var n=t.element();Qi(n).each((function(e){if(Cj.isDocked(t)){var r=Oc(e);za(n,"width",r+"px");var o=pc(n);za(e,"padding-top",o+"px")}else Xa(n,"width"),Xa(e,"padding-top")}))},Ej=function(t,n){n?(Ia(t,Sj.fadeOutClass),Na(t,[Sj.transitionClass,Sj.fadeInClass])):(Ia(t,Sj.fadeInClass),Na(t,[Sj.fadeOutClass,Sj.transitionClass]))},Dj=function(t,n){var e=$e.fromDom(t.getContainer());n?(Ra(e,kj),Ia(e,Oj)):(Ra(e,Oj),Ia(e,kj))},Aj=function(t,n){var e=Ki(n);Af(e).filter((function(t){return!eo(n,t)})).filter((function(n){return eo(n,$e.fromDom(e.dom().body))||uo(t,n)})).each((function(){return Tf(n)}))},_j=function(t,n){return _f(t).orThunk((function(){return n().toOption().bind((function(t){return _f(t.element())}))}))},Rj=function(t,n){t.inline||(t.on("ResizeWindow ResizeEditor ResizeContent",(function(){n().each(Tj)})),t.on("SkinLoaded",(function(){n().each(Cj.reset)})),t.on("FullscreenStateChanged",(function(){n().each(Cj.refresh)}))),t.on("PostRender",(function(){Dj(t,!1)}))},Bj=function(t){return t().map(Cj.isDocked).getOr(!1)},Ij=function(){var t;return[Sf.config({channels:(t={},t[ML()]={onReceive:Tj},t)})]},Pj=function(t,n){var e=We(x.none()),r=function(t){n().each((function(n){return t(n.element())}))},o=function(e){t.inline||Tj(e),Dj(t,Cj.isDocked(e)),e.getSystem().broadcastOn([cg()],{}),n().each((function(t){return t.getSystem().broadcastOn([cg()],{})}))},i=t.inline?[]:Ij();return p([yy.config({}),Cj.config({leftAttr:"data-dock-left",topAttr:"data-dock-top",positionAttr:"data-dock-pos",contextual:m({lazyContext:function(n){var e=pc(n.element()),r=t.inline?t.getContentAreaContainer():t.getContainer(),o=zc($e.fromDom(r)),i=o.height()-e;return x.some(Hc(o.x(),o.y(),o.width(),i))},onShow:function(){r((function(t){return Ej(t,!0)}))},onShown:function(t){r((function(t){return Ma(t,[Sj.transitionClass,Sj.fadeInClass])})),e.get().each((function(n){Aj(t.element(),n),e.set(x.none())}))},onHide:function(t){e.set(_j(t.element(),n)),r((function(t){return Ej(t,!1)}))},onHidden:function(){r((function(t){return Ma(t,[Sj.transitionClass])}))}},Sj),modes:["top"],onDocked:o,onUndocked:o})],i)},Nj=Object.freeze({setup:Rj,isDocked:Bj,getBehaviours:Pj}),Mj=e,Fj=f,Lj=i([]),Hj=Object.freeze({setup:Mj,isDocked:Fj,getBehaviours:Lj}),zj=function(t){var n=t.editor,e=t.sticky?Pj:Lj;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:mf(e(n,t.getSink))}},Vj=function(t,n){var e=function(t,e){var r=W(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},r=eH(e).mapError((function(t){return ee(t)})).getOrDie();return UI(r,"tox-mbtn",n.backstage,x.some("menuitem"))}));cy.set(t,r)},r={focus:Qb.focusIn,setMenus:e};return{uid:t.uid,dom:t.dom,components:[],behaviours:mf([cy.config({}),fy("menubar-events",[Li((function(n){t.onSetup(n)})),Di(Co(),(function(t,n){Gc(t.element(),".tox-mbtn--active").each((function(e){qc(n.event().target(),".tox-mbtn").each((function(n){eo(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){xD.expand(t),xD.close(e),yy.focus(t)}))}))}))}))})),Di(Zo(),(function(t,n){n.event().prevFocus().bind((function(n){return t.getSystem().getByDom(n).toOption()})).each((function(e){n.event().newFocus().bind((function(n){return t.getSystem().getByDom(n).toOption()})).each((function(t){xD.isOpen(e)&&(xD.expand(t),xD.close(e))}))}))}))]),Qb.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),x.some(!0)}}),GE.config({})]),apis:r,domModification:{attributes:{role:"menubar"}}}},jj=Zp({factory:Vj,name:"silver.Menubar",configFields:[ge("dom"),ge("uid"),ge("onEscape"),ge("backstage"),Ie("onSetup",e)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),Uj="container",Wj=[Ug("slotBehaviours",[])],Gj=function(t){return"<alloy.field."+t+">"},qj=function(t){var n=function(){var t=[],n=function(n,e){return t.push(n),_p(Uj,Gj(n),e)};return{slot:n,record:function(){return t}}}(),e=t(n),r=n.record(),o=W(r,(function(t){return wp({name:t,pname:Gj(t)})}));return Xp(Uj,Wj,o,Xj,e)},Xj=function(t,n,e){var r=function(n){return Hp(t)},o=function(n,e){return Np(n,t,e)},i=function(n,e){return void 0===e&&(e=void 0),function(r,o){return Np(r,t,o).map((function(t){return n(t,o)})).getOr(e)}},u=function(t){return function(n,e){G(e,(function(e){return t(n,e)}))}},a=function(t,n){return"true"!==xu(t.element(),"aria-hidden")},c=function(t,n){if(!a(t)){var e=t.element();Xa(e,"display"),Su(e,"aria-hidden"),ui(t,ti(),{name:n,visible:!0})}},s=function(t,n){if(a(t)){var e=t.element();za(e,"display","none"),yu(e,"aria-hidden","true"),ui(t,ti(),{name:n,visible:!1})}},f=i(a,!1),l=i(s),d=u(l),m=function(t){return d(t,r())},g=i(c),p={getSlotNames:r,getSlot:o,isShowing:f,hideSlot:l,hideAllSlots:m,showSlot:g};return{uid:t.uid,dom:t.dom,components:n,behaviours:Wg(t.slotBehaviours),apis:p}},Yj=dt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Ju),Kj=m(m({},Yj),{sketch:qj}),$j=Fn([De("icon"),De("tooltip"),He("onShow",e),He("onHide",e),He("onSetup",(function(){return e}))]),Jj=function(t){return Zn("sidebar",$j,t)},Qj=function(t){var n=t.ui.registry.getAll().sidebars;G(st(n),(function(e){var r=n[e],o=function(){return x.from(t.queryCommandValue("ToggleSidebar")).is(e)};t.ui.registry.addToggleButton(e,{icon:r.icon,tooltip:r.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(o())},onSetup:function(n){var e=function(){return n.setActive(o())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))},Zj=function(t){return{element:function(){return t.element().dom()}}},tU=function(t,n){var r=W(st(n),(function(t){var e=n[t],r=te(Jj(e));return{name:t,getApi:Zj,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}}));return W(r,(function(n){var o=We(e);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Kx.unnamedEvents([mS(n,o),gS(n,o),Di(ti(),(function(t,n){var e=n.event(),o=J(r,(function(t){return t.name===e.name()}));o.each((function(n){var r=e.visible()?n.onShow:n.onHide;r(n.getApi(t))}))}))])})}))},nU=function(t){return Kj.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:tU(n,t),slotBehaviours:Kx.unnamedEvents([Li((function(t){return Kj.hideAllSlots(t)}))])}}))},eU=function(t,n){var e=ih.getCurrent(t);e.each((function(t){return cy.set(t,[nU(n)])}))},rU=function(t,n){var e=ih.getCurrent(t);e.each((function(t){var e=ih.getCurrent(t);e.each((function(e){DL.hasGrown(t)?Kj.isShowing(e,n)?DL.shrink(t):(Kj.hideAllSlots(e),Kj.showSlot(e,n)):(Kj.hideAllSlots(e),Kj.showSlot(e,n),DL.grow(t))}))}))},oU=function(t){var n=ih.getCurrent(t);return n.bind((function(t){var n=DL.isGrowing(t)||DL.hasGrown(t);if(n){var e=ih.getCurrent(t);return e.bind((function(t){return J(Kj.getSlotNames(t),(function(n){return Kj.isShowing(t,n)}))}))}return x.none()}))},iU=Bu("FixSizeEvent"),uU=Bu("AutoSizeEvent"),aU=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:mf([GE.config({}),yy.config({}),DL.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){var n=ih.getCurrent(t);n.each(Kj.hideAllSlots),ii(t,uU)},onGrown:function(t){ii(t,uU)},onStartGrow:function(t){ui(t,iU,{width:Ga(t.element(),"width").getOr("")})},onStartShrink:function(t){ui(t,iU,{width:Oc(t.element())+"px"})}}),cy.config({}),ih.config({find:function(t){var n=cy.contents(t);return ut(n)}})])}],behaviours:mf([HR.childAt(0),fy("sidebar-sliding-events",[Di(iU,(function(t,n){za(t.element(),"width",n.event().width())})),Di(uU,(function(t,n){Xa(t.element(),"width")}))])])}},cU=function(t){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:fC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:mf([Qb.config({mode:"special",onTab:function(){return x.some(!0)},onShiftTab:function(){return x.some(!0)}}),yy.config({})])}},sU=function(t,n,e){var r=t.element();!0===n?(cy.set(t,[cU(e)]),Xa(r,"display"),Su(r,"aria-hidden")):(cy.set(t,[]),za(r,"display","none"),yu(r,"aria-hidden","true"))},fU=function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:mf([cy.config({})]),components:[]}},lU=function(t,n,e){var r=We(!1),o=We(x.none()),i=function(t){t!==r.get()&&(sU(n(),t,e.providers),r.set(t))};t.on("ProgressState",(function(n){if(o.get().each(qw.clearTimeout),I(n.time)){var e=qw.setEditorTimeout(t,(function(){return i(n.state)}),n.time);o.set(x.some(e))}else i(n.state),o.set(x.none())}))},dU=function(t,n,e){var r={getSocket:function(n){return xV.getPart(n,t,"socket")},setSidebar:function(n,e){xV.getPart(n,t,"sidebar").each((function(t){return eU(t,e)}))},toggleSidebar:function(n,e){xV.getPart(n,t,"sidebar").each((function(t){return rU(t,e)}))},whichSidebar:function(n){return xV.getPart(n,t,"sidebar").bind(oU).getOrNull()},getHeader:function(n){return xV.getPart(n,t,"header")},getToolbar:function(n){return xV.getPart(n,t,"toolbar")},setToolbar:function(n,e){xV.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){xV.getPart(n,t,"multiple-toolbar").each((function(t){AV.setItems(t,e)}))},refreshToolbar:function(n){var e=xV.getPart(n,t,"toolbar");e.each((function(t){return t.getApis().refresh(t)}))},getMoreButton:function(n){var e=xV.getPart(n,t,"toolbar");return e.bind((function(t){return t.getApis().getMoreButton(t)}))},getThrobber:function(n){return xV.getPart(n,t,"throbber")},focusToolbar:function(n){var e=xV.getPart(n,t,"toolbar").orThunk((function(){return xV.getPart(n,t,"multiple-toolbar")}));e.each((function(t){Qb.focusIn(t)}))},setMenubar:function(n,e){xV.getPart(n,t,"menubar").each((function(t){jj.setMenus(t,e)}))},focusMenubar:function(n){xV.getPart(n,t,"menubar").each((function(t){jj.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:r,behaviours:t.behaviours}},mU=CV.optional({factory:jj,name:"menubar",schema:[ge("backstage")]}),gU=function(t){return t.split===hT.sliding?KL:t.split===hT.floating?YL:$L},pU=CV.optional({factory:{sketch:function(t){return AV.sketch({uid:t.uid,dom:t.dom,listBehaviours:mf([Qb.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return $L({type:t.split,uid:Bu("multiple-toolbar-item"),backstage:t.backstage,cyclicKeying:!1,getSink:t.getSink,initGroups:[],onEscape:function(){return x.none()}})},setupItem:function(t,n,e,r){TF.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[ge("dom"),ge("onEscape")]}),hU=CV.optional({factory:{sketch:function(t){var n=gU(t),e={type:t.split,uid:t.uid,onEscape:function(){return t.onEscape(),x.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,backstage:t.backstage,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader}};return n(e)}},name:"toolbar",schema:[ge("dom"),ge("onEscape"),ge("getSink")]}),vU=CV.optional({factory:{sketch:zj},name:"header",schema:[ge("dom")]}),bU=CV.optional({name:"socket",schema:[ge("dom")]}),yU=CV.optional({factory:{sketch:aU},name:"sidebar",schema:[ge("dom")]}),wU=CV.optional({factory:{sketch:fU},name:"throbber",schema:[ge("dom")]}),xU=th({name:"OuterContainer",factory:dU,configFields:[ge("dom"),ge("behaviours")],partFields:[vU,mU,hU,pU,bU,yU,wU],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var r=W(e,(function(t){return GL(t)}));t.setToolbar(n,r)},setToolbars:function(t,n,e){var r=W(e,(function(t){return W(t,GL)}));t.setToolbars(n,r)},getMoreButton:function(t,n){return t.getMoreButton(n)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),CU="file edit view insert format tools table help",SU={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},kU=function(t,n,e){var r=BT(e).split(/[ ,]/);return{text:t.title,getItems:function(){return tt(t.items,(function(t){var e=t.toLowerCase();return 0===e.trim().length||V(r,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}},OU=function(t){return"string"===typeof t?t.split(" "):t},TU=function(t,n){var e=Tt(SU,n.menus),r=st(n.menus).length>0,o=void 0===n.menubar||!0===n.menubar?OU(CU):OU(!1===n.menubar?"":n.menubar),i=Y(o,(function(t){return r&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||SU.hasOwnProperty(t)})),u=W(i,(function(r){var o=e[r];return kU({title:o.title,items:OU(o.items)},n,t)}));return Y(u,(function(t){var n=function(t){return"separator"!==t.type};return t.getItems().length>0&&V(t.getItems(),n)}))},EU=function(t){var n=function(){t._skinLoaded=!0,kk.fireSkinLoaded(t)};return function(){t.initialized?n():t.on("init",n)}},DU={fireSkinLoaded:EU},AU=function(t,n){var e,r=xT(n);r&&(e=r+"/skin.min.css",n.contentCSS.push(r+(t?"/content.inline":"/content")+".min.css")),!1===ST(n)&&e?xS.DOM.styleSheetLoader.load(e,DU.fireSkinLoaded(n)):DU.fireSkinLoaded(n)()},_U=a(AU,!1),RU=a(AU,!0),BU=function(t,n,e,r){var o=n.outerContainer,i=e.toolbar,u=e.buttons;if(P(i,D)){var a=i.map((function(n){var e={toolbar:n,buttons:u};return fV(t,e,{backstage:r},x.none())}));xU.setToolbars(o,a)}else xU.setToolbar(o,fV(t,e,{backstage:r},x.none()))},IU=xS.DOM,PU=qr(),NU=PU.os.isiOS()&&PU.os.version.major<=12,MU=function(t){var n=t.getWin(),e=t.getDoc().documentElement,r=We(bc(n.innerWidth,n.innerHeight)),o=We(bc(e.offsetWidth,e.offsetHeight)),i=function(e){var i=t.getDoc().documentElement,u=r.get(),a=o.get();u.left()!==n.innerWidth||u.top()!==n.innerHeight?(r.set(bc(n.innerWidth,n.innerHeight)),kk.fireResizeContent(t,e)):a.left()===i.offsetWidth&&a.top()===i.offsetHeight||(o.set(bc(i.offsetWidth,i.offsetHeight)),kk.fireResizeContent(t,e))},u=function(n){return kk.fireScrollContent(t,n)};IU.bind(n,"resize",i),IU.bind(n,"scroll",u);var a=VO($e.fromDom(t.getBody()),"load",i);t.on("remove",(function(){a.unbind(),IU.unbind(n,"resize",i),IU.unbind(n,"scroll",u)}))},FU=function(t,n,e,r,o){var i=We(0);_U(t),Lm($e.fromDom(o.targetNode),n.mothership),Fm(bi(),n.uiMothership),t.on("PostRender",(function(){BU(t,n,e,r),i.set(t.getWin().innerWidth),xU.setMenubar(n.outerContainer,TU(t,e)),xU.setSidebar(n.outerContainer,e.sidebar),MU(t)}));var u=xU.getSocket(n.outerContainer).getOrDie("Could not find expected socket element");if(!0===NU){Va(u.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var a=Kw((function(){t.fire("ScrollContent")}),20);zO(u.element(),"scroll",a.throttle)}jL(t,n),t.addCommand("ToggleSidebar",(function(e,r){xU.toggleSidebar(n.outerContainer,r),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return xU.whichSidebar(n.outerContainer)}));var c=FT(t),s=function(){xU.refreshToolbar(n.outerContainer)};return c!==hT.sliding&&c!==hT.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var n=t.getWin().innerWidth;n!==i.get()&&(s(),i.set(n))})),{iframeContainer:u.element().dom(),editorContainer:n.outerContainer.element().dom()}},LU={render:FU},HU=function(t){var n=/^[0-9\.]+(|px)$/i;return n.test(""+t)?x.some(parseInt(""+t,10)):x.none()},zU=function(t){return I(t)?t+"px":t},VU=function(t,n,e){var r=n.filter((function(n){return t<n})),o=e.filter((function(n){return t>n}));return r.or(o).getOr(t)},jU={calcCappedSize:VU,parseToInt:HU,numToPx:zU},UU=function(t){var n=kT(t),e=ET(t),r=AT(t);return jU.parseToInt(n).map((function(t){return jU.calcCappedSize(t,e,r)}))},WU=function(t){var n=UU(t);return n.getOr(kT(t))},GU=function(t){var n=OT(t),e=TT(t),r=DT(t);return jU.parseToInt(n).map((function(t){return jU.calcCappedSize(t,e,r)}))},qU=function(t){var n=GU(t);return n.getOr(OT(t))},XU=function(t,n,e,r,o){var i,u=xS.DOM,a=zT(t),c=UT(t),s=$e.fromDom(o.targetNode),f=DT(t).or(GU(t)),l=FT(t),d=l===hT.sliding||l===hT.floating;RU(t);var m=function(t){var e=d?t.fold((function(){return 0}),(function(t){return t.components().length>1?gc(t.components()[1].element()):0})):0,r=xc(s),o=r.top()-gc(i.element())+e;Va(n.outerContainer.element(),{position:"absolute",top:Math.round(o)+"px",left:Math.round(r.left())+"px"});var u=f.getOrThunk((function(){var t=jU.parseToInt(Ua(bi(),"margin-left")).getOr(0);return Oc(bi())-r.left()+t}));za(i.element(),"max-width",u+"px")},g=function(t){if(void 0===t&&(t=!1),d&&xU.refreshToolbar(n.outerContainer),!a){var e=xU.getToolbar(n.outerContainer);m(e)}c&&(t?Cj.reset(i):Cj.refresh(i))},p=function(){za(n.outerContainer.element(),"display","flex"),u.addClass(t.getBody(),"mce-edit-focus"),Xa(n.uiMothership.element(),"display"),g()},h=function(){n.outerContainer&&(za(n.outerContainer.element(),"display","none"),u.removeClass(t.getBody(),"mce-edit-focus")),za(n.uiMothership.element(),"display","none")},v=function(){if(i)p();else{i=xU.getHeader(n.outerContainer).getOrDie();var o=VT(t);Fm(o,n.mothership),Fm(o,n.uiMothership),BU(t,n,e,r),xU.setMenubar(n.outerContainer,TU(t,e)),p(),t.on("activate",p),t.on("deactivate",h),t.on("NodeChange SkinLoaded ResizeWindow",(function(){t.hidden||g(!0)})),t.nodeChanged()}};return t.on("focus",v),t.on("blur hide",h),t.on("init",(function(){t.hasFocus()&&v()})),jL(t,n),{editorContainer:n.outerContainer.element().dom()}},YU={render:XU},KU=function(t){var n=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];BP.each(n,(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:hz(t,n.name)})}));var e={name:"alignnone",text:"No alignment",cmd:"JustifyNone",icon:"align-none"};t.ui.registry.addButton(e.name,{tooltip:e.text,onAction:function(){return t.execCommand(e.cmd)},icon:e.icon})},$U={register:KU},JU=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},QU=function(t){BP.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:hz(t,n.name),onAction:JU(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:hz(t,e),onAction:JU(t,e)})}},ZU=function(t){BP.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:function(){return t.execCommand(n.action)}})}))},tW=function(t){BP.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:function(){return t.execCommand(n.action)},onSetup:hz(t,n.name)})}))},nW=function(t){QU(t),ZU(t),tW(t)},eW=function(t){BP.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:function(){return t.execCommand(n.action)}})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:JU(t,"code")})},rW=function(t){nW(t),eW(t)},oW={register:rW},iW=function(t,n,e){var r=function(){return!!n.undoManager&&n.undoManager[e]()},o=function(){t.setDisabled(n.readonly||!r())};return t.setDisabled(!r()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o)}},uW=function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(n){return iW(n,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(n){return iW(n,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})},aW=function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(n){return iW(n,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(n){return iW(n,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})},cW=function(t){uW(t),aW(t)},sW={register:cW},fW=function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}},lW=function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(n){return fW(n,t)},onAction:function(){t.execCommand("mceToggleVisualAid")}})},dW=function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return t.execCommand("mceToggleVisualAid")}})},mW=function(t){dW(t),lW(t)},gW={register:mW},pW=function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}},hW=function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(n){return pW(n,t)},onAction:function(){return t.execCommand("outdent")}}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return t.execCommand("indent")}})},vW=function(t){hW(t)},bW={register:vW},yW=function(t,n){Az(t,n),Mz(t,n),Zz(t,n),$z(t,n),Wz(t,n)},wW={register:yW},xW=function(t,n){$U.register(t),oW.register(t),wW.register(t,n),sW.register(t),zk.register(t),gW.register(t),bW.register(t)},CW={setup:xW},SW=function(t,n){return{anchor:"makeshift",x:t,y:n}},kW=function(t,n,e){return SW(t.x+n,t.y+e)},OW=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},TW=function(t){if(OW(t)){var n=t.touches[0];return SW(n.pageX,n.pageY)}return SW(t.pageX,t.pageY)},EW=function(t){if(OW(t)){var n=t.touches[0];return SW(n.clientX,n.clientY)}return SW(t.clientX,t.clientY)},DW=function(t,n){var e=xS.DOM.getPos(t);return kW(n,e.x,e.y)},AW=function(t,n){return"contextmenu"===n.type?t.inline?TW(n):DW(t.getContentAreaContainer(),EW(n)):_W(t)},_W=function(t){return{anchor:"selection",root:$e.fromDom(t.selection.getNode())}},RW=function(t){return{anchor:"node",node:x.some($e.fromDom(t.selection.getNode())),root:$e.fromDom(t.getBody())}},BW=function(t,n,e){return e?RW(t):AW(t,n)},IW=function(t,n,e,r,o,i){var u=e(),a=BW(t,n,i);VI(u,pS.CLOSE_ON_EXECUTE,r,!1).map((function(t){n.preventDefault(),kw.showMenuAt(o,a,{menu:{markers:Kk("normal")},data:t})}))},PW={onLtr:function(){return[Qs,Xs,Ys,Ks,$s,Js,Pw,Nw,Bw,_w,Iw,Rw]},onRtl:function(){return[Qs,Ys,Xs,$s,Ks,Js,Pw,Nw,Iw,Rw,Bw,_w]}},NW=12,MW={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},FW=function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var r=n.touches[0],o=e.getRng(),i=gd(t.getWin(),yl.domRange(o));return i.exists((function(t){return t.left()<=r.clientX&&t.right()>=r.clientX&&t.top()<=r.clientY&&t.bottom()>=r.clientY}))},LW=function(t,n){var e=n?RW(t):_W(t);return m({bubble:If(0,NW,MW),layouts:PW,overrides:{maxWidthFunction:eM(),maxHeightFunction:dm()}},e)},HW=function(t){var n=t.selection.getRng(),e=function(){qw.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var r=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",r,!0);var o=function(){return i()};t.once("longpresscancel",o);var i=function(){t.off("touchend",e),t.off("longpresscancel",o),t.off("mousedown",r)}},zW=function(t,n,e,r,o,i){var u=LW(t,i);VI(e,pS.CLOSE_ON_EXECUTE,r,!0).map((function(e){n.preventDefault(),kw.showMenuWithinBounds(o,u,{menu:{markers:Kk("normal")},data:e,type:"horizontal"},(function(){return x.some(oz(t))})),t.fire(xF)}))},VW=function(t,n,e,r,o,i){var u=qr(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=function(){var u=e();zW(t,n,u,r,o,i)};if(!c&&!a||i)s&&!i&&t.selection.setCursorLocation(n.target,0),f();else{var l=function(){HW(t),f()};FW(t,n)?l():(t.once("selectionchange",l),t.once("touchend",(function(){return t.off("selectionchange",l)})))}},jW=function(t){return"string"===typeof t?t.split(/[ ,]/):t},UW=function(t){return t.settings.contextmenu_never_use_native||!1},WW=function(t,n,e){var r=t.ui.registry.getAll().contextMenus;return vt(t.settings,n).map(jW).getOrThunk((function(){return Y(jW(e),(function(t){return bt(r,t)}))}))},GW=function(t){return!1===t.getParam("contextmenu")},qW=function(t){return WW(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},XW={shouldNeverUseNative:UW,getContextMenu:qW,isContextMenuDisabled:GW},YW=function(t){return D(t)?"|"===t:"separator"===t.type},KW={type:"separator"},$W=function(t){if(D(t))return t;switch(t.type){case"separator":return KW;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var n=t.getSubmenuItems();return D(n)?n:W(n,$W)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:r(t.onAction)}}},JW=function(t,n){if(0===n.length)return t;var e=at(t).filter((function(t){return!YW(t)})),r=e.fold((function(){return[]}),(function(t){return[KW]}));return t.concat(r).concat(n).concat([KW])},QW=function(t,n,e){var r=$(n,(function(n,r){if(bt(t,r)){var o=t[r].update(e);if(D(o))return JW(n,o.split(" "));if(o.length>0){var i=W(o,$W);return JW(n,i)}return n}return n.concat([r])}),[]);return r.length>0&&YW(r[r.length-1])&&r.pop(),r},ZW=function(t,n){return n.ctrlKey&&!XW.shouldNeverUseNative(t)},tG=function(t,n,e){var r=qr(),o=r.deviceType.isTouch,i=sc(kw.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:mf([fy("dismissContextMenu",[Di(Jo(),(function(n,e){ug.close(n),t.focus()}))])])})),u=function(t){return kw.hide(i)},a=function(n){var r="longpress"===n.type;if(XW.shouldNeverUseNative(t)&&n.preventDefault(),!ZW(t,n)&&!XW.isContextMenuDisabled(t)){var u=!r&&(2!==n.button||n.target===t.getBody()),a=function(){var e=u?t.selection.getStart(!0):n.target,r=t.ui.registry.getAll(),o=XW.getContextMenu(t);return QW(r.contextMenus,o,e)},c=o()?VW:IW;c(t,n,a,e,i,u)}};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,u),t.on(o()?"longpress":"longpress contextmenu",a)}))},nG="data-initial-z-index",eG=function(t){Qi(t.element()).filter(pi).each((function(t){var n=xu(t,nG);Cu(t,nG)?za(t,"z-index",n):Xa(t,"z-index"),Su(t,nG)}))},rG=function(t){Qi(t.element()).filter(pi).each((function(n){Ga(n,"z-index").each((function(t){yu(n,nG,t)})),za(n,"z-index",Ua(t.element(),"z-index"))}))},oG=function(t,n){t.getSystem().addToGui(n),rG(n)},iG=function(t){eG(t),t.getSystem().removeFromGui(t)},uG=function(t,n,e){return t.getSystem().build(bT.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},aG=function(t,n){var e=t.element(),r=parseInt(xu(e,n.leftAttr),10),o=parseInt(xu(e,n.topAttr),10);return isNaN(r)||isNaN(o)?x.none():x.some(bc(r,o))},cG=function(t,n,e){var r=t.element();yu(r,n.leftAttr,e.left()+"px"),yu(r,n.topAttr,e.top()+"px")},sG=function(t,n){var e=t.element();Su(e,n.leftAttr),Su(e,n.topAttr)},fG=function(t,n,e,r){return aG(t,n).fold((function(){return e}),(function(t){return GV(t.left()+r.left(),t.top()+r.top())}))},lG=function(t,n,e,r,o,i){var u=fG(t,n,e,r),a=n.mustSnap?gG(t,n,u,o,i):pG(t,n,u,o,i),c=NV(u,o,i);return cG(t,n,c),a.fold((function(){return{coord:GV(c.left(),c.top()),extra:x.none()}}),(function(t){return{coord:t.output(),extra:t.extra()}}))},dG=function(t,n){sG(t,n)},mG=function(t,n,e,r){return Zc(t,(function(t){var o=t.sensor(),u=LV(n,o,t.range().left(),t.range().top(),e,r);return u?x.some({output:i(jV(t.output(),n,e,r)),extra:t.extra}):x.none()}))},gG=function(t,n,e,r,o){var u=n.getSnapPoints(t),a=mG(u,e,r,o);return a.orThunk((function(){var t=$(u,(function(t,n){var i=n.sensor(),u=HV(e,i,n.range().left(),n.range().top(),r,o);return t.deltas.fold((function(){return{deltas:x.some(u),snap:x.some(n)}}),(function(e){var r=(u.left()+u.top())/2,o=(e.left()+e.top())/2;return r<=o?{deltas:x.some(u),snap:x.some(n)}:t}))}),{deltas:x.none(),snap:x.none()});return t.snap.map((function(t){return{output:i(jV(t.output(),e,r,o)),extra:t.extra}}))}))},pG=function(t,n,e,r,o){var i=n.getSnapPoints(t);return mG(i,e,r,o)},hG=function(t,n,e){return{coord:jV(t.output(),t.output(),n,e),extra:t.extra()}},vG=function(t){return ns(Ga(t,"left"),Ga(t,"top"),Ga(t,"position"),(function(t,n,e){var r="fixed"===e?GV:UV;return r(parseInt(t,10),parseInt(n,10))})).getOrThunk((function(){var n=xc(t);return WV(n.left(),n.top())}))},bG=function(t,n,e,r,o){var i=o.bounds,u=MV(n,e,r),a=Zd(u.left(),i.x(),i.x()+i.width()-o.width),c=Zd(u.top(),i.y(),i.y()+i.height()-o.height),s=WV(a,c);return n.fold((function(){var t=FV(s,e,r);return UV(t.left(),t.top())}),(function(){return s}),(function(){var t=NV(s,e,r);return GV(t.left(),t.top())}))},yG=function(t,n,e,r,o,i,u){var a=n.fold((function(){var t=VV(e,i.left(),i.top()),n=NV(t,r,o);return GV(n.left(),n.top())}),(function(n){var u=lG(t,n,e,i,r,o);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}));return bG(t,a,r,o,u)},wG=function(t,n,e,r){var o=n.getTarget(t.element());if(n.repositionTarget){var i=Ki(t.element()),u=Dc(i),a=_V(o),c=vG(o),s=yG(t,n.snaps,c,u,a,r,e),f=zV(s,u,a);Va(o,f)}n.onDrag(t,o,r)},xG=function(t,n){return{bounds:t.getBounds(),height:pc(n.element()),width:Tc(n.element())}},CG=function(t,n,e,r,o){var i=e.update(r,o),u=e.getStartData().getOrThunk((function(){return xG(n,t)}));i.each((function(e){wG(t,n,u,e)}))},SG=function(t,n,e,r){n.each(iG),e.snaps.each((function(n){dG(t,n)}));var o=e.getTarget(t.element());r.reset(),e.onDrop(t,o)},kG=Re("snaps",[ge("getSnapPoints"),ys("onSensor"),ge("leftAttr"),ge("topAttr"),Ie("lazyViewport",jc),Ie("mustSnap",!1)]),OG=function(t){return ki([Di(bo(),t.forceDrop),Di(xo(),t.drop),Di(yo(),(function(n,e){t.move(e.event())})),Di(wo(),t.delayDrop)])},TG=function(t){return x.from(bc(t.x(),t.y()))},EG=function(t,n){return bc(n.left()-t.left(),n.top()-t.top())},DG=Object.freeze({getData:TG,getDelta:EG}),AG=function(t,n){var e=function(e){n.setStartData(xG(t,e))};return ki([Di(Xo(),(function(t){n.getStartData().each((function(){return e(t)}))})),Di(bo(),(function(r,o){var i=o.event().raw();if(0===i.button){o.stop();var u=function(){return SG(r,x.some(s),t,n)},a=WO(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),CG(r,t,n,DG,e)}},s=uG(r,t.blockerClass,OG(c)),f=function(){e(r),oG(r,s)};f()}}))])},_G=[Ie("useFixed",f),ge("blockerClass"),Ie("getTarget",u),Ie("onDrag",e),Ie("repositionTarget",!0),ys("onDrop"),He("getBounds",jc),kG,Ss("dragger",{handlers:AG})],RG=function(t){return ki([Di(go(),t.forceDrop),Di(ho(),t.drop),Di(vo(),t.drop),Di(po(),(function(n,e){t.move(e.event())}))])},BG=function(t){var n=t[0];return x.some(bc(n.clientX,n.clientY))},IG=function(t){var n=t.raw(),e=n.touches;return 1===e.length?BG(e):x.none()},PG=function(t,n){return bc(n.left()-t.left(),n.top()-t.top())},NG=Object.freeze({getData:IG,getDelta:PG}),MG=function(t,n){var e=We(x.none()),r=function(e){n.setStartData(xG(t,e))};return ki([Di(Xo(),(function(t){n.getStartData().each((function(){return r(t)}))})),Di(go(),(function(o,i){i.stop();var u=function(){SG(o,e.get(),t,n),e.set(x.none())},a={drop:u,delayDrop:function(){},forceDrop:u,move:function(e){CG(o,t,n,NG,e)}},c=uG(o,t.blockerClass,RG(a));e.set(x.some(c));var s=function(){r(o),oG(o,c)};s()})),Di(po(),(function(e,r){r.stop(),CG(e,t,n,NG,r.event())})),Di(ho(),(function(r){SG(r,e.get(),t,n),e.set(x.none())})),Di(vo(),(function(r){SG(r,e.get(),t,n),e.set(x.none())}))])},FG=[Ie("useFixed",f),ge("blockerClass"),Ie("getTarget",u),Ie("onDrag",e),Ie("repositionTarget",!0),Ie("onDrop",e),He("getBounds",jc),kG,Ss("dragger",{handlers:MG})],LG=_G,HG=FG,zG=Object.freeze({mouse:LG,touch:HG}),VG=function(){var t=x.none(),n=x.none(),e=function(){t=x.none(),n=x.none()},r=function(n,e){var r=t.map((function(t){return n.getDelta(t,e)}));return t=x.some(e),r},o=function(t,n){return t.getData(n).bind((function(n){return r(t,n)}))},u=function(t){n=x.some(t)},a=function(){return n},c=i({});return Zu({readState:c,reset:e,update:o,getStartData:a,setStartData:u})},jG=Object.freeze({init:VG}),UG=function(t,n,e,r){var o=n.getTarget(t.element());if(n.repositionTarget){var i=Ki(t.element()),u=Dc(i),a=_V(o),c=hG(r,u,a),s=zV(c.coord,u,a);Va(o,s)}},WG=Object.freeze({snapTo:UG}),GG=vf({branchKey:"mode",branches:zG,name:"dragging",active:{events:function(t,n){var e=t.dragger;return e.handlers(t,n)}},extra:{snap:Yi(["sensor","range","output"],["extra"])},state:jG,apis:WG}),qG=qr(),XG=40,YG=XG/2,KG=function(t,n,e,r,o,i){return t.fold((function(){return GG.snap({sensor:WV(e-YG,r-YG),range:bc(o,i),output:WV(x.some(e),x.some(r)),extra:{td:n}})}),(function(t){var o=e-YG,i=r-YG,u=XG,a=XG,c=t.element().dom().getBoundingClientRect();return GG.snap({sensor:WV(o,i),range:bc(u,a),output:WV(x.some(e-c.width/2),x.some(r-c.height/2)),extra:{td:n}})}))},$G=function(t,n,e){var r=function(t,n){return t.exists((function(t){return eo(t,n)}))};return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var i=o.td;r(n.get(),i)||(n.set(x.some(i)),e(i))},mustSnap:!0}},JG=function(t){return Lw(Fw.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:mf([GG.config({mode:qG.deviceType.isTouch()?"touch":"mouse",blockerClass:"blocker",snaps:t}),OD.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},QG=function(t,n){var e=We([]),r=We([]),o=We(!1),i=We(x.none()),u=We(x.none()),a=function(t){var e=Vc(t);return KG(m.getOpt(n),t,e.x(),e.y(),e.width(),e.height())},c=function(){return W(e.get(),(function(t){return a(t)}))},s=function(t){var e=Vc(t);return KG(g.getOpt(n),t,e.right(),e.bottom(),e.width(),e.height())},f=function(){return W(r.get(),(function(t){return s(t)}))},l=$G(c,i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),d=$G(f,u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),m=JG(l),g=JG(d),p=sc(m.asSpec()),h=sc(g.asSpec()),v=function(n,e,r,o){var i=e.dom().getBoundingClientRect();Xa(n.element(),"display");var u=Ji($e.fromDom(t.getBody())).dom().innerHeight,a=r(i),c=o(i,u);(a||c)&&za(n.element(),"display","none")},b=function(t,n,e,r){var o=e(n);GG.snapTo(t,o);var i=function(t){return t[r]<0},u=function(t,n){return t[r]>n};v(t,n,i,u)},y=function(t){return b(p,t,a,"top")},w=function(){return i.get().each(y)},C=function(t){return b(h,t,s,"bottom")},S=function(){return u.get().each(C)};qG.deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){o.get()||(Bm(n,p),Bm(n,h),o.set(!0)),i.set(x.some(t.start)),u.set(x.some(t.finish)),t.otherCells.each((function(n){e.set(n.upOrLeftCells),r.set(n.downOrRightCells),y(t.start),C(t.finish)}))})),t.on("resize ScrollContent",(function(){w(),S()})),t.on("TableSelectionClear",(function(){o.get()&&(Nm(p),Nm(h),o.set(!1)),i.set(x.none()),u.set(x.none())})))},ZG={setup:QG};(function(t){t[t["None"]=0]="None",t[t["Both"]=1]="Both",t[t["Vertical"]=2]="Vertical"})(Sz||(Sz={}));var tq=function(t,n,e,r,o){var i={};return i.height=jU.calcCappedSize(r+n.top(),ET(t),AT(t)),e===Sz.Both&&(i.width=jU.calcCappedSize(o+n.left(),TT(t),DT(t))),i},nq=function(t,n,e){var r=$e.fromDom(t.getContainer()),o=tq(t,n,e,gc(r),Oc(r));lt(o,(function(t,n){return za(r,n,jU.numToPx(t))})),kk.fireResizeEditor(t)},eq=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},rq=function(t,n){n.delimiter||(n.delimiter="");var e=function(e){var r=e||[],o=W(r,(function(n,e){return Fw.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":e,"tab-index":-1,"aria-level":e+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()}})})),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}};return $(o.slice(1),(function(t,n){var e=t;return e.push(i),e.push(n),e}),[o[0]])},r=function(n){var e=[],r=n.length;while(r-- >0){var o=n[r];if(1===o.nodeType&&!eq(o)){var i=t.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(i.isDefaultPrevented()||e.push({name:i.name,element:o}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:mf([Qb.config({mode:"flow",selector:"div[role=button]"}),GE.config({}),cy.config({}),fy("elementPathEvents",[Li((function(n,o){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Qb.focusIn(n)})),t.on("NodeChange",(function(t){var o=r(t.parents);o.length>0&&cy.set(n,e(o))}))}))])]),components:[]}},oq={renderElementPath:rq},iq=function(t,n){var e,r=function(t,e,r){return cy.set(t,[uc(n.translate(["{0} "+r,e[r]]))])};return Fw.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:mf([GE.config({}),cy.config({}),jg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),fy("wordcount-events",[Di(zo(),(function(t){var n=jg.getValue(t),e="words"===n.mode?"characters":"words";jg.setValue(t,{mode:e,count:n.count}),r(t,n.count,e)})),Li((function(n){t.on("wordCountUpdate",(function(t){var e=jg.getValue(n).mode;jg.setValue(n,{mode:e,count:t.wordCount}),r(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[zo()]=["wordcount-events","alloy.base.behaviour"],e)})},uq=function(t,n){var e=function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},innerHtml:zw("resize-handle",n.icons)},behaviours:mf([GG.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,r,o){nq(t,o,e)},blockerClass:"tox-blocker"})])}},r=function(){var t=lC.translate(["Powered by {0}","Tiny"]),n='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+t+'">'+t+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:n}}},o=function(t){var n=!Pr(t.settings.plugins,"autoresize"),e=t.getParam("resize",n);return!1===e?Sz.None:"both"===e?Sz.Both:Sz.Vertical},i=function(){var e=[];return t.getParam("elementpath",!0,"boolean")&&e.push(oq.renderElementPath(t,{})),Pr(t.settings.plugins,"wordcount")&&e.push(iq(t,n)),t.getParam("branding",!0,"boolean")&&e.push(r()),e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]},u=function(){var n=i(),r=o(t);return r!==Sz.None&&n.push(e(r)),n};return{dom:{tag:"div",classes:["tox-statusbar"]},components:u()}},aq=function(t){var n=t.inline,e=n?YU:LU,r=UT(t)?Nj:Hj,o=x.none(),i=qr(),u=i.browser.isIE(),a=u?["tox-platform-ie"]:[],c=i.deviceType.isTouch(),s="tox-platform-touch",f=c?[s]:[],l=lC.isRtl()?{attributes:{dir:"rtl"}}:{},d=function(){return o.bind(xU.getHeader)},g=sc({dom:m({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(f)},l),behaviours:mf([Tm.config({useFixed:function(){return r.isDocked(d)}})])}),p=function(){return O.value(g)},h=Lw({dom:{tag:"div",classes:["tox-anchorbar"]}}),v=function(){return o.bind((function(t){return h.getOpt(t)})).getOrDie("Could not find a anchor bar element")},b=function(){return o.bind((function(t){return xU.getMoreButton(t)})).getOrDie("Could not find more button element")},y=function(){return o.bind((function(t){return xU.getToolbar(t)})).getOrDie("Could not find more toolbar element")},w=function(){return o.bind((function(t){return xU.getThrobber(t)})).getOrDie("Could not find throbber element")},C=yF(g,t,v,b),S=xU.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:C,onEscape:function(){t.focus()}}),k=FT(t),T=xU.parts().toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,backstage:C,onEscape:function(){t.focus()},split:k,lazyToolbar:y,lazyMoreButton:b,lazyHeader:function(){return d().getOrDie("Could not find header element")}}),E=xU.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},onEscape:function(){},split:k}),D=xU.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),A=xU.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),_=xU.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:C}),R=t.getParam("statusbar",!0,"boolean"),B=R&&!n?x.some(uq(t,C.shared.providers)):x.none(),I={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[D,A]},P=MT(t),N=PT(t),M=IT(t),F=function(){return P?[E]:N?[T]:[]},L=xU.parts().header({dom:{tag:"div",classes:["tox-editor-header"]},components:Z([M?[S]:[],F(),zT(t)?[]:[h.asSpec()]]),sticky:UT(t),editor:t,getSink:p}),H=Z([[L],n?[]:[I]]),z={dom:{tag:"div",classes:["tox-editor-container"]},components:H},V=Z([[z],n?[]:B.toArray(),[_]]),j=jT(t),U=m(m({role:"application"},lC.isRtl()?{dir:"rtl"}:{}),j?{"aria-hidden":"true"}:{}),W=sc(xU.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(n?["tox-tinymce-inline"]:[]).concat(f).concat(a),styles:m({visibility:"hidden"},j?{opacity:"0",border:"0"}:{}),attributes:U},components:V,behaviours:mf([Qb.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));o=x.some(W),t.shortcuts.add("alt+F9","focus menubar",(function(){xU.focusMenubar(W)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){xU.focusToolbar(W)}));var G=yT(W),q=yT(g);wV.setup(t,G,q),$T.setup(t);var X=function(){var t={broadcastAll:q.broadcast,broadcastOn:q.broadcastOn,register:function(){}};return{channels:t}},Y=function(){var n=jU.numToPx(WU(t)),e=jU.numToPx(qU(t));return t.inline||(qa("div","width",e)&&za(W.element(),"width",e),qa("div","height",n)?za(W.element(),"height",n):za(W.element(),"height","200px")),n},K=function(){r.setup(t,d),CW.setup(t,C),tG(t,p,C),Qj(t),lU(t,w,C.shared);var n=t.ui.registry.getAll(),o=n.buttons,i=n.menuItems,u=n.contextToolbars,a=n.sidebars,c=NT(t),s={menuItems:i,menus:t.settings.menu?dt(t.settings.menu,(function(t){return Tt(t,{items:t.items})})):{},menubar:t.settings.menubar,toolbar:c.getOrThunk((function(){return t.getParam("toolbar",!0)})),buttons:o,sidebar:a};bV.register(t,u,g,{backstage:C}),ZG.setup(t,g);var f=t.getElement(),l=Y(),m={mothership:G,uiMothership:q,outerContainer:W},h={targetNode:f,height:l};return e.render(t,m,s,C,h)};return{mothership:G,uiMothership:q,backstage:C,renderUI:K,getUi:X}},cq={setup:aq},sq=function(t,n){var e=x.from(xu(t,"id")).fold((function(){var t=Bu("dialog-describe");return yu(n,"id",t),t}),u);yu(t,"aria-describedby",e)},fq={labelledBy:function(t,n){var e=x.from(xu(t,"id")).fold((function(){var t=Bu("dialog-label");return yu(n,"id",t),t}),u);yu(t,"aria-labelledby",e)}},lq=i([ge("lazySink"),Oe("dragBlockClass"),He("getBounds",jc),Ie("useTabstopAt",i(!0)),Ie("eventOrder",{}),Ug("modalBehaviours",[Qb]),ws("onExecute"),Cs("onEscape")]),dq={sketch:u},mq=i([Cp({name:"draghandle",overrides:function(t,n){return{behaviours:mf([GG.config({mode:"mouse",getTarget:function(t){return Wc(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),wp({schema:[ge("dom")],name:"title"}),wp({factory:dq,schema:[ge("dom")],name:"close"}),wp({factory:dq,schema:[ge("dom")],name:"body"}),Cp({factory:dq,schema:[ge("dom")],name:"footer"}),xp({factory:{sketch:function(t,n){return m(m({},t),{dom:n.dom,components:n.components})}},schema:[Ie("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ie("components",[])],name:"blocker"})]),gq=function(t,n,e,r){var o=Bu("alloy.dialog.busy"),i=Bu("alloy.dialog.idle"),u=mf([Qb.config({mode:"special",onTab:function(){return x.some(!0)},onShiftTab:function(){return x.some(!0)}}),yy.config({})]),a=function(n){var e=t.lazySink(n).getOrDie(),a=We(x.none()),c=r.blocker(),s=e.getSystem().build(m(m({},c),{components:c.components.concat([fc(n)]),behaviours:mf([yy.config({}),fy("dialog-blocker-events",[Fi(So(),(function(){Qb.focusIn(n)})),Di(i,(function(t,e){Cu(n.element(),"aria-busy")&&(Su(n.element(),"aria-busy"),a.get().each((function(t){return cy.remove(n,t)})))})),Di(o,(function(t,e){yu(n.element(),"aria-busy","true");var r=e.event().getBusySpec();a.get().each((function(t){cy.remove(n,t)}));var o=r(n,u),i=t.getSystem().build(o);a.set(x.some(i)),cy.append(n,fc(i)),i.hasConfigured(Qb)&&Qb.focusIn(i)}))])])}));Bm(e,s),Qb.focusIn(n)},c=function(t){Qi(t.element()).each((function(n){t.getSystem().getByDom(n).each((function(t){Nm(t)}))}))},s=function(n){return Mp(n,t,"body")},f=function(n){return Mp(n,t,"footer")},l=function(t,n){ui(t,o,{getBusySpec:n})},d=function(t){ii(t,i)},g=Bu("modal-events"),p=m(m({},t.eventOrder),{"alloy.system.attached":[g].concat(t.eventOrder["alloy.system.attached"]||[])});return{uid:t.uid,dom:t.dom,components:n,apis:{show:a,hide:c,getBody:s,getFooter:f,setIdle:d,setBusy:l},eventOrder:p,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Gg(t.modalBehaviours,[cy.config({}),Qb.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),fy(g,[Li((function(n){fq.labelledBy(n.element(),Mp(n,t,"title").element()),sq(n.element(),Mp(n,t,"body").element())}))])])}},pq=th({name:"ModalDialog",configFields:lq(),partFields:mq(),factory:gq,apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),hq=[ve("type"),ve("text"),be("level",["info","warn","error","success"]),ve("icon"),Ie("url","")],vq=Fn(hq),bq=function(t){return[ve("type"),t]},yq=[ve("type"),ve("text"),Le("disabled",!1),Le("primary",!1),Un("name","name",It((function(){return Bu("button-name")})),ce),De("icon"),Le("borderless",!1)],wq=Fn(yq),xq=[ve("type"),ve("name"),ve("label"),Le("disabled",!1)],Cq=Fn(xq),Sq=se,kq=[ve("type"),ve("name")],Oq=kq.concat([De("label")]),Tq=Oq,Eq=Fn(Tq),Dq=ce,Aq=Oq,_q=Fn(Aq),Rq=ce,Bq=Oq,Iq=Fn(Bq),Pq=Yn(),Nq=function(t){return[ve("type"),he("columns"),t]},Mq=Oq.concat([Le("sandboxed",!0)]),Fq=Fn(Mq),Lq=ce,Hq=Oq.concat([De("inputMode"),De("placeholder"),Le("maximized",!1),Le("disabled",!1)]),zq=Fn(Hq),Vq=ce,jq=Oq.concat([Se("items",[ve("text"),ve("value")]),Ne("size",1),Le("disabled",!1)]),Uq=Fn(jq),Wq=ce,Gq=Oq.concat([Le("constrain",!0),Le("disabled",!1)]),qq=Fn(Gq),Xq=Fn([ve("width"),ve("height")]),Yq=Oq.concat([De("placeholder"),Le("maximized",!1),Le("disabled",!1)]),Kq=Fn(Yq),$q=ce,Jq=Oq.concat([Fe("filetype","file",["image","media","file"]),Ie("disabled",!1)]),Qq=Fn(Jq),Zq=Fn([ve("value"),Ie("meta",{})]),tX=kq.concat([Me("tag","textarea"),ve("scriptId"),ve("scriptUrl"),ze("settings",void 0)]),nX=kq.concat([Me("tag","textarea"),we("init")]),eX=$n((function(t){return Zn("customeditor.old",Mn(nX),t).orThunk((function(){return Zn("customeditor.new",Mn(tX),t)}))})),rX=ce,oX=[ve("type"),ve("html"),Fe("presets","presentation",["presentation","document"])],iX=Fn(oX),uX=Oq.concat([pe("currentState",Fn([ge("blob"),ve("url")]))]),aX=Fn(uX),cX=Oq.concat([Ie("columns","auto")]),sX=Fn(cX),fX=Xn([ve("value"),ve("text"),ve("icon")]),lX=function(t){return[ve("type"),ve("label"),t]},dX=[ve("type"),ke("header",ce),ke("cells",Ln(ce))],mX=Fn(dX),gX=function(t){return Un("items","items",Rt(),Ln($n((function(n){return Zn("Checking item of "+t,pX,n).fold((function(t){return O.error(ee(t))}),(function(t){return O.value(t)}))}))))},pX=Kn((function(){return re("type",{alertbanner:vq,bar:Fn(bq(gX("bar"))),button:wq,checkbox:Cq,colorinput:Eq,colorpicker:_q,dropzone:Iq,grid:Fn(Nq(gX("grid"))),iframe:Fq,input:zq,selectbox:Uq,sizeinput:qq,textarea:Kq,urlinput:Qq,customeditor:eX,htmlpanel:iX,imagetools:aX,collection:sX,label:Fn(lX(gX("label"))),table:mX,panel:vX})})),hX=[ve("type"),Ie("classes",[]),ke("items",pX)],vX=Fn(hX),bX=[Un("name","name",It((function(){return Bu("tab-name")})),ce),ve("title"),ke("items",pX)],yX=[ve("type"),Se("tabs",bX)],wX=Fn(yX),xX=Fn([ve("type"),ve("name"),Le("active",!1)].concat(Px)),CX=se,SX=[Un("name","name",It((function(){return Bu("button-name")})),ce),De("icon"),Fe("align","end",["start","end"]),Le("primary",!1),Le("disabled",!1)],kX=p(SX,[ve("text")]),OX=p([be("type",["submit","cancel","custom"])],kX),TX=p([be("type",["menu"]),De("text"),De("tooltip"),De("icon"),ke("items",xX),He("onSetup",(function(){return e}))],SX),EX=oe("type",{submit:OX,cancel:OX,custom:OX,menu:TX}),DX=kX,AX=EX,_X=Fn([ve("title"),pe("body",re("type",{panel:vX,tabpanel:wX})),Me("size","normal"),ke("buttons",AX),Ie("initialData",{}),He("onAction",e),He("onChange",e),He("onSubmit",e),He("onClose",e),He("onCancel",e),Ie("onTabChange",e)]),RX=function(t){return Zn("dialog",_X,t)},BX=function(t){return A(t)?[t].concat(tt(ht(t),BX)):_(t)?tt(t,BX):[]},IX=function(t){return D(t.type)&&D(t.name)},PX={checkbox:Sq,colorinput:Dq,colorpicker:Rq,dropzone:Pq,input:Vq,iframe:Lq,sizeinput:Xq,selectbox:Wq,size:Xq,textarea:$q,urlinput:Zq,customeditor:rX,collection:fX,togglemenuitem:CX},NX=function(t){return x.from(PX[t.type])},MX=function(t){return Y(BX(t),IX)},FX=function(t){var n=MX(t),e=tt(n,(function(t){return NX(t).fold((function(){return[]}),(function(n){return[pe(t.name,n)]}))}));return Fn(e)},LX=Fn(p([be("type",["cancel","custom"])],DX)),HX=Fn([ve("title"),ve("url"),Ee("height"),Ee("width"),_e("buttons",LX),He("onAction",e),He("onCancel",e),He("onClose",e),He("onMessage",e)]),zX=function(t){return Zn("dialog",HX,t)},VX=function(t){var n=te(RX(t)),e=FX(t),r=t.initialData;return{internalDialog:n,dataValidator:e,initialData:r}},jX={open:function(t,n){var e=VX(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){var e=te(zX(n));return t(e)},redial:function(t){return VX(t)}},UX=function(){var t=We(x.none()),n=function(){t.set(x.none())},e=function(n){t.set(x.some(n))},r=function(n){t.get().each(n)},o=function(){return t.get().isSome()};return{clear:n,set:e,isSet:o,on:r}},WX=function(t){var n=[],e={};return lt(t,(function(t,r){t.fold((function(){n.push(r)}),(function(t){e[r]=t}))})),n.length>0?O.error(n):O.value(e)},GX=function(t,e){var r=Lw(OR.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:W(t.items,(function(t){return ZN(n,t,e)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[r.asSpec()]}],behaviours:mf([Qb.config({mode:"acyclic",useTabstopAt:c(dB.isPseudoStop)}),HR.memento(r),tB.memento(r,{postprocess:function(t){return WX(t).fold((function(t){return n.console.error(t),{}}),(function(t){return t}))}})])}},qX=function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:zy(t.action),behaviours:Gg(t.tabButtonBehaviours,[yy.config({}),Qb.config({mode:"execution",useSpace:!0,useEnter:!0}),jg.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}},XX=Zp({name:"TabButton",configFields:[Ie("uid",void 0),ge("value"),Un("dom","dom",Pt((function(t){return{attributes:{role:"tab",id:Bu("aria"),"aria-selected":"false"}}})),ie()),Oe("action"),Ie("domModification",{}),Ug("tabButtonBehaviours",[yy,Qb,jg]),ge("view")],factory:qX}),YX=i([ge("tabs"),ge("dom"),Ie("clickToDismiss",!1),Ug("tabbarBehaviours",[Oh,Qb]),vs(["tabClass","selectedClass"])]),KX=Sp({factory:XX,name:"tabs",unit:"tab",overrides:function(t,n){var r=function(t,n){Oh.dehighlight(t,n),ui(t,ei(),{tabbar:t,button:n})},o=function(t,n){Oh.highlight(t,n),ui(t,ni(),{tabbar:t,button:n})};return{action:function(n){var i=n.getSystem().getByUid(t.uid).getOrDie(),u=Oh.isHighlighted(i,n),a=function(){return u&&t.clickToDismiss?r:u?e:o}();a(i,n)},domModification:{classes:[t.markers.tabClass]}}}}),$X=i([KX]),JX=function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Gg(t.tabbarBehaviours,[Oh.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){yu(n.element(),"aria-selected","true")},onDehighlight:function(t,n){yu(n.element(),"aria-selected","false")}}),Qb.config({mode:"flow",getInitial:function(t){return Oh.getHighlighted(t).map((function(t){return t.element()}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}},QX=th({name:"Tabbar",configFields:YX(),partFields:$X(),factory:JX}),ZX=function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Gg(t.tabviewBehaviours,[cy.config({})]),domModification:{attributes:{role:"tabpanel"}}}},tY=Zp({name:"Tabview",configFields:[Ug("tabviewBehaviours",[cy])],factory:ZX}),nY=i([Ie("selectFirst",!0),ys("onChangeTab"),ys("onDismissTab"),Ie("tabs",[]),Ug("tabSectionBehaviours",[])]),eY=wp({factory:QX,schema:[ge("dom"),Ce("markers",[ge("tabClass"),ge("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),rY=wp({factory:tY,name:"tabview"}),oY=i([eY,rY]),iY=function(t,n,e,r){var o=function(n){var e=jg.getValue(n);Np(n,t,"tabview").each((function(r){var o=J(t.tabs,(function(t){return t.value===e}));o.each((function(e){var o=e.view();yu(r.element(),"aria-labelledby",xu(n.element(),"id")),cy.set(r,o),t.onChangeTab(r,n,o)}))}))},i=function(n,e){Np(n,t,"tabbar").each((function(t){e(t).each(ai)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:Wg(t.tabSectionBehaviours),events:ki(Z([t.selectFirst?[Li((function(t,n){i(t,Oh.getFirst)}))]:[],[Di(ni(),(function(t,n){var e=n.event().button();o(e)})),Di(ei(),(function(n,e){var r=e.event().button();t.onDismissTab(n,r)}))]])),apis:{getViewItems:function(n){return Np(n,t,"tabview").map((function(t){return cy.contents(t)})).getOr([])},showTab:function(t,n){var e=function(t){var e=Oh.getCandidates(t),r=J(e,(function(t){return jg.getValue(t)===n}));return r.filter((function(n){return!Oh.isHighlighted(t,n)}))};i(t,e)}}}},uY=th({name:"TabSection",configFields:nY(),partFields:oY(),factory:iY,apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),aY=function(t,n,e){return W(t,(function(r,o){cy.set(e,t[o].view());var i=n.dom().getBoundingClientRect();return cy.set(e,[]),i.height}))},cY=function(t){return ut(it(t,(function(t,n){return t>n?-1:t<n?1:0})))},sY=function(t,e,r){var o,i=$i(t).dom(),u=Wc(t,".tox-dialog-wrap").getOr(t),a="fixed"===Ua(u,"position");o=a?Math.max(i.clientHeight,n.window.innerHeight):Math.max(i.offsetHeight,i.scrollHeight);var c=gc(e),s=e.dom().offsetLeft>=r.dom().offsetLeft+Oc(r),f=s?Math.max(gc(r),c):c,l=parseInt(Ua(t,"margin-top"),10)||0,d=parseInt(Ua(t,"margin-bottom"),10)||0,m=gc(t)+l+d,g=m-f;return o-g},fY=function(t,n){ut(t).each((function(t){return uY.showTab(n,t.value)}))},lY=function(t,n){za(t,"height",n+"px"),qr().browser.isIE()?Xa(t,"flex-basis"):za(t,"flex-basis",n+"px")},dY=function(t,n,e){Wc(t,'[role="dialog"]').each((function(t){Gc(t,'[role="tablist"]').each((function(r){e.get().map((function(e){return za(n,"height","0"),za(n,"flex-basis","0"),Math.min(e,sY(t,n,r))})).each((function(t){lY(n,t)}))}))}))},mY=function(t){return Gc(t,'[role="tabpanel"]')},gY=function(t){var n=function(){var n=We(x.none()),e=[Li((function(e){var r=e.element();mY(r).each((function(o){za(o,"visibility","hidden"),e.getSystem().getByDom(o).toOption().each((function(e){var r=aY(t,o,e),i=cY(r);n.set(i)})),dY(r,o,n),Xa(o,"visibility"),fY(t,e),qw.requestAnimationFrame((function(){dY(r,o,n)}))}))})),Di(Yo(),(function(t){var e=t.element();mY(e).each((function(t){dY(e,t,n)}))})),Di(iE,(function(t,e){var r=t.element();mY(r).each((function(t){var e=Af();za(t,"visibility","hidden");var o=Ga(t,"height").map((function(t){return parseInt(t,10)}));Xa(t,"height"),Xa(t,"flex-basis");var i=t.dom().getBoundingClientRect().height,u=o.forall((function(t){return i>t}));u?(n.set(x.from(i)),dY(r,t,n)):o.each((function(n){lY(t,n)})),Xa(t,"visibility"),e.each(Tf)}))}))],r=!1;return{extraEvents:e,selectFirst:r}}(),e=function(){var t=[],n=!0;return{extraEvents:t,selectFirst:n}}();return{smartTabHeight:n,naiveTabHeight:e}},pY="send-data-to-section",hY="send-data-to-view",vY=function(t,n){var e=We({}),r=function(t){var n=jg.getValue(t),r=WX(n).getOr({}),o=e.get(),i=Ot(o,r);e.set(i)},o=function(t){var n=e.get();jg.setValue(t,n)},i=We(null),u=W(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[OR.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:W(t.items,(function(t){return ZN(e,t,n)})),formBehaviours:mf([Qb.config({mode:"acyclic",useTabstopAt:c(dB.isPseudoStop)}),fy("TabView.form.events",[Li(o),Hi(r)]),Sf.config({channels:Yt([{key:pY,value:{onReceive:r}},{key:hY,value:{onReceive:o}}])})])}}))]}}})),a=gY(u).smartTabHeight;return uY.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var r=jg.getValue(n);ui(t,oE,{name:r,oldName:i.get()}),i.set(r)},tabs:u,components:[uY.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[QX.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:mf([GE.config({})])}),uY.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:mf([fy("tabpanel",a.extraEvents),Qb.config({mode:"acyclic"}),ih.config({find:function(t){return ut(uY.getViewItems(t))}}),jg.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([pY],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([hY],{})}}})])})},bY=Bu("update-dialog"),yY=Bu("update-title"),wY=Bu("update-body"),xY=Bu("update-footer"),CY=Bu("body-send-message"),SY=function(t,n,e,r){var o=function(t){switch(t.body.type){case"tabpanel":return[vY(t.body,e)];default:return[GX(t.body,e)]}},i=function(t,n){return x.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:m(m({},n.map((function(t){return{id:t}})).getOr({})),r?u:{})},components:[],behaviours:mf([HR.childAt(0),OH.config({channel:wY,updateState:i,renderComponents:o,initialData:t})])}},kY=function(t,n,e,r){return SY(t,x.some(n),e,r)},OY=function(t,n){var e=SY(t,x.none(),n,!1);return pq.parts().body(e)},TY=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[dB.craft({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:mf([GE.config({}),yy.config({})])})]}],behaviours:mf([Qb.config({mode:"acyclic",useTabstopAt:c(dB.isPseudoStop)})])};return pq.parts().body(n)},EY=function(t,n){return[Pi(So(),dB.onFocus),t(QT,(function(t,e){n.onClose(),e.onClose()})),t(ZT,(function(t,n,e,r){n.onCancel(t),ii(r,QT)})),Di(rE,(function(t,e){return n.onUnblock()})),Di(eE,(function(t,e){return n.onBlock(e.event())}))]},DY=function(t,n){var e=function(n,e){return Di(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event(),n)}))}))},r=function(t,n){OH.getState(t).get().each((function(e){n(e,t)}))};return p(EY(e,n),[e(tE,(function(t,n,e){n.onAction(t,{name:e.name()})}))])},AY=function(t,n){var e=function(n,e){return Di(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event(),n)}))}))},r=function(t,n){OH.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return p(EY(e,n),[e(nE,(function(t,n){return n.onSubmit(t)})),e(JT,(function(t,n,e){n.onChange(t,{name:e.name()})})),e(tE,(function(t,n,e,r){var o=function(){return Qb.focusIn(r)},i=Af();n.onAction(t,{name:e.name(),value:e.value()}),Af().fold((function(){o()}),(function(t){(!uo(r.element(),t)||Cu(t,"disabled")||uo(t,i.getOrNull())&&Cu(i.getOrDie(),"disabled"))&&o()}))})),e(oE,(function(t,n,e){n.onTabChange(t,{newTabName:e.name(),oldTabName:e.oldName()})})),Hi((function(n){var e=t();jg.setValue(n,e.getData())}))])},_Y={initUrlDialog:DY,initDialog:AY},RY=function(t,n){return ZI(t,t.type,n)},BY=function(t,n,e){return J(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))},IY=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),r=X(e,(function(t){return"start"===t.align})),o=function(t,n){return bT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:W(n,(function(t){return t.memento.asSpec()}))})},i=o("start",r.pass),u=o("end",r.fail);return[i,u]},PY=function(t,n){var e=function(t,e){var r=W(e.buttons,(function(t){var e=Lw(RY(t,n));return{name:t.name,align:t.align,memento:e}})),o=function(t,n){return BY(t,r,n)};return x.some({lookupByName:o,footerButtons:r})};return{dom:fC('<div class="tox-dialog__footer"></div>'),components:[],behaviours:mf([OH.config({channel:xY,initialData:t,updateState:e,renderComponents:IY})])}},NY=function(t,n){return PY(t,n)},MY=function(t,n){return pq.parts().footer(PY(t,n))},FY=function(t,n){var e=t.getRoot();if(e.getSystem().isConnected()){var r=ih.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return OR.getField(r,n).fold((function(){var e=t.getFooter(),o=OH.getState(e);return o.get().bind((function(t){return t.lookupByName(r,n)}))}),(function(t){return x.some(t)}))}return x.none()},LY=function(t,n){var e=t.getRoot();return OH.getState(e).get().map((function(t){return te(Zn("data",t.dataValidator,n))})).getOr(n)},HY=function(t,n,e){var r=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},o=function(){var n=t.getRoot(),r=n.getSystem().isConnected()?t.getFormWrapper():n,o=jg.getValue(r),i=dt(e,(function(t){return t.get()}));return m(m({},o),i)},i=function(n){r((function(r){var o=p.getData(),i=Tt(o,n),u=LY(t,i),a=t.getFormWrapper();jg.setValue(a,u),lt(e,(function(t,n){bt(i,n)&&t.set(i[n])}))}))},u=function(n){FY(t,n).each(uS.disable)},a=function(n){FY(t,n).each(uS.enable)},c=function(n){FY(t,n).each(yy.focus)},s=function(t){if(!D(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(n){ui(n,eE,{message:t})}))},f=function(){r((function(t){ii(t,rE)}))},l=function(n){r((function(e){var r=t.getBody(),o=OH.getState(r);o.get().exists((function(t){return t.isTabPanel()}))&&ih.getCurrent(r).each((function(t){uY.showTab(t,n)}))}))},d=function(t){r((function(e){var r=n(t);e.getSystem().broadcastOn([bY],r),e.getSystem().broadcastOn([yY],r.internalDialog),e.getSystem().broadcastOn([wY],r.internalDialog),e.getSystem().broadcastOn([xY],r.internalDialog),p.setData(r.initialData)}))},g=function(){r((function(t){ii(t,QT)}))},p={getData:o,setData:i,disable:u,enable:a,focus:c,block:s,unblock:f,showTab:l,redial:d,close:g};return p},zY=TC.deviceType.isTouch(),VY=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},jY=function(t,n){return pq.parts().close(Fw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:mf([GE.config({})])}))},UY=function(){return pq.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},WY=function(t,n){return pq.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:fC("<p>"+n.translate(t)+"</p>")}]}]})},GY=function(t){return pq.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},qY=function(t,n){return[bT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),bT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},XY=function(t){var n,e="tox-dialog",r=e+"-wrap",o=r+"__backdrop",i=e+"__disable-scroll";return pq.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),x.some(!0)},useTabstopAt:function(t){return!dB.isPseudoStop(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:m({position:"relative"},t.extraStyles)},components:p([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:fC('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:zY?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:r,modalBehaviours:mf(p([yy.config({}),fy("dialog-events",t.dialogEvents.concat([Fi(So(),(function(t,n){Qb.focusIn(t)}))])),fy("scroll-lock",[Li((function(){Ra(bi(),i)})),Hi((function(){Ia(bi(),i)}))])],t.extraBehaviours)),eventOrder:m((n={},n[Fo()]=["dialog-events"],n[Ko()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[$o()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},YY=function(t){return Fw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(t){ii(t,ZT)}})},KY=function(t,n,e){var r=function(t){return[uc(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:m({},n.map((function(t){return{id:t}})).getOr({}))},components:r(t),behaviours:mf([OH.config({channel:yY,renderComponents:r})])}},$Y=function(){return{dom:fC('<div class="tox-dialog__draghandle"></div>')}},JY=function(t,n,e){return bT.sketch({dom:fC('<div class="tox-dialog__header"></div>'),components:[KY(t,x.some(n),e),$Y(),YY(e)],containerBehaviours:mf([GG.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return qc(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},QY=function(t,n){var e=pq.parts().title(KY(t,x.none(),n)),r=pq.parts().draghandle($Y()),o=pq.parts().close(YY(n)),i=[e].concat(t.draggable?[r]:[]).concat([o]);return bT.sketch({dom:fC('<div class="tox-dialog__header"></div>'),components:i})},ZY=function(t,n){return QY({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},tK=function(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){pq.setBusy(t(),(function(t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:fC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){pq.setIdle(t())}}},nK=function(t,n,e,r){var o,i=function(t,n){return x.some(n)};return sc(XY(m(m({},t),{lazySink:r.shared.getSink,extraBehaviours:p([OH.config({channel:bY,updateState:i,initialData:n}),tB.memory({})],t.extraBehaviours),onEscape:function(t){ii(t,ZT)},dialogEvents:e,eventOrder:(o={},o[Mo()]=["reflecting","receiving"],o[Ko()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],o[$o()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],o)})))},eK=function(t){var n=function(t){var n=W(t.items,(function(t){var n=We(!1);return m(m({},t),{storage:n})}));return m(m({},t),{items:n})};return W(t,(function(t){return"menu"===t.type?n(t):t}))},rK=function(t){return $(t,(function(t,n){if("menu"===n.type){var e=n;return $(e.items,(function(t,n){return t[n.name]=n.storage,t}),t)}return t}),{})},oK=function(t,n,e){var r=ZY(t.internalDialog.title,e),o=OY({body:t.internalDialog.body},e),i=eK(t.internalDialog.buttons),u=rK(i),a=MY({buttons:i},e),c=_Y.initDialog((function(){return m}),tK((function(){return l}),n)),s="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],f={header:r,body:o,footer:x.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=nK(f,t,c,e),d=function(){var t=function(){var t=pq.getBody(l);return ih.getCurrent(t).getOr(t)};return{getRoot:function(){return l},getBody:function(){return pq.getBody(l)},getFooter:function(){return pq.getFooter(l)},getFormWrapper:t}}(),m=HY(d,n.redial,u);return{dialog:l,instanceApi:m}},iK=function(t,n,e,r){var o,i,u=Bu("dialog-label"),a=Bu("dialog-content"),c=function(t,n){return x.some(n)},s=Lw(JY({title:t.internalDialog.title,draggable:!0},u,e.shared.providers)),f=Lw(kY({body:t.internalDialog.body},a,e,r)),l=eK(t.internalDialog.buttons),d=rK(l),m=Lw(NY({buttons:l},e)),g=_Y.initDialog((function(){return h}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}}),p=sc({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(o={role:"dialog"},o["aria-labelledby"]=u,o["aria-describedby"]=""+a,o)},eventOrder:(i={},i[Mo()]=[OH.name(),Sf.name()],i[Fo()]=["execute-on-form"],i[Ko()]=["reflecting","execute-on-form"],i),behaviours:mf([Qb.config({mode:"cyclic",onEscape:function(t){return ii(t,QT),x.some(!0)},useTabstopAt:function(t){return!dB.isPseudoStop(t)&&("button"!==di(t)||"disabled"!==xu(t,"disabled"))}}),OH.config({channel:bY,updateState:c,initialData:t}),yy.config({}),fy("execute-on-form",g.concat([Fi(So(),(function(t,n){Qb.focusIn(t)}))])),tB.memory({})]),components:[s.asSpec(),f.asSpec(),m.asSpec()]}),h=HY({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return f.get(p)},getFormWrapper:function(){var t=f.get(p);return ih.getCurrent(t).getOr(t)}},n.redial,d);return{dialog:p,instanceApi:h}},uK=tinymce.util.Tools.resolve("tinymce.util.URI"),aK=function(t){var n=function(n){t.getSystem().isConnected()&&n(t)},e=function(t){if(!D(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n((function(n){ui(n,eE,{message:t})}))},r=function(){n((function(t){ii(t,rE)}))},o=function(){n((function(t){ii(t,QT)}))},i=function(t){n((function(n){n.getSystem().broadcastOn([CY],t)}))};return{block:e,unblock:r,close:o,sendMessage:i}},cK=["insertContent","setContent","execCommand","close","block","unblock"],sK=function(t){return A(t)&&-1!==cK.indexOf(t.mceAction)},fK=function(t){return!sK(t)&&A(t)&&bt(t,"mceAction")},lK=function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var r=!!R(e.ui)&&e.ui;t.execCommand(e.cmd,r,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock();break}},dK=function(t,e,r,o){var i,u=ZY(t.title,o),a=TY(t),c=t.buttons.bind((function(t){return 0===t.length?x.none():x.some(MY({buttons:t},o))})),s=_Y.initUrlDialog((function(){return y}),tK((function(){return b}),e)),f=m(m({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),l=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],d=new uK(t.url,{base_uri:new uK(n.window.location.href)}),g=d.protocol+"://"+d.host+(d.port?":"+d.port:""),p=We(x.none()),h=[fy("messages",[Li((function(){var e=zO($e.fromDom(n.window),"message",(function(n){if(d.isSameOrigin(new uK(n.raw().origin))){var e=n.raw().data;sK(e)?lK(r,y,e):fK(e)&&t.onMessage(y,e)}}));p.set(x.some(e))})),Hi((function(){p.get().each((function(t){return t.unbind()}))}))]),Sf.config({channels:(i={},i[CY]={onReceive:function(t,n){Gc(t.element(),"iframe").each((function(t){var e=t.dom().contentWindow;e.postMessage(n,g)}))}},i)})],v={header:u,body:a,footer:c,extraClasses:l,extraBehaviours:h,extraStyles:f},b=nK(v,t,s,o),y=aK(b);return{dialog:b,instanceApi:y}},mK=function(t){var n=t.backstage.shared,e=function(e,r){var o=function(){pq.hide(c),r()},i=Lw(ZI({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:x.none()},"cancel",t.backstage)),u=UY(),a=jY(o,n.providers),c=sc(XY({lazySink:function(){return n.getSink()},header:VY(u,a),body:WY(e,n.providers),footer:x.some(GY(qY([],[i.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Di(ZT,o)],eventOrder:{}}));pq.show(c);var s=i.get(c);yy.focus(s)};return{open:e}},gK=function(t){var n=t.backstage.shared,e=function(e,r){var o=function(t){pq.hide(s),r(t)},i=Lw(ZI({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:x.none()},"submit",t.backstage)),u=ZI({name:"no",text:"No",primary:!0,align:"end",disabled:!1,icon:x.none()},"cancel",t.backstage),a=UY(),c=jY((function(){return o(!1)}),n.providers),s=sc(XY({lazySink:function(){return n.getSink()},header:VY(a,c),body:WY(e,n.providers),footer:x.some(GY(qY([],[u,i.asSpec()]))),onEscape:function(){return o(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Di(ZT,(function(){return o(!1)})),Di(nE,(function(){return o(!0)}))],eventOrder:{}}));pq.show(s);var f=i.get(s);yy.focus(f)};return{open:e}},pK=function(t,n){return te(Zn("data",n,t))},hK=function(t,n){return n?[]:[Cj.config({contextual:{lazyContext:function(){return x.some(zc($e.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},leftAttr:"data-dock-left",topAttr:"data-dock-top",positionAttr:"data-dock-pos",modes:["top"]})]},vK=function(t){var n=t.backstage,e=t.editor,r=UT(e),o=mK(t),i=gK(t),u=function(t,e,r){return void 0!==e&&"toolbar"===e.inline?f(t,n.shared.anchors.toolbar(),r,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?f(t,n.shared.anchors.cursor(),r,e.ariaAttrs):s(t,r)},a=function(t,n){return c(t,n)},c=function(t,r){var o=function(t){var o=dK(t,{closeWindow:function(){pq.hide(o.dialog),r(o.instanceApi)}},e,n);return pq.show(o.dialog),o.instanceApi};return jX.openUrl(o,t)},s=function(t,e){var r=function(t,r,o){var i=r,u={dataValidator:o,initialData:i,internalDialog:t},a=oK(u,{redial:jX.redial,closeWindow:function(){pq.hide(a.dialog),e(a.instanceApi)}},n);return pq.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return jX.open(r,t)},f=function(t,o,i,u){var a=function(t,a,c){var s=pK(a,c),f=UX(),l={dataValidator:c,initialData:s,internalDialog:t},d=function(){return f.on((function(t){Cj.refresh(t)}))},m=iK(l,{redial:jX.redial,closeWindow:function(){f.on(kw.hide),e.off("ResizeEditor",d),f.clear(),i(m.instanceApi)}},n,u),g=sc(kw.sketch({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},inlineBehaviours:mf(p([fy("window-manager-inline-events",[Di(Jo(),(function(t,n){ii(m.dialog,ZT)}))])],hK(e,r)))}));return f.set(g),kw.showWithin(g,o,fc(m.dialog),x.some(bi())),r||(Cj.refresh(g),e.on("ResizeEditor",d)),m.instanceApi.setData(s),Qb.focusIn(m.dialog),m.instanceApi};return jX.open(a,t)},l=function(t,n){i.open(t,(function(t){n(t)}))},d=function(t,n){o.open(t,(function(){n()}))},m=function(t){t.close()};return{open:u,openUrl:a,alert:d,close:m,confirm:l}},bK={setup:vK};function yK(){d.add("silver",(function(t){var n=cq.setup(t),e=n.uiMothership,r=n.backstage,o=n.renderUI,u=n.getUi;RO.register(t,r.shared);var a=bK.setup({editor:t,backstage:r});return{renderUI:o,getWindowManagerImpl:i(a),getNotificationManagerImpl:function(){return Xw(t,{backstage:r},e)},ui:u()}}))}yK()})(window)}).call(this,e("c8ba"))},"07d1":function(t,n,e){e("94ce")},"0d68":function(t,n,e){e("030f")},1:function(t,n,e){t.exports=e("f872")},2401:function(t,n){(function(t){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(){},r=function(t){return function(){return t}},o=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},i=r(!1),u=r(!0),a=function(){return c},c=function(){var t=function(t){return t.isNone()},n=function(t){return t()},o=function(t){return t},c={fold:function(t,n){return t()},is:i,isSome:i,isNone:u,getOr:o,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:o,orThunk:n,map:a,each:e,bind:a,exists:i,forall:u,filter:a,equals:t,equals_:t,toArray:function(){return[]},toString:r("none()")};return Object.freeze&&Object.freeze(c),c}(),s=function(t){var n=r(t),e=function(){return a},o=function(n){return n(t)},a={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:u,isNone:i,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return s(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?a:c},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(i,(function(n){return e(t,n)}))}};return a},f=function(t){return null===t||void 0===t?c:s(t)},l={some:s,none:a,from:f},d=function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},m=function(t){return function(n){return d(n)===t}},g=m("string"),p=m("array"),h=m("boolean"),v=m("function"),b=m("number"),y=Array.prototype.slice,w=Array.prototype.push,x=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},C=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];n(o,e)}},S=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e},k=function(t,n){if(0===t.length)return[];for(var e=n(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=n(a);c!==e&&(r.push(o),o=[]),e=c,o.push(a)}return 0!==o.length&&r.push(o),r},O=function(t,n,e){return C(t,(function(t){e=n(e,t)})),e},T=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return l.some(o)}return l.none()},E=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!p(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);w.apply(n,t[e])}return n},D=function(t,n){var e=x(t,n);return E(e)},A=function(t){var n=y.call(t,0);return n.reverse(),n},_=function(t){return 0===t.length?l.none():l.some(t[0])},R=function(t){return 0===t.length?l.none():l.some(t[t.length-1])},B=(v(Array.from)&&Array.from,function(t,n,e){return 0!==(t.compareDocumentPosition(n)&e)}),I=function(n,e){return B(n,e,t.Node.DOCUMENT_POSITION_PRECEDING)},P=function(n,e){return B(n,e,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},N={documentPositionPreceding:I,documentPositionContainedBy:P},M=function(t){var n=t,e=function(){return n},r=function(t){n=t},o=function(){return M(e())};return{get:e,set:r,clone:o}},F=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}},L=function(t,n){var e=F(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return V(r(1),r(2))},H=function(t,n){var e=String(n).toLowerCase();return 0===t.length?z():L(t,e)},z=function(){return V(0,0)},V=function(t,n){return{major:t,minor:n}},j={nu:V,detect:H,unknown:z},U="Edge",W="Chrome",G="IE",q="Opera",X="Firefox",Y="Safari",K=function(t,n){return function(){return n===t}},$=function(){return J({current:void 0,version:j.unknown()})},J=function(t){var n=t.current,e=t.version;return{current:n,version:e,isEdge:K(U,n),isChrome:K(W,n),isIE:K(G,n),isOpera:K(q,n),isFirefox:K(X,n),isSafari:K(Y,n)}},Q={unknown:$,nu:J,edge:r(U),chrome:r(W),ie:r(G),opera:r(q),firefox:r(X),safari:r(Y)},Z="Windows",tt="iOS",nt="Android",et="Linux",rt="OSX",ot="Solaris",it="FreeBSD",ut=function(t,n){return function(){return n===t}},at=function(){return ct({current:void 0,version:j.unknown()})},ct=function(t){var n=t.current,e=t.version;return{current:n,version:e,isWindows:ut(Z,n),isiOS:ut(tt,n),isAndroid:ut(nt,n),isOSX:ut(rt,n),isLinux:ut(et,n),isSolaris:ut(ot,n),isFreeBSD:ut(it,n)}},st={unknown:at,nu:ct,windows:r(Z),ios:r(tt),android:r(nt),linux:r(et),osx:r(rt),solaris:r(ot),freebsd:r(it)},ft=function(t,n,e,o){var i=t.isiOS()&&!0===/ipad/i.test(e),u=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),c=a||o("(pointer:coarse)"),s=i||!u&&a&&o("(min-device-width:768px)"),f=u||a&&!s,l=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),d=!f&&!s&&!l;return{isiPad:r(i),isiPhone:r(u),isTablet:r(s),isPhone:r(f),isTouch:r(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:r(l),isDesktop:r(d)}},lt=function(t,n){var e=String(n).toLowerCase();return T(t,(function(t){return t.search(e)}))},dt=function(t,n){return lt(t,n).map((function(t){var e=j.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},mt=function(t,n){return lt(t,n).map((function(t){var e=j.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},gt={detectBrowser:dt,detectOs:mt},pt=function(t,n){return-1!==t.indexOf(n)},ht=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,vt=function(t){return function(n){return pt(n,t)}},bt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return pt(t,"edge/")&&pt(t,"chrome")&&pt(t,"safari")&&pt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ht],search:function(t){return pt(t,"chrome")&&!pt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return pt(t,"msie")||pt(t,"trident")}},{name:"Opera",versionRegexes:[ht,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:vt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:vt("firefox")},{name:"Safari",versionRegexes:[ht,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(pt(t,"safari")||pt(t,"mobile/"))&&pt(t,"applewebkit")}}],yt=[{name:"Windows",search:vt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return pt(t,"iphone")||pt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:vt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:vt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:vt("linux"),versionRegexes:[]},{name:"Solaris",search:vt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:vt("freebsd"),versionRegexes:[]}],wt={browsers:r(bt),oses:r(yt)},xt=function(t,n){var e=wt.browsers(),r=wt.oses(),o=gt.detectBrowser(e,t).fold(Q.unknown,Q.nu),i=gt.detectOs(r,t).fold(st.unknown,st.nu),u=ft(i,o,t,n);return{browser:o,os:i,deviceType:u}},Ct={detect:xt},St=function(n){return t.window.matchMedia(n).matches},kt=M(Ct.detect(t.navigator.userAgent,St)),Ot=function(){return kt.get()},Tt=function(n,e){var r=e||t.document,o=r.createElement("div");if(o.innerHTML=n,!o.hasChildNodes()||o.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return At(o.childNodes[0])},Et=function(n,e){var r=e||t.document,o=r.createElement(n);return At(o)},Dt=function(n,e){var r=e||t.document,o=r.createTextNode(n);return At(o)},At=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:r(t)}},_t=function(t,n,e){var r=t.dom();return l.from(r.elementFromPoint(n,e)).map(At)},Rt={fromHtml:Tt,fromTag:Et,fromText:Dt,fromDom:At,fromPoint:_t},Bt=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE,t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),It=(t.Node.TEXT_NODE,t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,Bt),Pt=function(t,n){var e=t.dom();if(e.nodeType!==It)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Nt=function(t,n){return t.dom()===n.dom()},Mt=function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},Ft=function(t,n){return N.documentPositionContainedBy(t.dom(),n.dom())},Lt=Ot().browser,Ht=Lt.isIE()?Ft:Mt,zt=Pt,Vt=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),jt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Ut=tinymce.util.Tools.resolve("tinymce.util.VK"),Wt=function(t,n,e){return t.isSome()&&n.isSome()?l.some(e(t.getOrDie(),n.getOrDie())):l.none()},Gt=function(n,e){var r=e||t.document,o=r.createDocumentFragment();return C(n,(function(t){o.appendChild(t.dom())})),Rt.fromDom(o)},qt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var o={};return C(t,(function(t,e){o[t]=r(n[e])})),o}},Xt=Object.keys,Yt=function(t,n){for(var e=Xt(t),r=0,o=e.length;r<o;r++){var i=e[r],u=t[i];n(u,i)}},Kt=function(t){return l.from(t.dom().parentNode).map(Rt.fromDom)},$t=function(t){return x(t.dom().childNodes,Rt.fromDom)},Jt=function(t,n){var e=t.dom().childNodes;return l.from(e[n]).map(Rt.fromDom)},Qt=function(t){return Jt(t,0)},Zt=function(t){return Jt(t,t.dom().childNodes.length-1)},tn=(qt("element","offset"),function(t,n){var e=Kt(t);e.each((function(e){e.dom().insertBefore(n.dom(),t.dom())}))}),nn=function(t,n){t.dom().appendChild(n.dom())},en=function(t,n){C(n,(function(n){tn(t,n)}))},rn=function(t,n){C(n,(function(n){nn(t,n)}))},on=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},un=function(t,n,e){return t.fire("ListMutation",{action:n,element:e})},an="undefined"!==typeof t.window?t.window:Function("return this;")(),cn=function(t,n){for(var e=void 0!==n&&null!==n?n:an,r=0;r<t.length&&void 0!==e&&null!==e;++r)e=e[t[r]];return e},sn=function(t,n){var e=t.split(".");return cn(e,n)},fn=function(t,n){return sn(t,n)},ln=function(t,n){var e=fn(t,n);if(void 0===e||null===e)throw new Error(t+" not available on this browser");return e},dn={getOrDie:ln},mn=function(t){return dn.getOrDie("HTMLElement",t)},gn=function(t){var n=sn("ownerDocument.defaultView",t);return mn(n).prototype.isPrototypeOf(t)},pn={isPrototypeOf:gn},hn=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),vn=tinymce.util.Tools.resolve("tinymce.util.Tools"),bn=function(t){return t&&3===t.nodeType},yn=function(t){return t&&/^(OL|UL|DL)$/.test(t.nodeName)},wn=function(t){return t&&/^(OL|UL)$/.test(t.nodeName)},xn=function(t){return t&&/^(LI|DT|DD)$/.test(t.nodeName)},Cn=function(t){return t&&/^(DT|DD)$/.test(t.nodeName)},Sn=function(t){return t&&/^(TH|TD)$/.test(t.nodeName)},kn=function(t){return t&&"BR"===t.nodeName},On=function(t){return t.parentNode.firstChild===t},Tn=function(t){return t.parentNode.lastChild===t},En=function(t,n){return n&&!!t.schema.getTextBlockElements()[n.nodeName]},Dn=function(t,n){return t&&t.nodeName in n},An=function(t,n){return!!kn(n)&&!(!t.isBlock(n.nextSibling)||kn(n.previousSibling))},_n=function(t,n,e){var r=t.isEmpty(n);return!(e&&t.select("span[data-mce-type=bookmark]",n).length>0)&&r},Rn=function(t,n){return t.isChildOf(n,t.getRoot())},Bn={isTextNode:bn,isListNode:yn,isOlUlNode:wn,isDlItemNode:Cn,isListItemNode:xn,isTableCellNode:Sn,isBr:kn,isFirstChild:On,isLastChild:Tn,isTextBlock:En,isBlock:Dn,isBogusBr:An,isEmpty:_n,isChildOfBody:Rn},In=function(t){var n=t.selection.getStart(!0);return t.dom.getParent(n,"OL,UL,DL",zn(t,n))},Pn=function(t,n){return t&&1===n.length&&n[0]===t},Nn=function(t){return vn.grep(t.querySelectorAll("ol,ul,dl"),(function(t){return Bn.isListNode(t)}))},Mn=function(t){var n=In(t),e=t.selection.getSelectedBlocks();return Pn(n,e)?Nn(n):vn.grep(e,(function(t){return Bn.isListNode(t)&&n!==t}))},Fn=function(t,n){var e=vn.map(n,(function(n){var e=t.dom.getParent(n,"li,dd,dt",zn(t,n));return e||n}));return hn.unique(e)},Ln=function(t){var n=t.selection.getSelectedBlocks();return vn.grep(Fn(t,n),(function(t){return Bn.isListItemNode(t)}))},Hn=function(t){return S(Ln(t),Bn.isDlItemNode)},zn=function(t,n){var e=t.dom.getParents(n,"TD,TH"),r=e.length>0?e[0]:t.getBody();return r},Vn=function(t,n){var e=t.dom.getParents(n,"ol,ul",zn(t,n));return R(e)},jn=function(t){var n=Vn(t,t.selection.getStart()),e=S(t.selection.getSelectedBlocks(),Bn.isOlUlNode);return n.toArray().concat(e)},Un=function(t){var n=jn(t);return Wn(t,n)},Wn=function(t,n){var e=x(n,(function(n){return Vn(t,n).getOr(n)}));return hn.unique(e)},Gn=function(t){var n=In(t);return pn.isPrototypeOf(n)},qn={isList:Gn,getParentList:In,getSelectedSubLists:Mn,getSelectedListItems:Ln,getClosestListRootElm:zn,getSelectedDlItems:Hn,getSelectedListRoots:Un},Xn=function(t,n){var e,r,o,i,u=t.dom,a=t.schema.getBlockElements(),c=u.createFragment();if(t.settings.forced_root_block&&(o=t.settings.forced_root_block),o&&(r=u.create(o),r.tagName===t.settings.forced_root_block&&u.setAttribs(r,t.settings.forced_root_block_attrs),Bn.isBlock(n.firstChild,a)||c.appendChild(r)),n)while(e=n.firstChild){var s=e.nodeName;i||"SPAN"===s&&"bookmark"===e.getAttribute("data-mce-type")||(i=!0),Bn.isBlock(e,a)?(c.appendChild(e),r=null):o?(r||(r=u.create(o),c.appendChild(r)),r.appendChild(e)):c.appendChild(e)}return t.settings.forced_root_block?i||r.appendChild(u.create("br",{"data-mce-bogus":"1"})):c.appendChild(u.create("br")),c},Yn=function(t){var n=t.dom().nodeName;return n.toLowerCase()},Kn=function(t){return t.dom().nodeType},$n=function(t){return function(n){return Kn(n)===t}},Jn=$n(Bt),Qn=function(n,e,r){if(!(g(r)||h(r)||b(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},Zn=function(t,n){var e=t.dom();Yt(n,(function(t,n){Qn(e,n,t)}))},te=function(t){return O(t.dom().attributes,(function(t,n){return t[n.name]=n.value,t}),{})},ne=function(t){return void 0!==t.style&&v(t.style.getPropertyValue)},ee=function(n,e,r){if(!g(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);ne(n)&&n.style.setProperty(e,r)},re=function(t,n,e){var r=t.dom();ee(r,n,e)},oe=function(t,n){return Rt.fromDom(t.dom().cloneNode(n))},ie=function(t){return oe(t,!0)},ue=function(t,n){var e=Rt.fromTag(n),r=te(t);return Zn(e,r),e},ae=function(t,n){var e=ue(t,n);tn(t,e);var r=$t(t);return rn(e,r),on(t),e},ce=function(t,n){nn(t.item,n.list)},se=function(t){for(var n=1;n<t.length;n++)ce(t[n-1],t[n])},fe=function(t,n){Wt(R(t),_(n),ce)},le=function(t,n){var e={list:Rt.fromTag(n,t),item:Rt.fromTag("li",t)};return nn(e.list,e.item),e},de=function(t,n,e){for(var r=[],o=0;o<e;o++)r.push(le(t,n.listType));return r},me=function(t,n){for(var e=0;e<t.length-1;e++)re(t[e].item,"list-style-type","none");R(t).each((function(t){Zn(t.list,n.listAttributes),Zn(t.item,n.itemAttributes),rn(t.item,n.content)}))},ge=function(t,n){Yn(t.list)!==n.listType&&(t.list=ae(t.list,n.listType)),Zn(t.list,n.listAttributes)},pe=function(t,n,e){var r=Rt.fromTag("li",t);return Zn(r,n),rn(r,e),r},he=function(t,n){nn(t.list,n),t.item=n},ve=function(t,n,e){var r=n.slice(0,e.depth);return R(r).each((function(n){var r=pe(t,e.itemAttributes,e.content);he(n,r),ge(n,e)})),r},be=function(t,n,e){var r=de(t,e,e.depth-n.length);return se(r),me(r,e),fe(n,r),n.concat(r)},ye=function(t,n){var e=O(n,(function(n,e){return e.depth>n.length?be(t,n,e):ve(t,n,e)}),[]);return _(e).map((function(t){return t.list}))},we=function(t){return zt(t,"OL,UL")},xe=function(t){return Qt(t).map(we).getOr(!1)},Ce=function(t){return Zt(t).map(we).getOr(!1)},Se=function(t){return t.depth>0},ke=function(t){return t.isSelected},Oe=function(t){var n=$t(t),e=Ce(t)?n.slice(0,-1):n;return x(e,ie)},Te=function(t,n,e){return Kt(t).filter(Jn).map((function(r){return{depth:n,isSelected:e,content:Oe(t),itemAttributes:te(t),listAttributes:te(r),listType:Yn(r)}}))},Ee=function(t,n){switch(t){case"Indent":n.depth++;break;case"Outdent":n.depth--;break;case"Flatten":n.depth=0}},De=Object.prototype.hasOwnProperty,Ae=function(t,n){return n},_e=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)De.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},Re=_e(Ae),Be=function(t,n){t.listType=n.listType,t.listAttributes=Re({},n.listAttributes)},Ie=function(t,n){for(var e=t[n].depth,r=n-1;r>=0;r--){if(t[r].depth===e)return l.some(t[r]);if(t[r].depth<e)break}return l.none()},Pe=function(t){C(t,(function(n,e){Ie(t,e).each((function(t){Be(n,t)}))}))},Ne=function(t,n,e,r){return Qt(r).filter(we).fold((function(){n.each((function(t){Nt(t.start,r)&&e.set(!0)}));var o=Te(r,t,e.get());n.each((function(t){Nt(t.end,r)&&e.set(!1)}));var i=Zt(r).filter(we).map((function(r){return Me(t,n,e,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return Me(t,n,e,r)}))},Me=function(t,n,e,r){return D($t(r),(function(r){var o=we(r)?Me:Ne,i=t+1;return o(i,n,e,r)}))},Fe=function(t,n){var e=M(!1),r=0;return x(t,(function(t){return{sourceList:t,entries:Me(r,n,e,t)}}))},Le=function(t,n){return x(n,(function(n){var e=Gt(n.content);return Rt.fromDom(Xn(t,e.dom()))}))},He=function(t,n){return Pe(n),ye(t.contentDocument,n).toArray()},ze=function(t,n){return D(k(n,Se),(function(n){var e=_(n).map(Se).getOr(!1);return e?He(t,n):Le(t,n)}))},Ve=function(t,n){C(S(t,ke),(function(t){return Ee(n,t)}))},je=function(t){var n=x(qn.getSelectedListItems(t),Rt.fromDom);return Wt(T(n,o(xe)),T(A(n),o(xe)),(function(t,n){return{start:t,end:n}}))},Ue=function(t,n,e){var r=Fe(n,je(t));C(r,(function(n){Ve(n.entries,e);var r=ze(t,n.entries);C(r,(function(n){un(t,"Indent"===e?"IndentList":"OutdentList",n.dom())})),en(n.sourceList,r),on(n.sourceList)}))},We=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ge=We.DOM,qe=function(t,n,e){var r,o,i,u,a,c=function(t){vn.each(i,(function(n){t.parentNode.insertBefore(n,e.parentNode)})),Ge.remove(t)};for(i=Ge.select('span[data-mce-type="bookmark"]',n),a=Xn(t,e),r=Ge.createRng(),r.setStartAfter(e),r.setEndAfter(n),o=r.extractContents(),u=o.firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&t.dom.isEmpty(u)){Ge.remove(u);break}t.dom.isEmpty(o)||Ge.insertAfter(o,n),Ge.insertAfter(a,n),Bn.isEmpty(t.dom,e.parentNode)&&c(e.parentNode),Ge.remove(e),Bn.isEmpty(t.dom,n)&&Ge.remove(n)},Xe={splitList:qe},Ye=function(t,n){zt(n,"dd")?ae(n,"dt"):zt(n,"dt")&&Kt(n).each((function(e){return Xe.splitList(t,e.dom(),n.dom())}))},Ke=function(t){zt(t,"dt")&&ae(t,"dd")},$e=function(t,n,e){C(e,"Indent"===n?Ke:function(n){return Ye(t,n)})},Je=function(t,n){if(Bn.isTextNode(t))return{container:t,offset:n};var e=Vt.getNode(t,n);return Bn.isTextNode(e)?{container:e,offset:n>=t.childNodes.length?e.data.length:0}:e.previousSibling&&Bn.isTextNode(e.previousSibling)?{container:e.previousSibling,offset:e.previousSibling.data.length}:e.nextSibling&&Bn.isTextNode(e.nextSibling)?{container:e.nextSibling,offset:0}:{container:t,offset:n}},Qe=function(t){var n=t.cloneRange(),e=Je(t.startContainer,t.startOffset);n.setStart(e.container,e.offset);var r=Je(t.endContainer,t.endOffset);return n.setEnd(r.container,r.offset),n},Ze={getNormalizedPoint:Je,normalizeRange:Qe},tr=function(t,n){var e=x(qn.getSelectedListRoots(t),Rt.fromDom),r=x(qn.getSelectedDlItems(t),Rt.fromDom),o=!1;if(e.length||r.length){var i=t.selection.getBookmark();Ue(t,e,n),$e(t,n,r),t.selection.moveToBookmark(i),t.selection.setRng(Ze.normalizeRange(t.selection.getRng())),t.nodeChanged(),o=!0}return o},nr=function(t){return tr(t,"Indent")},er=function(t){return tr(t,"Outdent")},rr=function(t){return tr(t,"Flatten")},or=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),ir=We.DOM,ur=function(t){var n={},e=function(e){var r,o,i;o=t[e?"startContainer":"endContainer"],i=t[e?"startOffset":"endOffset"],1===o.nodeType&&(r=ir.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),e?o.insertBefore(r,o.childNodes[i]):ir.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),n[e?"startContainer":"endContainer"]=o,n[e?"startOffset":"endOffset"]=i};return e(!0),t.collapsed||e(),n},ar=function(t){function n(n){var e,r,o,i=function(t){var n=t.parentNode.firstChild,e=0;while(n){if(n===t)return e;1===n.nodeType&&"bookmark"===n.getAttribute("data-mce-type")||e++,n=n.nextSibling}return-1};e=o=t[n?"startContainer":"endContainer"],r=t[n?"startOffset":"endOffset"],e&&(1===e.nodeType&&(r=i(e),e=e.parentNode,ir.remove(o),!e.hasChildNodes()&&ir.isBlock(e)&&e.appendChild(ir.create("br"))),t[n?"startContainer":"endContainer"]=e,t[n?"startOffset":"endOffset"]=r)}n(!0),n();var e=ir.createRng();return e.setStart(t.startContainer,t.startOffset),t.endContainer&&e.setEnd(t.endContainer,t.endOffset),Ze.normalizeRange(e)},cr={createBookmark:ur,resolveBookmark:ar},sr=function(t){return/\btox\-/.test(t.className)},fr=function(t){switch(t){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},lr=function(t,n,e){var r=e["list-style-type"]?e["list-style-type"]:null;t.setStyle(n,"list-style-type",r)},dr=function(t,n){vn.each(n,(function(n,e){t.setAttribute(e,n)}))},mr=function(t,n,e){dr(n,e["list-attributes"]),vn.each(t.select("li",n),(function(t){dr(t,e["list-item-attributes"])}))},gr=function(t,n,e){lr(t,n,e),mr(t,n,e)},pr=function(t,n,e){vn.each(e,(function(e){var r;return t.setStyle(n,(r={},r[e]="",r))}))},hr=function(t,n,e,r){var o,i;o=n[e?"startContainer":"endContainer"],i=n[e?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!e&&Bn.isBr(o.nextSibling)&&(o=o.nextSibling);while(o.parentNode!==r){if(Bn.isTextBlock(t,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},vr=function(t,n,e){for(var r,o=[],i=t.dom,u=hr(t,n,!0,e),a=hr(t,n,!1,e),c=[],s=u;s;s=s.nextSibling)if(c.push(s),s===a)break;return vn.each(c,(function(n){if(Bn.isTextBlock(t,n))return o.push(n),void(r=null);if(i.isBlock(n)||Bn.isBr(n))return Bn.isBr(n)&&i.remove(n),void(r=null);var u=n.nextSibling;or.isBookmarkNode(n)&&(Bn.isTextBlock(t,u)||!u&&n.parentNode===e)?r=null:(r||(r=i.create("p"),n.parentNode.insertBefore(r,n),o.push(r)),r.appendChild(n))})),o},br=function(t,n,e){var r=t.getStyle(n,"list-style-type"),o=e?e["list-style-type"]:"";return o=null===o?"":o,r===o},yr=function(t,n,e){void 0===e&&(e={});var r,o=t.selection.getRng(!0),i="LI",u=qn.getClosestListRootElm(t,t.selection.getStart(!0)),a=t.dom;"false"!==a.getContentEditable(t.selection.getNode())&&(n=n.toUpperCase(),"DL"===n&&(i="DT"),r=cr.createBookmark(o),vn.each(vr(t,o,u),(function(r){var o,u;u=r.previousSibling,u&&Bn.isListNode(u)&&u.nodeName===n&&br(a,u,e)?(o=u,r=a.rename(r,i),u.appendChild(r)):(o=a.create(n),r.parentNode.insertBefore(o,r),o.appendChild(r),r=a.rename(r,i)),pr(a,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),gr(a,o,e),kr(t.dom,o)})),t.selection.setRng(cr.resolveBookmark(r)))},wr=function(t,n){return t&&n&&Bn.isListNode(t)&&t.nodeName===n.nodeName},xr=function(t,n,e){var r=t.getStyle(n,"list-style-type",!0),o=t.getStyle(e,"list-style-type",!0);return r===o},Cr=function(t,n){return t.className===n.className},Sr=function(t,n,e){return wr(n,e)&&xr(t,n,e)&&Cr(n,e)},kr=function(t,n){var e,r;if(e=n.nextSibling,Sr(t,n,e)){while(r=e.firstChild)n.appendChild(r);t.remove(e)}if(e=n.previousSibling,Sr(t,n,e)){while(r=e.lastChild)n.insertBefore(r,n.firstChild);t.remove(e)}},Or=function(t,n,e,r){if(n.nodeName!==e){var o=t.dom.rename(n,e);gr(t.dom,o,r),un(t,fr(e),o)}else gr(t.dom,n,r),un(t,fr(e),n)},Tr=function(t,n,e,r,o){if(n.nodeName!==r||Er(o)){var i=cr.createBookmark(t.selection.getRng(!0));vn.each([n].concat(e),(function(n){Or(t,n,r,o)})),t.selection.setRng(cr.resolveBookmark(i))}else rr(t)},Er=function(t){return"list-style-type"in t},Dr=function(t,n,e,r){if(n!==t.getBody())if(n)if(n.nodeName!==e||Er(r)||sr(n)){var o=cr.createBookmark(t.selection.getRng(!0));gr(t.dom,n,r);var i=t.dom.rename(n,e);kr(t.dom,i),t.selection.setRng(cr.resolveBookmark(o)),un(t,fr(e),i)}else rr(t);else yr(t,e,r),un(t,fr(e),n)},Ar=function(t,n,e){var r=qn.getParentList(t),o=qn.getSelectedSubLists(t);e=e||{},r&&o.length>0?Tr(t,r,o,n,e):Dr(t,r,n,e)},_r={toggleList:Ar,mergeWithAdjacentLists:kr},Rr=We.DOM,Br=function(t,n){var e,r=n.parentNode;"LI"===r.nodeName&&r.firstChild===n&&(e=r.previousSibling,e&&"LI"===e.nodeName?(e.appendChild(n),Bn.isEmpty(t,r)&&Rr.remove(r)):Rr.setStyle(r,"listStyleType","none")),Bn.isListNode(r)&&(e=r.previousSibling,e&&"LI"===e.nodeName&&e.appendChild(n))},Ir=function(t,n){vn.each(vn.grep(t.select("ol,ul",n)),(function(n){Br(t,n)}))},Pr={normalizeList:Br,normalizeLists:Ir},Nr=function(t,n,e,r){var o=n.startContainer,i=n.startOffset;if(Bn.isTextNode(o)&&(e?i<o.data.length:i>0))return o;var u=t.schema.getNonEmptyElements();1===o.nodeType&&(o=Vt.getNode(o,i));var a=new jt(o,r);e&&Bn.isBogusBr(t.dom,o)&&a.next();while(o=a[e?"next":"prev2"]()){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(Bn.isTextNode(o)&&o.data.length>0)return o}},Mr=function(t,n){var e=n.childNodes;return 1===e.length&&!Bn.isListNode(e[0])&&t.isBlock(e[0])},Fr=function(t,n){Mr(t,n)&&t.remove(n.firstChild,!0)},Lr=function(t,n,e){var r,o;if(o=Mr(t,e)?e.firstChild:e,Fr(t,n),!Bn.isEmpty(t,n,!0))while(r=n.firstChild)o.appendChild(r)},Hr=function(t,n,e){var r,o,i=n.parentNode;if(Bn.isChildOfBody(t,n)&&Bn.isChildOfBody(t,e)){Bn.isListNode(e.lastChild)&&(o=e.lastChild),i===e.lastChild&&Bn.isBr(i.previousSibling)&&t.remove(i.previousSibling),r=e.lastChild,r&&Bn.isBr(r)&&n.hasChildNodes()&&t.remove(r),Bn.isEmpty(t,e,!0)&&t.$(e).empty(),Lr(t,n,e),o&&e.appendChild(o);var u=Ht(Rt.fromDom(e),Rt.fromDom(n)),a=u?t.getParents(n,Bn.isListNode,e):[];t.remove(n),C(a,(function(n){Bn.isEmpty(t,n)&&n!==t.getRoot()&&t.remove(n)}))}},zr=function(t,n,e){t.dom.$(e).empty(),Hr(t.dom,n,e),t.selection.setCursorLocation(e)},Vr=function(t,n,e,r){var o=t.dom;if(o.isEmpty(r))zr(t,e,r);else{var i=cr.createBookmark(n);Hr(o,e,r),t.selection.setRng(cr.resolveBookmark(i))}},jr=function(t,n,e,r){var o=cr.createBookmark(n);Hr(t.dom,e,r);var i=cr.resolveBookmark(o);t.selection.setRng(i)},Ur=function(t,n){var e=t.dom,r=t.selection,o=r.getStart(),i=qn.getClosestListRootElm(t,o),u=e.getParent(r.getStart(),"LI",i);if(u){var a=u.parentNode;if(a===t.getBody()&&Bn.isEmpty(e,a))return!0;var c=Ze.normalizeRange(r.getRng()),s=e.getParent(Nr(t,c,n,i),"LI",i);if(s&&s!==u)return t.undoManager.transact((function(){n?Vr(t,c,s,u):Bn.isFirstChild(u)?er(t):jr(t,c,u,s)})),!0;if(!s&&!n&&0===c.startOffset&&0===c.endOffset)return t.undoManager.transact((function(){rr(t)})),!0}return!1},Wr=function(t,n,e){var r=t.getParent(n.parentNode,t.isBlock,e);t.remove(n),r&&t.isEmpty(r)&&t.remove(r)},Gr=function(t,n){var e=t.dom,r=t.selection.getStart(),o=qn.getClosestListRootElm(t,r),i=e.getParent(r,e.isBlock,o);if(i&&e.isEmpty(i)){var u=Ze.normalizeRange(t.selection.getRng()),a=e.getParent(Nr(t,u,n,o),"LI",o);if(a)return t.undoManager.transact((function(){Wr(e,i,o),_r.mergeWithAdjacentLists(e,a.parentNode),t.selection.select(a,!0),t.selection.collapse(n)})),!0}return!1},qr=function(t,n){return Ur(t,n)||Gr(t,n)},Xr=function(t){var n=t.selection.getStart(),e=qn.getClosestListRootElm(t,n),r=t.dom.getParent(n,"LI,DT,DD",e);return!!(r||qn.getSelectedListItems(t).length>0)&&(t.undoManager.transact((function(){t.execCommand("Delete"),Pr.normalizeLists(t.dom,t.getBody())})),!0)},Yr=function(t,n){return t.selection.isCollapsed()?qr(t,n):Xr(t)},Kr=function(t){t.on("keydown",(function(n){n.keyCode===Ut.BACKSPACE?Yr(t,!1)&&n.preventDefault():n.keyCode===Ut.DELETE&&Yr(t,!0)&&n.preventDefault()}))},$r={setup:Kr,backspaceDelete:Yr},Jr=function(t){return{backspaceDelete:function(n){$r.backspaceDelete(t,n)}}},Qr={get:Jr},Zr=function(t,n){return function(){var e=t.dom.getParent(t.selection.getStart(),"UL,OL,DL");return e&&e.nodeName===n}},to=function(t){t.on("BeforeExecCommand",(function(n){var e=n.command.toLowerCase();"indent"===e?nr(t):"outdent"===e&&er(t)})),t.addCommand("InsertUnorderedList",(function(n,e){_r.toggleList(t,"UL",e)})),t.addCommand("InsertOrderedList",(function(n,e){_r.toggleList(t,"OL",e)})),t.addCommand("InsertDefinitionList",(function(n,e){_r.toggleList(t,"DL",e)})),t.addCommand("RemoveList",(function(){rr(t)})),t.addQueryStateHandler("InsertUnorderedList",Zr(t,"UL")),t.addQueryStateHandler("InsertOrderedList",Zr(t,"OL")),t.addQueryStateHandler("InsertDefinitionList",Zr(t,"DL"))},no={register:to},eo=function(t){return t.getParam("lists_indent_on_tab",!0)},ro={shouldIndentOnTab:eo},oo=function(t){t.on("keydown",(function(n){n.keyCode!==Ut.TAB||Ut.metaKeyPressed(n)||t.undoManager.transact((function(){(n.shiftKey?er(t):nr(t))&&n.preventDefault()}))}))},io=function(t){ro.shouldIndentOnTab(t)&&oo(t),$r.setup(t)},uo={setup:io},ao=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(n(r))return e}return-1},co=function(t,n){return function(e){var r=function(t){var r=ao(t.parents,Bn.isTableCellNode),o=-1!==r?t.parents.slice(0,r):t.parents,i=vn.grep(o,Bn.isListNode);e.setActive(i.length>0&&i[0].nodeName===n&&!sr(i[0]))};return t.on("NodeChange",r),function(){return t.off("NodeChange",r)}}},so=function(t){var n=function(t,n){var e=t.settings.plugins?t.settings.plugins:"";return-1!==vn.inArray(e.split(/[ ,]/),n)},e=function(n){return function(){return t.execCommand(n)}};n(t,"advlist")||(t.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:e("InsertOrderedList"),onSetup:co(t,"OL")}),t.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:e("InsertUnorderedList"),onSetup:co(t,"UL")}))},fo={register:so};function lo(){n.add("lists",(function(t){return uo.setup(t),fo.register(t),no.register(t),Qr.get(t)}))}lo()})(window)},4237:function(t,n,e){e("be7f")},"4ea8":function(t,n,e){e("cdd9")},"64d8":function(t,n,e){e("ef1f")},"7c4f":function(t,n,e){(function(t){(function(n){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(t){n=t},i=function(){return e(r())};return{get:r,set:o,clone:i}},r=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=function(t){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(t.settings.plugins)||!r.get("powerpaste"))&&("undefined"!==typeof n.window.console&&n.window.console.log&&n.window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},i={hasProPlugin:o},u=function(t,n){return{clipboard:t,quirks:n}},a={get:u},c=function(t,n,e,r){return t.fire("PastePreProcess",{content:n,internal:e,wordContent:r})},s=function(t,n,e,r){return t.fire("PastePostProcess",{node:n,internal:e,wordContent:r})},f=function(t,n){return t.fire("PastePlainTextToggle",{state:n})},l=function(t,n){return t.fire("paste",{ieFake:n})},d={firePastePreProcess:c,firePastePostProcess:s,firePastePlainTextToggle:f,firePaste:l},m=function(t,n){"text"===n.pasteFormat.get()?(n.pasteFormat.set("html"),d.firePastePlainTextToggle(t,!1)):(n.pasteFormat.set("text"),d.firePastePlainTextToggle(t,!0)),t.focus()},g={togglePlainTextPaste:m},p=function(t,n){t.addCommand("mceTogglePlainTextPaste",(function(){g.togglePlainTextPaste(t,n)})),t.addCommand("mceInsertClipboardContent",(function(t,e){e.content&&n.pasteHtml(e.content,e.internal),e.text&&n.pasteText(e.text)}))},h={register:p},v=function(){},b=function(t){return function(){return t}},y=b(!1),w=b(!0),x=function(){return C},C=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:y,isSome:y,isNone:w,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:e,orThunk:n,map:x,each:v,bind:x,exists:y,forall:w,filter:x,equals:t,equals_:t,toArray:function(){return[]},toString:b("none()")};return Object.freeze&&Object.freeze(r),r}(),S=function(t){var n=b(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:w,isNone:y,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return S(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:C},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(y,(function(n){return e(t,n)}))}};return o},k=function(t){return null===t||void 0===t?C:S(t)},O={some:S,none:x,from:k},T=function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},E=function(t){return function(n){return T(n)===t}},D=E("function"),A=Array.prototype.slice,_=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},R=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];n(o,e)}},B=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e},I=function(t,n,e){return R(t,(function(t){e=n(e,t)})),e},P=D(Array.from)?Array.from:function(t){return A.call(t)},N={},M={exports:N};(function(n,e,r,o){(function(o){if("object"===typeof e&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof n&&n.amd)n([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(n,e,r){function i(a,c){if(!e[a]){if(!n[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};n[a][0].call(l.exports,(function(t){var e=n[a][1][t];return i(e||t)}),l,l.exports,t,n,e,r)}return e[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,n,e){var r,o,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var t=c(g);d=!0;var n=l.length;while(n){f=l,l=[];while(++m<n)f&&f[m].run();m=-1,n=l.length}f=null,d=!1,s(t)}}function h(t,n){this.fun=t,this.array=n}function v(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new h(t,n)),1!==l.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){(function(e){var r=setTimeout;function o(){}function i(t,n){return function(){t.apply(n,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,n){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(o){return void s(n.promise,o)}c(n.promise,r)}else(1===t._state?c:s)(n.promise,t._value)}))):t._deferreds.push(n)}function c(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void f(t);if("function"===typeof e)return void d(i(e,n),t)}t._state=1,t._value=n,f(t)}catch(r){s(t,r)}}function s(t,n){t._state=2,t._value=n,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)a(t,t._deferreds[n]);t._deferreds=null}function l(t,n,e){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof n?n:null,this.promise=e}function d(t,n){var e=!1;try{t((function(t){e||(e=!0,c(n,t))}),(function(t){e||(e=!0,s(n,t))}))}catch(r){if(e)return;e=!0,s(n,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,n){var e=new this.constructor(o);return a(this,new l(t,n,e)),e},u.all=function(t){var n=Array.prototype.slice.call(t);return new u((function(t,e){if(0===n.length)return t([]);var r=n.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),e)}n[i]=u,0===--r&&t(n)}catch(c){e(c)}}for(var i=0;i<n.length;i++)o(i,n[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(n){n(t)}))},u.reject=function(t){return new u((function(n,e){e(t)}))},u.race=function(t){return new u((function(n,e){for(var r=0,o=t.length;r<o;r++)t[r].then(n,e)}))},u._immediateFn="function"===typeof t?function(n){t(n)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof n&&n.exports?n.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"===typeof n?n:function(t){var n=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,o((function(){a[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();n.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,N,M,void 0);var F=M.exports.boltExport,L=function(t){var e=O.none(),r=[],o=function(t){return L((function(n){i((function(e){n(t(e))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){e=O.some(t),c(r),r=[]},a=function(){return e.isSome()},c=function(t){R(t,s)},s=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t(u),{get:i,map:o,isReady:a}},H=function(t){return L((function(n){n(t)}))},z={nu:L,pure:H},V=function(t){n.setTimeout((function(){throw t}),0)},j=function(t){var n=function(n){t().then(n,V)},e=function(n){return j((function(){return t().then(n)}))},r=function(n){return j((function(){return t().then((function(t){return n(t).toPromise()}))}))},o=function(n){return j((function(){return t().then((function(){return n.toPromise()}))}))},i=function(){return z.nu(n)},u=function(){var n=null;return j((function(){return null===n&&(n=t()),n}))},a=t;return{map:e,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:n}},U=function(t){return j((function(){return new F(t)}))},W=function(t){return j((function(){return F.resolve(t)}))},G={nu:U,pure:W},q=function(t,n){return n((function(n){var e=[],r=0,o=function(o){return function(i){e[o]=i,r++,r>=t.length&&n(e)}};0===t.length?n([]):R(t,(function(t,n){t.get(o(n))}))}))},X=function(t){return q(t,G.nu)},Y=function(t,n){return X(_(t,n))},K=function(){var t=e(O.none()),n=function(){t.set(O.none())},r=function(n){t.set(O.some(n))},o=function(n){t.get().each(n)},i=function(){return t.get().isSome()};return{clear:n,set:r,isSet:i,on:o}},$=tinymce.util.Tools.resolve("tinymce.Env"),J=tinymce.util.Tools.resolve("tinymce.util.Delay"),Q=tinymce.util.Tools.resolve("tinymce.util.Tools"),Z=tinymce.util.Tools.resolve("tinymce.util.VK"),tt="x-tinymce/html",nt="\x3c!-- "+tt+" --\x3e",et=function(t){return nt+t},rt=function(t){return t.replace(nt,"")},ot=function(t){return-1!==t.indexOf(nt)},it={mark:et,unmark:rt,isMarked:ot,internalHtmlMime:function(){return tt}},ut=tinymce.util.Tools.resolve("tinymce.html.Entities"),at=function(t){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(t)},ct=function(t){return t.replace(/\r?\n/g,"<br>")},st=function(t,n){var e,r=[],o="<"+t;if("object"===typeof n){for(e in n)n.hasOwnProperty(e)&&r.push(e+'="'+ut.encodeAllRaw(n[e])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"},ft=function(t,n,e){var r=t.split(/\n\n/),o=st(n,e),i="</"+n+">",u=Q.map(r,(function(t){return t.split(/\n/).join("<br />")})),a=function(t){return o+t+i};return 1===u.length?u[0]:Q.map(u,a).join("")},lt=function(t,n,e){return n?ft(t,!0===n?"p":n,e):ct(t)},dt={isPlainText:at,convert:lt,toBRs:ct,toBlockElements:ft},mt=tinymce.util.Tools.resolve("tinymce.html.DomParser"),gt=tinymce.util.Tools.resolve("tinymce.html.Serializer"),pt=tinymce.util.Tools.resolve("tinymce.html.Node"),ht=tinymce.util.Tools.resolve("tinymce.html.Schema"),vt=function(t){return t.getParam("paste_block_drop",!1)},bt=function(t){return t.getParam("paste_data_images",!1)},yt=function(t){return t.getParam("paste_filter_drop",!0)},wt=function(t){return t.getParam("paste_preprocess")},xt=function(t){return t.getParam("paste_postprocess")},Ct=function(t){return t.getParam("paste_webkit_styles")},St=function(t){return t.getParam("paste_remove_styles_if_webkit",!0)},kt=function(t){return t.getParam("paste_merge_formats",!0)},Ot=function(t){return t.getParam("smart_paste",!0)},Tt=function(t){return t.getParam("paste_as_text",!1)},Et=function(t){return t.getParam("paste_retain_style_properties")},Dt=function(t){var n="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody";return t.getParam("paste_word_valid_elements",n)},At=function(t){return t.getParam("paste_convert_word_fake_lists",!0)},_t=function(t){return t.getParam("paste_enable_default_filters",!0)},Rt={shouldBlockDrop:vt,shouldPasteDataImages:bt,shouldFilterDrop:yt,getPreProcess:wt,getPostProcess:xt,getWebkitStyles:Ct,shouldRemoveWebKitStyles:St,shouldMergeFormats:kt,isSmartPasteEnabled:Ot,isPasteAsTextEnabled:Tt,getRetainStyleProps:Et,getWordValidElements:Dt,shouldConvertWordFakeLists:At,shouldUseDefaultFilters:_t};function Bt(t,n){return Q.each(n,(function(n){t=n.constructor===RegExp?t.replace(n,""):t.replace(n[0],n[1])})),t}function It(t){var n=ht(),e=mt({},n),r="",o=n.getShortEndedElements(),i=Q.makeMap("script noscript style textarea video audio iframe object"," "),u=n.getBlockElements();function a(t){var n=t.name,e=t;if("br"!==n){if("wbr"!==n)if(o[n]&&(r+=" "),i[n])r+=" ";else{if(3===t.type&&(r+=t.value),!t.shortEnded&&(t=t.firstChild))do{a(t)}while(t=t.next);u[n]&&e.next&&(r+="\n","p"===n&&(r+="\n"))}}else r+="\n"}return t=Bt(t,[/<!\[[^\]]+\]>/g]),a(e.parse(t)),r}function Pt(t){function n(t,n,e){return n||e?"":" "}return t=Bt(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,n],/<br class="Apple-interchange-newline">/g,/<br>$/i]),t}function Nt(t){var n=0;return function(){return t+n++}}var Mt=function(){return-1!==n.navigator.userAgent.indexOf(" Edge/")},Ft={filter:Bt,innerText:It,trimHtml:Pt,createIdGenerator:Nt,isMsEdge:Mt};function Lt(t){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(t)||/class="OutlineElement/.test(t)||/id="?docs\-internal\-guid\-/.test(t)}function Ht(t){var n,e;return e=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],t=t.replace(/^[\u00a0 ]+/,""),Q.each(e,(function(e){if(e.test(t))return n=!0,!1})),n}function zt(t){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(t)}function Vt(t){var n,e,r=1;function o(t){var n="";if(3===t.type)return t.value;if(t=t.firstChild)do{n+=o(t)}while(t=t.next);return n}function i(t,n){if(3===t.type&&n.test(t.value))return t.value=t.value.replace(n,""),!1;if(t=t.firstChild)do{if(!i(t,n))return!1}while(t=t.next);return!0}function u(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)do{u(t)}while(t=t.next)}function a(t,o,a){var c=t._listLevel||r;c!==r&&(c<r?n&&(n=n.parent.parent):(e=n,n=null)),n&&n.name===o?n.append(t):(e=e||n,n=new pt(o,1),a>1&&n.attr("start",""+a),t.wrap(n)),t.name="li",c>r&&e&&e.lastChild.append(n),r=c,u(t),i(t,/^\u00a0+/),i(t,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(t,/^\u00a0+/)}var c=[],s=t.firstChild;while("undefined"!==typeof s&&null!==s)if(c.push(s),s=s.walk(),null!==s)while("undefined"!==typeof s&&s.parent!==t)s=s.walk();for(var f=0;f<c.length;f++)if(t=c[f],"p"===t.name&&t.firstChild){var l=o(t);if(zt(l)){a(t,"ul");continue}if(Ht(l)){var d=/([0-9]+)\./.exec(l),m=1;d&&(m=parseInt(d[1],10)),a(t,"ol",m);continue}if(t._listLevel){a(t,"ul",1);continue}n=null}else e=n,n=null}function jt(t,n,e,r){var o,i={},u=t.dom.parseStyle(r);return Q.each(u,(function(u,a){switch(a){case"mso-list":o=/\w+ \w+([0-9]+)/i.exec(r),o&&(e._listLevel=parseInt(o[1],10)),/Ignore/i.test(u)&&e.firstChild&&(e._listIgnore=!0,e.firstChild._listIgnore=!0);break;case"horiz-align":a="text-align";break;case"vert-align":a="vertical-align";break;case"font-color":case"mso-foreground":a="color";break;case"mso-background":case"mso-highlight":a="background";break;case"font-weight":case"font-style":return void("normal"!==u&&(i[a]=u));case"mso-element":if(/^(comment|comment-list)$/i.test(u))return void e.remove();break}0!==a.indexOf("mso-comment")?0!==a.indexOf("mso-")&&("all"===Rt.getRetainStyleProps(t)||n&&n[a])&&(i[a]=u):e.remove()})),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],e.wrap(new pt("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],e.wrap(new pt("i",1))),i=t.dom.serializeStyle(i,e.name),i||null}var Ut=function(t,n){var e,r;e=Rt.getRetainStyleProps(t),e&&(r=Q.makeMap(e.split(/[, ]/))),n=Ft.filter(n,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,n){return n.length>0?n.replace(/./," ").slice(Math.floor(n.length/2)).split("").join(""):""}]]);var o=Rt.getWordValidElements(t),i=ht({valid_elements:o,valid_children:"-li[p]"});Q.each(i.elements,(function(t){t.attributes.class||(t.attributes.class={},t.attributesOrder.push("class")),t.attributes.style||(t.attributes.style={},t.attributesOrder.push("style"))}));var u=mt({},i);u.addAttributeFilter("style",(function(n){var e,o=n.length;while(o--)e=n[o],e.attr("style",jt(t,r,e,e.attr("style"))),"span"===e.name&&e.parent&&!e.attributes.length&&e.unwrap()})),u.addAttributeFilter("class",(function(t){var n,e,r=t.length;while(r--)n=t[r],e=n.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(e)&&n.remove(),n.attr("class",null)})),u.addNodeFilter("del",(function(t){var n=t.length;while(n--)t[n].remove()})),u.addNodeFilter("a",(function(t){var n,e,r,o=t.length;while(o--)if(n=t[o],e=n.attr("href"),r=n.attr("name"),e&&-1!==e.indexOf("#_msocom_"))n.remove();else if(e&&0===e.indexOf("file://")&&(e=e.split("#")[1],e&&(e="#"+e)),e||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){n.unwrap();continue}n.attr({href:e,name:r})}else n.unwrap()}));var a=u.parse(n);return Rt.shouldConvertWordFakeLists(t)&&Vt(a),n=gt({validate:t.settings.validate},i).serialize(a),n},Wt=function(t,n){return Rt.shouldUseDefaultFilters(t)?Ut(t,n):n},Gt={preProcess:Wt,isWordContent:Lt},qt=function(t,n){var e=mt({},t.schema);e.addNodeFilter("meta",(function(t){Q.each(t,(function(t){return t.remove()}))}));var r=e.parse(n,{forced_root_block:!1,isRootContent:!0});return gt({validate:t.settings.validate},t.schema).serialize(r)},Xt=function(t,n){return{content:t,cancelled:n}},Yt=function(t,n,e,r){var o=t.dom.create("div",{style:"display:none"},n),i=d.firePastePostProcess(t,o,e,r);return Xt(i.node.innerHTML,i.isDefaultPrevented())},Kt=function(t,n,e,r){var o=d.firePastePreProcess(t,n,e,r),i=qt(t,o.content);return t.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?Yt(t,i,e,r):Xt(i,o.isDefaultPrevented())},$t=function(t,n,e){var r=Gt.isWordContent(n),o=r?Gt.preProcess(t,n):n;return Kt(t,o,e,r)},Jt={process:$t},Qt=function(t,n){return t.insertContent(n,{merge:Rt.shouldMergeFormats(t),paste:!0}),!0},Zt=function(t){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(t)},tn=function(t){return Zt(t)&&/.(gif|jpe?g|png)$/.test(t)},nn=function(t,n,e){return t.undoManager.extra((function(){e(t,n)}),(function(){t.insertContent('<img src="'+n+'">')})),!0},en=function(t,n,e){return t.undoManager.extra((function(){e(t,n)}),(function(){t.execCommand("mceInsertLink",!1,n)})),!0},rn=function(t,n,e){return!(!1!==t.selection.isCollapsed()||!Zt(n))&&en(t,n,e)},on=function(t,n,e){return!!tn(n)&&nn(t,n,e)},un=function(t,n){Q.each([rn,on,Qt],(function(e){return!0!==e(t,n,Qt)}))},an=function(t,n){!1===Rt.isSmartPasteEnabled(t)?Qt(t,n):un(t,n)},cn={isImageUrl:tn,isAbsoluteUrl:Zt,insertContent:an},sn=function(t){return-1!==" \f\t\v".indexOf(t)},fn=function(t){return"\n"===t||"\r"===t},ln=function(t,n){return n<t.length&&n>=0&&fn(t[n])},dn=function(t){var n=I(t,(function(n,e){return sn(e)||""===e?n.pcIsSpace||""===n.str||n.str.length===t.length-1||ln(t,n.str.length+1)?{pcIsSpace:!1,str:n.str+""}:{pcIsSpace:!0,str:n.str+" "}:{pcIsSpace:fn(e),str:n.str+e}}),{pcIsSpace:!1,str:""});return n.str},mn=function(t,n,e){var r=e||it.isMarked(n),o=Jt.process(t,it.unmark(n),r);!1===o.cancelled&&cn.insertContent(t,o.content)},gn=function(t,n){var e=t.dom.encode(n).replace(/\r\n/g,"\n"),r=dn(e),o=dt.convert(r,t.settings.forced_root_block,t.settings.forced_root_block_attrs);mn(t,o,!1)},pn=function(t){var n={},e="data:text/mce-internal,";if(t){if(t.getData){var r=t.getData("Text");r&&r.length>0&&-1===r.indexOf(e)&&(n["text/plain"]=r)}if(t.types)for(var o=0;o<t.types.length;o++){var i=t.types[o];try{n[i]=t.getData(i)}catch(u){n[i]=""}}}return n},hn=function(t,n){var e=pn(n.clipboardData||t.getDoc().dataTransfer);return Ft.isMsEdge()?Q.extend(e,{"text/html":""}):e},vn=function(t,n){return n in t&&t[n].length>0},bn=function(t){return vn(t,"text/html")||vn(t,"text/plain")},yn=function(t){var n;return n=t.indexOf(","),-1!==n?t.substr(n+1):null},wn=function(t,n){return!t.images_dataimg_filter||t.images_dataimg_filter(n)},xn=function(t,n){var e=n.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return e?t.dom.encode(e[1]):null},Cn=Ft.createIdGenerator("mceclip"),Sn=function(t,e){var r=yn(e.uri),o=Cn(),i=t.settings.images_reuse_filename&&e.blob.name?xn(t,e.blob.name):o,u=new n.Image;if(u.src=e.uri,wn(t.settings,u)){var a=t.editorUpload.blobCache,c=void 0,s=void 0;s=a.findFirst((function(t){return t.base64()===r})),s?c=s:(c=a.create(o,e.blob,r,i),a.add(c)),mn(t,'<img src="'+c.blobUri()+'">',!1)}else mn(t,'<img src="'+e.uri+'">',!1)},kn=function(t){return"paste"===t.type},On=function(t){return Y(t,(function(t){return G.nu((function(n){var e=t.getAsFile?t.getAsFile():t,r=new window.FileReader;r.onload=function(){n({blob:e,uri:r.result})},r.readAsDataURL(e)}))}))},Tn=function(t){var n=t.items?_(P(t.items),(function(t){return t.getAsFile()})):[],e=t.files?P(t.files):[],r=B(n.length>0?n:e,(function(t){return/^image\/(jpeg|png|gif|bmp)$/.test(t.type)}));return r},En=function(t,n,e){var r=kn(n)?n.clipboardData:n.dataTransfer;if(t.settings.paste_data_images&&r){var o=Tn(r);if(o.length>0)return n.preventDefault(),On(o).get((function(n){e&&t.selection.setRng(e),R(n,(function(n){Sn(t,n)}))})),!0}return!1},Dn=function(t){var e=t.clipboardData;return-1!==n.navigator.userAgent.indexOf("Android")&&e&&e.items&&0===e.items.length},An=function(t){return Z.metaKeyPressed(t)&&86===t.keyCode||t.shiftKey&&45===t.keyCode},_n=function(t,e,r){var o,i=K();function u(n,r,o,i){var u,a;vn(n,"text/html")?u=n["text/html"]:(u=e.getHtml(),i=i||it.isMarked(u),e.isDefaultContent(u)&&(o=!0)),u=Ft.trimHtml(u),e.remove(),a=!1===i&&dt.isPlainText(u),u.length&&!a||(o=!0),o&&(u=vn(n,"text/plain")&&a?n["text/plain"]:Ft.innerText(u)),e.isDefaultContent(u)?r||t.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?gn(t,u):mn(t,u,i)}t.on("keydown",(function(r){function u(t){An(t)&&!t.isDefaultPrevented()&&e.remove()}if(An(r)&&!r.isDefaultPrevented()){if(o=r.shiftKey&&86===r.keyCode,o&&$.webkit&&-1!==n.navigator.userAgent.indexOf("Version/"))return;if(r.stopImmediatePropagation(),i.set(r),window.setTimeout((function(){i.clear()}),100),$.ie&&o)return r.preventDefault(),void d.firePaste(t,!0);e.remove(),e.create(),t.once("keyup",u),t.once("paste",(function(){t.off("keyup",u)}))}}));var a=function(){return e.getLastRng()||t.selection.getRng()};t.on("paste",(function(n){var c=i.isSet(),s=hn(t,n),f="text"===r.get()||o,l=vn(s,it.internalHtmlMime());o=!1,n.isDefaultPrevented()||Dn(n)?e.remove():bn(s)||!En(t,n,a())?(c||n.preventDefault(),!$.ie||c&&!n.ieFake||vn(s,"text/html")||(e.create(),t.dom.bind(e.getEl(),"paste",(function(t){t.stopPropagation()})),t.getDoc().execCommand("Paste",!1,null),s["text/html"]=e.getHtml()),vn(s,"text/html")?(n.preventDefault(),l||(l=it.isMarked(s["text/html"])),u(s,c,f,l)):J.setEditorTimeout(t,(function(){u(s,c,f,l)}),0)):e.remove()}))},Rn=function(t,n,e){var r;_n(t,n,e),t.parser.addNodeFilter("img",(function(n,e,o){var i=function(t){return t.data&&!0===t.data.paste},u=function(t){t.attr("data-mce-object")||r===$.transparentSrc||t.remove()},a=function(t){return 0===t.indexOf("webkit-fake-url")},c=function(t){return 0===t.indexOf("data:")};if(!t.settings.paste_data_images&&i(o)){var s=n.length;while(s--)r=n[s].attr("src"),r&&(a(r)||!t.settings.allow_html_data_urls&&c(r))&&u(n[s])}}))},Bn=function(t){return $.ie&&t.inline?n.document.body:t.getBody()},In=function(t){return Bn(t)!==t.getBody()},Pn=function(t,n,e){In(t)&&t.dom.bind(n,"paste keyup",(function(n){jn(t,e)||t.fire("paste")}))},Nn=function(t,n,e){var r,o=t.dom,i=t.getBody();n.set(t.selection.getRng()),r=t.dom.add(Bn(t),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},e),($.ie||$.gecko)&&o.setStyle(r,"left","rtl"===o.getStyle(i,"direction",!0)?65535:-65535),o.bind(r,"beforedeactivate focusin focusout",(function(t){t.stopPropagation()})),Pn(t,r,e),r.focus(),t.selection.select(r,!0)},Mn=function(t,n){if(Fn(t)){var e=void 0,r=n.get();while(e=t.dom.get("mcepastebin"))t.dom.remove(e),t.dom.unbind(e);r&&t.selection.setRng(r)}n.set(null)},Fn=function(t){return t.dom.get("mcepastebin")},Ln=function(t){var n,e,r,o,i,u=function(n,e){n.appendChild(e),t.dom.remove(e,!0)};for(e=Q.grep(Bn(t).childNodes,(function(t){return"mcepastebin"===t.id})),n=e.shift(),Q.each(e,(function(t){u(n,t)})),o=t.dom.select("div[id=mcepastebin]",n),r=o.length-1;r>=0;r--)i=t.dom.create("div"),n.insertBefore(i,o[r]),u(i,o[r]);return n?n.innerHTML:""},Hn=function(t){return t.get()},zn=function(t,n){return n===t},Vn=function(t){return t&&"mcepastebin"===t.id},jn=function(t,n){var e=Fn(t);return Vn(e)&&zn(n,e.innerHTML)},Un=function(t){var n=e(null),r="%MCEPASTEBIN%";return{create:function(){return Nn(t,n,r)},remove:function(){return Mn(t,n)},getEl:function(){return Fn(t)},getHtml:function(){return Ln(t)},getLastRng:function(){return Hn(n)},isDefault:function(){return jn(t,r)},isDefaultContent:function(t){return zn(r,t)}}},Wn=function(t,n){var e=Un(t);return t.on("PreInit",(function(){return Rn(t,e,n)})),{pasteFormat:n,pasteHtml:function(n,e){return mn(t,n,e)},pasteText:function(n){return gn(t,n)},pasteImageData:function(n,e){return En(t,n,e)},getDataTransferItems:pn,hasHtmlOrText:bn,hasContentType:vn}},Gn=function(){},qn=function(t){return!1===$.iOS&&void 0!==t&&"function"===typeof t.setData&&!0!==Ft.isMsEdge()},Xn=function(t,n,e){if(!qn(t))return!1;try{return t.clearData(),t.setData("text/html",n),t.setData("text/plain",e),t.setData(it.internalHtmlMime(),n),!0}catch(r){return!1}},Yn=function(t,n,e,r){Xn(t.clipboardData,n.html,n.text)?(t.preventDefault(),r()):e(n.html,r)},Kn=function(t){return function(n,e){var r=it.mark(n),o=t.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=t.dom.create("div",{contenteditable:"true"},r);t.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),t.dom.add(t.getBody(),o);var u=t.selection.getRng();i.focus();var a=t.dom.createRng();a.selectNodeContents(i),t.selection.setRng(a),J.setTimeout((function(){t.selection.setRng(u),o.parentNode.removeChild(o),e()}),0)}},$n=function(t){return{html:t.selection.getContent({contextual:!0}),text:t.selection.getContent({format:"text"})}},Jn=function(t){return!!t.dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody())},Qn=function(t){return!t.selection.isCollapsed()||Jn(t)},Zn=function(t){return function(n){Qn(t)&&Yn(n,$n(t),Kn(t),(function(){if($.browser.isChrome()){var n=t.selection.getRng();J.setEditorTimeout(t,(function(){t.selection.setRng(n),t.execCommand("Delete")}),0)}else t.execCommand("Delete")}))}},te=function(t){return function(n){Qn(t)&&Yn(n,$n(t),Kn(t),Gn)}},ne=function(t){t.on("cut",Zn(t)),t.on("copy",te(t))},ee={register:ne},re=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),oe=function(t,n){return re.getCaretRangeFromPoint(n.clientX,n.clientY,t.getDoc())},ie=function(t){var n=t["text/plain"];return!!n&&0===n.indexOf("file://")},ue=function(t,n){t.focus(),t.selection.setRng(n)},ae=function(t,n,e){Rt.shouldBlockDrop(t)&&t.on("dragend dragover draggesture dragdrop drop drag",(function(t){t.preventDefault(),t.stopPropagation()})),Rt.shouldPasteDataImages(t)||t.on("drop",(function(t){var n=t.dataTransfer;n&&n.files&&n.files.length>0&&t.preventDefault()})),t.on("drop",(function(r){var o,i;if(i=oe(t,r),!r.isDefaultPrevented()&&!e.get()){o=n.getDataTransferItems(r.dataTransfer);var u=n.hasContentType(o,it.internalHtmlMime());if((n.hasHtmlOrText(o)&&!ie(o)||!n.pasteImageData(r,i))&&i&&Rt.shouldFilterDrop(t)){var a=o["mce-internal"]||o["text/html"]||o["text/plain"];a&&(r.preventDefault(),J.setEditorTimeout(t,(function(){t.undoManager.transact((function(){o["mce-internal"]&&t.execCommand("Delete"),ue(t,i),a=Ft.trimHtml(a),o["text/html"]?n.pasteHtml(a,u):n.pasteText(a)}))})))}}})),t.on("dragstart",(function(t){e.set(!0)})),t.on("dragover dragend",(function(n){Rt.shouldPasteDataImages(t)&&!1===e.get()&&(n.preventDefault(),ue(t,oe(t,n))),"dragend"===n.type&&e.set(!1)}))},ce={setup:ae},se=function(t){var n=t.plugins.paste,e=Rt.getPreProcess(t);e&&t.on("PastePreProcess",(function(t){e.call(n,n,t)}));var r=Rt.getPostProcess(t);r&&t.on("PastePostProcess",(function(t){r.call(n,n,t)}))},fe={setup:se};function le(t,n){t.on("PastePreProcess",(function(e){e.content=n(t,e.content,e.internal,e.wordContent)}))}function de(t,n){t.on("PastePostProcess",(function(e){n(t,e.node)}))}function me(t,n){if(!Gt.isWordContent(n))return n;var e=[];Q.each(t.schema.getBlockElements(),(function(t,n){e.push(n)}));var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+e.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return n=Ft.filter(n,[[r,"$1"]]),n=Ft.filter(n,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]),n}function ge(t,n,e,r){if(r||e)return n;var o,i=Rt.getWebkitStyles(t);if(!1===Rt.shouldRemoveWebKitStyles(t)||"all"===i)return n;if(i&&(o=i.split(/[, ]/)),o){var u=t.dom,a=t.selection.getNode();n=n.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(t,n,e,r){var i=u.parseStyle(u.decode(e)),c={};if("none"===o)return n+r;for(var s=0;s<o.length;s++){var f=i[o[s]],l=u.getStyle(a,o[s],!0);/color/.test(o[s])&&(f=u.toHex(f),l=u.toHex(l)),l!==f&&(c[o[s]]=f)}return c=u.serializeStyle(c,"span"),c?n+' style="'+c+'"'+r:n+r}))}else n=n.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return n=n.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(t,n,e,r){return n+' style="'+e+'"'+r})),n}function pe(t,n){t.$("a",n).find("font,u").each((function(n,e){t.dom.remove(e,!0)}))}var he=function(t){$.webkit&&le(t,ge),$.ie&&(le(t,me),de(t,pe))},ve={setup:he},be=function(t,n){return function(e){e.setActive("text"===n.pasteFormat.get());var r=function(t){return e.setActive(t.state)};return t.on("PastePlainTextToggle",r),function(){return t.off("PastePlainTextToggle",r)}}},ye=function(t,n){t.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return t.execCommand("mceTogglePlainTextPaste")},onSetup:be(t,n)}),t.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",onAction:function(){return t.execCommand("mceTogglePlainTextPaste")},onSetup:be(t,n)})},we={register:ye};function xe(){r.add("paste",(function(t){if(!1===i.hasProPlugin(t)){var n=e(!1),r=e(Rt.isPasteAsTextEnabled(t)?"text":"html"),o=Wn(t,r),u=ve.setup(t);return we.register(t,o),h.register(t,o),fe.setup(t),ee.register(t),ce.setup(t,o,n),a.get(o,u)}}))}xe()})(window)}).call(this,e("c8ba"))},"84ec":function(t,n,e){e("2401")},"94ce":function(t,n){(function(t){"use strict";var n=function(t){var e=t,r=function(){return e},o=function(t){e=t},i=function(){return n(r())};return{get:r,set:o,clone:i}},e=function(){},r=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}var a=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},c=function(t){return function(){throw new Error(t)}},s=o(!1),f=o(!0),l=function(){return d},d=function(){var t=function(t){return t.isNone()},n=function(t){return t()},r=function(t){return t},i={fold:function(t,n){return t()},is:s,isSome:s,isNone:f,getOr:r,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:r,orThunk:n,map:l,each:e,bind:l,exists:s,forall:f,filter:l,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(i),i}(),m=function(t){var n=o(t),e=function(){return i},r=function(n){return n(t)},i={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:f,isNone:s,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return m(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?i:d},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(s,(function(n){return e(t,n)}))}};return i},g=function(t){return null===t||void 0===t?d:m(t)},p={some:m,none:l,from:g},h=tinymce.util.Tools.resolve("tinymce.PluginManager"),v=function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},b=function(t){return function(n){return v(n)===t}},y=b("string"),w=b("array"),x=b("boolean"),C=b("function"),S=b("number"),k=Array.prototype.slice,O=Array.prototype.indexOf,T=Array.prototype.push,E=function(t,n){return O.call(t,n)},D=function(t,n){return E(t,n)>-1},A=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return!0}return!1},_=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},R=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];n(o,e)}},B=function(t,n){for(var e=t.length-1;e>=0;e--){var r=t[e];n(r,e)}},I=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e},P=function(t,n,e){return B(t,(function(t){e=n(e,t)})),e},N=function(t,n,e){return R(t,(function(t){e=n(e,t)})),e},M=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return p.some(o)}return p.none()},F=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return p.some(e)}return p.none()},L=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!w(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);T.apply(n,t[e])}return n},H=function(t,n){var e=_(t,n);return L(e)},z=function(t,n){for(var e=0,r=t.length;e<r;++e){var o=t[e];if(!0!==n(o,e))return!1}return!0},V=function(t){var n=k.call(t,0);return n.reverse(),n},j=function(t){return 0===t.length?p.none():p.some(t[t.length-1])},U=(C(Array.from)&&Array.from,Object.keys),W=Object.hasOwnProperty,G=function(t,n){for(var e=U(t),r=0,o=e.length;r<o;r++){var i=e[r],u=t[i];n(u,i)}},q=function(t,n){return X(t,(function(t,e){return{k:e,v:n(t,e)}}))},X=function(t,n){var e={};return G(t,(function(t,r){var o=n(t,r);e[o.k]=o.v})),e},Y=function(t,n){return K(t,n)?p.from(t[n]):p.none()},K=function(t,n){return W.call(t,n)},$=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return R(t,(function(t,e){r[t]=o(n[e])})),r}},J=function(t){return t.slice(0).sort()},Q=function(t,n){throw new Error("All required keys ("+J(t).join(", ")+") were not specified. Specified keys were: "+J(n).join(", ")+".")},Z=function(t){throw new Error("Unsupported keys for object: "+J(t).join(", "))},tt=function(t,n){if(!w(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");R(n,(function(n){if(!y(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")}))},nt=function(t,n){throw new Error("All values need to be of type: "+n+". Keys ("+J(t).join(", ")+") were not.")},et=function(t){var n=J(t),e=M(n,(function(t,e){return e<n.length-1&&t===n[e+1]}));e.each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")}))},rt=function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return tt("required",t),tt("optional",n),et(e),function(r){var i=U(r),u=z(t,(function(t){return D(i,t)}));u||Q(t,i);var a=I(i,(function(t){return!D(e,t)}));a.length>0&&Z(a);var c={};return R(t,(function(t){c[t]=o(r[t])})),R(n,(function(t){c[t]=o(Object.prototype.hasOwnProperty.call(r,t)?p.some(r[t]):p.none())})),c}},ot=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),it=t.Node.DOCUMENT_NODE,ut=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),at=t.Node.TEXT_NODE,ct=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,"undefined"!==typeof t.window?t.window:Function("return this;")(),function(t){var n=t.dom().nodeName;return n.toLowerCase()}),st=function(t){return t.dom().nodeType},ft=function(t){return function(n){return st(n)===t}},lt=function(t){return st(t)===ot||"#comment"===ct(t)},dt=ft(ut),mt=ft(at),gt=function(n,e,r){if(!(y(r)||x(r)||S(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},pt=function(t,n,e){gt(t.dom(),n,e)},ht=function(t,n){var e=t.dom();G(n,(function(t,n){gt(e,n,t)}))},vt=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},bt=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},yt=function(t,n){t.dom().removeAttribute(n)},wt=function(t){return N(t.dom().attributes,(function(t,n){return t[n.name]=n.value,t}),{})},xt=function(t,n,e){if(""===n)return!0;if(t.length<n.length)return!1;var r=t.substr(e,e+n.length);return r===n},Ct=function(t,n){return-1!==t.indexOf(n)},St=function(t,n){return xt(t,n,0)},kt=function(t,n){return xt(t,n,t.length-n.length)},Ot=function(t){return t.replace(/^\s+|\s+$/g,"")},Tt=function(t){return void 0!==t.style&&C(t.style.getPropertyValue)},Et=function(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}},Dt=function(n,e){var r=e||t.document,o=r.createElement("div");if(o.innerHTML=n,!o.hasChildNodes()||o.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Rt(o.childNodes[0])},At=function(n,e){var r=e||t.document,o=r.createElement(n);return Rt(o)},_t=function(n,e){var r=e||t.document,o=r.createTextNode(n);return Rt(o)},Rt=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},Bt=function(t,n,e){var r=t.dom();return p.from(r.elementFromPoint(n,e)).map(Rt)},It={fromHtml:Dt,fromTag:At,fromText:_t,fromDom:Rt,fromPoint:Bt},Pt=function(t){var n=mt(t)?t.dom().parentNode:t.dom();return void 0!==n&&null!==n&&n.ownerDocument.body.contains(n)},Nt=Et((function(){return Mt(It.fromDom(t.document))})),Mt=function(t){var n=t.dom().body;if(null===n||void 0===n)throw new Error("Body is not available yet");return It.fromDom(n)},Ft=function(n,e,r){if(!y(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);Tt(n)&&n.style.setProperty(e,r)},Lt=function(t,n){Tt(t)&&t.style.removeProperty(n)},Ht=function(t,n,e){var r=t.dom();Ft(r,n,e)},zt=function(t,n){var e=t.dom();G(n,(function(t,n){Ft(e,n,t)}))},Vt=function(n,e){var r=n.dom(),o=t.window.getComputedStyle(r),i=o.getPropertyValue(e),u=""!==i||Pt(n)?i:jt(r,e);return null===u?void 0:u},jt=function(t,n){return Tt(t)?t.style.getPropertyValue(n):""},Ut=function(t,n){var e=t.dom(),r=jt(e,n);return p.from(r).filter((function(t){return t.length>0}))},Wt=function(t,n){var e=t.dom();Lt(e,n),bt(t,"style")&&""===Ot(vt(t,"style"))&&yt(t,"style")},Gt=function(t,n){var e=t.dom(),r=n.dom();Tt(e)&&Tt(r)&&(r.style.cssText=e.style.cssText)},qt=function(t,n,e){return 0!==(t.compareDocumentPosition(n)&e)},Xt=function(n,e){return qt(n,e,t.Node.DOCUMENT_POSITION_PRECEDING)},Yt=function(n,e){return qt(n,e,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},Kt={documentPositionPreceding:Xt,documentPositionContainedBy:Yt},$t=function(){return $t=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e],n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},$t.apply(this,arguments)},Jt=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}},Qt=function(t,n){var e=Jt(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return nn(r(1),r(2))},Zt=function(t,n){var e=String(n).toLowerCase();return 0===t.length?tn():Qt(t,e)},tn=function(){return nn(0,0)},nn=function(t,n){return{major:t,minor:n}},en={nu:nn,detect:Zt,unknown:tn},rn="Edge",on="Chrome",un="IE",an="Opera",cn="Firefox",sn="Safari",fn=function(t,n){return function(){return n===t}},ln=function(){return dn({current:void 0,version:en.unknown()})},dn=function(t){var n=t.current,e=t.version;return{current:n,version:e,isEdge:fn(rn,n),isChrome:fn(on,n),isIE:fn(un,n),isOpera:fn(an,n),isFirefox:fn(cn,n),isSafari:fn(sn,n)}},mn={unknown:ln,nu:dn,edge:o(rn),chrome:o(on),ie:o(un),opera:o(an),firefox:o(cn),safari:o(sn)},gn="Windows",pn="iOS",hn="Android",vn="Linux",bn="OSX",yn="Solaris",wn="FreeBSD",xn=function(t,n){return function(){return n===t}},Cn=function(){return Sn({current:void 0,version:en.unknown()})},Sn=function(t){var n=t.current,e=t.version;return{current:n,version:e,isWindows:xn(gn,n),isiOS:xn(pn,n),isAndroid:xn(hn,n),isOSX:xn(bn,n),isLinux:xn(vn,n),isSolaris:xn(yn,n),isFreeBSD:xn(wn,n)}},kn={unknown:Cn,nu:Sn,windows:o(gn),ios:o(pn),android:o(hn),linux:o(vn),osx:o(bn),solaris:o(yn),freebsd:o(wn)},On=function(t,n,e,r){var i=t.isiOS()&&!0===/ipad/i.test(e),u=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),c=a||r("(pointer:coarse)"),s=i||!u&&a&&r("(min-device-width:768px)"),f=u||a&&!s,l=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),d=!f&&!s&&!l;return{isiPad:o(i),isiPhone:o(u),isTablet:o(s),isPhone:o(f),isTouch:o(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(l),isDesktop:o(d)}},Tn=function(t,n){var e=String(n).toLowerCase();return M(t,(function(t){return t.search(e)}))},En=function(t,n){return Tn(t,n).map((function(t){var e=en.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},Dn=function(t,n){return Tn(t,n).map((function(t){var e=en.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},An={detectBrowser:En,detectOs:Dn},_n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Rn=function(t){return function(n){return Ct(n,t)}},Bn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Ct(t,"edge/")&&Ct(t,"chrome")&&Ct(t,"safari")&&Ct(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,_n],search:function(t){return Ct(t,"chrome")&&!Ct(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Ct(t,"msie")||Ct(t,"trident")}},{name:"Opera",versionRegexes:[_n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Rn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Rn("firefox")},{name:"Safari",versionRegexes:[_n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Ct(t,"safari")||Ct(t,"mobile/"))&&Ct(t,"applewebkit")}}],In=[{name:"Windows",search:Rn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Ct(t,"iphone")||Ct(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Rn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Rn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Rn("linux"),versionRegexes:[]},{name:"Solaris",search:Rn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Rn("freebsd"),versionRegexes:[]}],Pn={browsers:o(Bn),oses:o(In)},Nn=function(t,n){var e=Pn.browsers(),r=Pn.oses(),o=An.detectBrowser(e,t).fold(mn.unknown,mn.nu),i=An.detectOs(r,t).fold(kn.unknown,kn.nu),u=On(i,o,t,n);return{browser:o,os:i,deviceType:u}},Mn={detect:Nn},Fn=function(n){return t.window.matchMedia(n).matches},Ln=n(Mn.detect(t.navigator.userAgent,Fn)),Hn=function(){return Ln.get()},zn=ut,Vn=it,jn=function(t,n){var e=t.dom();if(e.nodeType!==zn)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Un=function(t){return t.nodeType!==zn&&t.nodeType!==Vn||0===t.childElementCount},Wn=function(n,e){var r=void 0===e?t.document:e.dom();return Un(r)?[]:_(r.querySelectorAll(n),It.fromDom)},Gn=function(n,e){var r=void 0===e?t.document:e.dom();return Un(r)?p.none():p.from(r.querySelector(n)).map(It.fromDom)},qn=function(t,n){return t.dom()===n.dom()},Xn=function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},Yn=function(t,n){return Kt.documentPositionContainedBy(t.dom(),n.dom())},Kn=Hn().browser,$n=Kn.isIE()?Yn:Xn,Jn=jn,Qn=function(t){return It.fromDom(t.dom().ownerDocument)},Zn=function(t){return It.fromDom(t.dom().ownerDocument.defaultView)},te=function(t){return p.from(t.dom().parentNode).map(It.fromDom)},ne=function(t,n){var e=C(n)?n:s,r=t.dom(),o=[];while(null!==r.parentNode&&void 0!==r.parentNode){var i=r.parentNode,u=It.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},ee=function(t){return p.from(t.dom().previousSibling).map(It.fromDom)},re=function(t){return p.from(t.dom().nextSibling).map(It.fromDom)},oe=function(t){return _(t.dom().childNodes,It.fromDom)},ie=function(t,n){var e=t.dom().childNodes;return p.from(e[n]).map(It.fromDom)},ue=function(t){return ie(t,0)},ae=($("element","offset"),function(t,n){var e=te(t);e.each((function(e){e.dom().insertBefore(n.dom(),t.dom())}))}),ce=function(t,n){var e=re(t);e.fold((function(){var e=te(t);e.each((function(t){fe(t,n)}))}),(function(t){ae(t,n)}))},se=function(t,n){var e=ue(t);e.fold((function(){fe(t,n)}),(function(e){t.dom().insertBefore(n.dom(),e.dom())}))},fe=function(t,n){t.dom().appendChild(n.dom())},le=function(t,n){ae(t,n),fe(n,t)},de=function(t,n){R(n,(function(n){ae(t,n)}))},me=function(t,n){R(n,(function(e,r){var o=0===r?t:n[r-1];ce(o,e)}))},ge=function(t,n){R(n,(function(n){fe(t,n)}))},pe=function(t){t.dom().textContent="",R(oe(t),(function(t){he(t)}))},he=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},ve=function(t){var n=oe(t);n.length>0&&de(t,n),he(t)},be=($("width","height"),$("width","height"),$("rows","columns")),ye=$("row","column"),we=($("x","y"),$("element","rowspan","colspan")),xe=$("element","rowspan","colspan","isNew"),Ce=$("element","rowspan","colspan","row","column"),Se=$("element","cells","section"),ke=$("element","isNew"),Oe=$("element","cells","section","isNew"),Te=$("cells","section"),Ee=$("details","section"),De=$("startRow","startCol","finishRow","finishCol"),Ae=function(t,n,e){return I(ne(t,e),n)},_e=function(t,n){return I(oe(t),n)},Re=function(t,n){var e=[];return R(oe(t),(function(t){n(t)&&(e=e.concat([t])),e=e.concat(Re(t,n))})),e},Be=function(t,n,e){return Ae(t,(function(t){return jn(t,n)}),e)},Ie=function(t,n){return _e(t,(function(t){return jn(t,n)}))},Pe=function(t,n){return Wn(n,t)};function Ne(t,n,e,r,o){return t(e,r)?p.some(e):C(o)&&o(e)?p.none():n(e,r,o)}var Me=function(t,n,e){var r=t.dom(),i=C(e)?e:o(!1);while(r.parentNode){r=r.parentNode;var u=It.fromDom(r);if(n(u))return p.some(u);if(i(u))break}return p.none()},Fe=function(t,n,e){var r=function(t,n){return n(t)};return Ne(r,Me,t,n,e)},Le=function(t,n){var e=function(t){return n(It.fromDom(t))},r=M(t.dom().childNodes,e);return r.map(It.fromDom)},He=function(t,n){var e=function(t){for(var r=0;r<t.childNodes.length;r++){var o=It.fromDom(t.childNodes[r]);if(n(o))return p.some(o);var i=e(t.childNodes[r]);if(i.isSome())return i}return p.none()};return e(t.dom())},ze=function(t,n,e){return Me(t,(function(t){return jn(t,n)}),e)},Ve=function(t,n){return Le(t,(function(t){return jn(t,n)}))},je=function(t,n){return Gn(n,t)},Ue=function(t,n,e){return Ne(jn,ze,t,n,e)},We=function(t,n){return Ge(t,n,o(!0))},Ge=function(t,n,e){return H(oe(t),(function(t){return jn(t,n)?e(t)?[t]:[]:Ge(t,n,e)}))},qe={firstLayer:We,filterFirstLayer:Ge},Xe=function(t,n,e){if(void 0===e&&(e=s),e(n))return p.none();if(D(t,ct(n)))return p.some(n);var r=function(t){return jn(t,"table")||e(t)};return ze(n,t.join(","),r)},Ye=function(t,n){return Xe(["td","th"],t,n)},Ke=function(t){return qe.firstLayer(t,"th,td")},$e=function(t,n){return Xe(["caption","tr","tbody","tfoot","thead"],t,n)},Je=function(t,n){return te(n).map((function(n){return Ie(n,t)}))},Qe=u(Je,"th,td"),Ze=u(Je,"tr"),tr=function(t){return je(t,"th,td")},nr=function(t,n){return Ue(t,"table",n)},er=function(t,n){return Xe(["tr"],t,n)},rr=function(t){return qe.firstLayer(t,"tr")},or=function(t,n){return parseInt(vt(t,n),10)},ir=function(t,n,e){var r=or(t,n),o=or(t,e);return be(r,o)},ur={cell:Ye,firstCell:tr,cells:Ke,neighbourCells:Qe,table:nr,row:er,rows:rr,notCell:$e,neighbourRows:Ze,attr:or,grid:ir},ar=function(t){var n=ur.rows(t);return _(n,(function(t){var n=t,e=te(n),r=e.map((function(t){var n=ct(t);return"tfoot"===n||"thead"===n||"tbody"===n?n:"tbody"})).getOr("tbody"),o=_(ur.cells(t),(function(t){var n=bt(t,"rowspan")?parseInt(vt(t,"rowspan"),10):1,e=bt(t,"colspan")?parseInt(vt(t,"colspan"),10):1;return we(t,n,e)}));return Se(n,o,r)}))},cr=function(t,n){return _(t,(function(t){var e=_(ur.cells(t),(function(t){var n=bt(t,"rowspan")?parseInt(vt(t,"rowspan"),10):1,e=bt(t,"colspan")?parseInt(vt(t,"colspan"),10):1;return we(t,n,e)}));return Se(t,e,n.section())}))},sr={fromTable:ar,fromPastedRows:cr},fr=function(t,n){return t+","+n},lr=function(t,n,e){var r=t.access()[fr(n,e)];return void 0!==r?p.some(r):p.none()},dr=function(t,n,e){var r=mr(t,(function(t){return e(n,t.element())}));return r.length>0?p.some(r[0]):p.none()},mr=function(t,n){var e=H(t.all(),(function(t){return t.cells()}));return I(e,n)},gr=function(t){var n={},e=[],r=t.length,i=0;R(t,(function(t,r){var o=[];R(t.cells(),(function(t){var e=0;while(void 0!==n[fr(r,e)])e++;for(var u=Ce(t.element(),t.rowspan(),t.colspan(),r,e),a=0;a<t.colspan();a++)for(var c=0;c<t.rowspan();c++){var s=r+c,f=e+a,l=fr(s,f);n[l]=u,i=Math.max(i,f+1)}o.push(u)})),e.push(Se(t.element(),o,t.section()))}));var u=be(r,i);return{grid:o(u),access:o(n),all:o(e)}},pr=function(t){var n=_(t.all(),(function(t){return t.cells()}));return L(n)},hr={generate:gr,getAt:lr,findItem:dr,filterItems:mr,justCells:pr},vr=$("minRow","minCol","maxRow","maxCol"),br=function(t,n){var e=t.grid().columns(),r=t.grid().rows(),o=r,i=e,u=0,a=0;return G(t.access(),(function(t){if(n(t)){var e=t.row(),r=e+t.rowspan()-1,c=t.column(),s=c+t.colspan()-1;e<o?o=e:r>u&&(u=r),c<i?i=c:s>a&&(a=s)}})),vr(o,i,u,a)},yr=function(t,n,e){var r=t[e].element(),o=It.fromTag("td");fe(o,It.fromTag("br"));var i=n?fe:se;i(r,o)},wr=function(t,n,e,r){for(var o=n.grid().columns(),i=n.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<e.minRow()||u>e.maxRow()||c<e.minCol()||c>e.maxCol())){var s=hr.getAt(n,u,c).filter(r).isNone();s?yr(t,a,u):a=!0}},xr=function(t,n){var e=I(qe.firstLayer(t,"tr"),(function(t){return 0===t.dom().childElementCount}));R(e,he),n.minCol()!==n.maxCol()&&n.minRow()!==n.maxRow()||R(qe.firstLayer(t,"th,td"),(function(t){yt(t,"rowspan"),yt(t,"colspan")})),yt(t,"width"),yt(t,"height"),Wt(t,"width"),Wt(t,"height")},Cr=function(t,n){var e=function(t){return jn(t.element(),n)},r=sr.fromTable(t),o=hr.generate(r),i=br(o,e),u="th:not("+n+"),td:not("+n+")",a=qe.filterFirstLayer(t,"th,td",(function(t){return jn(t,u)}));return R(a,he),wr(r,o,i,e),xr(t,i),t},Sr={extract:Cr};function kr(t,n){var e=function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return r(e).getOr("")},r=function(n){return t(n)?p.from(n.dom().nodeValue):p.none()},o=function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r};return{get:e,getOption:r,set:o}}var Or=kr(mt,"text"),Tr=function(t){return Or.get(t)},Er=function(t){return Or.getOption(t)},Dr=function(t,n){Or.set(t,n)},Ar=function(t){return"img"===ct(t)?1:Er(t).fold((function(){return oe(t).length}),(function(t){return t.length}))},_r="",Rr=function(t){return Er(t).filter((function(t){return 0!==t.trim().length||t.indexOf(_r)>-1})).isSome()},Br=["img","br"],Ir=function(t){var n=Rr(t);return n||D(Br,ct(t))},Pr=function(t){return He(t,Ir)},Nr=function(t){return Mr(t,Ir)},Mr=function(t,n){var e=function(t){for(var r=oe(t),o=r.length-1;o>=0;o--){var i=r[o];if(n(i))return p.some(i);var u=e(i);if(u.isSome())return u}return p.none()};return e(t)},Fr=function(t,n){return It.fromDom(t.dom().cloneNode(n))},Lr=function(t){return Fr(t,!1)},Hr=function(t){return Fr(t,!0)},zr=function(t,n){var e=It.fromTag(n),r=wt(t);return ht(e,r),e},Vr=function(t,n){var e=zr(t,n),r=oe(Hr(t));return ge(e,r),e},jr=function(){var t=It.fromTag("td");return fe(t,It.fromTag("br")),t},Ur=function(t,n,e){var r=Vr(t,n);return G(e,(function(t,n){null===t?yt(r,n):pt(r,n,t)})),r},Wr=function(t){return t},Gr=function(t){return function(){return It.fromTag("tr",t.dom())}},qr=function(t,n,e){var r=Pr(t);return r.map((function(r){var o=e.join(","),i=Be(r,o,(function(n){return qn(n,t)}));return P(i,(function(t,n){var e=Lr(n);return yt(e,"contenteditable"),fe(t,e),e}),n)})).getOr(n)},Xr=function(t,n,e){var r=function(n){var r=Qn(n.element()),o=It.fromTag(ct(n.element()),r.dom()),i=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?qr(n.element(),o,i):o;return fe(u,It.fromTag("br")),Gt(n.element(),o),Wt(o,"height"),1!==n.colspan()&&Wt(n.element(),"width"),t(n.element(),o),o};return{row:Gr(n),cell:r,replace:Ur,gap:jr}},Yr=function(t){return{row:Gr(t),cell:jr,replace:Wr,gap:jr}},Kr={cellOperations:Xr,paste:Yr},$r=function(n,e){var r=e||t.document,o=r.createElement("div");return o.innerHTML=n,oe(It.fromDom(o))},Jr=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Qr=function(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()},Zr=function(t,n){for(var e=!0,r=u(Qr,n),o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)e=e&&hr.getAt(t,o,i).exists(r);return e?p.some(n):p.none()},to={inSelection:Jr,isWithin:Qr,isRectangular:Zr},no=function(t,n){return De(Math.min(t.row(),n.row()),Math.min(t.column(),n.column()),Math.max(t.row()+t.rowspan()-1,n.row()+n.rowspan()-1),Math.max(t.column()+t.colspan()-1,n.column()+n.colspan()-1))},eo=function(t,n,e){var r=hr.findItem(t,n,qn),o=hr.findItem(t,e,qn);return r.bind((function(t){return o.map((function(n){return no(t,n)}))}))},ro=function(t,n,e){return eo(t,n,e).bind((function(n){return to.isRectangular(t,n)}))},oo={getAnyBox:eo,getBox:ro},io=function(t,n,e,r){return hr.findItem(t,n,qn).bind((function(n){var o=e>0?n.row()+n.rowspan()-1:n.row(),i=r>0?n.column()+n.colspan()-1:n.column(),u=hr.getAt(t,o+e,i+r);return u.map((function(t){return t.element()}))}))},uo=function(t,n,e){return oo.getAnyBox(t,n,e).map((function(n){var e=hr.filterItems(t,u(to.inSelection,n));return _(e,(function(t){return t.element()}))}))},ao=function(t,n){var e=function(t,n){return $n(n,t)};return hr.findItem(t,n,e).map((function(t){return t.element()}))},co={moveBy:io,intercepts:uo,parentCell:ao},so=function(t,n,e){return ur.table(t).bind((function(r){var o=go(r);return co.moveBy(o,t,n,e)}))},fo=function(t,n,e){var r=go(t);return co.intercepts(r,n,e)},lo=function(t,n,e,r,o){var i=go(t),u=qn(t,e)?p.some(n):co.parentCell(i,n),a=qn(t,o)?p.some(r):co.parentCell(i,r);return u.bind((function(t){return a.bind((function(n){return co.intercepts(i,t,n)}))}))},mo=function(t,n,e){var r=go(t);return oo.getBox(r,n,e)},go=function(t){var n=sr.fromTable(t);return hr.generate(n)},po={moveBy:so,intercepts:fo,nestedIntercepts:lo,getBox:mo},ho=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function vo(){var t=function(t){return It.fromDom(t.dom().cloneNode(!1))},n=function(t){return t.dom().ownerDocument},e=function(t){return!!dt(t)&&("body"===ct(t)||D(ho,ct(t)))},r=function(t){return!!dt(t)&&D(["br","img","hr","input"],ct(t))},i=function(t,n){return t.dom().compareDocumentPosition(n.dom())},u=function(t,n){var e=wt(t);ht(n,e)};return{up:o({selector:ze,closest:Ue,predicate:Me,all:ne}),down:o({selector:Pe,predicate:Re}),styles:o({get:Vt,getRaw:Ut,set:Ht,remove:Wt}),attrs:o({get:vt,set:pt,remove:yt,copyTo:u}),insert:o({before:ae,after:ce,afterAll:me,append:fe,appendAll:ge,prepend:se,wrap:le}),remove:o({unwrap:ve,remove:he}),create:o({nu:It.fromTag,clone:t,text:It.fromText}),query:o({comparePosition:i,prevSibling:ee,nextSibling:re}),property:o({children:oe,name:ct,parent:te,document:n,isText:mt,isComment:lt,isElement:dt,getText:Tr,setText:Dr,isBoundary:e,isEmptyTag:r}),eq:qn,is:Jn}}var bo=$("left","right"),yo=$("first","second","splits"),wo=function(t,n,e){var r=t.property().children(n),i=F(r,u(t.eq,e));return i.map((function(t){return{before:o(r.slice(0,t)),after:o(r.slice(t+1))}}))},xo=function(t,n,e){return wo(t,n,e).map((function(e){var r=t.create().clone(n);return t.insert().appendAll(r,e.after()),t.insert().after(n,r),bo(n,r)}))},Co=function(t,n,e){return wo(t,n,e).map((function(r){var o=t.create().clone(n);return t.insert().appendAll(o,r.before().concat([e])),t.insert().appendAll(n,r.after()),t.insert().before(n,o),bo(o,n)}))},So=function(t,n,e,r){var o=function(n,i,u){var a=yo(n,p.none(),u);return e(n)?yo(n,i,u):t.property().parent(n).bind((function(i){return r(t,i,n).map((function(t){var n=[{first:t.left,second:t.right}],r=e(i)?i:t.left();return o(r,p.some(t.right()),u.concat(n))}))})).getOr(a)};return o(n,p.none(),[])},ko=function(t,n,e,r){var o=e[0],i=e.slice(1);return r(t,n,o,i)},Oo=function(t,n,e){return e.length>0?ko(t,n,e,To):p.none()},To=function(t,n,e,r){var o=n(t,e);return P(r,(function(e,r){var o=n(t,r);return Eo(t,e,o)}),o)},Eo=function(t,n,e){return n.bind((function(n){return e.filter(u(t.eq,n))}))},Do=function(t,n){return u(t.eq,n)},Ao=function(t,n,e,r){var o=t.property().children(n);if(t.eq(n,e[0]))return p.some([e[0]]);if(t.eq(n,r[0]))return p.some([r[0]]);var i=function(e){var r=V(e),i=F(r,Do(t,n)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return F(o,Do(t,u))},u=i(e),a=i(r);return u.bind((function(t){return a.map((function(n){var e=Math.min(t,n),r=Math.max(t,n);return o.slice(e,r+1)}))}))},_o=function(t,n,e,r){void 0===r&&(r=s);var i=[n].concat(t.up().all(n)),u=[e].concat(t.up().all(e)),a=function(t){var n=F(t,r);return n.fold((function(){return t}),(function(n){return t.slice(0,n+1)}))},c=a(i),f=a(u),l=M(c,(function(n){return A(f,Do(t,n))}));return{firstpath:o(c),secondpath:o(f),shared:o(l)}},Ro=function(t,n,e){var r=_o(t,n,e);return r.shared().bind((function(n){return Ao(t,n,r.firstpath(),r.secondpath())}))},Bo={subset:Ro,ancestors:_o},Io=Oo,Po=Bo.subset,No=Bo.ancestors,Mo=Co,Fo=xo,Lo=So,Ho={sharedOne:Io,subset:Po,ancestors:No,breakToLeft:Mo,breakToRight:Fo,breakPath:Lo},zo=vo(),Vo=function(t,n){return Ho.sharedOne(zo,(function(n,e){return t(e)}),n)},jo=function(t,n){return Ho.subset(zo,t,n)},Uo=function(t,n,e){return Ho.ancestors(zo,t,n,e)},Wo=function(t,n){return Ho.breakToLeft(zo,t,n)},Go=function(t,n){return Ho.breakToRight(zo,t,n)},qo=function(t,n,e){return Ho.breakPath(zo,t,n,(function(t,n,r){return e(n,r)}))},Xo={sharedOne:Vo,subset:jo,ancestors:Uo,breakToLeft:Wo,breakToRight:Go,breakPath:qo},Yo=rt(["boxes","start","finish"],[]),Ko={create:Yo},$o=function(t){return ze(t,"table")},Jo=function(t,n,e){var r=function(t){return function(n){return void 0!==e&&e(n)||qn(n,t)}};return qn(t,n)?p.some(Ko.create({boxes:p.some([t]),start:t,finish:n})):$o(t).bind((function(o){return $o(n).bind((function(i){if(qn(o,i))return p.some(Ko.create({boxes:po.intercepts(o,t,n),start:t,finish:n}));if($n(o,i)){var u=Be(n,"td,th",r(o)),a=u.length>0?u[u.length-1]:n;return p.some(Ko.create({boxes:po.nestedIntercepts(o,t,o,n,i),start:t,finish:a}))}if($n(i,o)){u=Be(t,"td,th",r(i));var c=u.length>0?u[u.length-1]:t;return p.some(Ko.create({boxes:po.nestedIntercepts(i,t,o,n,i),start:t,finish:c}))}return Xo.ancestors(t,n).shared().bind((function(u){return Ue(u,"table",e).bind((function(e){var u=Be(n,"td,th",r(e)),a=u.length>0?u[u.length-1]:n,c=Be(t,"td,th",r(e)),s=c.length>0?c[c.length-1]:t;return p.some(Ko.create({boxes:po.nestedIntercepts(e,t,o,n,i),start:s,finish:a}))}))}))}))}))},Qo=function(t,n){var e=Pe(t,n);return e.length>0?p.some(e):p.none()},Zo=function(t,n){return M(t,(function(t){return jn(t,n)}))},ti=function(t,n,e){return je(t,n).bind((function(n){return je(t,e).bind((function(t){return Xo.sharedOne($o,[n,t]).map((function(e){return{first:o(n),last:o(t),table:o(e)}}))}))}))},ni=function(t,n){return ze(t,"table").bind((function(e){return je(e,n).bind((function(n){return Jo(n,t).bind((function(t){return t.boxes().map((function(n){return{boxes:o(n),start:o(t.start()),finish:o(t.finish())}}))}))}))}))},ei=function(t,n,e,r,o){return Zo(t,o).bind((function(t){return po.moveBy(t,n,e).bind((function(t){return ni(t,r)}))}))},ri={identify:Jo,retrieve:Qo,shiftSelection:ei,getEdges:ti},oi=function(t,n){return ri.retrieve(t,n)},ii=function(t,n,e){return ri.getEdges(t,n,e).bind((function(n){var e=function(n){return qn(t,n)},r=ze(n.first(),"thead,tfoot,tbody,table",e),o=ze(n.last(),"thead,tfoot,tbody,table",e);return r.bind((function(t){return o.bind((function(e){return qn(t,e)?po.getBox(n.table(),n.first(),n.last()):p.none()}))}))}))},ui={retrieve:oi,retrieveBox:ii},ai="data-mce-selected",ci="td["+ai+"],th["+ai+"]",si="["+ai+"]",fi="data-mce-first-selected",li="td["+fi+"],th["+fi+"]",di="data-mce-last-selected",mi="td["+di+"],th["+di+"]",gi={selected:o(ai),selectedSelector:o(ci),attributeSelector:o(si),firstSelected:o(fi),firstSelectedSelector:o(li),lastSelected:o(di),lastSelectedSelector:o(mi)},pi=function(n){if(!w(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],r={};return R(n,(function(o,i){var u=U(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==r[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!w(c))throw new Error("case arguments must be an array");e.push(a),r[a]=function(){var r=arguments.length;if(r!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];var s=function(t){var n=U(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));var r=z(e,(function(t){return D(n,t)}));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,o)};return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);var t=arguments[i];return t.apply(null,o)},match:s,log:function(n){t.console.log(n,{constructors:e,constructor:a,params:o})}}}})),r},hi={generate:pi},vi=hi.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),bi=function(t,n,e,r){return t.fold(n,e,r)},yi={cata:bi,none:vi.none,multiple:vi.multiple,single:vi.single},wi=function(t,n){return yi.cata(n.get(),o([]),i,o([t]))},xi=function(t,n){var e=function(t){return bt(t,"rowspan")&&parseInt(vt(t,"rowspan"),10)>1||bt(t,"colspan")&&parseInt(vt(t,"colspan"),10)>1},r=wi(t,n);return r.length>0&&z(r,e)?p.some(r):p.none()},Ci=function(t,n){return yi.cata(n.get(),p.none,(function(n,e){return 0===n.length?p.none():ui.retrieveBox(t,gi.firstSelectedSelector(),gi.lastSelectedSelector()).bind((function(t){return n.length>1?p.some({bounds:o(t),cells:o(n)}):p.none()}))}),p.none)},Si={mergable:Ci,unmergable:xi,selection:wi},ki=function(t){return{element:o(t),mergable:p.none,unmergable:p.none,selection:o([t])}},Oi=function(t,n,e){return{element:o(e),mergable:o(Si.mergable(n,t)),unmergable:o(Si.unmergable(e,t)),selection:o(Si.selection(e,t))}},Ti=function(t){return ki(t)},Ei=$("element","clipboard","generators"),Di=function(t,n,e,r,i){return{element:o(e),mergable:p.none,unmergable:p.none,selection:o(Si.selection(e,t)),clipboard:o(r),generators:o(i)}},Ai={noMenu:ki,forMenu:Oi,notCell:Ti,paste:Ei,pasteRows:Di},_i=function(t){return ur.table(t[0]).map(Hr).map((function(t){return[Sr.extract(t,gi.attributeSelector())]}))},Ri=function(t,n){return _(n,(function(n){return t.selection.serializer.serialize(n.dom(),{})})).join("")},Bi=function(t){return _(t,(function(t){return t.dom().innerText})).join("")},Ii=function(t,n,r,o){t.on("BeforeGetContent",(function(r){var o=function(n){r.preventDefault(),_i(n).each((function(n){r.content="text"===r.format?Bi(n):Ri(t,n)}))};!0===r.selection&&yi.cata(n.get(),e,o,e)})),t.on("BeforeSetContent",(function(n){if(!0===n.selection&&!0===n.paste){var e=p.from(t.dom.getParent(t.selection.getStart(),"th,td"));e.each((function(e){var i=It.fromDom(e);ur.table(i).each((function(e){var u=I($r(n.content),(function(t){return"meta"!==ct(t)}));if(1===u.length&&"table"===ct(u[0])){n.preventDefault();var a=It.fromDom(t.getDoc()),c=Kr.paste(a),s=Ai.paste(i,u[0],c);r.pasteCells(e,s).each((function(n){t.selection.setRng(n),t.focus(),o.clear(e)}))}}))}))}}))},Pi={registerEvents:Ii};function Ni(t,n){var e=function(n,e){if(!S(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();Tt(r)&&(r.style[t]=e+"px")},r=function(e){var r=n(e);if(r<=0||null===r){var o=Vt(e,t);return parseFloat(o)||0}return r},o=r,i=function(t,n){return N(n,(function(n,e){var r=Vt(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)},u=function(t,n,e){var r=i(t,e),o=n>r?n-r:0;return o};return{set:e,get:r,getOuter:o,aggregate:i,max:u}}var Mi=Ni("height",(function(t){var n=t.dom();return Pt(t)?n.getBoundingClientRect().height:n.offsetHeight})),Fi=function(t){return Mi.get(t)},Li=function(t){return Mi.getOuter(t)},Hi=Ni("width",(function(t){return t.dom().offsetWidth})),zi=function(t){return Hi.get(t)},Vi=function(t){return Hi.getOuter(t)},ji=Hn(),Ui=function(){return ji.browser.isIE()||ji.browser.isEdge()},Wi=function(t,n){var e=parseFloat(t);return isNaN(e)?n:e},Gi=function(t,n,e){return Wi(Vt(t,n),e)},qi=function(t){var n=Gi(t,"padding-top",0),e=Gi(t,"padding-bottom",0),r=Gi(t,"border-top-width",0),o=Gi(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height,u=Vt(t,"box-sizing"),a=r+o;return"border-box"===u?i:i-n-e-a},Xi=function(t){return Gi(t,"width",zi(t))},Yi=function(t){return Ui()?qi(t):Gi(t,"height",Fi(t))},Ki={getWidth:Xi,getHeight:Yi},$i=/(\d+(\.\d+)?)(\w|%)*/,Ji=/(\d+(\.\d+)?)%/,Qi=/(\d+(\.\d+)?)px|em/,Zi=function(t,n){Ht(t,"width",n+"px")},tu=function(t,n){Ht(t,"width",n+"%")},nu=function(t,n){Ht(t,"height",n+"px")},eu=function(t){return Ut(t,"height").getOrThunk((function(){return Ki.getHeight(t)+"px"}))},ru=function(t,n,e,r){var o=ur.table(t).map((function(t){var r=e(t);return Math.floor(n/100*r)})).getOr(n);return r(t,o),o},ou=function(t,n,e,r){var o=parseInt(t,10);return kt(t,"%")&&"table"!==ct(n)?ru(n,o,e,r):o},iu=function(t){var n=eu(t);return n?ou(n,t,Fi,nu):Fi(t)},uu=function(t,n,e){var r=e(t),o=au(t,n);return r/o},au=function(t,n){return bt(t,n)?parseInt(vt(t,n),10):1},cu=function(t){var n=Ut(t,"width");return n.fold((function(){return p.from(vt(t,"width"))}),(function(t){return p.some(t)}))},su=function(t,n){return t/n.pixelWidth()*100},fu=function(t,n,e){var r=Ji.exec(n);if(null!==r)return parseFloat(r[1]);var o=zi(t);return su(o,e)},lu=function(t,n){var e=cu(t);return e.fold((function(){var e=zi(t);return su(e,n)}),(function(e){return fu(t,e,n)}))},du=function(t,n){return t/100*n.pixelWidth()},mu=function(t,n,e){var r=Qi.exec(n);if(null!==r)return parseInt(r[1],10);var o=Ji.exec(n);if(null!==o){var i=parseFloat(o[1]);return du(i,e)}return zi(t)},gu=function(t,n){var e=cu(t);return e.fold((function(){return zi(t)}),(function(e){return mu(t,e,n)}))},pu=function(t){return uu(t,"rowspan",iu)},hu=function(t){var n=cu(t);return n.bind((function(t){var n=$i.exec(t);return null!==n?p.some({width:o(parseFloat(n[1])),unit:o(n[3])}):p.none()}))},vu=function(t,n,e){Ht(t,"width",n+e)},bu={percentageBasedSizeRegex:o(Ji),pixelBasedSizeRegex:o(Qi),setPixelWidth:Zi,setPercentageWidth:tu,setHeight:nu,getPixelWidth:gu,getPercentageWidth:lu,getGenericWidth:hu,setGenericWidth:vu,getHeight:pu,getRawWidth:cu},yu=function(t,n){var e=bu.getGenericWidth(t);e.each((function(e){var r=e.width()/2;bu.setGenericWidth(t,r,e.unit()),bu.setGenericWidth(n,r,e.unit())}))},wu={halve:yu},xu=function(t,n){var e=function(e,r){return xu(t+e,n+r)};return{left:o(t),top:o(n),translate:e}},Cu=xu,Su=function(t){var n=t.getBoundingClientRect();return Cu(n.left,n.top)},ku=function(t,n){return void 0!==t?t:void 0!==n?n:0},Ou=function(t){var n=t.dom().ownerDocument,e=n.body,r=n.defaultView,o=n.documentElement;if(e===t.dom())return Cu(e.offsetLeft,e.offsetTop);var i=ku(r.pageYOffset,o.scrollTop),u=ku(r.pageXOffset,o.scrollLeft),a=ku(o.clientTop,e.clientTop),c=ku(o.clientLeft,e.clientLeft);return Tu(t).translate(u-c,i-a)},Tu=function(t){var n=t.dom(),e=n.ownerDocument,r=e.body;return r===n?Cu(r.offsetLeft,r.offsetTop):Pt(t)?Su(n):Cu(0,0)},Eu=$("row","y"),Du=$("col","x"),Au=function(t){var n=Ou(t);return n.left()+Vi(t)},_u=function(t){return Ou(t).left()},Ru=function(t,n){return Du(t,_u(n))},Bu=function(t,n){return Du(t,Au(n))},Iu=function(t){return Ou(t).top()},Pu=function(t,n){return Eu(t,Iu(n))},Nu=function(t,n){return Eu(t,Iu(n)+Li(n))},Mu=function(t,n,e){if(0===e.length)return[];var r=_(e.slice(1),(function(n,e){return n.map((function(n){return t(e,n)}))})),o=e[e.length-1].map((function(t){return n(e.length-1,t)}));return r.concat([o])},Fu=function(t){return-t},Lu={delta:i,positions:function(t){return Mu(Pu,Nu,t)},edge:Iu},Hu={delta:i,edge:_u,positions:function(t){return Mu(Ru,Bu,t)}},zu={delta:Fu,edge:Au,positions:function(t){return Mu(Bu,Ru,t)}},Vu={height:Lu,rtl:zu,ltr:Hu},ju={ltr:Vu.ltr,rtl:Vu.rtl};function Uu(t){var n=function(n){return t(n).isRtl()?ju.rtl:ju.ltr},e=function(t,e){return n(e).delta(t,e)},r=function(t,e){return n(e).positions(t,e)},o=function(t){return n(t).edge(t)};return{delta:e,edge:o,positions:r}}var Wu=function(t){var n=sr.fromTable(t),e=hr.generate(n);return e.grid()},Gu={getGridSize:Wu},qu=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},Xu=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return p.none()},Yu=function(t,n,e,r){e===r?yt(t,n):pt(t,n,e)},Ku=function(t,n){var e=[],r=[],i=function(n,o){var i=Ve(t,o).getOrThunk((function(){var n=It.fromTag(o,Qn(t).dom());return fe(t,n),n}));pe(i);var u=_(n,(function(t){t.isNew()&&e.push(t.element());var n=t.element();return pe(n),R(t.cells(),(function(t){t.isNew()&&r.push(t.element()),Yu(t.element(),"colspan",t.colspan(),1),Yu(t.element(),"rowspan",t.rowspan(),1),fe(n,t.element())})),n}));ge(i,u)},u=function(n){Ve(t,n).each(he)},a=function(t,n){t.length>0?i(t,n):u(n)},c=[],s=[],f=[];return R(n,(function(t){switch(t.section()){case"thead":c.push(t);break;case"tbody":s.push(t);break;case"tfoot":f.push(t);break}})),a(c,"thead"),a(s,"tbody"),a(f,"tfoot"),{newRows:o(e),newCells:o(r)}},$u=function(t){var n=_(t,(function(t){var n=Lr(t.element());return R(t.cells(),(function(t){var e=Hr(t.element());Yu(e,"colspan",t.colspan(),1),Yu(e,"rowspan",t.rowspan(),1),fe(n,e)})),n}));return n},Ju={render:Ku,copy:$u},Qu=function(t,n){var e=vt(t,n);return void 0===e||""===e?[]:e.split(" ")},Zu=function(t,n,e){var r=Qu(t,n),o=r.concat([e]);return pt(t,n,o.join(" ")),!0},ta=function(t,n,e){var r=I(Qu(t,n),(function(t){return t!==e}));return r.length>0?pt(t,n,r.join(" ")):yt(t,n),!1},na=function(t){return void 0!==t.dom().classList},ea=function(t){return Qu(t,"class")},ra=function(t,n){return Zu(t,"class",n)},oa=function(t,n){return ta(t,"class",n)},ia=function(t,n){na(t)?t.dom().classList.add(n):ra(t,n)},ua=function(t){var n=na(t)?t.dom().classList:ea(t);0===n.length&&yt(t,"class")},aa=function(t,n){if(na(t)){var e=t.dom().classList;e.remove(n)}else oa(t,n);ua(t)},ca=function(t,n){return na(t)&&t.dom().classList.contains(n)},sa=function(t,n){for(var e=[],r=0;r<t;r++)e.push(n(r));return e},fa=function(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e},la=function(t,n){if(n<0||n>=t.length-1)return p.none();var e=t[n].fold((function(){var e=V(t.slice(0,n));return Xu(e,(function(t,n){return t.map((function(t){return{value:t,delta:n+1}}))}))}),(function(t){return p.some({value:t,delta:0})})),r=t[n+1].fold((function(){var e=t.slice(n+1);return Xu(e,(function(t,n){return t.map((function(t){return{value:t,delta:n+1}}))}))}),(function(t){return p.some({value:t,delta:1})}));return e.bind((function(t){return r.map((function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e}))}))},da=function(t){var n=t.grid(),e=fa(0,n.columns()),r=fa(0,n.rows());return _(e,(function(n){var e=function(){return H(r,(function(e){return hr.getAt(t,e,n).filter((function(t){return t.column()===n})).fold(o([]),(function(t){return[t]}))}))},i=function(t){return 1===t.colspan()},u=function(){return hr.getAt(t,0,n)};return ma(e,i,u)}))},ma=function(t,n,e){var r=t(),o=M(r,n),i=o.orThunk((function(){return p.from(r[0]).orThunk(e)}));return i.map((function(t){return t.element()}))},ga=function(t){var n=t.grid(),e=fa(0,n.rows()),r=fa(0,n.columns());return _(e,(function(n){var e=function(){return H(r,(function(e){return hr.getAt(t,n,e).filter((function(t){return t.row()===n})).fold(o([]),(function(t){return[t]}))}))},i=function(t){return 1===t.rowspan()},u=function(){return hr.getAt(t,n,0)};return ma(e,i,u)}))},pa={columns:da,rows:ga},ha=function(t){var n=t.replace(/\./g,"-"),e=function(t){return n+"-"+t};return{resolve:e}},va=ha("ephox-snooker"),ba={resolve:va.resolve},ya=function(t,n,e,r,o){var i=It.fromTag("div");return zt(i,{position:"absolute",left:n-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),ht(i,{"data-column":t,role:"presentation"}),i},wa=function(t,n,e,r,o){var i=It.fromTag("div");return zt(i,{position:"absolute",left:n+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),ht(i,{"data-row":t,role:"presentation"}),i},xa={col:ya,row:wa},Ca=ba.resolve("resizer-bar"),Sa=ba.resolve("resizer-rows"),ka=ba.resolve("resizer-cols"),Oa=7,Ta=function(t){var n=Pe(t.parent(),"."+Ca);R(n,he)},Ea=function(t,n,e){var r=t.origin();R(n,(function(n,o){n.each((function(n){var o=e(r,n);ia(o,Ca),fe(t.parent(),o)}))}))},Da=function(t,n,e,r){Ea(t,n,(function(t,n){var o=xa.col(n.col(),n.x()-t.left(),e.top()-t.top(),Oa,r);return ia(o,ka),o}))},Aa=function(t,n,e,r){Ea(t,n,(function(t,n){var o=xa.row(n.row(),e.left()-t.left(),n.y()-t.top(),r,Oa);return ia(o,Sa),o}))},_a=function(t,n,e,r,o,i){var u=Ou(n),a=e.length>0?o.positions(e,n):[];Aa(t,a,u,Vi(n));var c=r.length>0?i.positions(r,n):[];Da(t,c,u,Li(n))},Ra=function(t,n,e,r){Ta(t);var o=sr.fromTable(n),i=hr.generate(o),u=pa.rows(i),a=pa.columns(i);_a(t,n,u,a,e,r)},Ba=function(t,n){var e=Pe(t.parent(),"."+Ca);R(e,n)},Ia=function(t){Ba(t,(function(t){Ht(t,"display","none")}))},Pa=function(t){Ba(t,(function(t){Ht(t,"display","block")}))},Na=function(t){return ca(t,Sa)},Ma=function(t){return ca(t,ka)},Fa={refresh:Ra,hide:Ia,show:Pa,destroy:Ta,isRowBar:Na,isColBar:Ma},La=function(t,n,e){var r=t.cells(),o=r.slice(0,n),i=r.slice(n),u=o.concat([e]).concat(i);return za(t,u)},Ha=function(t,n,e){var r=t.cells();r[n]=e},za=function(t,n){return Te(n,t.section())},Va=function(t,n){var e=t.cells(),r=_(e,n);return Te(r,t.section())},ja=function(t,n){return t.cells()[n]},Ua=function(t,n){return ja(t,n).element()},Wa=function(t){return t.cells().length},Ga={addCell:La,setCells:za,mutateCell:Ha,getCell:ja,getCellElement:Ua,mapCells:Va,cellLength:Wa},qa=function(t,n){return _(t,(function(t){return Ga.getCell(t,n)}))},Xa=function(t,n){return t[n]},Ya=function(t,n){if(0===t.length)return 0;var e=t[0],r=F(t,(function(t){return!n(e.element(),t.element())}));return r.fold((function(){return t.length}),(function(t){return t}))},Ka=function(t,n,e,r){var i=Xa(t,n).cells().slice(e),u=Ya(i,r),a=qa(t,e).slice(n),c=Ya(a,r);return{colspan:o(u),rowspan:o(c)}},$a={subgrid:Ka},Ja=function(t,n){var e=_(t,(function(t,n){return _(t.cells(),(function(t,n){return!1}))})),r=function(t,n,r,o){for(var i=t;i<t+r;i++)for(var u=n;u<n+o;u++)e[i][u]=!0};return _(t,(function(o,i){var u=H(o.cells(),(function(o,u){if(!1===e[i][u]){var a=$a.subgrid(t,i,u,n);return r(i,u,a.rowspan(),a.colspan()),[xe(o.element(),a.rowspan(),a.colspan(),o.isNew())]}return[]}));return Ee(u,o.section())}))},Qa=function(t,n,e){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=hr.getAt(t,o,u).map((function(t){return ke(t.element(),e)})).getOrThunk((function(){return ke(n.gap(),!0)}));i.push(a)}var c=Te(i,t.all()[o].section());r.push(c)}return r},Za={toDetails:Ja,toGrid:Qa},tc=function(t,n){return Za.toGrid(t,n,!1)},nc=function(t,n){var e=function(t){var e=Xu(t,(function(t){return te(t.element()).map((function(t){var n=te(t).isNone();return ke(t,n)}))}));return e.getOrThunk((function(){return ke(n.row(),!0)}))};return _(t,(function(t){var n=e(t.details());return Oe(n.element(),t.details(),t.section(),n.isNew())}))},ec=function(t,n){var e=Za.toDetails(t,qn);return nc(e,n)},rc=function(t,n){var e=L(_(t.all(),(function(t){return t.cells()})));return M(e,(function(t){return qn(n,t.element())}))},oc=function(t,n,e,r,i){return function(u,a,c,s,f){var l=sr.fromTable(a),d=hr.generate(l),m=n(d,c).map((function(n){var e=tc(d,s),r=t(e,n,qn,i(s)),u=ec(r.grid(),s);return{grid:o(u),cursor:r.cursor}}));return m.fold((function(){return p.none()}),(function(t){var n=Ju.render(a,t.grid());return e(a,t.grid(),f),r(a),Fa.refresh(u,a,Vu.height,f),p.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})}))}},ic=function(t,n){return ur.cell(n.element()).bind((function(n){return rc(t,n)}))},uc=function(t,n){return ur.cell(n.element()).bind((function(e){return rc(t,e).map((function(t){var e=$t($t({},t),{generators:n.generators,clipboard:n.clipboard});return e}))}))},ac=function(t,n){var e=_(n.selection(),(function(n){return ur.cell(n).bind((function(n){return rc(t,n)}))})),r=qu(e);return r.length>0?p.some({cells:r,generators:n.generators,clipboard:n.clipboard}):p.none()},cc=function(t,n){return n.mergable()},sc=function(t,n){return n.unmergable()},fc=function(t,n){var e=_(n.selection(),(function(n){return ur.cell(n).bind((function(n){return rc(t,n)}))})),r=qu(e);return r.length>0?p.some(r):p.none()},lc=function(t){var n=function(n){return t===n},e=function(n){return lc(t)},r=function(n){return lc(t)},i=function(n){return lc(n(t))},u=function(n){return lc(t)},a=function(n){n(t)},c=function(n){return n(t)},l=function(n,e){return e(t)},d=function(n){return n(t)},m=function(n){return n(t)},g=function(){return p.some(t)};return{is:n,isValue:f,isError:s,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:e,orThunk:r,fold:l,map:i,mapError:u,each:a,bind:c,exists:d,forall:m,toOption:g}},dc=function(t){var n=function(t){return t()},r=function(){return c(String(t))()},o=function(t){return t},u=function(t){return t()},a=function(n){return dc(t)},l=function(n){return dc(n(t))},d=function(n){return dc(t)},m=function(n,e){return n(t)};return{is:s,isValue:s,isError:f,getOr:i,getOrThunk:n,getOrDie:r,or:o,orThunk:u,fold:m,map:a,mapError:l,each:e,bind:d,exists:s,forall:f,toOption:p.none}},mc=function(t,n){return t.fold((function(){return dc(n)}),lc)},gc={value:lc,error:dc,fromOption:mc},pc=function(t,n,e){if(t.row()>=n.length||t.column()>Ga.cellLength(n[0]))return gc.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),i=r[0].cells().slice(t.column()),u=Ga.cellLength(e[0]),a=e.length;return gc.value({rowDelta:o(r.length-a),colDelta:o(i.length-u)})},hc=function(t,n){var e=Ga.cellLength(t[0]),r=Ga.cellLength(n[0]);return{rowDelta:o(0),colDelta:o(e-r)}},vc=function(t,n){return _(t,(function(){return ke(n.cell(),!0)}))},bc=function(t,n,e){return t.concat(sa(n,(function(n){return Ga.setCells(t[t.length-1],vc(t[t.length-1].cells(),e))})))},yc=function(t,n,e){return _(t,(function(t){return Ga.setCells(t,t.cells().concat(vc(fa(0,n),e)))}))},wc=function(t,n,e){var r=n.colDelta()<0?yc:i,o=n.rowDelta()<0?bc:i,u=r(t,Math.abs(n.colDelta()),e),a=o(u,Math.abs(n.rowDelta()),e);return a},xc={measure:pc,measureWidth:hc,tailor:wc},Cc=function(t,n,e,r){if(0===t.length)return t;for(var o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)Ga.mutateCell(t[o],i,ke(r(),!1));return t},Sc=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Ga.cellLength(t[0]);u++){var a=Ga.getCellElement(t[i],u),c=e(a,n);!0===c&&!1===o?Ga.mutateCell(t[i],u,ke(r(),!0)):!0===c&&(o=!1)}return t},kc=function(t,n){return N(t,(function(t,e){return A(t,(function(t){return n(t.element(),e.element())}))?t:t.concat([e])}),[])},Oc=function(t,n,e,r){if(n>0&&n<t.length){var o=t[n-1].cells(),i=kc(o,e);R(i,(function(o){for(var i=p.none(),u=function(n){for(var u=function(u){var a=t[n].cells()[u],c=e(a.element(),o.element());c&&(i.isNone()&&(i=p.some(r())),i.each((function(e){Ga.mutateCell(t[n],u,ke(e,!0))})))},a=0;a<Ga.cellLength(t[0]);a++)u(a)},a=n;a<t.length;a++)u(a)}))}return t},Tc={merge:Cc,unmerge:Sc,splitRows:Oc},Ec=function(t,n,e,r){var o=Ga.getCell(t[n],e),i=u(r,o.element()),a=t[n];return t.length>1&&Ga.cellLength(a)>1&&(e>0&&i(Ga.getCellElement(a,e-1))||e<a.cells().length-1&&i(Ga.getCellElement(a,e+1))||n>0&&i(Ga.getCellElement(t[n-1],e))||n<t.length-1&&i(Ga.getCellElement(t[n+1],e)))},Dc=function(t,n,e,r,o){for(var i=t.row(),u=t.column(),a=e.length,c=Ga.cellLength(e[0]),s=i+a,f=u+c,l=i;l<s;l++)for(var d=u;d<f;d++){Ec(n,l,d,o)&&Tc.unmerge(n,Ga.getCellElement(n[l],d),o,r.cell);var m=Ga.getCellElement(e[l-i],d-u),g=r.replace(m);Ga.mutateCell(n[l],d,ke(g,!0))}return n},Ac=function(t,n,e,r,o){var i=xc.measure(t,n,e);return i.map((function(i){var u=xc.tailor(n,i,r);return Dc(t,u,e,r,o)}))},_c=function(t,n,e,r,o){Tc.splitRows(n,t,o,r.cell);var i=xc.measureWidth(e,n),u=xc.tailor(e,i,r),a=xc.measureWidth(n,u),c=xc.tailor(n,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Rc={merge:Ac,insert:_c},Bc=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),a=Ga.mapCells(t[e],(function(e,i){var u=n>0&&n<t.length&&r(Ga.getCellElement(t[n-1],i),Ga.getCellElement(t[n],i)),a=u?Ga.getCell(t[n],i):ke(o(e.element(),r),!0);return a}));return i.concat([a]).concat(u)},Ic=function(t,n,e,r,o){return _(t,(function(t){var i=n>0&&n<Ga.cellLength(t)&&r(Ga.getCellElement(t,n-1),Ga.getCellElement(t,n)),u=i?Ga.getCell(t,n):ke(o(Ga.getCellElement(t,e),r),!0);return Ga.addCell(t,n,u)}))},Pc=function(t,n,e,r,o){var i=e+1;return _(t,(function(t,u){var a=u===n,c=a?ke(o(Ga.getCellElement(t,e),r),!0):Ga.getCell(t,e);return Ga.addCell(t,i,c)}))},Nc=function(t,n,e,r,o){var i=n+1,u=t.slice(0,i),a=t.slice(i),c=Ga.mapCells(t[n],(function(t,n){var i=n===e;return i?ke(o(t.element(),r),!0):t}));return u.concat([c]).concat(a)},Mc=function(t,n,e){var r=_(t,(function(t){var r=t.cells().slice(0,n).concat(t.cells().slice(e+1));return Te(r,t.section())}));return I(r,(function(t){return t.cells().length>0}))},Fc=function(t,n,e){return t.slice(0,n).concat(t.slice(e+1))},Lc={insertRowAt:Bc,insertColumnAt:Ic,splitCellIntoColumns:Pc,splitCellIntoRows:Nc,deleteRowsAt:Fc,deleteColumnsAt:Mc},Hc=function(t,n,e,r){var o=function(t){return A(n,(function(n){return e(t.element(),n.element())}))};return _(t,(function(t){return Ga.mapCells(t,(function(t){return o(t)?ke(r(t.element(),e),!0):t}))}))},zc=function(t,n,e,r){return void 0!==Ga.getCellElement(t[n],e)&&n>0&&r(Ga.getCellElement(t[n-1],e),Ga.getCellElement(t[n],e))},Vc=function(t,n,e){return n>0&&e(Ga.getCellElement(t,n-1),Ga.getCellElement(t,n))},jc=function(t,n,e,r){var o=H(t,(function(r,o){var i=zc(t,o,n,e)||Vc(r,n,e);return i?[]:[Ga.getCell(r,n)]}));return Hc(t,o,e,r)},Uc=function(t,n,e,r){var o=t[n],i=H(o.cells(),(function(r,i){var u=zc(t,n,i,e)||Vc(o,i,e);return u?[]:[r]}));return Hc(t,i,e,r)},Wc={replaceColumn:jc,replaceRow:Uc},Gc=hi.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),qc=$t({},Gc),Xc=function(t,n){return 0===t.length?qc.none():1===t.length?qc.only(0):0===n?qc.left(0,1):n===t.length-1?qc.right(n-1,n):n>0&&n<t.length-1?qc.middle(n-1,n,n+1):qc.none()},Yc=function(t,n,e,r){var i=t.slice(0),u=Xc(t,n),a=function(t){return _(t,o(0))},c=o(a(i)),s=function(t){return r.singleColumnWidth(i[t],e)},f=function(t,n){if(e>=0){var o=Math.max(r.minCellWidth(),i[n]-e);return a(i.slice(0,t)).concat([e,o-i[n]]).concat(a(i.slice(n+1)))}var u=Math.max(r.minCellWidth(),i[t]+e),c=i[t]-u;return a(i.slice(0,t)).concat([u-i[t],c]).concat(a(i.slice(n+1)))},l=f,d=function(t,n,e){return f(n,e)},m=function(t,n){if(e>=0)return a(i.slice(0,n)).concat([e]);var o=Math.max(r.minCellWidth(),i[n]+e);return a(i.slice(0,n)).concat([o-i[n]])};return u.fold(c,s,l,d,m)},Kc={determine:Yc},$c=function(t,n){return bt(t,n)&&parseInt(vt(t,n),10)>1},Jc=function(t){return $c(t,"colspan")},Qc=function(t){return $c(t,"rowspan")},Zc=function(t,n){return parseInt(Vt(t,n),10)},ts={hasColspan:Jc,hasRowspan:Qc,minWidth:o(10),minHeight:o(10),getInt:Zc},ns=function(t,n,e){return Ut(t,n).fold((function(){return e(t)+"px"}),(function(t){return t}))},es=function(t,n){return ns(t,"width",(function(t){return bu.getPixelWidth(t,n)}))},rs=function(t){return ns(t,"height",bu.getHeight)},os=function(t,n,e,r,o){var i=pa.columns(t),u=_(i,(function(t){return t.map(n.edge)}));return _(i,(function(t,n){var i=t.filter(a(ts.hasColspan));return i.fold((function(){var t=la(u,n);return r(t)}),(function(t){return e(t,o)}))}))},is=function(t){return t.map((function(t){return t+"px"})).getOr("")},us=function(t,n,e){return os(t,n,es,is,e)},as=function(t,n,e){return os(t,n,bu.getPercentageWidth,(function(t){return t.fold((function(){return e.minCellWidth()}),(function(t){return t/e.pixelWidth()*100}))}),e)},cs=function(t,n,e){return os(t,n,bu.getPixelWidth,(function(t){return t.getOrThunk(e.minCellWidth)}),e)},ss=function(t,n,e,r){var o=pa.rows(t),i=_(o,(function(t){return t.map(n.edge)}));return _(o,(function(t,n){var o=t.filter(a(ts.hasRowspan));return o.fold((function(){var t=la(i,n);return r(t)}),(function(t){return e(t)}))}))},fs=function(t,n){return ss(t,n,bu.getHeight,(function(t){return t.getOrThunk(ts.minHeight)}))},ls=function(t,n){return ss(t,n,rs,is)},ds={getRawWidths:us,getPixelWidths:cs,getPercentageWidths:as,getPixelHeights:fs,getRawHeights:ls},ms=function(t,n,e){for(var r=0,o=t;o<n;o++)r+=void 0!==e[o]?e[o]:0;return r},gs=function(t,n){var e=hr.justCells(t);return _(e,(function(t){var e=ms(t.column(),t.column()+t.colspan(),n);return{element:t.element,width:o(e),colspan:t.colspan}}))},ps=function(t,n){var e=hr.justCells(t);return _(e,(function(t){var e=ms(t.row(),t.row()+t.rowspan(),n);return{element:t.element,height:o(e),rowspan:t.rowspan}}))},hs=function(t,n){return _(t.all(),(function(t,e){return{element:t.element,height:o(n[e])}}))},vs={recalculateWidth:gs,recalculateHeight:ps,matchRowHeight:hs},bs=function(t,n){var e=parseFloat(t),r=zi(n),i=function(t){return t/r*100},u=function(t,n){return[100-t]},a=function(){return ts.minWidth()/r*100},c=function(t,n,r){var o=r/100,i=o*e;bu.setPercentageWidth(t,e+i)};return{width:o(e),pixelWidth:o(r),getWidths:ds.getPercentageWidths,getCellDelta:i,singleColumnWidth:u,minCellWidth:a,setElementWidth:bu.setPercentageWidth,setTableWidth:c}},ys=function(t){var n=i,e=function(t,n){var e=Math.max(ts.minWidth(),t+n);return[e-t]},r=function(t,n,e){var r=P(n,(function(t,n){return t+n}),0);bu.setPixelWidth(t,r)};return{width:o(t),pixelWidth:o(t),getWidths:ds.getPixelWidths,getCellDelta:n,singleColumnWidth:e,minCellWidth:ts.minWidth,setElementWidth:bu.setPixelWidth,setTableWidth:r}},ws=function(t,n){var e=bu.percentageBasedSizeRegex().exec(n);if(null!==e)return bs(e[1],t);var r=bu.pixelBasedSizeRegex().exec(n);if(null!==r){var o=parseInt(r[1],10);return ys(o)}var i=zi(t);return ys(i)},xs=function(t){var n=bu.getRawWidth(t);return n.fold((function(){var n=zi(t);return ys(n)}),(function(n){return ws(t,n)}))},Cs={getTableSize:xs},Ss=function(t){return hr.generate(t)},ks=function(t){return P(t,(function(t,n){return t+n}),0)},Os=function(t){var n=sr.fromTable(t);return Ss(n)},Ts=function(t,n,e,r){var o=Cs.getTableSize(t),i=o.getCellDelta(n),u=Os(t),a=o.getWidths(u,r,o),c=Kc.determine(a,e,i,o),s=_(c,(function(t,n){return t+a[n]})),f=vs.recalculateWidth(u,s);R(f,(function(t){o.setElementWidth(t.element(),t.width())})),e===u.grid().columns()-1&&o.setTableWidth(t,s,i)},Es=function(t,n,e,r){var o=Os(t),i=ds.getPixelHeights(o,r),u=_(i,(function(t,r){return e===r?Math.max(n+t,ts.minHeight()):t})),a=vs.recalculateHeight(o,u),c=vs.matchRowHeight(o,u);R(c,(function(t){bu.setHeight(t.element(),t.height())})),R(a,(function(t){bu.setHeight(t.element(),t.height())}));var s=ks(u);bu.setHeight(t,s)},Ds=function(t,n,e){var r=Cs.getTableSize(t),o=Ss(n),i=r.getWidths(o,e,r),u=vs.recalculateWidth(o,i);R(u,(function(t){r.setElementWidth(t.element(),t.width())})),u.length>0&&r.setTableWidth(t,i,r.getCellDelta(0))},As={adjustWidth:Ts,adjustHeight:Es,adjustWidthTo:Ds},_s=function(t,n){return Rs(t,n,{validate:C,label:"function"})},Rs=function(t,n,e){if(0===n.length)throw new Error("You must specify at least one required field.");return tt("required",n),et(n),function(r){var o=U(r),i=z(n,(function(t){return D(o,t)}));i||Q(n,o),t(n,o);var u=I(n,(function(t){return!e.validate(r[t],t)}));return u.length>0&&nt(u,e.label),r}},Bs=function(t,n){var e=I(n,(function(n){return!D(t,n)}));e.length>0&&Z(e)},Is=function(t){return _s(Bs,t)},Ps=Is(["cell","row","replace","gap"]),Ns=function(t){var n=bt(t,"colspan")?parseInt(vt(t,"colspan"),10):1,e=bt(t,"rowspan")?parseInt(vt(t,"rowspan"),10):1;return{element:o(t),colspan:o(n),rowspan:o(e)}},Ms=function(t,e){void 0===e&&(e=Ns),Ps(t);var r=n(p.none()),o=function(n){return t.cell(n)},i=function(t){var n=e(t);return o(n)},u=function(t){var n=i(t);return r.get().isNone()&&r.set(p.some(n)),a=p.some({item:t,replacement:n}),n},a=p.none(),c=function(t,n){return a.fold((function(){return u(t)}),(function(e){return n(t,e.item)?e.replacement:u(t)}))};return{getOrInit:c,cursor:r.get}},Fs=function(t,e){return function(r){var o=n(p.none());Ps(r);var i=[],u=function(t,n){return M(i,(function(e){return n(e.item,t)}))},a=function(n){var u={scope:t},a=r.replace(n,e,u);return i.push({item:n,sub:a}),o.get().isNone()&&o.set(p.some(a)),a},c=function(t,n){return u(t,n).fold((function(){return a(t)}),(function(e){return n(t,e.item)?e.sub:a(t)}))};return{replaceOrInit:c,cursor:o.get}}},Ls=function(t){Ps(t);var e=n(p.none()),r=function(n){return e.get().isNone()&&e.set(p.some(n)),function(){var e=t.cell({element:o(n),colspan:o(1),rowspan:o(1)});return Wt(e,"width"),Wt(n,"width"),e}};return{combine:r,cursor:e.get}},Hs={modification:Ms,transform:Fs,merging:Ls},zs=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Vs=function(t,n){var e=t.property().name(n);return D(["ol","ul"],e)},js=function(t,n){var e=t.property().name(n);return D(zs,e)},Us=function(t,n){var e=t.property().name(n);return D(["address","pre","p","h1","h2","h3","h4","h5","h6"],e)},Ws=function(t,n){var e=t.property().name(n);return D(["h1","h2","h3","h4","h5","h6"],e)},Gs=function(t,n){return D(["div","li","td","th","blockquote","body","caption"],t.property().name(n))},qs=function(t,n){return D(["br","img","hr","input"],t.property().name(n))},Xs=function(t,n){return"iframe"===t.property().name(n)},Ys=function(t,n){return!(js(t,n)||qs(t,n))&&"li"!==t.property().name(n)},Ks={isBlock:js,isList:Vs,isFormatting:Us,isHeading:Ws,isContainer:Gs,isEmptyTag:qs,isFrame:Xs,isInline:Ys},$s=vo(),Js=function(t){return Ks.isBlock($s,t)},Qs=function(t){return Ks.isList($s,t)},Zs=function(t){return Ks.isFormatting($s,t)},tf=function(t){return Ks.isHeading($s,t)},nf=function(t){return Ks.isContainer($s,t)},ef=function(t){return Ks.isEmptyTag($s,t)},rf=function(t){return Ks.isFrame($s,t)},of=function(t){return Ks.isInline($s,t)},uf={isBlock:Js,isList:Qs,isFormatting:Zs,isHeading:tf,isContainer:nf,isEmptyTag:ef,isFrame:rf,isInline:of},af=function(t){var n=function(t){return"br"===ct(t)},e=function(t){return z(t,(function(t){return n(t)||mt(t)&&0===Tr(t).trim().length}))},r=function(t){return"li"===ct(t)||Me(t,uf.isList).isSome()},o=function(t){return re(t).map((function(t){return!!uf.isBlock(t)||!!uf.isEmptyTag(t)&&"img"!==ct(t)})).getOr(!1)},i=function(t){return Nr(t).bind((function(e){var i=o(e);return te(e).map((function(o){return!0===i||r(o)||n(e)||uf.isBlock(o)&&!qn(t,o)?[]:[It.fromTag("br")]}))})).getOr([])},u=function(){var n=H(t,(function(t){var n=oe(t);return e(n)?[]:n.concat(i(t))}));return 0===n.length?[It.fromTag("br")]:n},a=u();pe(t[0]),ge(t[0],a)},cf={merge:af},sf=function(t){var n=ur.cells(t);0===n.length&&he(t)},ff=$("grid","cursor"),lf=function(t,n,e){return df(t,n,e).orThunk((function(){return df(t,0,0)}))},df=function(t,n,e){return p.from(t[n]).bind((function(t){return p.from(t.cells()[e]).bind((function(t){return p.from(t.element())}))}))},mf=function(t,n,e){return ff(t,df(t,n,e))},gf=function(t){return N(t,(function(t,n){return A(t,(function(t){return t.row()===n.row()}))?t:t.concat([n])}),[]).sort((function(t,n){return t.row()-n.row()}))},pf=function(t){return N(t,(function(t,n){return A(t,(function(t){return t.column()===n.column()}))?t:t.concat([n])}),[]).sort((function(t,n){return t.column()-n.column()}))},hf=function(t,n,e,r){var o=n.row(),i=n.row(),u=Lc.insertRowAt(t,i,o,e,r.getOrInit);return mf(u,i,n.column())},vf=function(t,n,e,r){var o=n[0].row(),i=n[0].row(),u=gf(n),a=N(u,(function(t,n){return Lc.insertRowAt(t,i,o,e,r.getOrInit)}),t);return mf(a,i,n[0].column())},bf=function(t,n,e,r){var o=n.row(),i=n.row()+n.rowspan(),u=Lc.insertRowAt(t,i,o,e,r.getOrInit);return mf(u,i,n.column())},yf=function(t,n,e,r){var o=gf(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=N(o,(function(t,n){return Lc.insertRowAt(t,u,i,e,r.getOrInit)}),t);return mf(a,u,n[0].column())},wf=function(t,n,e,r){var o=n.column(),i=n.column(),u=Lc.insertColumnAt(t,i,o,e,r.getOrInit);return mf(u,n.row(),i)},xf=function(t,n,e,r){var o=pf(n),i=o[0].column(),u=o[0].column(),a=N(o,(function(t,n){return Lc.insertColumnAt(t,u,i,e,r.getOrInit)}),t);return mf(a,n[0].row(),u)},Cf=function(t,n,e,r){var o=n.column(),i=n.column()+n.colspan(),u=Lc.insertColumnAt(t,i,o,e,r.getOrInit);return mf(u,n.row(),i)},Sf=function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan(),u=pf(n),a=N(u,(function(t,n){return Lc.insertColumnAt(t,i,o,e,r.getOrInit)}),t);return mf(a,n[0].row(),i)},kf=function(t,n,e,r){var o=Wc.replaceRow(t,n.row(),e,r.replaceOrInit);return mf(o,n.row(),n.column())},Of=function(t,n,e,r){var o=Wc.replaceColumn(t,n.column(),e,r.replaceOrInit);return mf(o,n.row(),n.column())},Tf=function(t,n,e,r){var o=Wc.replaceRow(t,n.row(),e,r.replaceOrInit);return mf(o,n.row(),n.column())},Ef=function(t,n,e,r){var o=Wc.replaceColumn(t,n.column(),e,r.replaceOrInit);return mf(o,n.row(),n.column())},Df=function(t,n,e,r){var o=Lc.splitCellIntoColumns(t,n.row(),n.column(),e,r.getOrInit);return mf(o,n.row(),n.column())},Af=function(t,n,e,r){var o=Lc.splitCellIntoRows(t,n.row(),n.column(),e,r.getOrInit);return mf(o,n.row(),n.column())},_f=function(t,n,e,r){var o=pf(n),i=Lc.deleteColumnsAt(t,o[0].column(),o[o.length-1].column()),u=lf(i,n[0].row(),n[0].column());return ff(i,u)},Rf=function(t,n,e,r){var o=gf(n),i=Lc.deleteRowsAt(t,o[0].row(),o[o.length-1].row()),u=lf(i,n[0].row(),n[0].column());return ff(i,u)},Bf=function(t,n,e,r){var i=n.cells();cf.merge(i);var u=Tc.merge(t,n.bounds(),e,o(i[0]));return ff(u,p.from(i[0]))},If=function(t,n,e,r){var o=P(n,(function(t,n){return Tc.unmerge(t,n,e,r.combine(n))}),t);return ff(o,p.from(n[0]))},Pf=function(t,n,e,r){var o=function(t,n){var e=sr.fromTable(t),r=hr.generate(e);return Za.toGrid(r,n,!0)},i=o(n.clipboard(),n.generators()),u=ye(n.row(),n.column()),a=Rc.merge(u,t,i,n.generators(),e);return a.fold((function(){return ff(t,p.some(n.element()))}),(function(t){var e=lf(t,n.row(),n.column());return ff(t,e)}))},Nf=function(t,n,e){var r=sr.fromPastedRows(t,e),o=hr.generate(r);return Za.toGrid(o,n,!0)},Mf=function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=Nf(n.clipboard(),n.generators(),o),a=Rc.insert(i,t,u,n.generators(),e),c=lf(a,n.cells[0].row(),n.cells[0].column());return ff(a,c)},Ff=function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=Nf(n.clipboard(),n.generators(),o),a=Rc.insert(i,t,u,n.generators(),e),c=lf(a,n.cells[0].row(),n.cells[0].column());return ff(a,c)},Lf=As.adjustWidthTo,Hf={insertRowBefore:oc(hf,ic,e,e,Hs.modification),insertRowsBefore:oc(vf,fc,e,e,Hs.modification),insertRowAfter:oc(bf,ic,e,e,Hs.modification),insertRowsAfter:oc(yf,fc,e,e,Hs.modification),insertColumnBefore:oc(wf,ic,Lf,e,Hs.modification),insertColumnsBefore:oc(xf,fc,Lf,e,Hs.modification),insertColumnAfter:oc(Cf,ic,Lf,e,Hs.modification),insertColumnsAfter:oc(Sf,fc,Lf,e,Hs.modification),splitCellIntoColumns:oc(Df,ic,Lf,e,Hs.modification),splitCellIntoRows:oc(Af,ic,e,e,Hs.modification),eraseColumns:oc(_f,fc,Lf,sf,Hs.modification),eraseRows:oc(Rf,fc,e,sf,Hs.modification),makeColumnHeader:oc(Of,ic,e,e,Hs.transform("row","th")),unmakeColumnHeader:oc(Ef,ic,e,e,Hs.transform(null,"td")),makeRowHeader:oc(kf,ic,e,e,Hs.transform("col","th")),unmakeRowHeader:oc(Tf,ic,e,e,Hs.transform(null,"td")),mergeCells:oc(Bf,cc,e,e,Hs.merging),unmergeCells:oc(If,sc,Lf,e,Hs.merging),pasteCells:oc(Pf,uc,Lf,e,Hs.modification),pasteRowsBefore:oc(Mf,ac,e,e,Hs.modification),pasteRowsAfter:oc(Ff,ac,e,e,Hs.modification)},zf=function(t){return It.fromDom(t.getBody())},Vf=function(t){return t.getBoundingClientRect().width},jf=function(t){return t.getBoundingClientRect().height},Uf=function(t){return function(n){return qn(n,zf(t))}},Wf=function(t){return t?t.replace(/px$/,""):""},Gf=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},qf=function(t){var n=Pe(t,"td[data-mce-style],th[data-mce-style]");yt(t,"data-mce-style"),R(n,(function(t){yt(t,"data-mce-style")}))},Xf=function(t){return"rtl"===Vt(t,"direction")?"rtl":"ltr"},Yf={isRtl:o(!1)},Kf={isRtl:o(!0)},$f=function(t){var n=Xf(t);return"rtl"===n?Kf:Yf},Jf={directionAt:$f},Qf="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",Zf={"border-collapse":"collapse",width:"100%"},tl={border:"1"},nl=function(t){return t.getParam("table_default_attributes",tl,"object")},el=function(t){return t.getParam("table_default_styles",Zf,"object")},rl=function(t){return t.getParam("table_resize_bars",!0,"boolean")},ol=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},il=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},ul=function(t){return t.getParam("table_row_advtab",!0,"boolean")},al=function(t){return t.getParam("table_advtab",!0,"boolean")},cl=function(t){return t.getParam("table_appearance_options",!0,"boolean")},sl=function(t){return t.getParam("table_grid",!0,"boolean")},fl=function(t){return t.getParam("table_style_by_css",!1,"boolean")},ll=function(t){return t.getParam("table_cell_class_list",[],"array")},dl=function(t){return t.getParam("table_row_class_list",[],"array")},ml=function(t){return t.getParam("table_class_list",[],"array")},gl=function(t){return!0===t.getParam("table_responsive_width")},pl=function(t){return!1===t.getParam("table_responsive_width")},hl=function(t){return t.getParam("table_toolbar",Qf)},vl=function(t){var n=t.getParam("table_clone_elements");return y(n)?p.some(n.split(/[ ,]/)):Array.isArray(n)?p.some(n):p.none()},bl=function(t){var n=t.getParam("object_resizing",!0);return y(n)?"table"===n:n},yl=function(t,n){return t.fire("newrow",{node:n})},wl=function(t,n){return t.fire("newcell",{node:n})},xl=function(t,n,e,r){t.fire("ObjectResizeStart",{target:n,width:e,height:r})},Cl=function(t,n,e,r){t.fire("ObjectResized",{target:n,width:e,height:r})},Sl=function(t,n,e,r,o){t.fire("TableSelectionChange",{cells:n,start:e,finish:r,otherCells:o})},kl=function(t){t.fire("TableSelectionClear")},Ol=function(t,n){var r=function(t){return"table"===ct(zf(t))},o=function(n){var e=Gu.getGridSize(n);return!1===r(t)||e.rows()>1},i=function(n){var e=Gu.getGridSize(n);return!1===r(t)||e.columns()>1},u=vl(t),a=function(n,e,r,o){return function(i,a){qf(i);var c=o(),s=It.fromDom(t.getDoc()),f=Uu(Jf.directionAt),l=Kr.cellOperations(r,s,u);return e(i)?n(c,i,a,l,f).bind((function(n){return R(n.newRows(),(function(n){yl(t,n.dom())})),R(n.newCells(),(function(n){wl(t,n.dom())})),n.cursor().map((function(n){var e=t.dom.createRng();return e.setStart(n.dom(),0),e.setEnd(n.dom(),0),e}))})):p.none()}},c=a(Hf.eraseRows,o,e,n),s=a(Hf.eraseColumns,i,e,n),l=a(Hf.insertRowsBefore,f,e,n),d=a(Hf.insertRowsAfter,f,e,n),m=a(Hf.insertColumnsBefore,f,wu.halve,n),g=a(Hf.insertColumnsAfter,f,wu.halve,n),h=a(Hf.mergeCells,f,e,n),v=a(Hf.unmergeCells,f,e,n),b=a(Hf.pasteRowsBefore,f,e,n),y=a(Hf.pasteRowsAfter,f,e,n),w=a(Hf.pasteCells,f,e,n);return{deleteRow:c,deleteColumn:s,insertRowsBefore:l,insertRowsAfter:d,insertColumnsBefore:m,insertColumnsAfter:g,mergeCells:h,unmergeCells:v,pasteRowsBefore:b,pasteRowsAfter:y,pasteCells:w}},Tl=function(t,n,e){var r=sr.fromTable(t),o=hr.generate(r),i=fc(o,n);return i.map((function(t){var n=Za.toGrid(o,e,!1),r=n.slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),i=ec(r,e);return Ju.copy(i)}))},El={copyRows:Tl},Dl=tinymce.util.Tools.resolve("tinymce.util.Tools"),Al=function(t,n,e){var r,o=t.select("td,th",n),i=function(n,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],e);if("undefined"===typeof n&&(n=i),n!==i)return""}return n};return r=i(r,o),r},_l=function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},Rl=function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},Bl=function(t,n){Dl.each("left center right".split(" "),(function(e){t.formatter.remove("align"+e,{},n)}))},Il=function(t,n){Dl.each("top middle bottom".split(" "),(function(e){t.formatter.remove("valign"+e,{},n)}))},Pl={applyAlign:_l,applyVAlign:Rl,unApplyAlign:Bl,unApplyVAlign:Il,getTDTHOverallStyle:Al},Nl=function(t,n,e){var r=function(t,e){return e=e||[],Dl.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,n&&n(o)),e.push(o)})),e};return r(t,e||[])},Ml=function(t,n){var e=function(n){return St(n,"rgb")?t.toHex(n):n},r=Ut(It.fromDom(n),"border-width").getOr(""),o=Ut(It.fromDom(n),"border-style").getOr(""),i=Ut(It.fromDom(n),"border-color").map(e).getOr(""),u=Ut(It.fromDom(n),"background-color").map(e).getOr("");return{borderwidth:r,borderstyle:o,bordercolor:i,backgroundcolor:u}},Fl=function(t){var n=t[0],e=t.slice(1),r=U(n);return R(e,(function(t){R(r,(function(e){G(t,(function(t,r){var o=n[e];""!==o&&e===r&&o!==t&&(n[e]="")}))}))})),n},Ll=function(t){var n=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],e={name:"borderwidth",type:"input",label:"Border width"},r="cell"===t?[e].concat(n):n;return{title:"Advanced",name:"advanced",items:r}},Hl=function(t,n,e,r,o){var i={};return Dl.each(t.split(" "),(function(t){r.formatter.matchNode(o,n+t)&&(i[e]=t)})),i[e]||(i[e]=""),i},zl=u(Hl,"left center right"),Vl=u(Hl,"top middle bottom"),jl=function(t,n){var e=el(t),r=nl(t),o=function(t){var n=function(n){return St(n,"rgb")?t.toHex(n):n},r=Y(e,"border-style").getOr(""),o=Y(e,"border-color").getOr(""),i=Y(e,"background-color").getOr("");return{borderstyle:r,bordercolor:n(o),backgroundcolor:n(i)}},i={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},u=function(){var n=e["border-width"];return fl(t)&&n?{border:n}:Y(r,"border").fold((function(){return{}}),(function(t){return{border:t}}))},a=t.dom,c=n?o(a):{},s=function(){var t=Y(e,"border-spacing").or(Y(r,"cellspacing")).fold((function(){return{}}),(function(t){return{cellspacing:t}})),n=Y(e,"border-padding").or(Y(r,"cellpadding")).fold((function(){return{}}),(function(t){return{cellpadding:t}}));return $t($t({},t),n)},f=$t($t($t($t($t($t({},i),e),r),c),u()),s());return f},Ul=function(t,n,e){var r=function(n,e){var r=Ut(It.fromDom(e),"border-width");return fl(t)&&r.isSome()?r.getOr(""):n.getAttrib(e,"border")||Pl.getTDTHOverallStyle(t.dom,e,"border-width")||Pl.getTDTHOverallStyle(t.dom,e,"border")},o=t.dom,i=$t($t({width:o.getStyle(n,"width")||o.getAttrib(n,"width"),height:o.getStyle(n,"height")||o.getAttrib(n,"height"),cellspacing:o.getStyle(n,"border-spacing")||o.getAttrib(n,"cellspacing"),cellpadding:o.getAttrib(n,"cellpadding")||Pl.getTDTHOverallStyle(t.dom,n,"padding"),border:r(o,n),caption:!!o.select("caption",n)[0],class:o.getAttrib(n,"class","")},zl("align","align",t,n)),e?Ml(o,n):{});return i},Wl=function(t,n,e){var r=t.dom,o=$t($t({height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),class:r.getAttrib(n,"class",""),align:"",type:n.parentNode.nodeName.toLowerCase()},zl("align","align",t,n)),e?Ml(r,n):{});return o},Gl=function(t,n,e){var r=t.dom,o=$t($t($t({width:r.getStyle(n,"width")||r.getAttrib(n,"width"),height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),celltype:n.nodeName.toLowerCase(),class:r.getAttrib(n,"class","")},zl("align","halign",t,n)),Vl("valign","valign",t,n)),e?Ml(r,n):{});return o},ql={buildListItems:Nl,extractAdvancedStyles:Ml,getSharedValues:Fl,getAdvancedTab:Ll,extractDataFromTableElement:Ul,extractDataFromRowElement:Wl,extractDataFromCellElement:Gl,extractDataFromSettings:jl},Xl=function(t){var n=ll(t),e=ql.buildListItems(n,(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})}));return n.length>0?p.some({name:"class",type:"selectbox",label:"Class",items:e}):p.none()},Yl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Kl=function(t){return Xl(t).fold((function(){return Yl}),(function(t){return Yl.concat(t)}))},$l={getItems:Kl},Jl=function(t,n){var e=function(e,r){t.setAttrib(n,e,r)},r=function(e,r){t.setStyle(n,e,r)};return{setAttrib:e,setStyle:r}},Ql=function(t,n){var e=function(e,r){r&&t.setAttrib(n,e,r)},r=function(e,r){r&&t.setStyle(n,e,r)};return{setAttrib:e,setStyle:r}},Zl={normal:Jl,ifTruthy:Ql},td=function(t,n){t.setAttrib("scope",n.scope),t.setAttrib("class",n.class),t.setStyle("width",Gf(n.width)),t.setStyle("height",Gf(n.height))},nd=function(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle),t.setStyle("border-width",Gf(n.borderwidth))},ed=function(t,n,e){var r=t.dom,o=e.celltype&&n[0].nodeName.toLowerCase()!==e.celltype?r.rename(n[0],e.celltype):n[0],i=Zl.normal(r,o);td(i,e),il(t)&&nd(i,e),Pl.unApplyAlign(t,o),Pl.unApplyVAlign(t,o),e.halign&&Pl.applyAlign(t,o,e.halign),e.valign&&Pl.applyVAlign(t,o,e.valign)},rd=function(t,n,e){var r=t.dom;Dl.each(n,(function(n){e.celltype&&n.nodeName.toLowerCase()!==e.celltype&&(n=r.rename(n,e.celltype));var o=Zl.ifTruthy(r,n);td(o,e),il(t)&&nd(o,e),e.halign&&Pl.applyAlign(t,n,e.halign),e.valign&&Pl.applyVAlign(t,n,e.valign)}))},od=function(t,n,e){var r=e.getData();e.close(),t.undoManager.transact((function(){var e=1===n.length?ed:rd;e(t,n,r),t.focus()}))},id=function(t){var n,e=[];if(e=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!e.length&&n&&e.push(n),n=n||e[0],n){var r=Dl.map(e,(function(n){return ql.extractDataFromCellElement(t,n,il(t))})),o=ql.getSharedValues(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:$l.getItems(t)},ql.getAdvancedTab("cell")]},a={type:"panel",items:[{type:"grid",columns:2,items:$l.getItems(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:il(t)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(od,t,e)})}},ud={open:id},ad=function(t){var n=dl(t),e=ql.buildListItems(n,(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})}));return n.length>0?p.some({name:"class",type:"selectbox",label:"Class",items:e}):p.none()},cd=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],sd=function(t){return ad(t).fold((function(){return cd}),(function(t){return cd.concat(t)}))},fd={getItems:sd},ld=function(t,n,e){var r=t.getParent(n,"table"),o=n.parentNode,i=t.select(e,r)[0];i||(i=t.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(n),o.hasChildNodes()||t.remove(o)},dd=function(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle)},md=function(t,n,e,r){var o=t.dom,i=r.getData();r.close();var u=1===n.length?Zl.normal:Zl.ifTruthy;t.undoManager.transact((function(){Dl.each(n,(function(n){i.type!==n.parentNode.nodeName.toLowerCase()&&ld(t.dom,n,i.type);var r=u(o,n);r.setAttrib("scope",i.scope),r.setAttrib("class",i.class),r.setStyle("height",Gf(i.height)),ul(t)&&dd(r,i),i.align!==e.align&&(Pl.unApplyAlign(t,n),Pl.applyAlign(t,n,i.align))})),t.focus()}))},gd=function(t){var n,e,r,o=t.dom,i=[];if(n=o.getParent(t.selection.getStart(),"table"),n&&(e=o.getParent(t.selection.getStart(),"td,th"),Dl.each(n.rows,(function(t){Dl.each(t.cells,(function(n){if((o.getAttrib(n,"data-mce-selected")||n===e)&&i.indexOf(t)<0)return i.push(t),!1}))})),r=i[0],r)){var a=Dl.map(i,(function(n){return ql.extractDataFromRowElement(t,n,ul(t))})),c=ql.getSharedValues(a),s={type:"tabpanel",tabs:[{title:"General",name:"general",items:fd.getItems(t)},ql.getAdvancedTab("row")]},f={type:"panel",items:[{type:"grid",columns:2,items:fd.getItems(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:ul(t)?s:f,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:u(md,t,i,c)})}},pd={open:gd},hd=Object.prototype.hasOwnProperty,vd=function(t,n){return n},bd=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)hd.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},yd=bd(vd),wd=tinymce.util.Tools.resolve("tinymce.Env"),xd={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Cd=function(){return It.fromTag("table")},Sd=function(){return It.fromTag("tbody")},kd=function(){return It.fromTag("tr")},Od=function(){return It.fromTag("th")},Td=function(){return It.fromTag("td")},Ed=function(t,n,e,r,o){void 0===o&&(o=xd);var i=Cd();zt(i,o.styles),ht(i,o.attributes);var u=Sd();fe(i,u);for(var a=[],c=0;c<t;c++){for(var s=kd(),f=0;f<n;f++){var l=c<e||f<r?Od():Td();f<r&&pt(l,"scope","row"),c<e&&pt(l,"scope","col"),fe(l,It.fromTag("br")),o.percentages&&Ht(l,"width",100/n+"%"),fe(s,l)}a.push(s)}return ge(u,a),i},Dd=function(t){return t.dom().innerHTML},Ad=function(t){var n=It.fromTag("div"),e=It.fromDom(t.dom().cloneNode(!0));return fe(n,e),Dd(n)},_d=function(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)},Rd=function(t,n){je(n,"td,th").each(u(_d,t))},Bd=function(t,n){R(Pe(n,"tr"),(function(n){yl(t,n.dom()),R(Pe(n,"th,td"),(function(n){wl(t,n.dom())}))}))},Id=function(t){return y(t)&&-1!==t.indexOf("%")},Pd=function(t,n,e){var r=el(t),o={styles:r,attributes:nl(t),percentages:Id(r.width)&&!pl(t)},i=Ed(e,n,0,0,o);pt(i,"data-mce-id","__mce");var u=Ad(i);return t.insertContent(u),je(zf(t),'table[data-mce-id="__mce"]').map((function(n){return pl(t)&&Ht(n,"width",Vt(n,"width")),yt(n,"data-mce-id"),Bd(t,n),Rd(t,n),n.dom()})).getOr(null)},Nd={insert:Pd},Md=function(t,n,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],i=cl(t)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=[{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],a=n?[{type:"selectbox",name:"class",label:"Class",items:ql.buildListItems(ml(t),(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})}))}]:[];return r.concat(o).concat(i).concat(u).concat(a)},Fd={getItems:Md},Ld=function(t,n,e,r){if("TD"===n.tagName||"TH"===n.tagName)y(e)?t.setStyle(n,e,r):t.setStyle(n,e);else if(n.children)for(var o=0;o<n.children.length;o++)Ld(t,n.children[o],e,r)},Hd=function(t,n,e){var r=t.dom,o={},i={};if(o.class=e.class,i.height=Gf(e.height),r.getAttrib(n,"width")&&!fl(t)?o.width=Wf(e.width):i.width=Gf(e.width),fl(t)?(i["border-width"]=Gf(e.border),i["border-spacing"]=Gf(e.cellspacing)):(o.border=e.border,o.cellpadding=e.cellpadding,o.cellspacing=e.cellspacing),fl(t)&&n.children)for(var u=0;u<n.children.length;u++)Ld(r,n.children[u],{"border-width":Gf(e.border),padding:Gf(e.cellpadding)}),al(t)&&Ld(r,n.children[u],{"border-color":e.bordercolor});al(t)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),o.style=r.serializeStyle(yd(el(t),i)),r.setAttribs(n,yd(nl(t),o))},zd=function(t,n,e){var r,o=t.dom,i=e.getData();e.close(),""===i.class&&delete i.class,t.undoManager.transact((function(){if(!n){var e=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;n=Nd.insert(t,e,u)}Hd(t,n,i),r=o.select("caption",n)[0],r&&!i.caption&&o.remove(r),!r&&i.caption&&(r=o.create("caption"),r.innerHTML=wd.ie?"":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),""===i.align?Pl.unApplyAlign(t,n):Pl.applyAlign(t,n,i.align),t.focus(),t.addVisual()}))},Vd=function(t,n){var e,r=t.dom,o=ql.extractDataFromSettings(t,al(t));!1===n?(e=r.getParent(t.selection.getStart(),"table"),e?o=ql.extractDataFromTableElement(t,e,al(t)):al(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor="")):(o.cols="1",o.rows="1",al(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=ml(t).length>0;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var a={type:"grid",columns:2,items:Fd.getItems(t,i,n)},c=function(){return{type:"panel",items:[a]}},s=function(){return{type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},ql.getAdvancedTab("table")]}},f=al(t)?s():c();t.windowManager.open({title:"Table Properties",size:"normal",body:f,onSubmit:u(zd,t,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},jd={open:Vd},Ud=function(t){return function(n){return p.from(n.dom.getParent(n.selection.getStart(),t)).map(It.fromDom)}},Wd=Ud("th,td"),Gd=Ud("th,td,caption"),qd=Dl.each,Xd=function(t,n,r,o,i){var c=Uf(t),s=function(){Gd(t).each((function(n){var e=ur.table(n,c);e.filter(a(c)).each((function(n){var e=It.fromText("");if(ce(n,e),he(n),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),t.selection.setRng(r),t.nodeChanged()}}))}))},f=function(t){return ur.table(t,c)},l=function(t){return{width:Vf(t.dom()),height:Vf(t.dom())}},d=function(t,n,e){var r=l(e);n.width===r.width&&n.height===r.height||(xl(t,e.dom(),n.width,n.height),Cl(t,e.dom(),r.width,r.height))},m=function(n){Wd(t).each((function(e){f(e).each((function(i){var u=Ai.forMenu(o,i,e),a=l(i);n(i,u).each((function(n){d(t,a,i),t.selection.setRng(n),t.focus(),r.clear(i),qf(i)}))}))}))},g=function(n){return Wd(t).map((function(n){return f(n).bind((function(r){var i=It.fromDom(t.getDoc()),u=Ai.forMenu(o,r,n),a=Kr.cellOperations(e,i,p.none());return El.copyRows(r,u,a)}))}))},h=function(n){i.get().each((function(e){var i=_(e,(function(t){return Hr(t)}));Wd(t).each((function(e){f(e).each((function(u){var a=It.fromDom(t.getDoc()),c=Kr.paste(a),s=Ai.pasteRows(o,u,e,i,c);n(u,s).each((function(n){t.selection.setRng(n),t.focus(),r.clear(u)}))}))}))}))};qd({mceTableSplitCells:function(){m(n.unmergeCells)},mceTableMergeCells:function(){m(n.mergeCells)},mceTableInsertRowBefore:function(){m(n.insertRowsBefore)},mceTableInsertRowAfter:function(){m(n.insertRowsAfter)},mceTableInsertColBefore:function(){m(n.insertColumnsBefore)},mceTableInsertColAfter:function(){m(n.insertColumnsAfter)},mceTableDeleteCol:function(){m(n.deleteColumn)},mceTableDeleteRow:function(){m(n.deleteRow)},mceTableCutRow:function(t){g().each((function(t){i.set(t),m(n.deleteRow)}))},mceTableCopyRow:function(t){g().each((function(t){i.set(t)}))},mceTablePasteRowBefore:function(t){h(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){h(n.pasteRowsAfter)},mceTableDelete:s},(function(n,e){t.addCommand(e,n)})),qd({mceInsertTable:u(jd.open,t,!0),mceTableProps:u(jd.open,t,!1),mceTableRowProps:u(pd.open,t),mceTableCellProps:u(ud.open,t)},(function(n,e){t.addCommand(e,(function(){n()}))}))},Yd={registerCommands:Xd},Kd=function(t){var n=p.from(t.dom().documentElement).map(It.fromDom).getOr(t);return{parent:o(n),view:o(t),origin:o(Cu(0,0))}},$d=function(t,n){var e=function(){return Ou(n)};return{parent:o(n),view:o(t),origin:e}},Jd=function(t,n){return{parent:o(n),view:o(t),origin:o(Cu(0,0))}},Qd={only:Kd,detached:$d,body:Jd},Zd=function(t){var n=$.apply(null,t),e=[],r=function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");e.push(t)},o=function(t){e=I(e,(function(n){return n!==t}))},i=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.apply(null,t);R(e,(function(t){t(o)}))};return{bind:r,unbind:o,trigger:i}},tm=function(t){var n=q(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),e=q(t,(function(t){return t.trigger}));return{registry:n,trigger:e}},nm={create:tm},em=function(t,n,e,r,i,u,a){return{target:o(t),x:o(n),y:o(e),stop:r,prevent:i,kill:u,raw:o(a)}},rm=function(t){var n=It.fromDom(t.target),e=function(){t.stopPropagation()},o=function(){t.preventDefault()},i=r(o,e);return em(n,t.clientX,t.clientY,e,o,i,t)},om=function(t,n){return function(e){t(e)&&n(rm(e))}},im=function(t,n,e,r,o){var i=om(e,r);return t.dom().addEventListener(n,i,o),{unbind:u(am,t,n,i,o)}},um=function(t,n,e,r){return im(t,n,e,r,!1)},am=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},cm=o(!0),sm=function(t,n,e){return um(t,n,cm,e)},fm=ha("ephox-dragster"),lm={resolve:fm.resolve},dm=function(t){var n=yd({layerClass:lm.resolve("blocker")},t),e=It.fromTag("div");pt(e,"role","presentation"),zt(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ia(e,lm.resolve("blocker")),ia(e,n.layerClass);var r=function(){return e},o=function(){he(e)};return{element:r,destroy:o}},mm=Is(["compare","extract","mutate","sink"]),gm=Is(["element","start","stop","destroy"]),pm=Is(["forceDrop","drop","move","delayDrop"]),hm=function(t,n){return Cu(n.left()-t.left(),n.top()-t.top())},vm=function(t){return p.some(Cu(t.x(),t.y()))},bm=function(t,n){t.mutate(n.left(),n.top())},ym=function(t,n){var e=dm(n),r=sm(e.element(),"mousedown",t.forceDrop),o=sm(e.element(),"mouseup",t.drop),i=sm(e.element(),"mousemove",t.move),u=sm(e.element(),"mouseout",t.delayDrop),a=function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(t){fe(t,e.element())},s=function(){he(e.element())};return gm({element:e.element,start:c,stop:s,destroy:a})},wm=mm({compare:hm,extract:vm,sink:ym,mutate:bm}),xm=function(n,e){var r=null,o=function(){null!==r&&(t.clearTimeout(r),r=null)},i=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&t.clearTimeout(r),r=t.setTimeout((function(){n.apply(null,o),r=null}),e)};return{cancel:o,throttle:i}};function Cm(){var t=p.none(),n=function(){t=p.none()},e=function(n,e){var r=t.map((function(t){return n.compare(t,e)}));return t=p.some(e),r},r=function(t,n){var r=n.extract(t);r.each((function(t){var r=e(n,t);r.each((function(t){o.trigger.move(t)}))}))},o=nm.create({move:Zd(["info"])});return{onEvent:r,reset:n,events:o.registry}}function Sm(){return{onEvent:e,reset:e}}function km(){var t=Sm(),n=Cm(),e=t,r=function(){e.reset(),e=n},o=function(){e.reset(),e=t},i=function(t,n){e.onEvent(t,n)},u=function(){return e===n};return{on:r,off:o,isOn:u,onEvent:i,events:n.events}}var Om=function(t,n,e){var r=!1,o=nm.create({start:Zd([]),stop:Zd([])}),i=km(),u=function(){m.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=xm(u,200),c=function(t){m.start(t),i.on(),o.trigger.start()},s=function(t){a.cancel(),i.onEvent(t,n)};i.events.move.bind((function(e){n.mutate(t,e.info())}));var f=function(){r=!0},l=function(){r=!1},d=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r&&t.apply(null,n)}},m=n.sink(pm({forceDrop:u,drop:d(u),move:d(s),delayDrop:d(a.throttle)}),e),g=function(){m.destroy()};return{element:m.element,go:c,on:f,off:l,destroy:g,events:o.registry}},Tm={setup:Om},Em=function(t,n){void 0===n&&(n={});var e=void 0!==n.mode?n.mode:wm;return Tm.setup(t,e,n)},Dm={transform:Em},Am=function(){var t=nm.create({drag:Zd(["xDelta","yDelta"])}),n=function(n,e){t.trigger.drag(n,e)};return{mutate:n,events:t.registry}},_m=function(){var t=nm.create({drag:Zd(["xDelta","yDelta","target"])}),n=p.none(),e=Am();e.events.drag.bind((function(e){n.each((function(n){t.trigger.drag(e.xDelta(),e.yDelta(),n)}))}));var r=function(t){n=p.some(t)},o=function(){return n};return{assign:r,get:o,mutate:e.mutate,events:t.registry}},Rm=function(t){return"true"===vt(t,"contenteditable")},Bm=function(t,n){return Ue(t,"[contenteditable]",n)},Im=ba.resolve("resizer-bar-dragging"),Pm=function(t,n,e){var r=_m(),o=Dm.transform(r,{}),i=p.none(),a=function(t,n){return p.from(vt(t,n))};r.events.drag.bind((function(t){a(t.target(),"data-row").each((function(n){var e=ts.getInt(t.target(),"top");Ht(t.target(),"top",e+t.yDelta()+"px")})),a(t.target(),"data-column").each((function(n){var e=ts.getInt(t.target(),"left");Ht(t.target(),"left",e+t.xDelta()+"px")}))}));var c=function(t,n){var e=ts.getInt(t,n),r=parseInt(vt(t,"data-initial-"+n),10);return e-r};o.events.stop.bind((function(){r.get().each((function(r){i.each((function(o){a(r,"data-row").each((function(t){var n=c(r,"top");yt(r,"data-initial-top"),v.trigger.adjustHeight(o,n,parseInt(t,10))})),a(r,"data-column").each((function(t){var n=c(r,"left");yt(r,"data-initial-left"),v.trigger.adjustWidth(o,n,parseInt(t,10))})),Fa.refresh(t,o,e,n)}))}))}));var s=function(n,e){v.trigger.startAdjust(),r.assign(n),pt(n,"data-initial-"+e,parseInt(Vt(n,e),10)),ia(n,Im),Ht(n,"opacity","0.2"),o.go(t.parent())},f=sm(t.parent(),"mousedown",(function(t){Fa.isRowBar(t.target())&&s(t.target(),"top"),Fa.isColBar(t.target())&&s(t.target(),"left")})),l=function(n){return qn(n,t.view())},d=function(t){return Ue(t,"table",l).filter((function(t){return Bm(t,l).exists(Rm)}))},m=sm(t.view(),"mouseover",(function(r){d(r.target()).fold((function(){Pt(r.target())&&Fa.destroy(t)}),(function(r){i=p.some(r),Fa.refresh(t,r,e,n)}))})),g=function(){f.unbind(),m.unbind(),o.destroy(),Fa.destroy(t)},h=function(r){Fa.refresh(t,r,e,n)},v=nm.create({adjustHeight:Zd(["table","delta","row"]),adjustWidth:Zd(["table","delta","column"]),startAdjust:Zd([])});return{destroy:g,refresh:h,on:o.on,off:o.off,hideBars:u(Fa.hide,t),showBars:u(Fa.show,t),events:v.registry}},Nm=function(t,n){var e=Vu.height,r=Pm(t,n,e),o=nm.create({beforeResize:Zd(["table"]),afterResize:Zd(["table"]),startDrag:Zd([])});return r.events.adjustHeight.bind((function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());As.adjustHeight(t.table(),n,t.row(),e),o.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());As.adjustWidth(t.table(),e,t.column(),n),o.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},Mm={create:Nm},Fm=function(){var t=It.fromTag("div");return zt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),fe(Nt(),t),t},Lm=function(t,n){return t.inline?Qd.body(zf(t),Fm()):Qd.only(It.fromDom(t.getDoc()))},Hm=function(t,n){t.inline&&he(n.parent())},zm={get:Lm,remove:Hm},Vm=function(t,n){return Vf(t.dom())/Vf(n.dom())*100+"%"},jm=function(t){var n=It.fromDom(t);te(n).map((function(t){return Vm(n,t)})).each((function(t){Ht(n,"width",t),R(Pe(n,"tr"),(function(t){R(oe(t),(function(n){Ht(n,"width",Vm(n,t))}))}))}))},Um=function(t){Ht(It.fromDom(t),"width",Vf(t).toString()+"px")},Wm=function(t){var n,e,r=p.none(),o=p.none(),i=p.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName},c=function(n){var e=t.dom.getStyle(n,"width")||t.dom.getAttrib(n,"width");return p.from(e).filter((function(t){return t.length>0}))},s=function(){return o},f=function(){return i.getOr(Qd.only(It.fromDom(t.getBody())))},l=function(){o.each((function(t){t.destroy()})),i.each((function(n){zm.remove(t,n)}))};return t.on("init",(function(){var n=Uu(Jf.directionAt),e=zm.get(t);if(i=p.some(e),bl(t)&&rl(t)){var u=Mm.create(e,n);u.on(),u.events.startDrag.bind((function(n){r=p.some(t.selection.getRng())})),u.events.beforeResize.bind((function(n){var e=n.table().dom();xl(t,e,Vf(e),jf(e))})),u.events.afterResize.bind((function(n){var e=n.table(),o=e.dom();qf(e),r.each((function(n){t.selection.setRng(n),t.focus()})),Cl(t,o,Vf(o),jf(o)),t.undoManager.add()})),o=p.some(u)}})),t.on("ObjectResizeStart",(function(r){var o=r.target;if(a(o)){var i=c(o).map((function(t){return u.test(t)})).getOr(!1);i&&pl(t)?Um(o):!i&&gl(t)&&jm(o),n=r.width,e=c(o).getOr("")}})),t.on("ObjectResized",(function(r){var o=r.target;if(a(o)){var i=o;if(u.test(e)){var c=parseFloat(u.exec(e)[1]),s=r.width*c/n;t.dom.setStyle(i,"width",s+"%")}else{var f=[];Dl.each(i.rows,(function(n){Dl.each(n.cells,(function(n){var e=t.dom.getStyle(n,"width",!0);f.push({cell:n,width:e})}))})),Dl.each(f,(function(n){t.dom.setStyle(n.cell,"width",n.width),t.dom.setAttrib(n.cell,"width",null)}))}}})),t.on("SwitchMode",(function(){s().each((function(n){t.readonly?n.hideBars():n.showBars()}))})),{lazyResize:s,lazyWire:f,destroy:l}},Gm=hi.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),qm=function(t){return void 0===t&&(t=void 0),Gm.none(t)},Xm=$t($t({},Gm),{none:qm}),Ym=function(t,n){return ur.table(t,n).bind((function(n){var e=ur.cells(n),r=F(e,(function(n){return qn(t,n)}));return r.map((function(t){return{index:o(t),all:o(e)}}))}))},Km=function(t,n){var e=Ym(t,n);return e.fold((function(){return Xm.none(t)}),(function(n){return n.index()+1<n.all().length?Xm.middle(t,n.all()[n.index()+1]):Xm.last(t)}))},$m=function(t,n){var e=Ym(t,n);return e.fold((function(){return Xm.none()}),(function(n){return n.index()-1>=0?Xm.middle(t,n.all()[n.index()-1]):Xm.first(t)}))},Jm={next:Km,prev:$m},Qm=$("start","soffset","finish","foffset"),Zm={create:Qm},tg=hi.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ng=function(t,n,e,r){return t.fold(n,e,r)},eg=function(t){return t.fold(i,i,i)},rg=tg.before,og=tg.on,ig=tg.after,ug={before:rg,on:og,after:ig,cata:ng,getStart:eg},ag=hi.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),cg=function(t){return ag.exact(t.start(),t.soffset(),t.finish(),t.foffset())},sg=function(t){return t.match({domRange:function(t){return It.fromDom(t.startContainer)},relative:function(t,n){return ug.getStart(t)},exact:function(t,n,e,r){return t}})},fg=ag.domRange,lg=ag.relative,dg=ag.exact,mg=function(t){var n=sg(t);return Zn(n)},gg=Zm.create,pg={domRange:fg,relative:lg,exact:dg,exactFromRange:cg,getWin:mg,range:gg},hg=function(t,n){var e=t.document.createRange();return vg(e,n),e},vg=function(t,n){t.selectNodeContents(n.dom())},bg=function(t,n){n.fold((function(n){t.setStartBefore(n.dom())}),(function(n,e){t.setStart(n.dom(),e)}),(function(n){t.setStartAfter(n.dom())}))},yg=function(t,n){n.fold((function(n){t.setEndBefore(n.dom())}),(function(n,e){t.setEnd(n.dom(),e)}),(function(n){t.setEndAfter(n.dom())}))},wg=function(t,n,e){var r=t.document.createRange();return bg(r,n),yg(r,e),r},xg=function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},Cg=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Sg=function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?p.some(e).map(Cg):p.none()},kg=hi.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Og=function(t,n,e){return n(It.fromDom(e.startContainer),e.startOffset,It.fromDom(e.endContainer),e.endOffset)},Tg=function(t,n){return n.match({domRange:function(t){return{ltr:o(t),rtl:p.none}},relative:function(n,e){return{ltr:Et((function(){return wg(t,n,e)})),rtl:Et((function(){return p.some(wg(t,e,n))}))}},exact:function(n,e,r,o){return{ltr:Et((function(){return xg(t,n,e,r,o)})),rtl:Et((function(){return p.some(xg(t,r,o,n,e))}))}}})},Eg=function(t,n){var e=n.ltr();if(e.collapsed){var r=n.rtl().filter((function(t){return!1===t.collapsed}));return r.map((function(t){return kg.rtl(It.fromDom(t.endContainer),t.endOffset,It.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Og(t,kg.ltr,e)}))}return Og(t,kg.ltr,e)},Dg=function(t,n){var e=Tg(t,n);return Eg(t,e)},Ag=function(t,n){var e=Dg(t,n);return e.match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})},_g=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(n-a.left);if(e<=a.bottom){if(e<a.top||c>i)return u-1;i=c}}return 0},Rg=function(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom},Bg=function(t,n,e,r,o){var i=function(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r},u=function(t){var n=i(t);return n.getBoundingClientRect()},a=Tr(n).length,c=_g(u,e,r,o.right,a);return i(c)},Ig=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getClientRects(),u=Xu(i,(function(t){return Rg(t,e,r)?p.some(t):p.none()}));return u.map((function(o){return Bg(t,n,e,r,o)}))},Pg=function(t,n,e,r){var o=t.dom().createRange(),i=oe(n);return Xu(i,(function(n){return o.selectNode(n.dom()),Rg(o.getBoundingClientRect(),e,r)?Ng(t,n,e,r):p.none()}))},Ng=function(t,n,e,r){return mt(n)?Ig(t,n,e,r):Pg(t,n,e,r)},Mg=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return Ng(t,n,u,a)},Fg=!0,Lg=!1,Hg=function(t,n){return n-t.left<t.right-n?Fg:Lg},zg=function(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r},Vg=function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=Hg(o,e),u=i===Fg?Pr:Nr;return u(n).map((function(n){return zg(t,n,i)}))},jg=function(t,n,e){var r=n.dom().getBoundingClientRect(),o=Hg(r,e);return p.some(zg(t,n,o))},Ug=function(t,n,e){var r=0===oe(n).length?jg:Vg;return r(t,n,e)},Wg=function(t,n,e){return p.from(t.dom().caretPositionFromPoint(n,e)).bind((function(n){if(null===n.offsetNode)return p.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),p.some(e)}))},Gg=function(t,n,e){return p.from(t.dom().caretRangeFromPoint(n,e))},qg=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return Mg(t,n,u,a)},Xg=function(t,n,e){return It.fromPoint(t,n,e).bind((function(r){var o=function(){return Ug(t,r,n)};return 0===oe(r).length?o():qg(t,r,n,e).orThunk(o)}))},Yg=document.caretPositionFromPoint?Wg:document.caretRangeFromPoint?Gg:Xg,Kg=function(t,n,e){var r=It.fromDom(t.document);return Yg(r,n,e).map((function(t){return Zm.create(It.fromDom(t.startContainer),t.startOffset,It.fromDom(t.endContainer),t.endOffset)}))},$g=function(t,n){var e=ct(t);return"input"===e?ug.after(t):D(["br","img"],e)?0===n?ug.before(t):ug.after(t):ug.on(t,n)},Jg=function(t,n){var e=t.fold(ug.before,$g,ug.after),r=n.fold(ug.before,$g,ug.after);return pg.relative(e,r)},Qg=function(t,n,e,r){var o=$g(t,n),i=$g(e,r);return pg.relative(o,i)},Zg=function(t){return t.match({domRange:function(t){var n=It.fromDom(t.startContainer),e=It.fromDom(t.endContainer);return Qg(n,t.startOffset,e,t.endOffset)},relative:Jg,exact:Qg})},tp=function(t,n,e,r){var o=Qn(t),i=o.dom().createRange();return i.setStart(t.dom(),n),i.setEnd(e.dom(),r),i},np=function(t,n,e,r){var o=tp(t,n,e,r),i=qn(t,e)&&n===r;return o.collapsed&&!i},ep=function(t,n){p.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(n)}))},rp=function(t,n,e,r,o){var i=xg(t,n,e,r,o);ep(t,i)},op=function(t,n,e,r,o,i){n.collapse(e.dom(),r),n.extend(o.dom(),i)},ip=function(t,n){return Dg(t,n).match({ltr:function(n,e,r,o){rp(t,n,e,r,o)},rtl:function(n,e,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(n.dom(),e,r.dom(),o);else if(i.extend)try{op(t,i,n,e,r,o)}catch(u){rp(t,r,o,n,e)}else rp(t,r,o,n,e)}})},up=function(t,n,e,r,o){var i=Qg(n,e,r,o);ip(t,i)},ap=function(t,n,e){var r=Jg(n,e);ip(t,r)},cp=function(t){var n=pg.getWin(t).dom(),e=function(t,e,r,o){return xg(n,t,e,r,o)},r=Zg(t);return Dg(n,r).match({ltr:e,rtl:e})},sp=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return p.some(Zm.create(It.fromDom(n.startContainer),n.startOffset,It.fromDom(e.endContainer),e.endOffset))}return p.none()},fp=function(t){var n=It.fromDom(t.anchorNode),e=It.fromDom(t.focusNode);return np(n,t.anchorOffset,e,t.focusOffset)?p.some(Zm.create(n,t.anchorOffset,e,t.focusOffset)):sp(t)},lp=function(t,n){var e=hg(t,n);ep(t,e)},dp=function(t){return p.from(t.getSelection()).filter((function(t){return t.rangeCount>0})).bind(fp)},mp=function(t){return dp(t).map((function(t){return pg.exact(t.start(),t.soffset(),t.finish(),t.foffset())}))},gp=function(t,n){var e=Ag(t,n);return Sg(e)},pp=function(t,n,e){return Kg(t,n,e)},hp=function(t){var n=t.getSelection();n.removeAllRanges()},vp=tinymce.util.Tools.resolve("tinymce.util.VK"),bp=function(t,n,e,r){return Cp(t,n,Jm.next(e),r)},yp=function(t,n,e,r){return Cp(t,n,Jm.prev(e),r)},wp=function(t,n){var e=pg.exact(n,0,n,0);return cp(e)},xp=function(t,n){var e=Pe(n,"tr");return j(e).bind((function(n){return je(n,"td,th").map((function(n){return wp(t,n)}))}))},Cp=function(t,n,e,r,o){return e.fold(p.none,p.none,(function(n,e){return Pr(e).map((function(n){return wp(t,n)}))}),(function(e){return ur.table(e,n).bind((function(n){var o=Ai.noMenu(e);return t.undoManager.transact((function(){r.insertRowsAfter(n,o)})),xp(t,n)}))}))},Sp=["table","li","dl"],kp=function(t,n,e,r){if(t.keyCode===vp.TAB){var o=zf(n),i=function(t){var n=ct(t);return qn(t,o)||D(Sp,n)},u=n.selection.getRng();if(u.collapsed){var a=It.fromDom(u.startContainer);ur.cell(a,i).each((function(o){t.preventDefault();var u=t.shiftKey?yp:bp,a=u(n,i,o,e,r);a.each((function(t){n.selection.setRng(t)}))}))}}},Op={handle:kp},Tp=$("selection","kill"),Ep={create:Tp},Dp=function(t,n,e,r){return{start:o(ug.on(t,n)),finish:o(ug.on(e,r))}},Ap={create:Dp},_p=function(t,n){var e=Ag(t,n);return Zm.create(It.fromDom(e.startContainer),e.startOffset,It.fromDom(e.endContainer),e.endOffset)},Rp=Ap.create,Bp={convertToRange:_p,makeSitus:Rp},Ip=function(t,n,e,r,o,i,u){return qn(e,o)&&r===i?p.none():Ue(e,"td,th",n).bind((function(e){return Ue(o,"td,th",n).bind((function(r){return Pp(t,n,e,r,u)}))}))},Pp=function(t,n,e,r,o){return qn(e,r)?p.none():ri.identify(e,r,n).bind((function(n){var r=n.boxes().getOr([]);return r.length>0?(o(t,r,n.start(),n.finish()),p.some(Ep.create(p.some(Bp.makeSitus(e,0,e,Ar(e))),!0))):p.none()}))},Np=function(t,n,e,r,o){var i=function(t){return o.clearBeforeUpdate(e),o.selectRange(e,t.boxes(),t.start(),t.finish()),t.boxes()};return ri.shiftSelection(r,t,n,o.firstSelectedSelector(),o.lastSelectedSelector()).map(i)},Mp={sync:Ip,detect:Pp,update:Np},Fp=$("item","mode"),Lp=function(t,n,e,r){return void 0===r&&(r=Hp),t.property().parent(n).map((function(t){return Fp(t,r)}))},Hp=function(t,n,e,r){return void 0===r&&(r=zp),e.sibling(t,n).map((function(t){return Fp(t,r)}))},zp=function(t,n,e,r){void 0===r&&(r=zp);var o=t.property().children(n),i=e.first(o);return i.map((function(t){return Fp(t,r)}))},Vp=[{current:Lp,next:Hp,fallback:p.none()},{current:Hp,next:zp,fallback:p.some(Lp)},{current:zp,next:zp,fallback:p.some(Hp)}],jp=function(t,n,e,r,o){void 0===o&&(o=Vp);var i=M(o,(function(t){return t.current===e}));return i.bind((function(e){return e.current(t,n,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return jp(t,n,e,r)}))}))}))},Up=function(){var t=function(t,n){return t.query().prevSibling(n)},n=function(t){return t.length>0?p.some(t[t.length-1]):p.none()};return{sibling:t,first:n}},Wp=function(){var t=function(t,n){return t.query().nextSibling(n)},n=function(t){return t.length>0?p.some(t[0]):p.none()};return{sibling:t,first:n}},Gp={left:Up,right:Wp},qp=function(t,n,e,r,o,i){var u=jp(t,n,r,o);return u.bind((function(n){return i(n.item())?p.none():e(n.item())?p.some(n.item()):qp(t,n.item(),e,n.mode(),o,i)}))},Xp=function(t,n,e,r){return qp(t,n,e,Hp,Gp.left(),r)},Yp=function(t,n,e,r){return qp(t,n,e,Hp,Gp.right(),r)},Kp=function(t){return function(n){return 0===t.property().children(n).length}},$p=function(t,n,e){return Qp(t,n,Kp(t),e)},Jp=function(t,n,e){return Zp(t,n,Kp(t),e)},Qp=Xp,Zp=Yp,th=vo(),nh=function(t,n){return $p(th,t,n)},eh=function(t,n){return Jp(th,t,n)},rh=function(t,n,e){return Qp(th,t,n,e)},oh=function(t,n,e){return Zp(th,t,n,e)},ih=function(t,n,e){return Me(t,n,e).isSome()},uh=$("element","offset"),ah=($("element","deltaOffset"),$("element","start","finish"),$("begin","end"),$("element","text"),hi.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),ch=function(t,n,e){var r=t.getRect(n),o=t.getRect(e);return o.right>r.left&&o.left<r.right},sh=function(t){return Ue(t,"tr")},fh=function(t,n,e,r,o,i,u){return Ue(r,"td,th",u).bind((function(e){return Ue(n,"td,th",u).map((function(n){return qn(e,n)?qn(r,e)&&Ar(e)===o?i(n):ah.none("in same cell"):Xo.sharedOne(sh,[e,n]).fold((function(){return ch(t,n,e)?ah.success():i(n)}),(function(t){return i(n)}))}))})).getOr(ah.none("default"))},lh=function(t,n,e,r,o){return t.fold(n,e,r,o)},dh=$t($t({},ah),{verify:fh,cata:lh}),mh=($("ancestor","descendants","element","index"),$("parent","children","element","index")),gh=function(t){return te(t).bind((function(n){var e=oe(n);return ph(e,t).map((function(r){return mh(n,e,t,r)}))}))},ph=function(t,n){return F(t,u(qn,n))},hh=function(t){return"br"===ct(t)},vh=function(t,n,e){return n(t,e).bind((function(t){return mt(t)&&0===Tr(t).trim().length?vh(t,n,e):p.some(t)}))},bh=function(t,n,e){return e.traverse(n).orThunk((function(){return vh(n,e.gather,t)})).map(e.relative)},yh=function(t,n){return ie(t,n).filter(hh).orThunk((function(){return ie(t,n-1).filter(hh)}))},wh=function(t,n,e,r){return yh(n,e).bind((function(n){return r.traverse(n).fold((function(){return vh(n,r.gather,t).map(r.relative)}),(function(t){return gh(t).map((function(t){return ug.on(t.parent(),t.index())}))}))}))},xh=function(t,n,e,r){var i=hh(n)?bh(t,n,r):wh(t,n,e,r);return i.map((function(t){return{start:o(t),finish:o(t)}}))},Ch=function(t){return dh.cata(t,(function(t){return p.none()}),(function(){return p.none()}),(function(t){return p.some(uh(t,0))}),(function(t){return p.some(uh(t,Ar(t)))}))},Sh={tryBr:xh,process:Ch},kh=rt(["left","top","right","bottom"],[]),Oh=function(t,n){return kh({left:t.left(),top:t.top()+n,right:t.right(),bottom:t.bottom()+n})},Th=function(t,n){return kh({left:t.left(),top:t.top()-n,right:t.right(),bottom:t.bottom()-n})},Eh=function(t,n){var e=t.bottom()-t.top();return kh({left:t.left(),top:n-e,right:t.right(),bottom:n})},Dh=function(t,n){var e=t.bottom()-t.top();return kh({left:t.left(),top:n,right:t.right(),bottom:n+e})},Ah=function(t,n,e){return kh({left:t.left()+n,top:t.top()+e,right:t.right()+n,bottom:t.bottom()+e})},_h=function(t){return t.top()},Rh=function(t){return t.bottom()},Bh=function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"},Ih={nu:kh,moveUp:Th,moveDown:Oh,moveBottomTo:Eh,moveTopTo:Dh,getTop:_h,getBottom:Rh,translate:Ah,toString:Bh},Ph=function(t,n,e){return e>=0&&e<Ar(n)?t.getRangedRect(n,e,n,e+1):e>0?t.getRangedRect(n,e-1,n,e):p.none()},Nh=function(t){return Ih.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Mh=function(t,n){return p.some(t.getRect(n))},Fh=function(t,n,e){return dt(n)?Mh(t,n).map(Nh):mt(n)?Ph(t,n,e).map(Nh):p.none()},Lh=function(t,n){return dt(n)?Mh(t,n).map(Nh):mt(n)?t.getRangedRect(n,0,n,Ar(n)).map(Nh):p.none()},Hh={getBoxAt:Fh,getEntireBox:Lh},zh=5,Vh=100,jh=hi.generate([{none:[]},{retry:["caret"]}]),Uh=function(t,n){return t.left()<n.left()||Math.abs(n.right()-t.left())<1||t.left()>n.right()},Wh=function(t,n,e){return Fe(n,uf.isBlock).fold(o(!1),(function(n){return Hh.getEntireBox(t,n).exists((function(t){return Uh(e,t)}))}))},Gh=function(t,n,e,r,o){var i=Ih.moveDown(o,zh);return Math.abs(e.bottom()-r.bottom())<1||e.top()>o.bottom()?jh.retry(i):e.top()===o.bottom()?jh.retry(Ih.moveDown(o,1)):Wh(t,n,o)?jh.retry(Ih.translate(i,zh,0)):jh.none()},qh=function(t,n,e,r,o){var i=Ih.moveUp(o,zh);return Math.abs(e.top()-r.top())<1||e.bottom()<o.top()?jh.retry(i):e.bottom()===o.top()?jh.retry(Ih.moveUp(o,1)):Wh(t,n,o)?jh.retry(Ih.translate(i,zh,0)):jh.none()},Xh={point:Ih.getTop,adjuster:qh,move:Ih.moveUp,gather:nh},Yh={point:Ih.getBottom,adjuster:Gh,move:Ih.moveDown,gather:eh},Kh=function(t,n,e){return t.elementFromPoint(n,e).filter((function(t){return"table"===ct(t)})).isSome()},$h=function(t,n,e,r,o){return Jh(t,n,e,n.move(r,zh),o)},Jh=function(t,n,e,r,o){return 0===o?p.some(r):Kh(t,r.left(),n.point(r))?$h(t,n,e,r,o-1):t.situsFromPoint(r.left(),n.point(r)).bind((function(i){return i.start().fold(p.none,(function(i){return Hh.getEntireBox(t,i).bind((function(u){return n.adjuster(t,i,u,e,r).fold(p.none,(function(r){return Jh(t,n,e,r,o-1)}))})).orThunk((function(){return p.some(r)}))}),p.none)}))},Qh=function(t,n){return t.situsFromPoint(n.left(),n.bottom()+zh)},Zh=function(t,n){return t.situsFromPoint(n.left(),n.top()-zh)},tv=function(t,n,e){return t.point(n)>e.getInnerHeight()?p.some(t.point(n)-e.getInnerHeight()):t.point(n)<0?p.some(-t.point(n)):p.none()},nv=function(t,n,e){var r=t.move(e,zh),o=Jh(n,t,e,r,Vh).getOr(r);return tv(t,o,n).fold((function(){return n.situsFromPoint(o.left(),t.point(o))}),(function(e){return n.scrollBy(0,e),n.situsFromPoint(o.left(),t.point(o)-e)}))},ev={tryUp:u(nv,Xh),tryDown:u(nv,Yh),ieTryUp:Zh,ieTryDown:Qh,getJumpSize:o(zh)},rv=20,ov=Hn(),iv=function(t,n,e){return t.getSelection().bind((function(r){return Sh.tryBr(n,r.finish(),r.foffset(),e).fold((function(){return p.some(uh(r.finish(),r.foffset()))}),(function(o){var i=t.fromSitus(o),u=dh.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),e.failure,n);return Sh.process(u)}))}))},uv=function(t,n,e,r,o,i){return 0===i?p.none():sv(t,n,e,r,o).bind((function(u){var a=t.fromSitus(u),c=dh.verify(t,e,r,a.finish(),a.foffset(),o.failure,n);return dh.cata(c,(function(){return p.none()}),(function(){return p.some(u)}),(function(u){return qn(e,u)&&0===r?av(t,e,r,Ih.moveUp,o):uv(t,n,u,0,o,i-1)}),(function(u){return qn(e,u)&&r===Ar(u)?av(t,e,r,Ih.moveDown,o):uv(t,n,u,Ar(u),o,i-1)}))}))},av=function(t,n,e,r,o){return Hh.getBoxAt(t,n,e).bind((function(n){return cv(t,o,r(n,ev.getJumpSize()))}))},cv=function(t,n,e){return ov.browser.isChrome()||ov.browser.isSafari()||ov.browser.isFirefox()||ov.browser.isEdge()?n.otherRetry(t,e):ov.browser.isIE()?n.ieRetry(t,e):p.none()},sv=function(t,n,e,r,o){return Hh.getBoxAt(t,e,r).bind((function(n){return cv(t,o,n)}))},fv=function(t,n,e){return iv(t,n,e).bind((function(r){return uv(t,n,r.element(),r.offset(),e,rv).map(t.fromSitus)}))},lv={handle:fv},dv=Hn(),mv=function(t,n){return ih(t,(function(t){return te(t).exists((function(t){return qn(t,n)}))}))},gv=function(t,n,e,r,i){return Ue(r,"td,th",n).bind((function(r){return Ue(r,"table",n).bind((function(u){return mv(i,u)?lv.handle(t,n,e).bind((function(t){return Ue(t.finish(),"td,th",n).map((function(n){return{start:o(r),finish:o(n),range:o(t)}}))})):p.none()}))}))},pv=function(t,n,e,r,o,i){return dv.browser.isIE()?p.none():i(r,n).orThunk((function(){return gv(t,n,e,r,o).map((function(t){var n=t.range();return Ep.create(p.some(Bp.makeSitus(n.start(),n.soffset(),n.finish(),n.foffset())),!0)}))}))},hv=function(t,n){return Ue(t,"tr",n).bind((function(t){return Ue(t,"table",n).bind((function(e){var r=Pe(e,"tr");return qn(t,r[0])?rh(e,(function(t){return Nr(t).isSome()}),n).map((function(t){var n=Ar(t);return Ep.create(p.some(Bp.makeSitus(t,n,t,n)),!0)})):p.none()}))}))},vv=function(t,n){return Ue(t,"tr",n).bind((function(t){return Ue(t,"table",n).bind((function(e){var r=Pe(e,"tr");return qn(t,r[r.length-1])?oh(e,(function(t){return Pr(t).isSome()}),n).map((function(t){return Ep.create(p.some(Bp.makeSitus(t,0,t,0)),!0)})):p.none()}))}))},bv=function(t,n,e,r,o,i,u){return gv(t,e,r,o,i).bind((function(t){return Mp.detect(n,e,t.start(),t.finish(),u)}))},yv={navigate:pv,select:bv,firstUpCheck:hv,lastDownCheck:vv},wv=function(t,n){return Ue(t,"td,th",n)};function xv(t,n,e,r){var o=p.none(),i=function(){o=p.none()},u=function(t){r.clear(n),o=wv(t.target(),e)},a=function(i){o.each((function(o){r.clearBeforeUpdate(n),wv(i.target(),e).each((function(i){ri.identify(o,i,e).each((function(e){var u=e.boxes().getOr([]);(u.length>1||1===u.length&&!qn(o,i))&&(r.selectRange(n,u,e.start(),e.finish()),t.selectContents(i))}))}))}))},c=function(t){o.each(i)};return{mousedown:u,mouseover:a,mouseup:c}}var Cv={traverse:re,gather:eh,relative:ug.before,otherRetry:ev.tryDown,ieRetry:ev.ieTryDown,failure:dh.failedDown},Sv={traverse:ee,gather:nh,relative:ug.before,otherRetry:ev.tryUp,ieRetry:ev.ieTryUp,failure:dh.failedUp},kv={down:Cv,up:Sv},Ov=function(t){return function(n){return n===t}},Tv=Ov(38),Ev=Ov(40),Dv=function(t){return t>=37&&t<=40},Av={ltr:{isBackward:Ov(37),isForward:Ov(39)},rtl:{isBackward:Ov(39),isForward:Ov(37)},isUp:Tv,isDown:Ev,isNavigation:Dv},_v=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},Rv={toRaw:_v},Bv=(Hn().browser.isSafari(),function(n){var e=void 0!==n?n.dom():t.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return Cu(r,o)}),Iv=function(n,e,r){var o=void 0!==r?r.dom():t.document,i=o.defaultView;i.scrollBy(n,e)},Pv=function(t){var n=function(n,e){return It.fromPoint(It.fromDom(t.document),n,e)},e=function(t){return t.dom().getBoundingClientRect()},r=function(n,e,r,o){var i=pg.exact(n,e,r,o);return gp(t,i).map(Rv.toRaw)},o=function(){return mp(t).map((function(n){return Bp.convertToRange(t,n)}))},i=function(n){var e=pg.relative(n.start(),n.finish());return Bp.convertToRange(t,e)},u=function(n,e){return pp(t,n,e).map((function(t){return Ap.create(t.start(),t.soffset(),t.finish(),t.foffset())}))},a=function(){hp(t)},c=function(n){void 0===n&&(n=!1),mp(t).each((function(e){return e.fold((function(t){return t.collapse(n)}),(function(e,r){var o=n?e:r;ap(t,o,o)}),(function(e,r,o,i){var u=n?e:o,a=n?r:i;up(t,u,a,u,a)}))}))},s=function(n){lp(t,n)},f=function(n){up(t,n.start(),n.soffset(),n.finish(),n.foffset())},l=function(n,e){ap(t,n,e)},d=function(){return t.innerHeight},m=function(){var n=Bv(It.fromDom(t.document));return n.top()},g=function(n,e){Iv(n,e,It.fromDom(t.document))};return{elementFromPoint:n,getRect:e,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,collapseSelection:c,setSelection:f,setRelativeSelection:l,selectContents:s,getInnerHeight:d,getScrollY:m,scrollBy:g}},Nv=$("rows","cols"),Mv=function(t,n,e,r){var o=Pv(t),i=xv(o,n,e,r);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},Fv=function(t,n,e,r){var o=Pv(t),i=function(){return r.clear(n),p.none()},a=function(t,a,c,s,f,l){var d=t.raw(),m=d.which,g=!0===d.shiftKey,h=ri.retrieve(n,r.selectedSelector()).fold((function(){return Av.isDown(m)&&g?u(yv.select,o,n,e,kv.down,s,a,r.selectRange):Av.isUp(m)&&g?u(yv.select,o,n,e,kv.up,s,a,r.selectRange):Av.isDown(m)?u(yv.navigate,o,e,kv.down,s,a,yv.lastDownCheck):Av.isUp(m)?u(yv.navigate,o,e,kv.up,s,a,yv.firstUpCheck):p.none}),(function(t){var e=function(e){return function(){var i=Xu(e,(function(e){return Mp.update(e.rows(),e.cols(),n,t,r)}));return i.fold((function(){return ri.getEdges(n,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var e=Av.isDown(m)||l.isForward(m)?ug.after:ug.before;return o.setRelativeSelection(ug.on(t.first(),0),e(t.table())),r.clear(n),Ep.create(p.none(),!0)}))}),(function(t){return p.some(Ep.create(p.none(),!0))}))}};return Av.isDown(m)&&g?e([Nv(1,0)]):Av.isUp(m)&&g?e([Nv(-1,0)]):l.isBackward(m)&&g?e([Nv(0,-1),Nv(-1,0)]):l.isForward(m)&&g?e([Nv(0,1),Nv(1,0)]):Av.isNavigation(m)&&!1===g?i:p.none}));return h()},c=function(t,o,i,u,a){return ri.retrieve(n,r.selectedSelector()).fold((function(){var c=t.raw(),s=c.which,f=!0===c.shiftKey;return!1===f?p.none():Av.isNavigation(s)?Mp.sync(n,e,o,i,u,a,r.selectRange):p.none()}),p.none)};return{keydown:a,keyup:c}},Lv=function(t,n,e,r){var o=Pv(t);return function(t,i){r.clearBeforeUpdate(n),ri.identify(t,i,e).each((function(t){var e=t.boxes().getOr([]);r.selectRange(n,e,t.start(),t.finish()),o.selectContents(i),o.collapseSelection()}))}},Hv={mouse:Mv,keyboard:Fv,external:Lv},zv=function(t,n){R(n,(function(n){aa(t,n)}))},Vv=function(t){return function(n){ia(n,t)}},jv=function(t){return function(n){zv(n,t)}},Uv=function(t){var n=Vv(t.selected()),e=jv([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(n){var r=Pe(n,t.selectedSelector());R(r,e)},o=function(e,o,i,u){r(e),R(o,n),ia(i,t.firstSelected()),ia(u,t.lastSelected())};return{clearBeforeUpdate:r,clear:r,selectRange:o,selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},Wv=function(t,n,e){var r=function(n){yt(n,t.selected()),yt(n,t.firstSelected()),yt(n,t.lastSelected())},o=function(n){pt(n,t.selected(),"1")},i=function(t){u(t),e()},u=function(n){var e=Pe(n,t.selectedSelector());R(e,r)},a=function(e,r,u,a){i(e),R(r,o),pt(u,t.firstSelected(),"1"),pt(a,t.lastSelected(),"1"),n(r,u,a)};return{clearBeforeUpdate:u,clear:i,selectRange:a,selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},Gv={byClass:Uv,byAttr:Wv},qv=function(t,n,e){var r=t.slice(0,n[n.length-1].row()+1),o=ec(r,e);return H(o,(function(t){var e=t.cells().slice(0,n[n.length-1].column()+1);return _(e,(function(t){return t.element()}))}))},Xv=function(t,n,e){var r=t.slice(n[0].row()+n[0].rowspan()-1,t.length),o=ec(r,e);return H(o,(function(t){var e=t.cells().slice(n[0].column()+n[0].colspan()-1,+t.cells().length);return _(e,(function(t){return t.element()}))}))},Yv=function(t,n,e){var r=sr.fromTable(t),o=hr.generate(r),i=fc(o,n);return i.map((function(t){var n=Za.toGrid(o,e,!1),r=qv(n,t,e),i=Xv(n,t,e);return{upOrLeftCells:r,downOrRightCells:i}}))},Kv={getOtherCells:Yv},$v=function(t){return!1===ca(It.fromDom(t.target),"ephox-snooker-resizer-bar")};function Jv(t,i,u){var a=rt(["mousedown","mouseover","mouseup","keyup","keydown"],[]),c=p.none(),s=vl(t),f=function(n,r,o){u.targets().each((function(i){var u=ur.table(r);u.each((function(u){var a=It.fromDom(t.getDoc()),c=Kr.cellOperations(e,a,s),f=Kv.getOtherCells(u,i,c);Sl(t,n,r,o,f)}))}))},l=function(){kl(t)},d=Gv.byAttr(gi,f,l);t.on("init",(function(u){var s=t.getWin(),f=zf(t),l=Uf(t),m=function(){var n=t.selection,r=It.fromDom(n.getStart()),o=It.fromDom(n.getEnd()),i=Xo.sharedOne(ur.table,[r,o]);i.fold((function(){d.clear(f)}),e)},g=Hv.mouse(s,f,l,d),h=Hv.keyboard(s,f,l,d),v=Hv.external(s,f,l,d),b=function(t){return!0===t.raw().shiftKey};t.on("TableSelectorChange",(function(t){v(t.start,t.finish)}));var y=function(n,e){b(n)&&(e.kill()&&n.kill(),e.selection().each((function(n){var e=pg.relative(n.start(),n.finish()),r=Ag(s,e);t.selection.setRng(r)})))},w=function(n){var e=S(n);if(e.raw().shiftKey&&Av.isNavigation(e.raw().which)){var r=t.selection.getRng(),o=It.fromDom(r.startContainer),i=It.fromDom(r.endContainer);h.keyup(e,o,r.startOffset,i,r.endOffset).each((function(t){y(e,t)}))}},x=function(n){var e=S(n);i().each((function(t){t.hideBars()}));var r=t.selection.getRng(),o=It.fromDom(t.selection.getStart()),u=It.fromDom(r.startContainer),a=It.fromDom(r.endContainer),c=Jf.directionAt(o).isRtl()?Av.rtl:Av.ltr;h.keydown(e,u,r.startOffset,a,r.endOffset,c).each((function(t){y(e,t)})),i().each((function(t){t.showBars()}))},C=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},S=function(t){var n=It.fromDom(t.target),e=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,e);return{target:o(n),x:o(C(t)?t.x:null),y:o(C(t)?t.y:null),stop:e,prevent:i,kill:u,raw:o(t)}},k=function(t){return 0===t.button},O=function(t){return void 0===t.buttons||0!==(1&t.buttons)},T=function(t){k(t)&&$v(t)&&g.mousedown(S(t))},E=function(t){O(t)&&$v(t)&&g.mouseover(S(t))},D=function(t){k(t)&&$v(t)&&g.mouseup(S(t))},A=function(){var t=n(It.fromDom(f)),e=n(0),r=function(n){var r=It.fromDom(n.target);if("td"===ct(r)||"th"===ct(r)){var o=t.get(),i=e.get();qn(o,r)&&n.timeStamp-i<300&&(n.preventDefault(),v(r,r))}t.set(r),e.set(n.timeStamp)};return{touchEnd:r}},_=A();t.on("mousedown",T),t.on("mouseover",E),t.on("mouseup",D),t.on("touchend",_.touchEnd),t.on("keyup",w),t.on("keydown",x),t.on("NodeChange",m),c=p.some(a({mousedown:T,mouseover:E,mouseup:D,keyup:w,keydown:x}))}));var m=function(){c.each((function(t){}))};return{clear:d.clear,destroy:m}}var Qv=function(t){var n=function(){var n=zf(t);return ui.retrieve(n,gi.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?yi.none():yi.single(t.selection)}),(function(t){return yi.multiple(t)}))};return{get:n}},Zv=function(t,e){var r=n(p.none()),o=n([]),i=function(){return Gd(t).bind((function(t){var n=ur.table(t);return n.map((function(n){return"caption"===ct(t)?Ai.notCell(t):Ai.forMenu(e,n,t)}))}))},u=function(){r.set(Et(i)()),R(o.get(),(function(t){return t()}))},a=function(t,n){var e=function(){return r.get().fold((function(){t.setDisabled(!0)}),(function(e){t.setDisabled(n(e))}))};return e(),o.set(o.get().concat([e])),function(){o.set(I(o.get(),(function(t){return t!==e})))}},c=function(t){return a(t,(function(t){return!1}))},s=function(t){return a(t,(function(t){return"caption"===ct(t.element())}))},f=function(t){return a(t,(function(t){return t.mergable().isNone()}))},l=function(t){return a(t,(function(t){return t.unmergable().isNone()}))};return t.on("NodeChange TableSelectorChange",u),{onSetupTable:c,onSetupCellOrRow:s,onSetupMergeable:f,onSetupUnmergeable:l,resetTargets:u,targets:function(){return r.get()}}},tb=function(t,n){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable | cell row column | advtablesort | tableprops deletetable")}});var e=function(n){return function(){return t.execCommand(n)}};t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:e("mceInsertTable"),icon:"table"})},nb=function(t){var n=function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},e=hl(t);e.length>0&&t.ui.registry.addContextToolbar("table",{predicate:n,items:e,scope:"node",position:"node"})},eb={addButtons:tb,addToolbars:nb},rb=function(t,n){var e=function(n){return function(){return t.execCommand(n)}},r=function(n){var e=n.numRows,r=n.numColumns;t.undoManager.transact((function(){Nd.insert(t,r,e)})),t.addVisual()},o={text:"Table properties",onSetup:n.onSetupTable,onAction:e("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:e("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:e("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:e("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:e("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:e("mceTableRowProps"),onSetup:n.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:e("mceTableCutRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:e("mceTableCopyRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:e("mceTablePasteRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:e("mceTablePasteRowAfter"),onSetup:n.onSetupCellOrRow}],a={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},c=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:e("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:e("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:e("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}],s={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return c}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:e("mceTableCellProps"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:e("mceTableMergeCells"),onSetup:n.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:e("mceTableSplitCells"),onSetup:n.onSetupUnmergeable}],l={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};!1===sl(t)?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:e("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:e("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",a),t.ui.registry.addNestedMenuItem("column",s),t.ui.registry.addNestedMenuItem("cell",l),t.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold((function(){return""}),(function(t){return"caption"===ct(t.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})},ob={addMenuItems:rb},ib=function(t){return t.get().fold((function(){}),(function(t){return _(t,(function(t){return t.dom()}))}))},ub=function(t,n){var e=_(t,It.fromDom);n.set(p.from(e))},ab=function(t,n,e,r){return{insertTable:function(n,e){return Nd.insert(t,n,e)},setClipboardRows:function(t){return ub(t,n)},getClipboardRows:function(){return ib(n)},resizeHandler:e,selectionTargets:r}};function cb(t){var e=Qv(t),r=Zv(t,e),o=Wm(t),i=Jv(t,o.lazyResize,r),u=Ol(t,o.lazyWire),a=n(p.none());return Yd.registerCommands(t,u,i,e,a),Pi.registerEvents(t,e,u,i),ob.addMenuItems(t,r),eb.addButtons(t,r),eb.addToolbars(t),t.on("PreInit",(function(){t.serializer.addTempAttr(gi.firstSelected()),t.serializer.addTempAttr(gi.lastSelected())})),ol(t)&&t.on("keydown",(function(n){Op.handle(n,t,u,o.lazyWire)})),t.on("remove",(function(){o.destroy(),i.destroy()})),ab(t,a,o,r)}function sb(){h.add("table",cb)}sb()})(window)},bc54:function(t,n,e){e("7c4f")},be7f:function(t,n,e){(function(t){(function(n){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.util.VK"),o=function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},i=function(t){return function(n){return o(n)===t}},u=i("string"),a=i("array"),c=i("boolean"),s=i("function"),f=function(t){var n=t.getParam("link_assume_external_targets",!1);return c(n)&&n?1:!u(n)||"http"!==n&&"https"!==n?0:n},l=function(t){return t.getParam("link_context_toolbar",!1,"boolean")},d=function(t){return t.getParam("link_list")},m=function(t){return t.getParam("default_link_target")},g=function(t){return t.getParam("target_list",!0)},p=function(t){return t.getParam("rel_list",[],"array")},h=function(t){return t.getParam("link_class_list",[],"array")},v=function(t){return t.getParam("link_title",!0,"boolean")},b=function(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")},y=function(t){return t.getParam("link_quicklink",!1,"boolean")},w={assumeExternalTargets:f,hasContextToolbar:l,getLinkList:d,getDefaultLinkTarget:m,getTargetList:g,getRelList:p,getLinkClassList:h,shouldShowLinkTitle:v,allowUnsafeLinkTarget:b,useQuickLink:y},x=function(t,e){n.document.body.appendChild(t),t.dispatchEvent(e),n.document.body.removeChild(t)},C=function(t){var e=n.document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var r=n.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.window,0,0,0,0,0,!1,!1,!1,!1,0,null),x(e,r)},S={open:C},k=function(){return k=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e],n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},k.apply(this,arguments)},O=function(){},T=function(t){return function(){return t}},E=T(!1),D=T(!0),A=function(){return _},_=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:E,isSome:E,isNone:D,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:T(null),getOrUndefined:T(void 0),or:e,orThunk:n,map:A,each:O,bind:A,exists:E,forall:D,filter:A,equals:t,equals_:t,toArray:function(){return[]},toString:T("none()")};return Object.freeze&&Object.freeze(r),r}(),R=function(t){var n=T(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:D,isNone:E,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return R(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:_},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(E,(function(n){return e(t,n)}))}};return o},B=function(t){return null===t||void 0===t?_:R(t)},I={some:R,none:A,from:B},P=Array.prototype.slice,N=Array.prototype.indexOf,M=Array.prototype.push,F=function(t,n){return N.call(t,n)},L=function(t,n){return F(t,n)>-1},H=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},z=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];n(o,e)}},V=function(t,n,e){return z(t,(function(t){e=n(e,t)})),e},j=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!a(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);M.apply(n,t[e])}return n},U=function(t,n){var e=H(t,n);return j(e)},W=(s(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),G=function(t){return/^\w+:/i.test(t)},q=function(t){var n=t.getAttribute("data-mce-href");return n||t.getAttribute("href")},X=function(t,n){var e=["noopener"],r=t?t.split(/\s+/):[],o=function(t){return W.trim(t.sort().join(" "))},i=function(t){return t=u(t),t.length>0?t.concat(e):e},u=function(t){return t.filter((function(t){return-1===W.inArray(e,t)}))},a=n?i(r):u(r);return a.length>0?o(a):""},Y=function(t){return t.replace(/\uFEFF/g,"")},K=function(t,n){return n=n||t.selection.getNode(),tt(n)?t.dom.select("a[href]",n)[0]:t.dom.getParent(n,"a[href]")},$=function(t,n){var e=n?n.innerText||n.textContent:t.getContent({format:"text"});return Y(e)},J=function(t){return t&&"A"===t.nodeName&&!!t.href},Q=function(t){return W.grep(t,J).length>0},Z=function(t){return!(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||-1===t.indexOf("href=")))},tt=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},nt=function(t){return V(["title","rel","class","target"],(function(n,e){return t[e].each((function(t){n[e]=t.length>0?t:null})),n}),{href:t.href})},et=function(t,n){return"http"!==n&&"https"!==n||G(t)?t:n+"://"+t},rt=function(t,n){var e=k({},n);if(!(w.getRelList(t).length>0)&&!1===w.allowUnsafeLinkTarget(t)){var r=X(e.rel,"_blank"===e.target);e.rel=r||null}return I.from(e.target).isNone()&&!1===w.getTargetList(t)&&(e.target=w.getDefaultLinkTarget(t)),e.href=et(e.href,w.assumeExternalTargets(t)),e},ot=function(t,n,e,r){e.each((function(t){n.hasOwnProperty("innerText")?n.innerText=t:n.textContent=t})),t.dom.setAttribs(n,r),t.selection.select(n)},it=function(t,n,e,r){tt(n)?st(t,n,r):e.fold((function(){t.execCommand("mceInsertLink",!1,r)}),(function(n){t.insertContent(t.dom.createHTML("a",r,t.dom.encode(n)))}))},ut=function(t,n,e){var r=t.selection.getNode(),o=K(t,r),i=rt(t,nt(e));t.undoManager.transact((function(){e.href===n.href&&n.attach(),o?(t.focus(),ot(t,o,e.text,i)):it(t,r,e.text,i)}))},at=function(t){t.undoManager.transact((function(){var n=t.selection.getNode();if(tt(n))ct(t,n);else{var e=t.dom.getParent(n,"a[href]",t.getBody());e&&t.dom.remove(e,!0)}t.focus()}))},ct=function(t,n){var e=t.dom.select("img",n)[0];if(e){var r=t.dom.getParents(e,"a[href]",n)[0];r&&(r.parentNode.insertBefore(e,r),t.dom.remove(r))}},st=function(t,n,e){var r=t.dom.select("img",n)[0];if(r){var o=t.dom.create("a",e);r.parentNode.insertBefore(o,r),o.appendChild(r)}},ft={link:ut,unlink:at,isLink:J,hasLinks:Q,getHref:q,isOnlyTextSelected:Z,getAnchorElement:K,getAnchorText:$,applyRelTargetRules:X,hasProtocol:G},lt=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},dt=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return I.none()},mt=function(t){return u(t.value)?t.value:""},gt=function(t,n){var e=[];return W.each(t,(function(t){var r=u(t.text)?t.text:u(t.title)?t.title:"";if(void 0!==t.menu);else{var o=n(t);e.push({text:r,value:o})}})),e},pt=function(t){return void 0===t&&(t=mt),function(n){return I.from(n).map((function(n){return gt(n,t)}))}},ht=function(t){return pt(mt)(t)},vt=function(t,n){return function(e){return{name:t,type:"selectbox",label:n,items:e}}},bt={sanitize:ht,sanitizeWith:pt,createUi:vt,getValue:mt},yt=function(t){var n=t,e=function(){return n},r=function(t){n=t},o=function(){return yt(e())};return{get:e,set:r,clone:o}},wt=function(t,n){return dt(n,(function(n){return I.some(n).filter((function(n){return n.value===t}))}))},xt=function(t,n,e,r){var o=r[n],i=t.length>0;return void 0!==o?wt(o,e).map((function(n){return{url:{value:n.value,meta:{text:i?t:n.text,attach:O}},text:i?t:n.text}})):I.none()},Ct=function(t,n){return"link"===n?t.catalogs.link:"anchor"===n?t.catalogs.anchor:I.none()},St=function(t,n){var e=yt(t.text),r=function(t){if(e.get().length<=0){var n=void 0!==t.url.meta.text?t.url.meta.text:t.url.value;return I.some({text:n})}return I.none()},o=function(t,r){var o=Ct(n,r.name).getOr([]);return xt(e.get(),r.name,o,t)},i=function(t,n){return"url"===n.name?r(t()):L(["anchor","link"],n.name)?o(t(),n):"text"===n.name?(e.set(t().text),I.none()):I.none()};return{onChange:i}},kt={init:St,getDelta:xt},Ot={},Tt={exports:Ot};(function(n,e,r,o){(function(o){if("object"===typeof e&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof n&&n.amd)n([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(n,e,r){function i(a,c){if(!e[a]){if(!n[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};n[a][0].call(l.exports,(function(t){var e=n[a][1][t];return i(e||t)}),l,l.exports,t,n,e,r)}return e[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,n,e){var r,o,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var t=c(g);d=!0;var n=l.length;while(n){f=l,l=[];while(++m<n)f&&f[m].run();m=-1,n=l.length}f=null,d=!1,s(t)}}function h(t,n){this.fun=t,this.array=n}function v(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new h(t,n)),1!==l.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){(function(e){var r=setTimeout;function o(){}function i(t,n){return function(){t.apply(n,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,n){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(o){return void s(n.promise,o)}c(n.promise,r)}else(1===t._state?c:s)(n.promise,t._value)}))):t._deferreds.push(n)}function c(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void f(t);if("function"===typeof e)return void d(i(e,n),t)}t._state=1,t._value=n,f(t)}catch(r){s(t,r)}}function s(t,n){t._state=2,t._value=n,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)a(t,t._deferreds[n]);t._deferreds=null}function l(t,n,e){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof n?n:null,this.promise=e}function d(t,n){var e=!1;try{t((function(t){e||(e=!0,c(n,t))}),(function(t){e||(e=!0,s(n,t))}))}catch(r){if(e)return;e=!0,s(n,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,n){var e=new this.constructor(o);return a(this,new l(t,n,e)),e},u.all=function(t){var n=Array.prototype.slice.call(t);return new u((function(t,e){if(0===n.length)return t([]);var r=n.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),e)}n[i]=u,0===--r&&t(n)}catch(c){e(c)}}for(var i=0;i<n.length;i++)o(i,n[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(n){n(t)}))},u.reject=function(t){return new u((function(n,e){e(t)}))},u.race=function(t){return new u((function(n,e){for(var r=0,o=t.length;r<o;r++)t[r].then(n,e)}))},u._immediateFn="function"===typeof t?function(n){t(n)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof n&&n.exports?n.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"===typeof n?n:function(t){var n=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,o((function(){a[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();n.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,Ot,Tt,void 0);var Et=Tt.exports.boltExport,Dt=function(t){var e=I.none(),r=[],o=function(t){return Dt((function(n){i((function(e){n(t(e))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){e=I.some(t),c(r),r=[]},a=function(){return e.isSome()},c=function(t){z(t,s)},s=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t(u),{get:i,map:o,isReady:a}},At=function(t){return Dt((function(n){n(t)}))},_t={nu:Dt,pure:At},Rt=function(t){n.setTimeout((function(){throw t}),0)},Bt=function(t){var n=function(n){t().then(n,Rt)},e=function(n){return Bt((function(){return t().then(n)}))},r=function(n){return Bt((function(){return t().then((function(t){return n(t).toPromise()}))}))},o=function(n){return Bt((function(){return t().then((function(){return n.toPromise()}))}))},i=function(){return _t.nu(n)},u=function(){var n=null;return Bt((function(){return null===n&&(n=t()),n}))},a=t;return{map:e,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:n}},It=function(t){return Bt((function(){return new Et(t)}))},Pt=function(t){return Bt((function(){return Et.resolve(t)}))},Nt={nu:It,pure:Pt},Mt=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ft=function(t,n,e){var r=t.selection.getRng();Mt.setEditorTimeout(t,(function(){t.windowManager.confirm(n,(function(n){t.selection.setRng(r),e(n)}))}))},Lt=function(t){var n=t.href,e=n.indexOf("@")>0&&-1===n.indexOf("//")&&-1===n.indexOf("mailto:");return e?I.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return k(k({},t),{href:"mailto:"+n})}}):I.none()},Ht=function(t){return function(n){var e=n.href,r=1===t&&!ft.hasProtocol(e)||0===t&&/^\s*www[\.|\d\.]/i.test(e);return r?I.some({message:"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",preprocess:function(t){return k(k({},t),{href:"http://"+e})}}):I.none()}},zt=function(t,n,e){return dt([Lt,Ht(n)],(function(t){return t(e)})).fold((function(){return Nt.pure(e)}),(function(n){return Nt.nu((function(r){Ft(t,n.message,(function(t){r(t?n.preprocess(e):e)}))}))}))},Vt={preprocess:zt},jt=function(t){var n=t.dom.select("a:not([href])"),e=U(n,(function(t){var n=t.name||t.id;return n?[{text:n,value:"#"+n}]:[]}));return e.length>0?I.some([{text:"None",value:""}].concat(e)):I.none()},Ut={getAnchors:jt},Wt=function(t){var n=w.getLinkClassList(t);return n.length>0?bt.sanitize(n):I.none()},Gt={getClasses:Wt},qt=tinymce.util.Tools.resolve("tinymce.util.XHR"),Xt=function(t){try{return I.some(JSON.parse(t))}catch(n){return I.none()}},Yt=function(t){var n=function(n){return t.convertURL(n.value||n.url,"href")},e=w.getLinkList(t);return Nt.nu((function(t){u(e)?qt.send({url:e,success:function(n){return t(Xt(n))},error:function(n){return t(I.none())}}):s(e)?e((function(n){return t(I.some(n))})):t(I.from(e))})).map((function(t){return t.bind(bt.sanitizeWith(n)).map((function(t){return t.length>0?[{text:"None",value:""}].concat(t):t}))}))},Kt={getLinks:Yt},$t=function(t,n){var e=w.getRelList(t);if(e.length>0){var r=n.is("_blank"),o=!1===w.allowUnsafeLinkTarget(t),i=function(t){return ft.applyRelTargetRules(bt.getValue(t),r)},u=o?bt.sanitizeWith(i):bt.sanitize;return u(e)}return I.none()},Jt={getRels:$t},Qt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Zt=function(t){var n=w.getTargetList(t);return a(n)?bt.sanitize(n).orThunk((function(){return I.some(Qt)})):!1===n?I.none():I.some(Qt)},tn={getTargets:Zt},nn=function(t,n,e){var r=t.getAttrib(n,e);return null!==r&&r.length>0?I.some(r):I.none()},en=function(t,n){var e=t.dom,r=ft.isOnlyTextSelected(t.selection.getContent()),o=r?I.some(ft.getAnchorText(t.selection,n)):I.none(),i=n?I.some(e.getAttrib(n,"href")):I.none(),u=n?I.from(e.getAttrib(n,"target")):I.none(),a=nn(e,n,"rel"),c=nn(e,n,"class"),s=nn(e,n,"title");return{url:i,text:o,title:s,target:u,rel:a,linkClass:c}},rn=function(t,n){return Kt.getLinks(t).map((function(e){var r=en(t,n);return{anchor:r,catalogs:{targets:tn.getTargets(t),rels:Jt.getRels(t,r.target),classes:Gt.getClasses(t),anchor:Ut.getAnchors(t),link:e},optNode:I.from(n),flags:{titleEnabled:w.shouldShowLinkTitle(t)}}}))},on={collect:rn},un=function(t,n,e){return function(r){var o=r.getData();if(!o.url.value)return ft.unlink(t),void r.close();var i=function(t){return I.from(o[t]).filter((function(e){return!n.anchor[t].is(e)}))},u={href:o.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},a={href:o.url.value,attach:void 0!==o.url.meta&&o.url.meta.attach?o.url.meta.attach:function(){}};Vt.preprocess(t,e,u).get((function(n){ft.link(t,a,n)})),r.close()}},an=function(t){var n=ft.getAnchorElement(t);return on.collect(t,n)},cn=function(t,n){return{url:{value:t.anchor.url.getOr(""),meta:{attach:function(){},text:t.anchor.url.fold((function(){return""}),(function(){return t.anchor.text.getOr("")})),original:{value:t.anchor.url.getOr("")}}},text:t.anchor.text.getOr(""),title:t.anchor.title.getOr(""),anchor:t.anchor.url.getOr(""),link:t.anchor.url.getOr(""),rel:t.anchor.rel.getOr(""),target:t.anchor.target.or(n).getOr(""),linkClass:t.anchor.linkClass.getOr("")}},sn=function(t,n,e){var r=[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],o=t.anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),i=t.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],u=I.from(w.getDefaultLinkTarget(e)),a=cn(t,u),c=kt.init(a,t),s=t.catalogs,f={type:"panel",items:j([r,o,i,lt([s.anchor.map(bt.createUi("anchor","Anchors")),s.rels.map(bt.createUi("rel","Rel")),s.targets.map(bt.createUi("target","Open link in...")),s.link.map(bt.createUi("link","Link list")),s.classes.map(bt.createUi("linkClass","Class"))])])};return{title:"Insert/Edit Link",size:"normal",body:f,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onChange:function(t,n){var e=n.name;c.onChange(t.getData,{name:e}).each((function(n){t.setData(n)}))},onSubmit:n}},fn=function(t){var n=an(t);n.map((function(n){var e=un(t,n,w.assumeExternalTargets(t));return sn(n,e,t)})).get((function(n){t.windowManager.open(n)}))},ln={open:fn},dn=function(t,n){return t.dom.getParent(n,"a[href]")},mn=function(t){return dn(t,t.selection.getStart())},gn=function(t){return!0===t.altKey&&!1===t.shiftKey&&!1===t.ctrlKey&&!1===t.metaKey},pn=function(t,n){if(n){var e=ft.getHref(n);if(/^#/.test(e)){var r=t.$(e);r.length&&t.selection.scrollIntoView(r[0],!0)}else S.open(n.href)}},hn=function(t){return function(){ln.open(t)}},vn=function(t){return function(){pn(t,mn(t))}},bn=function(t){return function(n){var e,r,o;return!!(w.hasContextToolbar(t)&&ft.isLink(n)&&(e=t.selection,r=e.getRng(),o=r.startContainer,3===o.nodeType&&e.isCollapsed()&&r.startOffset>0&&r.startOffset<o.data.length))}},yn=function(t){t.on("click",(function(n){var e=dn(t,n.target);e&&r.metaKeyPressed(n)&&(n.preventDefault(),pn(t,e))})),t.on("keydown",(function(n){var e=mn(t);e&&13===n.keyCode&&gn(n)&&(n.preventDefault(),pn(t,e))}))},wn=function(t){return function(n){var e=function(e){return n.setActive(!t.readonly&&!!ft.getAnchorElement(t,e.element))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}},xn=function(t){return function(n){n.setDisabled(!ft.hasLinks(t.dom.getParents(t.selection.getStart())));var e=function(t){return n.setDisabled(!ft.hasLinks(t.parents))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}},Cn={openDialog:hn,gotoSelectedLink:vn,leftClickedOnAHref:bn,setupGotoLinks:yn,toggleActiveState:wn,toggleEnabledState:xn},Sn=function(t){t.addCommand("mceLink",(function(){w.useQuickLink(t)?t.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):Cn.openDialog(t)()}))},kn={register:Sn},On=function(t){t.addShortcut("Meta+K","",(function(){t.execCommand("mceLink")}))},Tn={setup:On},En=function(t){t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:Cn.openDialog(t),onSetup:Cn.toggleActiveState(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:Cn.gotoSelectedLink(t),onSetup:Cn.toggleEnabledState(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return ft.unlink(t)},onSetup:Cn.toggleEnabledState(t)})},Dn=function(t){t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Cn.gotoSelectedLink(t),onSetup:Cn.toggleEnabledState(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Cn.openDialog(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return ft.unlink(t)},onSetup:Cn.toggleEnabledState(t)})},An=function(t){var n="link unlink openlink",e="link";t.ui.registry.addContextMenu("link",{update:function(r){return ft.hasLinks(t.dom.getParents(r,"a"))?n:e}})},_n=function(t){var n=function(t){t.selection.collapse(!1)},e=function(n){var e=t.selection.getNode();return n.setDisabled(!ft.getAnchorElement(t,e)),function(){}};t.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Cn.toggleActiveState(t)},label:"Link",predicate:function(n){return!!ft.getAnchorElement(t,n)&&w.hasContextToolbar(t)},initValue:function(){var n=ft.getAnchorElement(t);return n?ft.getHref(n):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(n){var e=t.selection.getNode();return n.setActive(!!ft.getAnchorElement(t,e)),Cn.toggleActiveState(t)(n)},onAction:function(e){var r=ft.getAnchorElement(t),o=e.getValue();if(r)t.dom.setAttrib(r,"href",o),n(t),e.hide();else{var i={href:o,attach:function(){}},u=ft.isOnlyTextSelected(t.selection.getContent()),a=u?I.some(ft.getAnchorText(t.selection,r)).filter((function(t){return t.length>0})).or(I.from(o)):I.none();ft.link(t,i,{href:o,text:a,title:I.none(),rel:I.none(),target:I.none(),class:I.none()}),e.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:e,onAction:function(n){ft.unlink(t),n.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:e,onAction:function(n){Cn.gotoSelectedLink(t)(),n.hide()}}]})},Rn={setupButtons:En,setupMenuItems:Dn,setupContextMenu:An,setupContextToolbars:_n};function Bn(){e.add("link",(function(t){Rn.setupButtons(t),Rn.setupMenuItems(t),Rn.setupContextMenu(t),Rn.setupContextToolbars(t),Cn.setupGotoLinks(t),kn.register(t),Tn.setup(t)}))}Bn()})(window)}).call(this,e("c8ba"))},cdd9:function(t,n,e){(function(t){(function(n){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(){},o=function(t){return function(){return t}},i=function(t){return t},u=function(t){return function(){throw new Error(t)}},a=o(!1),c=o(!0),s=function(){return f},f=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},i={fold:function(t,n){return t()},is:a,isSome:a,isNone:c,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:e,orThunk:n,map:s,each:r,bind:s,exists:a,forall:c,filter:s,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(i),i}(),l=function(t){var n=o(t),e=function(){return i},r=function(n){return n(t)},i={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:c,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return l(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?i:f},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(a,(function(n){return e(t,n)}))}};return i},d=function(t){return null===t||void 0===t?f:l(t)},m={some:l,none:s,from:d},g=function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},p=function(t){return function(n){return g(n)===t}},h=p("string"),v=p("object"),b=p("array"),y=p("boolean"),w=p("function"),x=Array.prototype.slice,C=Array.prototype.push,S=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];n(o,e)}},k=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!b(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);C.apply(n,t[e])}return n},O=function(t){return 0===t.length?m.none():m.some(t[0])},T=(w(Array.from)&&Array.from,function(){return T=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e],n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},T.apply(this,arguments)}),E={},D={exports:E};(function(n,e,r,o){(function(o){if("object"===typeof e&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof n&&n.amd)n([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(n,e,r){function i(a,c){if(!e[a]){if(!n[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};n[a][0].call(l.exports,(function(t){var e=n[a][1][t];return i(e||t)}),l,l.exports,t,n,e,r)}return e[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,n,e){var r,o,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var t=c(g);d=!0;var n=l.length;while(n){f=l,l=[];while(++m<n)f&&f[m].run();m=-1,n=l.length}f=null,d=!1,s(t)}}function h(t,n){this.fun=t,this.array=n}function v(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new h(t,n)),1!==l.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){(function(e){var r=setTimeout;function o(){}function i(t,n){return function(){t.apply(n,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,n){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(o){return void s(n.promise,o)}c(n.promise,r)}else(1===t._state?c:s)(n.promise,t._value)}))):t._deferreds.push(n)}function c(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void f(t);if("function"===typeof e)return void d(i(e,n),t)}t._state=1,t._value=n,f(t)}catch(r){s(t,r)}}function s(t,n){t._state=2,t._value=n,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)a(t,t._deferreds[n]);t._deferreds=null}function l(t,n,e){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof n?n:null,this.promise=e}function d(t,n){var e=!1;try{t((function(t){e||(e=!0,c(n,t))}),(function(t){e||(e=!0,s(n,t))}))}catch(r){if(e)return;e=!0,s(n,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,n){var e=new this.constructor(o);return a(this,new l(t,n,e)),e},u.all=function(t){var n=Array.prototype.slice.call(t);return new u((function(t,e){if(0===n.length)return t([]);var r=n.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),e)}n[i]=u,0===--r&&t(n)}catch(c){e(c)}}for(var i=0;i<n.length;i++)o(i,n[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(n){n(t)}))},u.reject=function(t){return new u((function(n,e){e(t)}))},u.race=function(t){return new u((function(n,e){for(var r=0,o=t.length;r<o;r++)t[r].then(n,e)}))},u._immediateFn="function"===typeof t?function(n){t(n)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof n&&n.exports?n.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"===typeof n?n:function(t){var n=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,o((function(){a[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();n.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,E,D,void 0);var A=D.exports.boltExport,_=function(t){var e=m.none(),r=[],o=function(t){return _((function(n){i((function(e){n(t(e))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){e=m.some(t),c(r),r=[]},a=function(){return e.isSome()},c=function(t){S(t,s)},s=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t(u),{get:i,map:o,isReady:a}},R=function(t){return _((function(n){n(t)}))},B={nu:_,pure:R},I=function(t){n.setTimeout((function(){throw t}),0)},P=function(t){var n=function(n){t().then(n,I)},e=function(n){return P((function(){return t().then(n)}))},r=function(n){return P((function(){return t().then((function(t){return n(t).toPromise()}))}))},o=function(n){return P((function(){return t().then((function(){return n.toPromise()}))}))},i=function(){return B.nu(n)},u=function(){var n=null;return P((function(){return null===n&&(n=t()),n}))},a=t;return{map:e,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:n}},N=function(t){return P((function(){return new A(t)}))},M=function(t){return P((function(){return A.resolve(t)}))},F={nu:N,pure:M},L=function(t){var n=function(n){return t===n},e=function(n){return L(t)},r=function(n){return L(t)},i=function(n){return L(n(t))},u=function(n){return L(t)},s=function(n){n(t)},f=function(n){return n(t)},l=function(n,e){return e(t)},d=function(n){return n(t)},g=function(n){return n(t)},p=function(){return m.some(t)};return{is:n,isValue:c,isError:a,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:e,orThunk:r,fold:l,map:i,mapError:u,each:s,bind:f,exists:d,forall:g,toOption:p}},H=function(t){var n=function(t){return t()},e=function(){return u(String(t))()},o=function(t){return t},s=function(t){return t()},f=function(n){return H(t)},l=function(n){return H(n(t))},d=function(n){return H(t)},g=function(n,e){return n(t)};return{is:a,isValue:a,isError:c,getOr:i,getOrThunk:n,getOrDie:e,or:o,orThunk:s,fold:g,map:f,mapError:l,each:r,bind:d,exists:a,forall:c,toOption:m.none}},z=function(t,n){return t.fold((function(){return H(n)}),L)},V={value:L,error:H,fromOption:z},j=function(t){var e=function(){return j(t.toCached())},r=function(n){return j(t.bind((function(t){return t.fold((function(t){return F.pure(V.error(t))}),(function(t){return n(t)}))})))},o=function(n){return j(t.map((function(t){return t.bind(n)})))},i=function(n){return j(t.map((function(t){return t.map(n)})))},u=function(n){return j(t.map((function(t){return t.mapError(n)})))},a=function(n,e){return t.map((function(t){return t.fold(n,e)}))},c=function(e,r){return j(F.nu((function(o){var i=!1,u=n.setTimeout((function(){i=!0,o(V.error(r()))}),e);t.get((function(t){i||(n.clearTimeout(u),o(t))}))})))};return T(T({},t),{toCached:e,bindFuture:r,bindResult:o,mapResult:i,mapError:u,foldResult:a,withTimeout:c})},U=function(t){return j(F.nu(t))},W=function(t){return j(F.pure(V.value(t)))},G=function(t){return j(F.pure(V.error(t)))},q=function(t){return j(F.pure(t))},X=function(t){return j(t.map(V.value))},Y=function(t){return U((function(n){t.then((function(t){n(V.value(t))}),(function(t){n(V.error(t))}))}))},K={nu:U,wrap:j,pure:W,value:W,error:G,fromResult:q,fromFuture:X,fromPromise:Y},$=Object.prototype.hasOwnProperty,J=function(t,n){return n},Q=function(t,n){var e=v(t)&&v(n);return e?tt(t,n):n},Z=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)$.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},tt=Z(Q),nt=Z(J),et=function(t){var n={name:"src",type:"urlinput",filetype:"image",label:"Source"},e=t.imageList.map((function(t){return{name:"images",type:"selectbox",label:"Image list",items:t}})),r={name:"alt",type:"input",label:"Image description"},o={name:"title",type:"input",label:"Image title"},i={name:"dimensions",type:"sizeinput"},u=t.classList.map((function(t){return{name:"classes",type:"selectbox",label:"Class",items:t}})),a={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]};return k([[n],e.toArray(),t.hasDescription?[r]:[],t.hasImageTitle?[o]:[],t.hasDimensions?[i]:[],[{type:"grid",columns:2,items:k([u.toArray(),t.hasImageCaption?[a]:[]])}]])},rt=function(t){return{title:"General",name:"general",items:et(t)}},ot={makeTab:rt,makeItems:et},it=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ut=tinymce.util.Tools.resolve("tinymce.util.Promise"),at=tinymce.util.Tools.resolve("tinymce.util.XHR"),ct=function(t){return t.getParam("image_dimensions",!0,"boolean")},st=function(t){return t.getParam("image_advtab",!1,"boolean")},ft=function(t){return t.getParam("image_uploadtab",!0,"boolean")},lt=function(t){return t.getParam("image_prepend_url","","string")},dt=function(t){return t.getParam("image_class_list")},mt=function(t){return t.getParam("image_description",!0,"boolean")},gt=function(t){return t.getParam("image_title",!1,"boolean")},pt=function(t){return t.getParam("image_caption",!1,"boolean")},ht=function(t){return t.getParam("image_list",!1)},vt=function(t){return!!yt(t)},bt=function(t){return!!wt(t)},yt=function(t){return t.getParam("images_upload_url","","string")},wt=function(t){return t.getParam("images_upload_handler",void 0,"function")},xt=function(t){return t.getParam("images_upload_base_path",void 0,"string")},Ct=function(t){return t.getParam("images_upload_credentials",!1,"boolean")},St={hasDimensions:ct,hasUploadTab:ft,hasAdvTab:st,getPrependUrl:lt,getClassList:dt,hasDescription:mt,hasImageTitle:gt,hasImageCaption:pt,getImageList:ht,hasUploadUrl:vt,hasUploadHandler:bt,getUploadUrl:yt,getUploadHandler:wt,getUploadBasePath:xt,getUploadCredentials:Ct},kt=function(t,n){return Math.max(parseInt(t,10),parseInt(n,10))},Ot=function(t,e){var r=n.document.createElement("img"),o=function(t){r.parentNode&&r.parentNode.removeChild(r),e(t)};r.onload=function(){var t=kt(r.width,r.clientWidth),n=kt(r.height,r.clientHeight),e={width:t,height:n};o(V.value(e))},r.onerror=function(){o(V.error("Failed to get image dimensions for: "+t))};var i=r.style;i.visibility="hidden",i.position="fixed",i.bottom=i.left="0px",i.width=i.height="auto",n.document.body.appendChild(r),r.src=t},Tt=function(t){return t&&(t=t.replace(/px$/,"")),t},Et=function(t){return t.length>0&&/^[0-9]+$/.test(t)&&(t+="px"),t},Dt=function(t){if(t.margin){var n=String(t.margin).split(" ");switch(n.length){case 1:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[0],t["margin-bottom"]=t["margin-bottom"]||n[0],t["margin-left"]=t["margin-left"]||n[0];break;case 2:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[1],t["margin-bottom"]=t["margin-bottom"]||n[0],t["margin-left"]=t["margin-left"]||n[1];break;case 3:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[1],t["margin-bottom"]=t["margin-bottom"]||n[2],t["margin-left"]=t["margin-left"]||n[1];break;case 4:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[1],t["margin-bottom"]=t["margin-bottom"]||n[2],t["margin-left"]=t["margin-left"]||n[3]}delete t.margin}return t},At=function(t,n){var e=St.getImageList(t);"string"===typeof e?at.send({url:e,success:function(t){n(JSON.parse(t))}}):"function"===typeof e?e(n):n(e)},_t=function(t,n,e){var r=function(){e.onload=e.onerror=null,t.selection&&(t.selection.select(e),t.nodeChanged())};e.onload=function(){n.width||n.height||!St.hasDimensions(t)||t.dom.setAttribs(e,{width:String(e.clientWidth),height:String(e.clientHeight)}),r()},e.onerror=r},Rt=function(t){return new ut((function(e,r){var o=new n.FileReader;o.onload=function(){e(o.result)},o.onerror=function(){r(o.error.message)},o.readAsDataURL(t)}))},Bt=function(t){return"IMG"===t.nodeName&&(t.hasAttribute("data-mce-object")||t.hasAttribute("data-mce-placeholder"))},It={getImageSize:Ot,removePixelSuffix:Tt,addPixelSuffix:Et,mergeMargins:Dt,createImageList:At,waitLoadImage:_t,blobToDataUri:Rt,isPlaceholderImage:Bt},Pt=it.DOM,Nt=function(t){return t.style.marginLeft&&t.style.marginRight&&t.style.marginLeft===t.style.marginRight?It.removePixelSuffix(t.style.marginLeft):""},Mt=function(t){return t.style.marginTop&&t.style.marginBottom&&t.style.marginTop===t.style.marginBottom?It.removePixelSuffix(t.style.marginTop):""},Ft=function(t){return t.style.borderWidth?It.removePixelSuffix(t.style.borderWidth):""},Lt=function(t,n){return t.hasAttribute(n)?t.getAttribute(n):""},Ht=function(t,n){return t.style[n]?t.style[n]:""},zt=function(t){return null!==t.parentNode&&"FIGURE"===t.parentNode.nodeName},Vt=function(t,n,e){t.setAttribute(n,e)},jt=function(t){var n=Pt.create("figure",{class:"image"});Pt.insertAfter(n,t),n.appendChild(t),n.appendChild(Pt.create("figcaption",{contentEditable:"true"},"Caption")),n.contentEditable="false"},Ut=function(t){var n=t.parentNode;Pt.insertAfter(t,n),Pt.remove(n)},Wt=function(t){zt(t)?Ut(t):jt(t)},Gt=function(t,n){var e=t.getAttribute("style"),r=n(null!==e?e:"");r.length>0?(t.setAttribute("style",r),t.setAttribute("data-mce-style",r)):t.removeAttribute("style")},qt=function(t,n){return function(t,e,r){t.style[e]?(t.style[e]=It.addPixelSuffix(r),Gt(t,n)):Vt(t,e,r)}},Xt=function(t,n){return t.style[n]?It.removePixelSuffix(t.style[n]):Lt(t,n)},Yt=function(t,n){var e=It.addPixelSuffix(n);t.style.marginLeft=e,t.style.marginRight=e},Kt=function(t,n){var e=It.addPixelSuffix(n);t.style.marginTop=e,t.style.marginBottom=e},$t=function(t,n){var e=It.addPixelSuffix(n);t.style.borderWidth=e},Jt=function(t,n){t.style.borderStyle=n},Qt=function(t){return Ht(t,"borderStyle")},Zt=function(t){return"FIGURE"===t.nodeName},tn=function(t){return"IMG"===t.nodeName},nn=function(){return{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""}},en=function(t,e){var r=n.document.createElement("img");return Vt(r,"style",e.style),(Nt(r)||""!==e.hspace)&&Yt(r,e.hspace),(Mt(r)||""!==e.vspace)&&Kt(r,e.vspace),(Ft(r)||""!==e.border)&&$t(r,e.border),(Qt(r)||""!==e.borderStyle)&&Jt(r,e.borderStyle),t(r.getAttribute("style"))},rn=function(t,e){var r=n.document.createElement("img");if(cn(t,nt(e,{caption:!1}),r),Vt(r,"alt",e.alt),e.caption){var o=Pt.create("figure",{class:"image"});return o.appendChild(r),o.appendChild(Pt.create("figcaption",{contentEditable:"true"},"Caption")),o.contentEditable="false",o}return r},on=function(t,n){return{src:Lt(n,"src"),alt:Lt(n,"alt"),title:Lt(n,"title"),width:Xt(n,"width"),height:Xt(n,"height"),class:Lt(n,"class"),style:t(Lt(n,"style")),caption:zt(n),hspace:Nt(n),vspace:Mt(n),border:Ft(n),borderStyle:Ht(n,"borderStyle")}},un=function(t,n,e,r,o){e[r]!==n[r]&&o(t,r,e[r])},an=function(t,n){return function(e,r,o){t(e,o),Gt(e,n)}},cn=function(t,n,e){var r=on(t,e);un(e,r,n,"caption",(function(t,n,e){return Wt(t)})),un(e,r,n,"src",Vt),un(e,r,n,"alt",Vt),un(e,r,n,"title",Vt),un(e,r,n,"width",qt("width",t)),un(e,r,n,"height",qt("height",t)),un(e,r,n,"class",Vt),un(e,r,n,"style",an((function(t,n){return Vt(t,"style",n)}),t)),un(e,r,n,"hspace",an(Yt,t)),un(e,r,n,"vspace",an(Kt,t)),un(e,r,n,"border",an($t,t)),un(e,r,n,"borderStyle",an(Jt,t))},sn=function(t,n){var e=t.dom.styles.parse(n),r=It.mergeMargins(e),o=t.dom.styles.parse(t.dom.styles.serialize(r));return t.dom.styles.serialize(o)},fn=function(t){var n=t.selection.getNode(),e=t.dom.getParent(n,"figure.image");return e?t.dom.select("img",e)[0]:n&&("IMG"!==n.nodeName||It.isPlaceholderImage(n))?null:n},ln=function(t,n){var e=t.dom,r=e.getParent(n.parentNode,(function(n){return t.schema.getTextBlockElements()[n.nodeName]}),t.getBody());return r?e.split(r,n):n},dn=function(t){var n=fn(t);return n?on((function(n){return sn(t,n)}),n):nn()},mn=function(t,n){var e=rn((function(n){return sn(t,n)}),n);t.dom.setAttrib(e,"data-mce-id","__mcenew"),t.focus(),t.selection.setContent(e.outerHTML);var r=t.dom.select('*[data-mce-id="__mcenew"]')[0];if(t.dom.setAttrib(r,"data-mce-id",null),Zt(r)){var o=ln(t,r);t.selection.select(o)}else t.selection.select(r)},gn=function(t,n){t.dom.setAttrib(n,"src",n.getAttribute("src"))},pn=function(t,n){if(n){var e=t.dom.is(n.parentNode,"figure.image")?n.parentNode:n;t.dom.remove(e),t.focus(),t.nodeChanged(),t.dom.isEmpty(t.getBody())&&(t.setContent(""),t.selection.setCursorLocation())}},hn=function(t,n){var e=fn(t);if(cn((function(n){return sn(t,n)}),n,e),gn(t,e),Zt(e.parentNode)){var r=e.parentNode;ln(t,r),t.selection.select(e.parentNode)}else t.selection.select(e),It.waitLoadImage(t,n,e)},vn=function(t,n){var e=fn(t);e?n.src?hn(t,n):pn(t,e):n.src&&mn(t,n)},bn=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return m.none()},yn=tinymce.util.Tools.resolve("tinymce.util.Tools"),wn=function(t){return h(t.value)?t.value:""},xn=function(t,n){var e=[];return yn.each(t,(function(t){var r=h(t.text)?t.text:h(t.title)?t.title:"";if(void 0!==t.menu){var o=xn(t.menu,n);e.push({text:r,items:o})}else{var i=n(t);e.push({text:r,value:i})}})),e},Cn=function(t){return void 0===t&&(t=wn),function(n){return n?m.from(n).map((function(n){return xn(n,t)})):m.none()}},Sn=function(t){return Cn(wn)(t)},kn=function(t){return Object.prototype.hasOwnProperty.call(t,"items")},On=function(t,n){return bn(t,(function(t){return kn(t)?On(t.items,n):t.value===n?m.some(t):m.none()}))},Tn=function(t,n){return t.bind((function(t){return On(t,n)}))},En={sanitizer:Cn,sanitize:Sn,findEntry:Tn},Dn=function(t,n){return t?t.replace(/\/$/,"")+"/"+n.replace(/^\//,""):n};function An(t){var e=function(e,r,o,i){var u,a;u=new n.XMLHttpRequest,u.open("POST",t.url),u.withCredentials=t.credentials,u.upload.onprogress=function(t){i(t.loaded/t.total*100)},u.onerror=function(){o("Image upload failed due to a XHR Transport error. Code: "+u.status)},u.onload=function(){var n;u.status<200||u.status>=300?o("HTTP Error: "+u.status):(n=JSON.parse(u.responseText),n&&"string"===typeof n.location?r(Dn(t.basePath,n.location)):o("Invalid JSON: "+u.responseText))},a=new n.FormData,a.append("file",e.blob(),e.filename()),u.send(a)},o=function(t,n){return new ut((function(e,o){try{n(t,e,o,r)}catch(i){o(i.message)}}))},i=function(t){return t===e},u=function(n){return!t.url&&i(t.handler)?ut.reject("Upload url missing from the settings."):o(n,t.handler)};return t=yn.extend({credentials:!1,handler:e},t),{upload:u}}var _n=function(t){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"selectbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},Rn={makeTab:_n},Bn=function(t){var n=En.sanitizer((function(n){return t.convertURL(n.value||n.url,"src")})),e=F.nu((function(e){It.createImageList(t,(function(t){e(n(t).map((function(t){return k([[{text:"None",value:""}],t])})))}))})),r=En.sanitize(St.getClassList(t)),o=St.hasAdvTab(t),i=St.hasUploadTab(t),u=St.hasUploadUrl(t),a=St.hasUploadHandler(t),c=dn(t),s=St.hasDescription(t),f=St.hasImageTitle(t),l=St.hasDimensions(t),d=St.hasImageCaption(t),g=St.getUploadUrl(t),p=St.getUploadBasePath(t),v=St.getUploadCredentials(t),b=St.getUploadHandler(t),y=m.some(St.getPrependUrl(t)).filter((function(t){return h(t)&&t.length>0}));return e.map((function(t){return{image:c,imageList:t,classList:r,hasAdvTab:o,hasUploadTab:i,hasUploadUrl:u,hasUploadHandler:a,hasDescription:s,hasImageTitle:f,hasDimensions:l,hasImageCaption:d,url:g,basePath:p,credentials:v,handler:b,prependURL:y}}))},In=function(t){var n=[{type:"dropzone",name:"fileinput"}];return{title:"Upload",name:"upload",items:n}},Pn={makeTab:In},Nn=function(t){return{prevImage:En.findEntry(t.imageList,t.image.src),prevAlt:t.image.alt,open:!0}},Mn=function(t){return{src:{value:t.src,meta:{}},images:t.src,alt:t.alt,title:t.title,dimensions:{width:t.width,height:t.height},classes:t.class,caption:t.caption,style:t.style,vspace:t.vspace,border:t.border,hspace:t.hspace,borderstyle:t.borderStyle,fileinput:[]}},Fn=function(t){return{src:t.src.value,alt:t.alt,title:t.title,width:t.dimensions.width,height:t.dimensions.height,class:t.classes,style:t.style,caption:t.caption,hspace:t.hspace,vspace:t.vspace,border:t.border,borderStyle:t.borderstyle}},Ln=function(t,n){return/^(?:[a-zA-Z]+:)?\/\//.test(n)?m.none():t.prependURL.bind((function(t){return n.substring(0,t.length)!==t?m.some(t+n):m.none()}))},Hn=function(t,n){var e=n.getData();Ln(t,e.src.value).each((function(t){n.setData({src:{value:t,meta:e.src.meta}})}))},zn=function(t,n,e){t.hasDescription&&h(e.alt)&&(n.alt=e.alt),t.hasImageTitle&&h(e.title)&&(n.title=e.title),t.hasDimensions&&(h(e.width)&&(n.dimensions.width=e.width),h(e.height)&&(n.dimensions.height=e.height)),h(e.class)&&En.findEntry(t.classList,e.class).each((function(t){n.classes=t.value})),t.hasImageCaption&&y(e.caption)&&(n.caption=e.caption),t.hasAdvTab&&(h(e.vspace)&&(n.vspace=e.vspace),h(e.border)&&(n.border=e.border),h(e.hspace)&&(n.hspace=e.hspace),h(e.borderstyle)&&(n.borderstyle=e.borderstyle))},Vn=function(t,n){var e=n.getData(),r=e.src.meta;if(void 0!==r){var o=tt({},e);zn(t,o,r),n.setData(o)}},jn=function(t,n,e,r){var o=r.getData(),i=o.src.value,u=o.src.meta||{};u.width||u.height||!n.hasDimensions||t.imageSize(i).get((function(t){t.each((function(t){e.open&&r.setData({dimensions:t})}))}))},Un=function(t,n,e){var r=e.getData(),o=En.findEntry(t.imageList,r.src.value);n.prevImage=o,e.setData({images:o.map((function(t){return t.value})).getOr("")})},Wn=function(t,n,e,r){Hn(n,r),Vn(n,r),jn(t,n,e,r),Un(n,e,r)},Gn=function(t,n,e,r){var o=r.getData(),i=En.findEntry(n.imageList,o.images);i.each((function(t){var n=""===o.alt||e.prevImage.map((function(t){return t.text===o.alt})).getOr(!1);n?""===t.value?r.setData({src:t,alt:e.prevAlt}):r.setData({src:t,alt:t.text}):r.setData({src:t})})),e.prevImage=i,Wn(t,n,e,r)},qn=function(t){var n=t["margin-top"]&&t["margin-bottom"]&&t["margin-top"]===t["margin-bottom"];return n?It.removePixelSuffix(String(t["margin-top"])):""},Xn=function(t){var n=t["margin-right"]&&t["margin-left"]&&t["margin-right"]===t["margin-left"];return n?It.removePixelSuffix(String(t["margin-right"])):""},Yn=function(t){return t["border-width"]?It.removePixelSuffix(String(t["border-width"])):""},Kn=function(t){return t["border-style"]?String(t["border-style"]):""},$n=function(t,n,e){return n(t(n(e)))},Jn=function(t,n,e){var r=It.mergeMargins(t(e.style)),o=tt({},e);return o.vspace=qn(r),o.hspace=Xn(r),o.border=Yn(r),o.borderstyle=Kn(r),o.style=$n(t,n,r),o},Qn=function(t,n){var e=n.getData(),r=Jn(t.parseStyle,t.serializeStyle,e);n.setData(r)},Zn=function(t,n,e){var r=tt(Mn(n.image),e.getData()),o=en(t.normalizeCss,Fn(r));e.setData({style:o})},te=function(t,e,r,o){var i=o.getData();o.block("Uploading image"),O(i.fileinput).fold((function(){o.unblock()}),(function(i){var u=n.URL.createObjectURL(i),a=An({url:e.url,basePath:e.basePath,credentials:e.credentials,handler:e.handler}),c=function(){o.unblock(),n.URL.revokeObjectURL(u)};It.blobToDataUri(i).then((function(n){var s=t.createBlobCache(i,u,n);a.upload(s).then((function(n){o.setData({src:{value:n,meta:{}}}),o.showTab("general"),Wn(t,e,r,o),c()})).catch((function(n){c(),t.alertErr(o,n)}))}))}))},ne=function(t,n,e){return function(r,o){"src"===o.name?Wn(t,n,e,r):"images"===o.name?Gn(t,n,e,r):"alt"===o.name?e.prevAlt=r.getData().alt:"style"===o.name?Qn(t,r):"vspace"===o.name||"hspace"===o.name||"border"===o.name||"borderstyle"===o.name?Zn(t,n,r):"fileinput"===o.name&&te(t,n,e,r)}},ee=function(t){return function(){t.open=!1}},re=function(t){if(t.hasAdvTab||t.hasUploadUrl||t.hasUploadHandler){var n={type:"tabpanel",tabs:k([[ot.makeTab(t)],t.hasAdvTab?[Rn.makeTab(t)]:[],t.hasUploadTab&&(t.hasUploadUrl||t.hasUploadHandler)?[Pn.makeTab(t)]:[]])};return n}var e={type:"panel",items:ot.makeItems(t)};return e},oe=function(t){return function(n){var e=Nn(n);return{title:"Insert/Edit Image",size:"normal",body:re(n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Mn(n.image),onSubmit:t.onSubmit(n),onChange:ne(t,n,e),onClose:ee(e)}}},ie=function(t){return function(n){return function(e){var r=tt(Mn(n.image),e.getData());t.undoManager.transact((function(){vn(t,Fn(r))})),t.editorUpload.uploadImagesAuto(),e.close()}}},ue=function(t){return function(n){return K.nu((function(e){It.getImageSize(t.documentBaseURI.toAbsolute(n),(function(t){var n=t.map((function(t){return{width:String(t.width),height:String(t.height)}}));e(n)}))}))}},ae=function(t){return function(n,e,r){return t.editorUpload.blobCache.create({blob:n,blobUri:e,name:n.name?n.name.replace(/\.[^\.]+$/,""):null,base64:r.split(",")[1]})}},ce=function(t){return function(n,e){t.windowManager.alert(e,n.close)}},se=function(t){return function(n){return sn(t,n)}},fe=function(t){return function(n){return t.dom.parseStyle(n)}},le=function(t){return function(n,e){return t.dom.serializeStyle(n,e)}},de=function(t){var n={onSubmit:ie(t),imageSize:ue(t),createBlobCache:ae(t),alertErr:ce(t),normalizeCss:se(t),parseStyle:fe(t),serializeStyle:le(t)},e=function(){return Bn(t).map(oe(n)).get((function(n){t.windowManager.open(n)}))};return{open:e}},me=function(t){t.addCommand("mceImage",de(t).open)},ge={register:me},pe=function(t){var n=t.attr("class");return n&&/\bimage\b/.test(n)},he=function(t){return function(n){var e=n.length,r=function(n){n.attr("contenteditable",t?"true":null)};while(e--){var o=n[e];pe(o)&&(o.attr("contenteditable",t?"false":null),yn.each(o.getAll("figcaption"),r))}}},ve=function(t){t.on("PreInit",(function(){t.parser.addNodeFilter("figure",he(!0)),t.serializer.addNodeFilter("figure",he(!1))}))},be={setup:ve},ye=function(t){t.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:de(t).open,onSetup:function(n){return t.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",n.setActive).unbind}}),t.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:de(t).open}),t.ui.registry.addContextMenu("image",{update:function(t){return Zt(t)||tn(t)&&!It.isPlaceholderImage(t)?["image"]:[]}})},we={register:ye};function xe(){e.add("image",(function(t){be.setup(t),we.register(t),ge.register(t)}))}xe()})(window)}).call(this,e("c8ba"))},ef1f:function(t,n){(function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(t,n){t.focus(),t.undoManager.transact((function(){t.setContent(n)})),t.selection.setCursorLocation(),t.nodeChanged()},e=function(t){return t.getContent({source_view:!0})},r={setContent:n,getContent:e},o=function(t){var n=r.getContent(t);t.windowManager.open({title:"Source Code",size:"large",body:{type:"panel",items:[{type:"textarea",name:"code"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{code:n},onSubmit:function(n){r.setContent(t,n.getData().code),n.close()}})},i={open:o},u=function(t){t.addCommand("mceCodeEditor",(function(){i.open(t)}))},a={register:u},c=function(t){t.ui.registry.addButton("code",{icon:"sourcecode",tooltip:"Source code",onAction:function(){return i.open(t)}}),t.ui.registry.addMenuItem("code",{icon:"sourcecode",text:"Source code",onAction:function(){return i.open(t)}})},s={register:c};function f(){t.add("code",(function(t){return a.register(t),s.register(t),{}}))}f()})()},f872:function(t,n,e){"use strict";e.r(n),function(t){e("a4d3"),e("e01a"),e("d28b"),e("99af"),e("d3b7"),e("3ca3"),e("ddb0"),e("e260"),e("e6cf"),e("cca6"),e("a79d");var n=e("e562"),r=e.n(n);e("0d68"),e("4237"),e("84ec"),e("4ea8"),e("07d1"),e("64d8"),e("bc54");function o(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=["link","lists","image","table"],o="undo redo removeformat | styleselect | h1 h2 | bold italic underline | numlist bullist indent outdent | table blockquote link image";n&&(e.push("code"),o+=" | code");var i="".concat(t.type,"#").concat(t.id);r.a.init({selector:i,plugins:e,skin_url:"/static/tinymce_skin",menubar:!1,branding:!1,toolbar:o,contextmenu_never_use_native:!1,contextmenu:!1})}var i=!0,u=!1,a=void 0;try{for(var c,s=document.querySelectorAll(".richtext-editor")[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var f=c.value;o(f)}}catch(v){u=!0,a=v}finally{try{i||null==s.return||s.return()}finally{if(u)throw a}}var l=!0,d=!1,m=void 0;try{for(var g,p=document.querySelectorAll(".richtext-editor-src")[Symbol.iterator]();!(l=(g=p.next()).done);l=!0){var h=g.value;o(h,!0)}}catch(v){d=!0,m=v}finally{try{l||null==p.return||p.return()}finally{if(d)throw m}}t.initRichTextEditor=o}.call(this,e("c8ba"))}});
//# sourceMappingURL=rich_text_editor.8a622f99.js.map